/*! For license information please see main.6c8c0d72.js.LICENSE.txt */
(()=>{"use strict";var t={730:(t,e,i)=>{var n=i(43),s=i(853);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function l(t,e){h(t,e),h(t+"Capture",e)}function h(t,e){for(a[t]=e,t=0;t<e.length;t++)r.add(e[t])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},g={};function m(t,e,i,n,s,o,r){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=r}var p={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){p[t]=new m(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];p[e]=new m(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){p[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){p[t]=new m(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){p[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){p[t]=new m(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){p[t]=new m(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){p[t]=new m(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){p[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(t){return t[1].toUpperCase()}function b(t,e,i,n){var s=p.hasOwnProperty(e)?p[e]:null;(null!==s?0!==s.type:n||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,i,n){if(null===e||"undefined"===typeof e||function(t,e,i,n){if(null!==i&&0===i.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,i,s,n)&&(i=null),n||null===s?function(t){return!!c.call(g,t)||!c.call(f,t)&&(d.test(t)?g[t]=!0:(f[t]=!0,!1))}(e)&&(null===i?t.removeAttribute(e):t.setAttribute(e,""+i)):s.mustUseProperty?t[s.propertyName]=null===i?3!==s.type&&"":i:(e=s.attributeName,n=s.attributeNamespace,null===i?t.removeAttribute(e):(i=3===(s=s.type)||4===s&&!0===i?"":""+i,n?t.setAttributeNS(n,e,i):t.setAttribute(e,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,v);p[e]=new m(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,v);p[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,v);p[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){p[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)})),p.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){p[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)}));var x=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),N=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),F=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function E(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=R&&t[R]||t["@@iterator"])?t:null}var B,I=Object.assign;function V(t){if(void 0===B)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);B=e&&e[1]||""}return"\n"+B+t}var z=!1;function j(t,e){if(!t||z)return"";z=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var n=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){n=h}t.call(e.prototype)}else{try{throw Error()}catch(h){n=h}t()}}catch(h){if(h&&n&&"string"===typeof h.stack){for(var s=h.stack.split("\n"),o=n.stack.split("\n"),r=s.length-1,a=o.length-1;1<=r&&0<=a&&s[r]!==o[a];)a--;for(;1<=r&&0<=a;r--,a--)if(s[r]!==o[a]){if(1!==r||1!==a)do{if(r--,0>--a||s[r]!==o[a]){var l="\n"+s[r].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=r&&0<=a);break}}}finally{z=!1,Error.prepareStackTrace=i}return(t=t?t.displayName||t.name:"")?V(t):""}function U(t){switch(t.tag){case 5:return V(t.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return t=j(t.type,!1);case 11:return t=j(t.type.render,!1);case 1:return t=j(t.type,!0);default:return""}}function K(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case S:return"Fragment";case k:return"Portal";case M:return"Profiler";case P:return"StrictMode";case T:return"Suspense";case A:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case N:return(t.displayName||"Context")+".Consumer";case C:return(t._context.displayName||"Context")+".Provider";case L:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case D:return null!==(e=t.displayName||null)?e:K(t.type)||"Memo";case F:e=t._payload,t=t._init;try{return K(t(e))}catch(i){}}return null}function G(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K(e);case 8:return e===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function X(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function Y(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function _(t){t._valueTracker||(t._valueTracker=function(t){var e=Y(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var s=i.get,o=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(t){n=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(t){n=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function H(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),n="";return t&&(n=Y(t)?t.checked?"true":"false":t.value),(t=n)!==i&&(e.setValue(t),!0)}function q(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function W(t,e){var i=e.checked;return I({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:t._wrapperState.initialChecked})}function $(t,e){var i=null==e.defaultValue?"":e.defaultValue,n=null!=e.checked?e.checked:e.defaultChecked;i=X(null!=e.value?e.value:i),t._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function J(t,e){null!=(e=e.checked)&&b(t,"checked",e,!1)}function Z(t,e){J(t,e);var i=X(e.value),n=e.type;if(null!=i)"number"===n?(0===i&&""===t.value||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if("submit"===n||"reset"===n)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,i):e.hasOwnProperty("defaultValue")&&tt(t,e.type,X(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Q(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!("submit"!==n&&"reset"!==n||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}""!==(i=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==i&&(t.name=i)}function tt(t,e,i){"number"===e&&q(t.ownerDocument)===t||(null==i?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}var et=Array.isArray;function it(t,e,i,n){if(t=t.options,e){e={};for(var s=0;s<i.length;s++)e["$"+i[s]]=!0;for(i=0;i<t.length;i++)s=e.hasOwnProperty("$"+t[i].value),t[i].selected!==s&&(t[i].selected=s),s&&n&&(t[i].defaultSelected=!0)}else{for(i=""+X(i),e=null,s=0;s<t.length;s++){if(t[s].value===i)return t[s].selected=!0,void(n&&(t[s].defaultSelected=!0));null!==e||t[s].disabled||(e=t[s])}null!==e&&(e.selected=!0)}}function nt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return I({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function st(t,e){var i=e.value;if(null==i){if(i=e.children,e=e.defaultValue,null!=i){if(null!=e)throw Error(o(92));if(et(i)){if(1<i.length)throw Error(o(93));i=i[0]}e=i}null==e&&(e=""),i=e}t._wrapperState={initialValue:X(i)}}function ot(t,e){var i=X(e.value),n=X(e.defaultValue);null!=i&&((i=""+i)!==t.value&&(t.value=i),null==e.defaultValue&&t.defaultValue!==i&&(t.defaultValue=i)),null!=n&&(t.defaultValue=""+n)}function rt(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function at(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?at(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ht,ut,ct=(ut=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ht=ht||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ht.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,i,n){MSApp.execUnsafeLocalFunction((function(){return ut(t,e)}))}:ut);function dt(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&3===i.nodeType)return void(i.nodeValue=e)}t.textContent=e}var ft={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gt=["Webkit","ms","Moz","O"];function mt(t,e,i){return null==e||"boolean"===typeof e||""===e?"":i||"number"!==typeof e||0===e||ft.hasOwnProperty(t)&&ft[t]?(""+e).trim():e+"px"}function pt(t,e){for(var i in t=t.style,e)if(e.hasOwnProperty(i)){var n=0===i.indexOf("--"),s=mt(i,e[i],n);"float"===i&&(i="cssFloat"),n?t.setProperty(i,s):t[i]=s}}Object.keys(ft).forEach((function(t){gt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ft[e]=ft[t]}))}));var yt=I({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vt(t,e){if(e){if(yt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(o(62))}}function bt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xt=null;function wt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var kt=null,St=null,Pt=null;function Mt(t){if(t=bs(t)){if("function"!==typeof kt)throw Error(o(280));var e=t.stateNode;e&&(e=ws(e),kt(t.stateNode,t.type,e))}}function Ct(t){St?Pt?Pt.push(t):Pt=[t]:St=t}function Nt(){if(St){var t=St,e=Pt;if(Pt=St=null,Mt(t),e)for(t=0;t<e.length;t++)Mt(e[t])}}function Lt(t,e){return t(e)}function Tt(){}var At=!1;function Dt(t,e,i){if(At)return t(e,i);At=!0;try{return Lt(t,e,i)}finally{At=!1,(null!==St||null!==Pt)&&(Tt(),Nt())}}function Ft(t,e){var i=t.stateNode;if(null===i)return null;var n=ws(i);if(null===n)return null;i=n[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!n;break t;default:t=!1}if(t)return null;if(i&&"function"!==typeof i)throw Error(o(231,e,typeof i));return i}var Ot=!1;if(u)try{var Rt={};Object.defineProperty(Rt,"passive",{get:function(){Ot=!0}}),window.addEventListener("test",Rt,Rt),window.removeEventListener("test",Rt,Rt)}catch(ut){Ot=!1}function Et(t,e,i,n,s,o,r,a,l){var h=Array.prototype.slice.call(arguments,3);try{e.apply(i,h)}catch(u){this.onError(u)}}var Bt=!1,It=null,Vt=!1,zt=null,jt={onError:function(t){Bt=!0,It=t}};function Ut(t,e,i,n,s,o,r,a,l){Bt=!1,It=null,Et.apply(jt,arguments)}function Kt(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(i=e.return),t=e.return}while(t)}return 3===e.tag?i:null}function Gt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Xt(t){if(Kt(t)!==t)throw Error(o(188))}function Yt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Kt(t)))throw Error(o(188));return e!==t?null:t}for(var i=t,n=e;;){var s=i.return;if(null===s)break;var r=s.alternate;if(null===r){if(null!==(n=s.return)){i=n;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===i)return Xt(s),t;if(r===n)return Xt(s),e;r=r.sibling}throw Error(o(188))}if(i.return!==n.return)i=s,n=r;else{for(var a=!1,l=s.child;l;){if(l===i){a=!0,i=s,n=r;break}if(l===n){a=!0,n=s,i=r;break}l=l.sibling}if(!a){for(l=r.child;l;){if(l===i){a=!0,i=r,n=s;break}if(l===n){a=!0,n=r,i=s;break}l=l.sibling}if(!a)throw Error(o(189))}}if(i.alternate!==n)throw Error(o(190))}if(3!==i.tag)throw Error(o(188));return i.stateNode.current===i?t:e}(t))?_t(t):null}function _t(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=_t(t);if(null!==e)return e;t=t.sibling}return null}var Ht=s.unstable_scheduleCallback,qt=s.unstable_cancelCallback,Wt=s.unstable_shouldYield,$t=s.unstable_requestPaint,Jt=s.unstable_now,Zt=s.unstable_getCurrentPriorityLevel,Qt=s.unstable_ImmediatePriority,te=s.unstable_UserBlockingPriority,ee=s.unstable_NormalPriority,ie=s.unstable_LowPriority,ne=s.unstable_IdlePriority,se=null,oe=null;var re=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(ae(t)/le|0)|0},ae=Math.log,le=Math.LN2;var he=64,ue=4194304;function ce(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var i=t.pendingLanes;if(0===i)return 0;var n=0,s=t.suspendedLanes,o=t.pingedLanes,r=268435455&i;if(0!==r){var a=r&~s;0!==a?n=ce(a):0!==(o&=r)&&(n=ce(o))}else 0!==(r=i&~s)?n=ce(r):0!==o&&(n=ce(o));if(0===n)return 0;if(0!==e&&e!==n&&0===(e&s)&&((s=n&-n)>=(o=e&-e)||16===s&&0!==(4194240&o)))return e;if(0!==(4&n)&&(n|=16&i),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=n;0<e;)s=1<<(i=31-re(e)),n|=t[i],e&=~s;return n}function fe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function ge(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function me(){var t=he;return 0===(4194240&(he<<=1))&&(he=64),t}function pe(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function ye(t,e,i){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-re(e)]=i}function ve(t,e){var i=t.entangledLanes|=e;for(t=t.entanglements;i;){var n=31-re(i),s=1<<n;s&e|t[n]&e&&(t[n]|=e),i&=~s}}var be=0;function xe(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var we,ke,Se,Pe,Me,Ce=!1,Ne=[],Le=null,Te=null,Ae=null,De=new Map,Fe=new Map,Oe=[],Re="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ee(t,e){switch(t){case"focusin":case"focusout":Le=null;break;case"dragenter":case"dragleave":Te=null;break;case"mouseover":case"mouseout":Ae=null;break;case"pointerover":case"pointerout":De.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fe.delete(e.pointerId)}}function Be(t,e,i,n,s,o){return null===t||t.nativeEvent!==o?(t={blockedOn:e,domEventName:i,eventSystemFlags:n,nativeEvent:o,targetContainers:[s]},null!==e&&(null!==(e=bs(e))&&ke(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,null!==s&&-1===e.indexOf(s)&&e.push(s),t)}function Ie(t){var e=vs(t.target);if(null!==e){var i=Kt(e);if(null!==i)if(13===(e=i.tag)){if(null!==(e=Gt(i)))return t.blockedOn=e,void Me(t.priority,(function(){Se(i)}))}else if(3===e&&i.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}t.blockedOn=null}function Ve(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var i=We(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==i)return null!==(e=bs(i))&&ke(e),t.blockedOn=i,!1;var n=new(i=t.nativeEvent).constructor(i.type,i);xt=n,i.target.dispatchEvent(n),xt=null,e.shift()}return!0}function ze(t,e,i){Ve(t)&&i.delete(e)}function je(){Ce=!1,null!==Le&&Ve(Le)&&(Le=null),null!==Te&&Ve(Te)&&(Te=null),null!==Ae&&Ve(Ae)&&(Ae=null),De.forEach(ze),Fe.forEach(ze)}function Ue(t,e){t.blockedOn===e&&(t.blockedOn=null,Ce||(Ce=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,je)))}function Ke(t){function e(e){return Ue(e,t)}if(0<Ne.length){Ue(Ne[0],t);for(var i=1;i<Ne.length;i++){var n=Ne[i];n.blockedOn===t&&(n.blockedOn=null)}}for(null!==Le&&Ue(Le,t),null!==Te&&Ue(Te,t),null!==Ae&&Ue(Ae,t),De.forEach(e),Fe.forEach(e),i=0;i<Oe.length;i++)(n=Oe[i]).blockedOn===t&&(n.blockedOn=null);for(;0<Oe.length&&null===(i=Oe[0]).blockedOn;)Ie(i),null===i.blockedOn&&Oe.shift()}var Ge=x.ReactCurrentBatchConfig,Xe=!0;function Ye(t,e,i,n){var s=be,o=Ge.transition;Ge.transition=null;try{be=1,He(t,e,i,n)}finally{be=s,Ge.transition=o}}function _e(t,e,i,n){var s=be,o=Ge.transition;Ge.transition=null;try{be=4,He(t,e,i,n)}finally{be=s,Ge.transition=o}}function He(t,e,i,n){if(Xe){var s=We(t,e,i,n);if(null===s)Xn(t,e,n,qe,i),Ee(t,n);else if(function(t,e,i,n,s){switch(e){case"focusin":return Le=Be(Le,t,e,i,n,s),!0;case"dragenter":return Te=Be(Te,t,e,i,n,s),!0;case"mouseover":return Ae=Be(Ae,t,e,i,n,s),!0;case"pointerover":var o=s.pointerId;return De.set(o,Be(De.get(o)||null,t,e,i,n,s)),!0;case"gotpointercapture":return o=s.pointerId,Fe.set(o,Be(Fe.get(o)||null,t,e,i,n,s)),!0}return!1}(s,t,e,i,n))n.stopPropagation();else if(Ee(t,n),4&e&&-1<Re.indexOf(t)){for(;null!==s;){var o=bs(s);if(null!==o&&we(o),null===(o=We(t,e,i,n))&&Xn(t,e,n,qe,i),o===s)break;s=o}null!==s&&n.stopPropagation()}else Xn(t,e,n,null,i)}}var qe=null;function We(t,e,i,n){if(qe=null,null!==(t=vs(t=wt(n))))if(null===(e=Kt(t)))t=null;else if(13===(i=e.tag)){if(null!==(t=Gt(e)))return t;t=null}else if(3===i){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qe=t,null}function $e(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zt()){case Qt:return 1;case te:return 4;case ee:case ie:return 16;case ne:return 536870912;default:return 16}default:return 16}}var Je=null,Ze=null,Qe=null;function ti(){if(Qe)return Qe;var t,e,i=Ze,n=i.length,s="value"in Je?Je.value:Je.textContent,o=s.length;for(t=0;t<n&&i[t]===s[t];t++);var r=n-t;for(e=1;e<=r&&i[n-e]===s[o-e];e++);return Qe=s.slice(t,1<e?1-e:void 0)}function ei(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function ii(){return!0}function ni(){return!1}function si(t){function e(e,i,n,s,o){for(var r in this._reactName=e,this._targetInst=n,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(r)&&(e=t[r],this[r]=e?e(s):s[r]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?ii:ni,this.isPropagationStopped=ni,this}return I(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=ii)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=ii)},persist:function(){},isPersistent:ii}),e}var oi,ri,ai,li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hi=si(li),ui=I({},li,{view:0,detail:0}),ci=si(ui),di=I({},ui,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pi,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ai&&(ai&&"mousemove"===t.type?(oi=t.screenX-ai.screenX,ri=t.screenY-ai.screenY):ri=oi=0,ai=t),oi)},movementY:function(t){return"movementY"in t?t.movementY:ri}}),fi=si(di),gi=si(I({},di,{dataTransfer:0})),mi=si(I({},ui,{relatedTarget:0})),pi=si(I({},li,{animationName:0,elapsedTime:0,pseudoElement:0})),yi=I({},li,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),vi=si(yi),bi=si(I({},li,{data:0})),xi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ki={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Si(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=ki[t])&&!!e[t]}function Pi(){return Si}var Mi=I({},ui,{key:function(t){if(t.key){var e=xi[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=ei(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?wi[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pi,charCode:function(t){return"keypress"===t.type?ei(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?ei(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Ci=si(Mi),Ni=si(I({},di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Li=si(I({},ui,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pi})),Ti=si(I({},li,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ai=I({},di,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Di=si(Ai),Fi=[9,13,27,32],Oi=u&&"CompositionEvent"in window,Ri=null;u&&"documentMode"in document&&(Ri=document.documentMode);var Ei=u&&"TextEvent"in window&&!Ri,Bi=u&&(!Oi||Ri&&8<Ri&&11>=Ri),Ii=String.fromCharCode(32),Vi=!1;function zi(t,e){switch(t){case"keyup":return-1!==Fi.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ji(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Ui=!1;var Ki={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Ki[t.type]:"textarea"===e}function Xi(t,e,i,n){Ct(n),0<(e=_n(e,"onChange")).length&&(i=new hi("onChange","change",null,i,n),t.push({event:i,listeners:e}))}var Yi=null,_i=null;function Hi(t){Vn(t,0)}function qi(t){if(H(xs(t)))return t}function Wi(t,e){if("change"===t)return e}var $i=!1;if(u){var Ji;if(u){var Zi="oninput"in document;if(!Zi){var Qi=document.createElement("div");Qi.setAttribute("oninput","return;"),Zi="function"===typeof Qi.oninput}Ji=Zi}else Ji=!1;$i=Ji&&(!document.documentMode||9<document.documentMode)}function tn(){Yi&&(Yi.detachEvent("onpropertychange",en),_i=Yi=null)}function en(t){if("value"===t.propertyName&&qi(_i)){var e=[];Xi(e,_i,t,wt(t)),Dt(Hi,e)}}function nn(t,e,i){"focusin"===t?(tn(),_i=i,(Yi=e).attachEvent("onpropertychange",en)):"focusout"===t&&tn()}function sn(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return qi(_i)}function on(t,e){if("click"===t)return qi(e)}function rn(t,e){if("input"===t||"change"===t)return qi(e)}var an="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function ln(t,e){if(an(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var s=i[n];if(!c.call(e,s)||!an(t[s],e[s]))return!1}return!0}function hn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function un(t,e){var i,n=hn(t);for(t=0;n;){if(3===n.nodeType){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=hn(n)}}function cn(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?cn(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function dn(){for(var t=window,e=q();e instanceof t.HTMLIFrameElement;){try{var i="string"===typeof e.contentWindow.location.href}catch(n){i=!1}if(!i)break;e=q((t=e.contentWindow).document)}return e}function fn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function gn(t){var e=dn(),i=t.focusedElem,n=t.selectionRange;if(e!==i&&i&&i.ownerDocument&&cn(i.ownerDocument.documentElement,i)){if(null!==n&&fn(i))if(e=n.start,void 0===(t=n.end)&&(t=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(t,i.value.length);else if((t=(e=i.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var s=i.textContent.length,o=Math.min(n.start,s);n=void 0===n.end?o:Math.min(n.end,s),!t.extend&&o>n&&(s=n,n=o,o=s),s=un(i,o);var r=un(i,n);s&&r&&(1!==t.rangeCount||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==r.node||t.focusOffset!==r.offset)&&((e=e.createRange()).setStart(s.node,s.offset),t.removeAllRanges(),o>n?(t.addRange(e),t.extend(r.node,r.offset)):(e.setEnd(r.node,r.offset),t.addRange(e)))}for(e=[],t=i;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<e.length;i++)(t=e[i]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mn=u&&"documentMode"in document&&11>=document.documentMode,pn=null,yn=null,vn=null,bn=!1;function xn(t,e,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;bn||null==pn||pn!==q(n)||("selectionStart"in(n=pn)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},vn&&ln(vn,n)||(vn=n,0<(n=_n(yn,"onSelect")).length&&(e=new hi("onSelect","select",null,e,i),t.push({event:e,listeners:n}),e.target=pn)))}function wn(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var kn={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},Sn={},Pn={};function Mn(t){if(Sn[t])return Sn[t];if(!kn[t])return t;var e,i=kn[t];for(e in i)if(i.hasOwnProperty(e)&&e in Pn)return Sn[t]=i[e];return t}u&&(Pn=document.createElement("div").style,"AnimationEvent"in window||(delete kn.animationend.animation,delete kn.animationiteration.animation,delete kn.animationstart.animation),"TransitionEvent"in window||delete kn.transitionend.transition);var Cn=Mn("animationend"),Nn=Mn("animationiteration"),Ln=Mn("animationstart"),Tn=Mn("transitionend"),An=new Map,Dn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fn(t,e){An.set(t,e),l(e,[t])}for(var On=0;On<Dn.length;On++){var Rn=Dn[On];Fn(Rn.toLowerCase(),"on"+(Rn[0].toUpperCase()+Rn.slice(1)))}Fn(Cn,"onAnimationEnd"),Fn(Nn,"onAnimationIteration"),Fn(Ln,"onAnimationStart"),Fn("dblclick","onDoubleClick"),Fn("focusin","onFocus"),Fn("focusout","onBlur"),Fn(Tn,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var En="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bn=new Set("cancel close invalid load scroll toggle".split(" ").concat(En));function In(t,e,i){var n=t.type||"unknown-event";t.currentTarget=i,function(t,e,i,n,s,r,a,l,h){if(Ut.apply(this,arguments),Bt){if(!Bt)throw Error(o(198));var u=It;Bt=!1,It=null,Vt||(Vt=!0,zt=u)}}(n,e,void 0,t),t.currentTarget=null}function Vn(t,e){e=0!==(4&e);for(var i=0;i<t.length;i++){var n=t[i],s=n.event;n=n.listeners;t:{var o=void 0;if(e)for(var r=n.length-1;0<=r;r--){var a=n[r],l=a.instance,h=a.currentTarget;if(a=a.listener,l!==o&&s.isPropagationStopped())break t;In(s,a,h),o=l}else for(r=0;r<n.length;r++){if(l=(a=n[r]).instance,h=a.currentTarget,a=a.listener,l!==o&&s.isPropagationStopped())break t;In(s,a,h),o=l}}}if(Vt)throw t=zt,Vt=!1,zt=null,t}function zn(t,e){var i=e[ms];void 0===i&&(i=e[ms]=new Set);var n=t+"__bubble";i.has(n)||(Gn(e,t,2,!1),i.add(n))}function jn(t,e,i){var n=0;e&&(n|=4),Gn(i,t,n,e)}var Un="_reactListening"+Math.random().toString(36).slice(2);function Kn(t){if(!t[Un]){t[Un]=!0,r.forEach((function(e){"selectionchange"!==e&&(Bn.has(e)||jn(e,!1,t),jn(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Un]||(e[Un]=!0,jn("selectionchange",!1,e))}}function Gn(t,e,i,n){switch($e(e)){case 1:var s=Ye;break;case 4:s=_e;break;default:s=He}i=s.bind(null,e,i,t),s=void 0,!Ot||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(s=!0),n?void 0!==s?t.addEventListener(e,i,{capture:!0,passive:s}):t.addEventListener(e,i,!0):void 0!==s?t.addEventListener(e,i,{passive:s}):t.addEventListener(e,i,!1)}function Xn(t,e,i,n,s){var o=n;if(0===(1&e)&&0===(2&e)&&null!==n)t:for(;;){if(null===n)return;var r=n.tag;if(3===r||4===r){var a=n.stateNode.containerInfo;if(a===s||8===a.nodeType&&a.parentNode===s)break;if(4===r)for(r=n.return;null!==r;){var l=r.tag;if((3===l||4===l)&&((l=r.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;r=r.return}for(;null!==a;){if(null===(r=vs(a)))return;if(5===(l=r.tag)||6===l){n=o=r;continue t}a=a.parentNode}}n=n.return}Dt((function(){var n=o,s=wt(i),r=[];t:{var a=An.get(t);if(void 0!==a){var l=hi,h=t;switch(t){case"keypress":if(0===ei(i))break t;case"keydown":case"keyup":l=Ci;break;case"focusin":h="focus",l=mi;break;case"focusout":h="blur",l=mi;break;case"beforeblur":case"afterblur":l=mi;break;case"click":if(2===i.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Li;break;case Cn:case Nn:case Ln:l=pi;break;case Tn:l=Ti;break;case"scroll":l=ci;break;case"wheel":l=Di;break;case"copy":case"cut":case"paste":l=vi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ni}var u=0!==(4&e),c=!u&&"scroll"===t,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,g=n;null!==g;){var m=(f=g).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Ft(g,d))&&u.push(Yn(g,m,f)))),c)break;g=g.return}0<u.length&&(a=new l(a,h,null,i,s),r.push({event:a,listeners:u}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||i===xt||!(h=i.relatedTarget||i.fromElement)||!vs(h)&&!h[gs])&&(l||a)&&(a=s.window===s?s:(a=s.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=n,null!==(h=(h=i.relatedTarget||i.toElement)?vs(h):null)&&(h!==(c=Kt(h))||5!==h.tag&&6!==h.tag)&&(h=null)):(l=null,h=n),l!==h)){if(u=fi,m="onMouseLeave",d="onMouseEnter",g="mouse","pointerout"!==t&&"pointerover"!==t||(u=Ni,m="onPointerLeave",d="onPointerEnter",g="pointer"),c=null==l?a:xs(l),f=null==h?a:xs(h),(a=new u(m,g+"leave",l,i,s)).target=c,a.relatedTarget=f,m=null,vs(s)===n&&((u=new u(d,g+"enter",h,i,s)).target=f,u.relatedTarget=c,m=u),c=m,l&&h)t:{for(d=h,g=0,f=u=l;f;f=Hn(f))g++;for(f=0,m=d;m;m=Hn(m))f++;for(;0<g-f;)u=Hn(u),g--;for(;0<f-g;)d=Hn(d),f--;for(;g--;){if(u===d||null!==d&&u===d.alternate)break t;u=Hn(u),d=Hn(d)}u=null}else u=null;null!==l&&qn(r,a,l,u,!1),null!==h&&null!==c&&qn(r,c,h,u,!0)}if("select"===(l=(a=n?xs(n):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var p=Wi;else if(Gi(a))if($i)p=rn;else{p=sn;var y=nn}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(p=on);switch(p&&(p=p(t,n))?Xi(r,p,i,s):(y&&y(t,a,n),"focusout"===t&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&tt(a,"number",a.value)),y=n?xs(n):window,t){case"focusin":(Gi(y)||"true"===y.contentEditable)&&(pn=y,yn=n,vn=null);break;case"focusout":vn=yn=pn=null;break;case"mousedown":bn=!0;break;case"contextmenu":case"mouseup":case"dragend":bn=!1,xn(r,i,s);break;case"selectionchange":if(mn)break;case"keydown":case"keyup":xn(r,i,s)}var v;if(Oi)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else Ui?zi(t,i)&&(b="onCompositionEnd"):"keydown"===t&&229===i.keyCode&&(b="onCompositionStart");b&&(Bi&&"ko"!==i.locale&&(Ui||"onCompositionStart"!==b?"onCompositionEnd"===b&&Ui&&(v=ti()):(Ze="value"in(Je=s)?Je.value:Je.textContent,Ui=!0)),0<(y=_n(n,b)).length&&(b=new bi(b,t,null,i,s),r.push({event:b,listeners:y}),v?b.data=v:null!==(v=ji(i))&&(b.data=v))),(v=Ei?function(t,e){switch(t){case"compositionend":return ji(e);case"keypress":return 32!==e.which?null:(Vi=!0,Ii);case"textInput":return(t=e.data)===Ii&&Vi?null:t;default:return null}}(t,i):function(t,e){if(Ui)return"compositionend"===t||!Oi&&zi(t,e)?(t=ti(),Qe=Ze=Je=null,Ui=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Bi&&"ko"!==e.locale?null:e.data}}(t,i))&&(0<(n=_n(n,"onBeforeInput")).length&&(s=new bi("onBeforeInput","beforeinput",null,i,s),r.push({event:s,listeners:n}),s.data=v))}Vn(r,e)}))}function Yn(t,e,i){return{instance:t,listener:e,currentTarget:i}}function _n(t,e){for(var i=e+"Capture",n=[];null!==t;){var s=t,o=s.stateNode;5===s.tag&&null!==o&&(s=o,null!=(o=Ft(t,i))&&n.unshift(Yn(t,o,s)),null!=(o=Ft(t,e))&&n.push(Yn(t,o,s))),t=t.return}return n}function Hn(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function qn(t,e,i,n,s){for(var o=e._reactName,r=[];null!==i&&i!==n;){var a=i,l=a.alternate,h=a.stateNode;if(null!==l&&l===n)break;5===a.tag&&null!==h&&(a=h,s?null!=(l=Ft(i,o))&&r.unshift(Yn(i,l,a)):s||null!=(l=Ft(i,o))&&r.push(Yn(i,l,a))),i=i.return}0!==r.length&&t.push({event:e,listeners:r})}var Wn=/\r\n?/g,$n=/\u0000|\uFFFD/g;function Jn(t){return("string"===typeof t?t:""+t).replace(Wn,"\n").replace($n,"")}function Zn(t,e,i){if(e=Jn(e),Jn(t)!==e&&i)throw Error(o(425))}function Qn(){}var ts=null,es=null;function is(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ns="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,os="function"===typeof Promise?Promise:void 0,rs="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof os?function(t){return os.resolve(null).then(t).catch(as)}:ns;function as(t){setTimeout((function(){throw t}))}function ls(t,e){var i=e,n=0;do{var s=i.nextSibling;if(t.removeChild(i),s&&8===s.nodeType)if("/$"===(i=s.data)){if(0===n)return t.removeChild(s),void Ke(e);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=s}while(i);Ke(e)}function hs(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function us(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var i=t.data;if("$"===i||"$!"===i||"$?"===i){if(0===e)return t;e--}else"/$"===i&&e++}t=t.previousSibling}return null}var cs=Math.random().toString(36).slice(2),ds="__reactFiber$"+cs,fs="__reactProps$"+cs,gs="__reactContainer$"+cs,ms="__reactEvents$"+cs,ps="__reactListeners$"+cs,ys="__reactHandles$"+cs;function vs(t){var e=t[ds];if(e)return e;for(var i=t.parentNode;i;){if(e=i[gs]||i[ds]){if(i=e.alternate,null!==e.child||null!==i&&null!==i.child)for(t=us(t);null!==t;){if(i=t[ds])return i;t=us(t)}return e}i=(t=i).parentNode}return null}function bs(t){return!(t=t[ds]||t[gs])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function xs(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function ws(t){return t[fs]||null}var ks=[],Ss=-1;function Ps(t){return{current:t}}function Ms(t){0>Ss||(t.current=ks[Ss],ks[Ss]=null,Ss--)}function Cs(t,e){Ss++,ks[Ss]=t.current,t.current=e}var Ns={},Ls=Ps(Ns),Ts=Ps(!1),As=Ns;function Ds(t,e){var i=t.type.contextTypes;if(!i)return Ns;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s,o={};for(s in i)o[s]=e[s];return n&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Fs(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Os(){Ms(Ts),Ms(Ls)}function Rs(t,e,i){if(Ls.current!==Ns)throw Error(o(168));Cs(Ls,e),Cs(Ts,i)}function Es(t,e,i){var n=t.stateNode;if(e=e.childContextTypes,"function"!==typeof n.getChildContext)return i;for(var s in n=n.getChildContext())if(!(s in e))throw Error(o(108,G(t)||"Unknown",s));return I({},i,n)}function Bs(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ns,As=Ls.current,Cs(Ls,t),Cs(Ts,Ts.current),!0}function Is(t,e,i){var n=t.stateNode;if(!n)throw Error(o(169));i?(t=Es(t,e,As),n.__reactInternalMemoizedMergedChildContext=t,Ms(Ts),Ms(Ls),Cs(Ls,t)):Ms(Ts),Cs(Ts,i)}var Vs=null,zs=!1,js=!1;function Us(t){null===Vs?Vs=[t]:Vs.push(t)}function Ks(){if(!js&&null!==Vs){js=!0;var t=0,e=be;try{var i=Vs;for(be=1;t<i.length;t++){var n=i[t];do{n=n(!0)}while(null!==n)}Vs=null,zs=!1}catch(s){throw null!==Vs&&(Vs=Vs.slice(t+1)),Ht(Qt,Ks),s}finally{be=e,js=!1}}return null}var Gs=[],Xs=0,Ys=null,_s=0,Hs=[],qs=0,Ws=null,$s=1,Js="";function Zs(t,e){Gs[Xs++]=_s,Gs[Xs++]=Ys,Ys=t,_s=e}function Qs(t,e,i){Hs[qs++]=$s,Hs[qs++]=Js,Hs[qs++]=Ws,Ws=t;var n=$s;t=Js;var s=32-re(n)-1;n&=~(1<<s),i+=1;var o=32-re(e)+s;if(30<o){var r=s-s%5;o=(n&(1<<r)-1).toString(32),n>>=r,s-=r,$s=1<<32-re(e)+s|i<<s|n,Js=o+t}else $s=1<<o|i<<s|n,Js=t}function to(t){null!==t.return&&(Zs(t,1),Qs(t,1,0))}function eo(t){for(;t===Ys;)Ys=Gs[--Xs],Gs[Xs]=null,_s=Gs[--Xs],Gs[Xs]=null;for(;t===Ws;)Ws=Hs[--qs],Hs[qs]=null,Js=Hs[--qs],Hs[qs]=null,$s=Hs[--qs],Hs[qs]=null}var io=null,no=null,so=!1,oo=null;function ro(t,e){var i=Dh(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=t,null===(e=t.deletions)?(t.deletions=[i],t.flags|=16):e.push(i)}function ao(t,e){switch(t.tag){case 5:var i=t.type;return null!==(e=1!==e.nodeType||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,io=t,no=hs(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,io=t,no=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(i=null!==Ws?{id:$s,overflow:Js}:null,t.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},(i=Dh(18,null,null,0)).stateNode=e,i.return=t,t.child=i,io=t,no=null,!0);default:return!1}}function lo(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function ho(t){if(so){var e=no;if(e){var i=e;if(!ao(t,e)){if(lo(t))throw Error(o(418));e=hs(i.nextSibling);var n=io;e&&ao(t,e)?ro(n,i):(t.flags=-4097&t.flags|2,so=!1,io=t)}}else{if(lo(t))throw Error(o(418));t.flags=-4097&t.flags|2,so=!1,io=t}}}function uo(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;io=t}function co(t){if(t!==io)return!1;if(!so)return uo(t),so=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!is(t.type,t.memoizedProps)),e&&(e=no)){if(lo(t))throw fo(),Error(o(418));for(;e;)ro(t,e),e=hs(e.nextSibling)}if(uo(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var i=t.data;if("/$"===i){if(0===e){no=hs(t.nextSibling);break t}e--}else"$"!==i&&"$!"!==i&&"$?"!==i||e++}t=t.nextSibling}no=null}}else no=io?hs(t.stateNode.nextSibling):null;return!0}function fo(){for(var t=no;t;)t=hs(t.nextSibling)}function go(){no=io=null,so=!1}function mo(t){null===oo?oo=[t]:oo.push(t)}var po=x.ReactCurrentBatchConfig;function yo(t,e,i){if(null!==(t=i.ref)&&"function"!==typeof t&&"object"!==typeof t){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(o(309));var n=i.stateNode}if(!n)throw Error(o(147,t));var s=n,r=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===r?e.ref:(e=function(t){var e=s.refs;null===t?delete e[r]:e[r]=t},e._stringRef=r,e)}if("string"!==typeof t)throw Error(o(284));if(!i._owner)throw Error(o(290,t))}return t}function vo(t,e){throw t=Object.prototype.toString.call(e),Error(o(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function bo(t){return(0,t._init)(t._payload)}function xo(t){function e(e,i){if(t){var n=e.deletions;null===n?(e.deletions=[i],e.flags|=16):n.push(i)}}function i(i,n){if(!t)return null;for(;null!==n;)e(i,n),n=n.sibling;return null}function n(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function s(t,e){return(t=Oh(t,e)).index=0,t.sibling=null,t}function r(e,i,n){return e.index=n,t?null!==(n=e.alternate)?(n=n.index)<i?(e.flags|=2,i):n:(e.flags|=2,i):(e.flags|=1048576,i)}function a(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,i,n){return null===e||6!==e.tag?((e=Ih(i,t.mode,n)).return=t,e):((e=s(e,i)).return=t,e)}function h(t,e,i,n){var o=i.type;return o===S?c(t,e,i.props.children,n,i.key):null!==e&&(e.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===F&&bo(o)===e.type)?((n=s(e,i.props)).ref=yo(t,e,i),n.return=t,n):((n=Rh(i.type,i.key,i.props,null,t.mode,n)).ref=yo(t,e,i),n.return=t,n)}function u(t,e,i,n){return null===e||4!==e.tag||e.stateNode.containerInfo!==i.containerInfo||e.stateNode.implementation!==i.implementation?((e=Vh(i,t.mode,n)).return=t,e):((e=s(e,i.children||[])).return=t,e)}function c(t,e,i,n,o){return null===e||7!==e.tag?((e=Eh(i,t.mode,n,o)).return=t,e):((e=s(e,i)).return=t,e)}function d(t,e,i){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Ih(""+e,t.mode,i)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case w:return(i=Rh(e.type,e.key,e.props,null,t.mode,i)).ref=yo(t,null,e),i.return=t,i;case k:return(e=Vh(e,t.mode,i)).return=t,e;case F:return d(t,(0,e._init)(e._payload),i)}if(et(e)||E(e))return(e=Eh(e,t.mode,i,null)).return=t,e;vo(t,e)}return null}function f(t,e,i,n){var s=null!==e?e.key:null;if("string"===typeof i&&""!==i||"number"===typeof i)return null!==s?null:l(t,e,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return i.key===s?h(t,e,i,n):null;case k:return i.key===s?u(t,e,i,n):null;case F:return f(t,e,(s=i._init)(i._payload),n)}if(et(i)||E(i))return null!==s?null:c(t,e,i,n,null);vo(t,i)}return null}function g(t,e,i,n,s){if("string"===typeof n&&""!==n||"number"===typeof n)return l(e,t=t.get(i)||null,""+n,s);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return h(e,t=t.get(null===n.key?i:n.key)||null,n,s);case k:return u(e,t=t.get(null===n.key?i:n.key)||null,n,s);case F:return g(t,e,i,(0,n._init)(n._payload),s)}if(et(n)||E(n))return c(e,t=t.get(i)||null,n,s,null);vo(e,n)}return null}function m(s,o,a,l){for(var h=null,u=null,c=o,m=o=0,p=null;null!==c&&m<a.length;m++){c.index>m?(p=c,c=null):p=c.sibling;var y=f(s,c,a[m],l);if(null===y){null===c&&(c=p);break}t&&c&&null===y.alternate&&e(s,c),o=r(y,o,m),null===u?h=y:u.sibling=y,u=y,c=p}if(m===a.length)return i(s,c),so&&Zs(s,m),h;if(null===c){for(;m<a.length;m++)null!==(c=d(s,a[m],l))&&(o=r(c,o,m),null===u?h=c:u.sibling=c,u=c);return so&&Zs(s,m),h}for(c=n(s,c);m<a.length;m++)null!==(p=g(c,s,m,a[m],l))&&(t&&null!==p.alternate&&c.delete(null===p.key?m:p.key),o=r(p,o,m),null===u?h=p:u.sibling=p,u=p);return t&&c.forEach((function(t){return e(s,t)})),so&&Zs(s,m),h}function p(s,a,l,h){var u=E(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var c=u=null,m=a,p=a=0,y=null,v=l.next();null!==m&&!v.done;p++,v=l.next()){m.index>p?(y=m,m=null):y=m.sibling;var b=f(s,m,v.value,h);if(null===b){null===m&&(m=y);break}t&&m&&null===b.alternate&&e(s,m),a=r(b,a,p),null===c?u=b:c.sibling=b,c=b,m=y}if(v.done)return i(s,m),so&&Zs(s,p),u;if(null===m){for(;!v.done;p++,v=l.next())null!==(v=d(s,v.value,h))&&(a=r(v,a,p),null===c?u=v:c.sibling=v,c=v);return so&&Zs(s,p),u}for(m=n(s,m);!v.done;p++,v=l.next())null!==(v=g(m,s,p,v.value,h))&&(t&&null!==v.alternate&&m.delete(null===v.key?p:v.key),a=r(v,a,p),null===c?u=v:c.sibling=v,c=v);return t&&m.forEach((function(t){return e(s,t)})),so&&Zs(s,p),u}return function t(n,o,r,l){if("object"===typeof r&&null!==r&&r.type===S&&null===r.key&&(r=r.props.children),"object"===typeof r&&null!==r){switch(r.$$typeof){case w:t:{for(var h=r.key,u=o;null!==u;){if(u.key===h){if((h=r.type)===S){if(7===u.tag){i(n,u.sibling),(o=s(u,r.props.children)).return=n,n=o;break t}}else if(u.elementType===h||"object"===typeof h&&null!==h&&h.$$typeof===F&&bo(h)===u.type){i(n,u.sibling),(o=s(u,r.props)).ref=yo(n,u,r),o.return=n,n=o;break t}i(n,u);break}e(n,u),u=u.sibling}r.type===S?((o=Eh(r.props.children,n.mode,l,r.key)).return=n,n=o):((l=Rh(r.type,r.key,r.props,null,n.mode,l)).ref=yo(n,o,r),l.return=n,n=l)}return a(n);case k:t:{for(u=r.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===r.containerInfo&&o.stateNode.implementation===r.implementation){i(n,o.sibling),(o=s(o,r.children||[])).return=n,n=o;break t}i(n,o);break}e(n,o),o=o.sibling}(o=Vh(r,n.mode,l)).return=n,n=o}return a(n);case F:return t(n,o,(u=r._init)(r._payload),l)}if(et(r))return m(n,o,r,l);if(E(r))return p(n,o,r,l);vo(n,r)}return"string"===typeof r&&""!==r||"number"===typeof r?(r=""+r,null!==o&&6===o.tag?(i(n,o.sibling),(o=s(o,r)).return=n,n=o):(i(n,o),(o=Ih(r,n.mode,l)).return=n,n=o),a(n)):i(n,o)}}var wo=xo(!0),ko=xo(!1),So=Ps(null),Po=null,Mo=null,Co=null;function No(){Co=Mo=Po=null}function Lo(t){var e=So.current;Ms(So),t._currentValue=e}function To(t,e,i){for(;null!==t;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==n&&(n.childLanes|=e)):null!==n&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===i)break;t=t.return}}function Ao(t,e){Po=t,Co=Mo=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(ba=!0),t.firstContext=null)}function Do(t){var e=t._currentValue;if(Co!==t)if(t={context:t,memoizedValue:e,next:null},null===Mo){if(null===Po)throw Error(o(308));Mo=t,Po.dependencies={lanes:0,firstContext:t}}else Mo=Mo.next=t;return e}var Fo=null;function Oo(t){null===Fo?Fo=[t]:Fo.push(t)}function Ro(t,e,i,n){var s=e.interleaved;return null===s?(i.next=i,Oo(e)):(i.next=s.next,s.next=i),e.interleaved=i,Eo(t,n)}function Eo(t,e){t.lanes|=e;var i=t.alternate;for(null!==i&&(i.lanes|=e),i=t,t=t.return;null!==t;)t.childLanes|=e,null!==(i=t.alternate)&&(i.childLanes|=e),i=t,t=t.return;return 3===i.tag?i.stateNode:null}var Bo=!1;function Io(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vo(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function jo(t,e,i){var n=t.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Ll)){var s=n.pending;return null===s?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Eo(t,i)}return null===(s=n.interleaved)?(e.next=e,Oo(n)):(e.next=s.next,s.next=e),n.interleaved=e,Eo(t,i)}function Uo(t,e,i){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&i))){var n=e.lanes;i|=n&=t.pendingLanes,e.lanes=i,ve(t,i)}}function Ko(t,e){var i=t.updateQueue,n=t.alternate;if(null!==n&&i===(n=n.updateQueue)){var s=null,o=null;if(null!==(i=i.firstBaseUpdate)){do{var r={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===o?s=o=r:o=o.next=r,i=i.next}while(null!==i);null===o?s=o=e:o=o.next=e}else s=o=e;return i={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:n.shared,effects:n.effects},void(t.updateQueue=i)}null===(t=i.lastBaseUpdate)?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}function Go(t,e,i,n){var s=t.updateQueue;Bo=!1;var o=s.firstBaseUpdate,r=s.lastBaseUpdate,a=s.shared.pending;if(null!==a){s.shared.pending=null;var l=a,h=l.next;l.next=null,null===r?o=h:r.next=h,r=l;var u=t.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==r&&(null===a?u.firstBaseUpdate=h:a.next=h,u.lastBaseUpdate=l))}if(null!==o){var c=s.baseState;for(r=0,u=h=l=null,a=o;;){var d=a.lane,f=a.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var g=t,m=a;switch(d=e,f=i,m.tag){case 1:if("function"===typeof(g=m.payload)){c=g.call(f,c,d);break t}c=g;break t;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(d="function"===typeof(g=m.payload)?g.call(f,c,d):g)||void 0===d)break t;c=I({},c,d);break t;case 2:Bo=!0}}null!==a.callback&&0!==a.lane&&(t.flags|=64,null===(d=s.effects)?s.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(h=u=f,l=c):u=u.next=f,r|=d;if(null===(a=a.next)){if(null===(a=s.shared.pending))break;a=(d=a).next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}if(null===u&&(l=c),s.baseState=l,s.firstBaseUpdate=h,s.lastBaseUpdate=u,null!==(e=s.shared.interleaved)){s=e;do{r|=s.lane,s=s.next}while(s!==e)}else null===o&&(s.shared.lanes=0);Bl|=r,t.lanes=r,t.memoizedState=c}}function Xo(t,e,i){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(null!==s){if(n.callback=null,n=i,"function"!==typeof s)throw Error(o(191,s));s.call(n)}}}var Yo={},_o=Ps(Yo),Ho=Ps(Yo),qo=Ps(Yo);function Wo(t){if(t===Yo)throw Error(o(174));return t}function $o(t,e){switch(Cs(qo,e),Cs(Ho,t),Cs(_o,Yo),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Ms(_o),Cs(_o,e)}function Jo(){Ms(_o),Ms(Ho),Ms(qo)}function Zo(t){Wo(qo.current);var e=Wo(_o.current),i=lt(e,t.type);e!==i&&(Cs(Ho,t),Cs(_o,i))}function Qo(t){Ho.current===t&&(Ms(_o),Ms(Ho))}var tr=Ps(0);function er(t){for(var e=t;null!==e;){if(13===e.tag){var i=e.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ir=[];function nr(){for(var t=0;t<ir.length;t++)ir[t]._workInProgressVersionPrimary=null;ir.length=0}var sr=x.ReactCurrentDispatcher,or=x.ReactCurrentBatchConfig,rr=0,ar=null,lr=null,hr=null,ur=!1,cr=!1,dr=0,fr=0;function gr(){throw Error(o(321))}function mr(t,e){if(null===e)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!an(t[i],e[i]))return!1;return!0}function pr(t,e,i,n,s,r){if(rr=r,ar=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sr.current=null===t||null===t.memoizedState?Qr:ta,t=i(n,s),cr){r=0;do{if(cr=!1,dr=0,25<=r)throw Error(o(301));r+=1,hr=lr=null,e.updateQueue=null,sr.current=ea,t=i(n,s)}while(cr)}if(sr.current=Zr,e=null!==lr&&null!==lr.next,rr=0,hr=lr=ar=null,ur=!1,e)throw Error(o(300));return t}function yr(){var t=0!==dr;return dr=0,t}function vr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===hr?ar.memoizedState=hr=t:hr=hr.next=t,hr}function br(){if(null===lr){var t=ar.alternate;t=null!==t?t.memoizedState:null}else t=lr.next;var e=null===hr?ar.memoizedState:hr.next;if(null!==e)hr=e,lr=t;else{if(null===t)throw Error(o(310));t={memoizedState:(lr=t).memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},null===hr?ar.memoizedState=hr=t:hr=hr.next=t}return hr}function xr(t,e){return"function"===typeof e?e(t):e}function wr(t){var e=br(),i=e.queue;if(null===i)throw Error(o(311));i.lastRenderedReducer=t;var n=lr,s=n.baseQueue,r=i.pending;if(null!==r){if(null!==s){var a=s.next;s.next=r.next,r.next=a}n.baseQueue=s=r,i.pending=null}if(null!==s){r=s.next,n=n.baseState;var l=a=null,h=null,u=r;do{var c=u.lane;if((rr&c)===c)null!==h&&(h=h.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===h?(l=h=d,a=n):h=h.next=d,ar.lanes|=c,Bl|=c}u=u.next}while(null!==u&&u!==r);null===h?a=n:h.next=l,an(n,e.memoizedState)||(ba=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=h,i.lastRenderedState=n}if(null!==(t=i.interleaved)){s=t;do{r=s.lane,ar.lanes|=r,Bl|=r,s=s.next}while(s!==t)}else null===s&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function kr(t){var e=br(),i=e.queue;if(null===i)throw Error(o(311));i.lastRenderedReducer=t;var n=i.dispatch,s=i.pending,r=e.memoizedState;if(null!==s){i.pending=null;var a=s=s.next;do{r=t(r,a.action),a=a.next}while(a!==s);an(r,e.memoizedState)||(ba=!0),e.memoizedState=r,null===e.baseQueue&&(e.baseState=r),i.lastRenderedState=r}return[r,n]}function Sr(){}function Pr(t,e){var i=ar,n=br(),s=e(),r=!an(n.memoizedState,s);if(r&&(n.memoizedState=s,ba=!0),n=n.queue,Br(Nr.bind(null,i,n,t),[t]),n.getSnapshot!==e||r||null!==hr&&1&hr.memoizedState.tag){if(i.flags|=2048,Dr(9,Cr.bind(null,i,n,s,e),void 0,null),null===Tl)throw Error(o(349));0!==(30&rr)||Mr(i,e,s)}return s}function Mr(t,e,i){t.flags|=16384,t={getSnapshot:e,value:i},null===(e=ar.updateQueue)?(e={lastEffect:null,stores:null},ar.updateQueue=e,e.stores=[t]):null===(i=e.stores)?e.stores=[t]:i.push(t)}function Cr(t,e,i,n){e.value=i,e.getSnapshot=n,Lr(e)&&Tr(t)}function Nr(t,e,i){return i((function(){Lr(e)&&Tr(t)}))}function Lr(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!an(t,i)}catch(n){return!0}}function Tr(t){var e=Eo(t,1);null!==e&&ih(e,t,1,-1)}function Ar(t){var e=vr();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xr,lastRenderedState:t},e.queue=t,t=t.dispatch=qr.bind(null,ar,t),[e.memoizedState,t]}function Dr(t,e,i,n){return t={tag:t,create:e,destroy:i,deps:n,next:null},null===(e=ar.updateQueue)?(e={lastEffect:null,stores:null},ar.updateQueue=e,e.lastEffect=t.next=t):null===(i=e.lastEffect)?e.lastEffect=t.next=t:(n=i.next,i.next=t,t.next=n,e.lastEffect=t),t}function Fr(){return br().memoizedState}function Or(t,e,i,n){var s=vr();ar.flags|=t,s.memoizedState=Dr(1|e,i,void 0,void 0===n?null:n)}function Rr(t,e,i,n){var s=br();n=void 0===n?null:n;var o=void 0;if(null!==lr){var r=lr.memoizedState;if(o=r.destroy,null!==n&&mr(n,r.deps))return void(s.memoizedState=Dr(e,i,o,n))}ar.flags|=t,s.memoizedState=Dr(1|e,i,o,n)}function Er(t,e){return Or(8390656,8,t,e)}function Br(t,e){return Rr(2048,8,t,e)}function Ir(t,e){return Rr(4,2,t,e)}function Vr(t,e){return Rr(4,4,t,e)}function zr(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function jr(t,e,i){return i=null!==i&&void 0!==i?i.concat([t]):null,Rr(4,4,zr.bind(null,e,t),i)}function Ur(){}function Kr(t,e){var i=br();e=void 0===e?null:e;var n=i.memoizedState;return null!==n&&null!==e&&mr(e,n[1])?n[0]:(i.memoizedState=[t,e],t)}function Gr(t,e){var i=br();e=void 0===e?null:e;var n=i.memoizedState;return null!==n&&null!==e&&mr(e,n[1])?n[0]:(t=t(),i.memoizedState=[t,e],t)}function Xr(t,e,i){return 0===(21&rr)?(t.baseState&&(t.baseState=!1,ba=!0),t.memoizedState=i):(an(i,e)||(i=me(),ar.lanes|=i,Bl|=i,t.baseState=!0),e)}function Yr(t,e){var i=be;be=0!==i&&4>i?i:4,t(!0);var n=or.transition;or.transition={};try{t(!1),e()}finally{be=i,or.transition=n}}function _r(){return br().memoizedState}function Hr(t,e,i){var n=eh(t);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},Wr(t))$r(e,i);else if(null!==(i=Ro(t,e,i,n))){ih(i,t,n,th()),Jr(i,e,n)}}function qr(t,e,i){var n=eh(t),s={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(Wr(t))$r(e,s);else{var o=t.alternate;if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var r=e.lastRenderedState,a=o(r,i);if(s.hasEagerState=!0,s.eagerState=a,an(a,r)){var l=e.interleaved;return null===l?(s.next=s,Oo(e)):(s.next=l.next,l.next=s),void(e.interleaved=s)}}catch(h){}null!==(i=Ro(t,e,s,n))&&(ih(i,t,n,s=th()),Jr(i,e,n))}}function Wr(t){var e=t.alternate;return t===ar||null!==e&&e===ar}function $r(t,e){cr=ur=!0;var i=t.pending;null===i?e.next=e:(e.next=i.next,i.next=e),t.pending=e}function Jr(t,e,i){if(0!==(4194240&i)){var n=e.lanes;i|=n&=t.pendingLanes,e.lanes=i,ve(t,i)}}var Zr={readContext:Do,useCallback:gr,useContext:gr,useEffect:gr,useImperativeHandle:gr,useInsertionEffect:gr,useLayoutEffect:gr,useMemo:gr,useReducer:gr,useRef:gr,useState:gr,useDebugValue:gr,useDeferredValue:gr,useTransition:gr,useMutableSource:gr,useSyncExternalStore:gr,useId:gr,unstable_isNewReconciler:!1},Qr={readContext:Do,useCallback:function(t,e){return vr().memoizedState=[t,void 0===e?null:e],t},useContext:Do,useEffect:Er,useImperativeHandle:function(t,e,i){return i=null!==i&&void 0!==i?i.concat([t]):null,Or(4194308,4,zr.bind(null,e,t),i)},useLayoutEffect:function(t,e){return Or(4194308,4,t,e)},useInsertionEffect:function(t,e){return Or(4,2,t,e)},useMemo:function(t,e){var i=vr();return e=void 0===e?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var n=vr();return e=void 0!==i?i(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Hr.bind(null,ar,t),[n.memoizedState,t]},useRef:function(t){return t={current:t},vr().memoizedState=t},useState:Ar,useDebugValue:Ur,useDeferredValue:function(t){return vr().memoizedState=t},useTransition:function(){var t=Ar(!1),e=t[0];return t=Yr.bind(null,t[1]),vr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,i){var n=ar,s=vr();if(so){if(void 0===i)throw Error(o(407));i=i()}else{if(i=e(),null===Tl)throw Error(o(349));0!==(30&rr)||Mr(n,e,i)}s.memoizedState=i;var r={value:i,getSnapshot:e};return s.queue=r,Er(Nr.bind(null,n,r,t),[t]),n.flags|=2048,Dr(9,Cr.bind(null,n,r,i,e),void 0,null),i},useId:function(){var t=vr(),e=Tl.identifierPrefix;if(so){var i=Js;e=":"+e+"R"+(i=($s&~(1<<32-re($s)-1)).toString(32)+i),0<(i=dr++)&&(e+="H"+i.toString(32)),e+=":"}else e=":"+e+"r"+(i=fr++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ta={readContext:Do,useCallback:Kr,useContext:Do,useEffect:Br,useImperativeHandle:jr,useInsertionEffect:Ir,useLayoutEffect:Vr,useMemo:Gr,useReducer:wr,useRef:Fr,useState:function(){return wr(xr)},useDebugValue:Ur,useDeferredValue:function(t){return Xr(br(),lr.memoizedState,t)},useTransition:function(){return[wr(xr)[0],br().memoizedState]},useMutableSource:Sr,useSyncExternalStore:Pr,useId:_r,unstable_isNewReconciler:!1},ea={readContext:Do,useCallback:Kr,useContext:Do,useEffect:Br,useImperativeHandle:jr,useInsertionEffect:Ir,useLayoutEffect:Vr,useMemo:Gr,useReducer:kr,useRef:Fr,useState:function(){return kr(xr)},useDebugValue:Ur,useDeferredValue:function(t){var e=br();return null===lr?e.memoizedState=t:Xr(e,lr.memoizedState,t)},useTransition:function(){return[kr(xr)[0],br().memoizedState]},useMutableSource:Sr,useSyncExternalStore:Pr,useId:_r,unstable_isNewReconciler:!1};function ia(t,e){if(t&&t.defaultProps){for(var i in e=I({},e),t=t.defaultProps)void 0===e[i]&&(e[i]=t[i]);return e}return e}function na(t,e,i,n){i=null===(i=i(n,e=t.memoizedState))||void 0===i?e:I({},e,i),t.memoizedState=i,0===t.lanes&&(t.updateQueue.baseState=i)}var sa={isMounted:function(t){return!!(t=t._reactInternals)&&Kt(t)===t},enqueueSetState:function(t,e,i){t=t._reactInternals;var n=th(),s=eh(t),o=zo(n,s);o.payload=e,void 0!==i&&null!==i&&(o.callback=i),null!==(e=jo(t,o,s))&&(ih(e,t,s,n),Uo(e,t,s))},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var n=th(),s=eh(t),o=zo(n,s);o.tag=1,o.payload=e,void 0!==i&&null!==i&&(o.callback=i),null!==(e=jo(t,o,s))&&(ih(e,t,s,n),Uo(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=th(),n=eh(t),s=zo(i,n);s.tag=2,void 0!==e&&null!==e&&(s.callback=e),null!==(e=jo(t,s,n))&&(ih(e,t,n,i),Uo(e,t,n))}};function oa(t,e,i,n,s,o,r){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(n,o,r):!e.prototype||!e.prototype.isPureReactComponent||(!ln(i,n)||!ln(s,o))}function ra(t,e,i){var n=!1,s=Ns,o=e.contextType;return"object"===typeof o&&null!==o?o=Do(o):(s=Fs(e)?As:Ls.current,o=(n=null!==(n=e.contextTypes)&&void 0!==n)?Ds(t,s):Ns),e=new e(i,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=sa,t.stateNode=e,e._reactInternals=t,n&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function aa(t,e,i,n){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(i,n),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(i,n),e.state!==t&&sa.enqueueReplaceState(e,e.state,null)}function la(t,e,i,n){var s=t.stateNode;s.props=i,s.state=t.memoizedState,s.refs={},Io(t);var o=e.contextType;"object"===typeof o&&null!==o?s.context=Do(o):(o=Fs(e)?As:Ls.current,s.context=Ds(t,o)),s.state=t.memoizedState,"function"===typeof(o=e.getDerivedStateFromProps)&&(na(t,e,o,i),s.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(e=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),e!==s.state&&sa.enqueueReplaceState(s,s.state,null),Go(t,i,s,n),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308)}function ha(t,e){try{var i="",n=e;do{i+=U(n),n=n.return}while(n);var s=i}catch(o){s="\nError generating stack: "+o.message+"\n"+o.stack}return{value:t,source:e,stack:s,digest:null}}function ua(t,e,i){return{value:t,source:null,stack:null!=i?i:null,digest:null!=e?e:null}}function ca(t,e){try{console.error(e.value)}catch(i){setTimeout((function(){throw i}))}}var da="function"===typeof WeakMap?WeakMap:Map;function fa(t,e,i){(i=zo(-1,i)).tag=3,i.payload={element:null};var n=e.value;return i.callback=function(){Xl||(Xl=!0,Yl=n),ca(0,e)},i}function ga(t,e,i){(i=zo(-1,i)).tag=3;var n=t.type.getDerivedStateFromError;if("function"===typeof n){var s=e.value;i.payload=function(){return n(s)},i.callback=function(){ca(0,e)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(i.callback=function(){ca(0,e),"function"!==typeof n&&(null===_l?_l=new Set([this]):_l.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),i}function ma(t,e,i){var n=t.pingCache;if(null===n){n=t.pingCache=new da;var s=new Set;n.set(e,s)}else void 0===(s=n.get(e))&&(s=new Set,n.set(e,s));s.has(i)||(s.add(i),t=Mh.bind(null,t,e,i),e.then(t,t))}function pa(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function ya(t,e,i,n,s){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((e=zo(-1,1)).tag=2,jo(i,e,1))),i.lanes|=1),t):(t.flags|=65536,t.lanes=s,t)}var va=x.ReactCurrentOwner,ba=!1;function xa(t,e,i,n){e.child=null===t?ko(e,null,i,n):wo(e,t.child,i,n)}function wa(t,e,i,n,s){i=i.render;var o=e.ref;return Ao(e,s),n=pr(t,e,i,n,o,s),i=yr(),null===t||ba?(so&&i&&to(e),e.flags|=1,xa(t,e,n,s),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Xa(t,e,s))}function ka(t,e,i,n,s){if(null===t){var o=i.type;return"function"!==typeof o||Fh(o)||void 0!==o.defaultProps||null!==i.compare||void 0!==i.defaultProps?((t=Rh(i.type,null,n,e,e.mode,s)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Sa(t,e,o,n,s))}if(o=t.child,0===(t.lanes&s)){var r=o.memoizedProps;if((i=null!==(i=i.compare)?i:ln)(r,n)&&t.ref===e.ref)return Xa(t,e,s)}return e.flags|=1,(t=Oh(o,n)).ref=e.ref,t.return=e,e.child=t}function Sa(t,e,i,n,s){if(null!==t){var o=t.memoizedProps;if(ln(o,n)&&t.ref===e.ref){if(ba=!1,e.pendingProps=n=o,0===(t.lanes&s))return e.lanes=t.lanes,Xa(t,e,s);0!==(131072&t.flags)&&(ba=!0)}}return Ca(t,e,i,n,s)}function Pa(t,e,i){var n=e.pendingProps,s=n.children,o=null!==t?t.memoizedState:null;if("hidden"===n.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cs(Ol,Fl),Fl|=i;else{if(0===(1073741824&i))return t=null!==o?o.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Cs(Ol,Fl),Fl|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==o?o.baseLanes:i,Cs(Ol,Fl),Fl|=n}else null!==o?(n=o.baseLanes|i,e.memoizedState=null):n=i,Cs(Ol,Fl),Fl|=n;return xa(t,e,s,i),e.child}function Ma(t,e){var i=e.ref;(null===t&&null!==i||null!==t&&t.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function Ca(t,e,i,n,s){var o=Fs(i)?As:Ls.current;return o=Ds(e,o),Ao(e,s),i=pr(t,e,i,n,o,s),n=yr(),null===t||ba?(so&&n&&to(e),e.flags|=1,xa(t,e,i,s),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Xa(t,e,s))}function Na(t,e,i,n,s){if(Fs(i)){var o=!0;Bs(e)}else o=!1;if(Ao(e,s),null===e.stateNode)Ga(t,e),ra(e,i,n),la(e,i,n,s),n=!0;else if(null===t){var r=e.stateNode,a=e.memoizedProps;r.props=a;var l=r.context,h=i.contextType;"object"===typeof h&&null!==h?h=Do(h):h=Ds(e,h=Fs(i)?As:Ls.current);var u=i.getDerivedStateFromProps,c="function"===typeof u||"function"===typeof r.getSnapshotBeforeUpdate;c||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(a!==n||l!==h)&&aa(e,r,n,h),Bo=!1;var d=e.memoizedState;r.state=d,Go(e,n,r,s),l=e.memoizedState,a!==n||d!==l||Ts.current||Bo?("function"===typeof u&&(na(e,i,u,n),l=e.memoizedState),(a=Bo||oa(e,i,a,n,d,l,h))?(c||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||("function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"===typeof r.componentDidMount&&(e.flags|=4194308)):("function"===typeof r.componentDidMount&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),r.props=n,r.state=l,r.context=h,n=a):("function"===typeof r.componentDidMount&&(e.flags|=4194308),n=!1)}else{r=e.stateNode,Vo(t,e),a=e.memoizedProps,h=e.type===e.elementType?a:ia(e.type,a),r.props=h,c=e.pendingProps,d=r.context,"object"===typeof(l=i.contextType)&&null!==l?l=Do(l):l=Ds(e,l=Fs(i)?As:Ls.current);var f=i.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof r.getSnapshotBeforeUpdate)||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(a!==c||d!==l)&&aa(e,r,n,l),Bo=!1,d=e.memoizedState,r.state=d,Go(e,n,r,s);var g=e.memoizedState;a!==c||d!==g||Ts.current||Bo?("function"===typeof f&&(na(e,i,f,n),g=e.memoizedState),(h=Bo||oa(e,i,h,n,d,g,l)||!1)?(u||"function"!==typeof r.UNSAFE_componentWillUpdate&&"function"!==typeof r.componentWillUpdate||("function"===typeof r.componentWillUpdate&&r.componentWillUpdate(n,g,l),"function"===typeof r.UNSAFE_componentWillUpdate&&r.UNSAFE_componentWillUpdate(n,g,l)),"function"===typeof r.componentDidUpdate&&(e.flags|=4),"function"===typeof r.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof r.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),r.props=n,r.state=g,r.context=l,n=h):("function"!==typeof r.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return La(t,e,i,n,o,s)}function La(t,e,i,n,s,o){Ma(t,e);var r=0!==(128&e.flags);if(!n&&!r)return s&&Is(e,i,!1),Xa(t,e,o);n=e.stateNode,va.current=e;var a=r&&"function"!==typeof i.getDerivedStateFromError?null:n.render();return e.flags|=1,null!==t&&r?(e.child=wo(e,t.child,null,o),e.child=wo(e,null,a,o)):xa(t,e,a,o),e.memoizedState=n.state,s&&Is(e,i,!0),e.child}function Ta(t){var e=t.stateNode;e.pendingContext?Rs(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Rs(0,e.context,!1),$o(t,e.containerInfo)}function Aa(t,e,i,n,s){return go(),mo(s),e.flags|=256,xa(t,e,i,n),e.child}var Da,Fa,Oa,Ra,Ea={dehydrated:null,treeContext:null,retryLane:0};function Ba(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ia(t,e,i){var n,s=e.pendingProps,r=tr.current,a=!1,l=0!==(128&e.flags);if((n=l)||(n=(null===t||null!==t.memoizedState)&&0!==(2&r)),n?(a=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(r|=1),Cs(tr,1&r),null===t)return ho(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=s.children,t=s.fallback,a?(s=e.mode,a=e.child,l={mode:"hidden",children:l},0===(1&s)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Bh(l,s,0,null),t=Eh(t,s,i,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Ba(i),e.memoizedState=Ea,t):Va(e,l));if(null!==(r=t.memoizedState)&&null!==(n=r.dehydrated))return function(t,e,i,n,s,r,a){if(i)return 256&e.flags?(e.flags&=-257,za(t,e,a,n=ua(Error(o(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(r=n.fallback,s=e.mode,n=Bh({mode:"visible",children:n.children},s,0,null),(r=Eh(r,s,a,null)).flags|=2,n.return=e,r.return=e,n.sibling=r,e.child=n,0!==(1&e.mode)&&wo(e,t.child,null,a),e.child.memoizedState=Ba(a),e.memoizedState=Ea,r);if(0===(1&e.mode))return za(t,e,a,null);if("$!"===s.data){if(n=s.nextSibling&&s.nextSibling.dataset)var l=n.dgst;return n=l,za(t,e,a,n=ua(r=Error(o(419)),n,void 0))}if(l=0!==(a&t.childLanes),ba||l){if(null!==(n=Tl)){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(n.suspendedLanes|a))?0:s)&&s!==r.retryLane&&(r.retryLane=s,Eo(t,s),ih(n,t,s,-1))}return mh(),za(t,e,a,n=ua(Error(o(421))))}return"$?"===s.data?(e.flags|=128,e.child=t.child,e=Nh.bind(null,t),s._reactRetry=e,null):(t=r.treeContext,no=hs(s.nextSibling),io=e,so=!0,oo=null,null!==t&&(Hs[qs++]=$s,Hs[qs++]=Js,Hs[qs++]=Ws,$s=t.id,Js=t.overflow,Ws=e),e=Va(e,n.children),e.flags|=4096,e)}(t,e,l,s,n,r,i);if(a){a=s.fallback,l=e.mode,n=(r=t.child).sibling;var h={mode:"hidden",children:s.children};return 0===(1&l)&&e.child!==r?((s=e.child).childLanes=0,s.pendingProps=h,e.deletions=null):(s=Oh(r,h)).subtreeFlags=14680064&r.subtreeFlags,null!==n?a=Oh(n,a):(a=Eh(a,l,i,null)).flags|=2,a.return=e,s.return=e,s.sibling=a,e.child=s,s=a,a=e.child,l=null===(l=t.child.memoizedState)?Ba(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=t.childLanes&~i,e.memoizedState=Ea,s}return t=(a=t.child).sibling,s=Oh(a,{mode:"visible",children:s.children}),0===(1&e.mode)&&(s.lanes=i),s.return=e,s.sibling=null,null!==t&&(null===(i=e.deletions)?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=s,e.memoizedState=null,s}function Va(t,e){return(e=Bh({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function za(t,e,i,n){return null!==n&&mo(n),wo(e,t.child,null,i),(t=Va(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function ja(t,e,i){t.lanes|=e;var n=t.alternate;null!==n&&(n.lanes|=e),To(t.return,e,i)}function Ua(t,e,i,n,s){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=i,o.tailMode=s)}function Ka(t,e,i){var n=e.pendingProps,s=n.revealOrder,o=n.tail;if(xa(t,e,n.children,i),0!==(2&(n=tr.current)))n=1&n|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&ja(t,i,e);else if(19===t.tag)ja(t,i,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Cs(tr,n),0===(1&e.mode))e.memoizedState=null;else switch(s){case"forwards":for(i=e.child,s=null;null!==i;)null!==(t=i.alternate)&&null===er(t)&&(s=i),i=i.sibling;null===(i=s)?(s=e.child,e.child=null):(s=i.sibling,i.sibling=null),Ua(e,!1,s,i,o);break;case"backwards":for(i=null,s=e.child,e.child=null;null!==s;){if(null!==(t=s.alternate)&&null===er(t)){e.child=s;break}t=s.sibling,s.sibling=i,i=s,s=t}Ua(e,!0,i,null,o);break;case"together":Ua(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ga(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Xa(t,e,i){if(null!==t&&(e.dependencies=t.dependencies),Bl|=e.lanes,0===(i&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(i=Oh(t=e.child,t.pendingProps),e.child=i,i.return=e;null!==t.sibling;)t=t.sibling,(i=i.sibling=Oh(t,t.pendingProps)).return=e;i.sibling=null}return e.child}function Ya(t,e){if(!so)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;null!==e;)null!==e.alternate&&(i=e),e=e.sibling;null===i?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?e||null===t.tail?t.tail=null:t.tail.sibling=null:n.sibling=null}}function _a(t){var e=null!==t.alternate&&t.alternate.child===t.child,i=0,n=0;if(e)for(var s=t.child;null!==s;)i|=s.lanes|s.childLanes,n|=14680064&s.subtreeFlags,n|=14680064&s.flags,s.return=t,s=s.sibling;else for(s=t.child;null!==s;)i|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=i,e}function Ha(t,e,i){var n=e.pendingProps;switch(eo(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _a(e),null;case 1:case 17:return Fs(e.type)&&Os(),_a(e),null;case 3:return n=e.stateNode,Jo(),Ms(Ts),Ms(Ls),nr(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||(co(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==oo&&(rh(oo),oo=null))),Fa(t,e),_a(e),null;case 5:Qo(e);var s=Wo(qo.current);if(i=e.type,null!==t&&null!=e.stateNode)Oa(t,e,i,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(null===e.stateNode)throw Error(o(166));return _a(e),null}if(t=Wo(_o.current),co(e)){n=e.stateNode,i=e.type;var r=e.memoizedProps;switch(n[ds]=e,n[fs]=r,t=0!==(1&e.mode),i){case"dialog":zn("cancel",n),zn("close",n);break;case"iframe":case"object":case"embed":zn("load",n);break;case"video":case"audio":for(s=0;s<En.length;s++)zn(En[s],n);break;case"source":zn("error",n);break;case"img":case"image":case"link":zn("error",n),zn("load",n);break;case"details":zn("toggle",n);break;case"input":$(n,r),zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!r.multiple},zn("invalid",n);break;case"textarea":st(n,r),zn("invalid",n)}for(var l in vt(i,r),s=null,r)if(r.hasOwnProperty(l)){var h=r[l];"children"===l?"string"===typeof h?n.textContent!==h&&(!0!==r.suppressHydrationWarning&&Zn(n.textContent,h,t),s=["children",h]):"number"===typeof h&&n.textContent!==""+h&&(!0!==r.suppressHydrationWarning&&Zn(n.textContent,h,t),s=["children",""+h]):a.hasOwnProperty(l)&&null!=h&&"onScroll"===l&&zn("scroll",n)}switch(i){case"input":_(n),Q(n,r,!0);break;case"textarea":_(n),rt(n);break;case"select":case"option":break;default:"function"===typeof r.onClick&&(n.onclick=Qn)}n=s,e.updateQueue=n,null!==n&&(e.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=at(i)),"http://www.w3.org/1999/xhtml"===t?"script"===i?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof n.is?t=l.createElement(i,{is:n.is}):(t=l.createElement(i),"select"===i&&(l=t,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):t=l.createElementNS(t,i),t[ds]=e,t[fs]=n,Da(t,e,!1,!1),e.stateNode=t;t:{switch(l=bt(i,n),i){case"dialog":zn("cancel",t),zn("close",t),s=n;break;case"iframe":case"object":case"embed":zn("load",t),s=n;break;case"video":case"audio":for(s=0;s<En.length;s++)zn(En[s],t);s=n;break;case"source":zn("error",t),s=n;break;case"img":case"image":case"link":zn("error",t),zn("load",t),s=n;break;case"details":zn("toggle",t),s=n;break;case"input":$(t,n),s=W(t,n),zn("invalid",t);break;case"option":default:s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=I({},n,{value:void 0}),zn("invalid",t);break;case"textarea":st(t,n),s=nt(t,n),zn("invalid",t)}for(r in vt(i,s),h=s)if(h.hasOwnProperty(r)){var u=h[r];"style"===r?pt(t,u):"dangerouslySetInnerHTML"===r?null!=(u=u?u.__html:void 0)&&ct(t,u):"children"===r?"string"===typeof u?("textarea"!==i||""!==u)&&dt(t,u):"number"===typeof u&&dt(t,""+u):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(a.hasOwnProperty(r)?null!=u&&"onScroll"===r&&zn("scroll",t):null!=u&&b(t,r,u,l))}switch(i){case"input":_(t),Q(t,n,!1);break;case"textarea":_(t),rt(t);break;case"option":null!=n.value&&t.setAttribute("value",""+X(n.value));break;case"select":t.multiple=!!n.multiple,null!=(r=n.value)?it(t,!!n.multiple,r,!1):null!=n.defaultValue&&it(t,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof s.onClick&&(t.onclick=Qn)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break t;case"img":n=!0;break t;default:n=!1}}n&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return _a(e),null;case 6:if(t&&null!=e.stateNode)Ra(t,e,t.memoizedProps,n);else{if("string"!==typeof n&&null===e.stateNode)throw Error(o(166));if(i=Wo(qo.current),Wo(_o.current),co(e)){if(n=e.stateNode,i=e.memoizedProps,n[ds]=e,(r=n.nodeValue!==i)&&null!==(t=io))switch(t.tag){case 3:Zn(n.nodeValue,i,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Zn(n.nodeValue,i,0!==(1&t.mode))}r&&(e.flags|=4)}else(n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[ds]=e,e.stateNode=n}return _a(e),null;case 13:if(Ms(tr),n=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(so&&null!==no&&0!==(1&e.mode)&&0===(128&e.flags))fo(),go(),e.flags|=98560,r=!1;else if(r=co(e),null!==n&&null!==n.dehydrated){if(null===t){if(!r)throw Error(o(318));if(!(r=null!==(r=e.memoizedState)?r.dehydrated:null))throw Error(o(317));r[ds]=e}else go(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;_a(e),r=!1}else null!==oo&&(rh(oo),oo=null),r=!0;if(!r)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=i,e):((n=null!==n)!==(null!==t&&null!==t.memoizedState)&&n&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&tr.current)?0===Rl&&(Rl=3):mh())),null!==e.updateQueue&&(e.flags|=4),_a(e),null);case 4:return Jo(),Fa(t,e),null===t&&Kn(e.stateNode.containerInfo),_a(e),null;case 10:return Lo(e.type._context),_a(e),null;case 19:if(Ms(tr),null===(r=e.memoizedState))return _a(e),null;if(n=0!==(128&e.flags),null===(l=r.rendering))if(n)Ya(r,!1);else{if(0!==Rl||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=er(t))){for(e.flags|=128,Ya(r,!1),null!==(n=l.updateQueue)&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=i,i=e.child;null!==i;)t=n,(r=i).flags&=14680066,null===(l=r.alternate)?(r.childLanes=0,r.lanes=t,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,t=l.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),i=i.sibling;return Cs(tr,1&tr.current|2),e.child}t=t.sibling}null!==r.tail&&Jt()>Kl&&(e.flags|=128,n=!0,Ya(r,!1),e.lanes=4194304)}else{if(!n)if(null!==(t=er(l))){if(e.flags|=128,n=!0,null!==(i=t.updateQueue)&&(e.updateQueue=i,e.flags|=4),Ya(r,!0),null===r.tail&&"hidden"===r.tailMode&&!l.alternate&&!so)return _a(e),null}else 2*Jt()-r.renderingStartTime>Kl&&1073741824!==i&&(e.flags|=128,n=!0,Ya(r,!1),e.lanes=4194304);r.isBackwards?(l.sibling=e.child,e.child=l):(null!==(i=r.last)?i.sibling=l:e.child=l,r.last=l)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Jt(),e.sibling=null,i=tr.current,Cs(tr,n?1&i|2:1&i),e):(_a(e),null);case 22:case 23:return ch(),n=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==n&&(e.flags|=8192),n&&0!==(1&e.mode)?0!==(1073741824&Fl)&&(_a(e),6&e.subtreeFlags&&(e.flags|=8192)):_a(e),null;case 24:case 25:return null}throw Error(o(156,e.tag))}function qa(t,e){switch(eo(e),e.tag){case 1:return Fs(e.type)&&Os(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Jo(),Ms(Ts),Ms(Ls),nr(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return Qo(e),null;case 13:if(Ms(tr),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(o(340));go()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Ms(tr),null;case 4:return Jo(),null;case 10:return Lo(e.type._context),null;case 22:case 23:return ch(),null;default:return null}}Da=function(t,e){for(var i=e.child;null!==i;){if(5===i.tag||6===i.tag)t.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Fa=function(){},Oa=function(t,e,i,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Wo(_o.current);var o,r=null;switch(i){case"input":s=W(t,s),n=W(t,n),r=[];break;case"select":s=I({},s,{value:void 0}),n=I({},n,{value:void 0}),r=[];break;case"textarea":s=nt(t,s),n=nt(t,n),r=[];break;default:"function"!==typeof s.onClick&&"function"===typeof n.onClick&&(t.onclick=Qn)}for(u in vt(i,n),i=null,s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&null!=s[u])if("style"===u){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(i||(i={}),i[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in n){var h=n[u];if(l=null!=s?s[u]:void 0,n.hasOwnProperty(u)&&h!==l&&(null!=h||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||h&&h.hasOwnProperty(o)||(i||(i={}),i[o]="");for(o in h)h.hasOwnProperty(o)&&l[o]!==h[o]&&(i||(i={}),i[o]=h[o])}else i||(r||(r=[]),r.push(u,i)),i=h;else"dangerouslySetInnerHTML"===u?(h=h?h.__html:void 0,l=l?l.__html:void 0,null!=h&&l!==h&&(r=r||[]).push(u,h)):"children"===u?"string"!==typeof h&&"number"!==typeof h||(r=r||[]).push(u,""+h):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=h&&"onScroll"===u&&zn("scroll",t),r||l===h||(r=[])):(r=r||[]).push(u,h))}i&&(r=r||[]).push("style",i);var u=r;(e.updateQueue=u)&&(e.flags|=4)}},Ra=function(t,e,i,n){i!==n&&(e.flags|=4)};var Wa=!1,$a=!1,Ja="function"===typeof WeakSet?WeakSet:Set,Za=null;function Qa(t,e){var i=t.ref;if(null!==i)if("function"===typeof i)try{i(null)}catch(n){Ph(t,e,n)}else i.current=null}function tl(t,e,i){try{i()}catch(n){Ph(t,e,n)}}var el=!1;function il(t,e,i){var n=e.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var s=n=n.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,void 0!==o&&tl(e,i,o)}s=s.next}while(s!==n)}}function nl(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var i=e=e.next;do{if((i.tag&t)===t){var n=i.create;i.destroy=n()}i=i.next}while(i!==e)}}function sl(t){var e=t.ref;if(null!==e){var i=t.stateNode;t.tag,t=i,"function"===typeof e?e(t):e.current=t}}function ol(t){var e=t.alternate;null!==e&&(t.alternate=null,ol(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[ds],delete e[fs],delete e[ms],delete e[ps],delete e[ys])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rl(t){return 5===t.tag||3===t.tag||4===t.tag}function al(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||rl(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ll(t,e,i){var n=t.tag;if(5===n||6===n)t=t.stateNode,e?8===i.nodeType?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(8===i.nodeType?(e=i.parentNode).insertBefore(t,i):(e=i).appendChild(t),null!==(i=i._reactRootContainer)&&void 0!==i||null!==e.onclick||(e.onclick=Qn));else if(4!==n&&null!==(t=t.child))for(ll(t,e,i),t=t.sibling;null!==t;)ll(t,e,i),t=t.sibling}function hl(t,e,i){var n=t.tag;if(5===n||6===n)t=t.stateNode,e?i.insertBefore(t,e):i.appendChild(t);else if(4!==n&&null!==(t=t.child))for(hl(t,e,i),t=t.sibling;null!==t;)hl(t,e,i),t=t.sibling}var ul=null,cl=!1;function dl(t,e,i){for(i=i.child;null!==i;)fl(t,e,i),i=i.sibling}function fl(t,e,i){if(oe&&"function"===typeof oe.onCommitFiberUnmount)try{oe.onCommitFiberUnmount(se,i)}catch(a){}switch(i.tag){case 5:$a||Qa(i,e);case 6:var n=ul,s=cl;ul=null,dl(t,e,i),cl=s,null!==(ul=n)&&(cl?(t=ul,i=i.stateNode,8===t.nodeType?t.parentNode.removeChild(i):t.removeChild(i)):ul.removeChild(i.stateNode));break;case 18:null!==ul&&(cl?(t=ul,i=i.stateNode,8===t.nodeType?ls(t.parentNode,i):1===t.nodeType&&ls(t,i),Ke(t)):ls(ul,i.stateNode));break;case 4:n=ul,s=cl,ul=i.stateNode.containerInfo,cl=!0,dl(t,e,i),ul=n,cl=s;break;case 0:case 11:case 14:case 15:if(!$a&&(null!==(n=i.updateQueue)&&null!==(n=n.lastEffect))){s=n=n.next;do{var o=s,r=o.destroy;o=o.tag,void 0!==r&&(0!==(2&o)||0!==(4&o))&&tl(i,e,r),s=s.next}while(s!==n)}dl(t,e,i);break;case 1:if(!$a&&(Qa(i,e),"function"===typeof(n=i.stateNode).componentWillUnmount))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(a){Ph(i,e,a)}dl(t,e,i);break;case 21:dl(t,e,i);break;case 22:1&i.mode?($a=(n=$a)||null!==i.memoizedState,dl(t,e,i),$a=n):dl(t,e,i);break;default:dl(t,e,i)}}function gl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var i=t.stateNode;null===i&&(i=t.stateNode=new Ja),e.forEach((function(e){var n=Lh.bind(null,t,e);i.has(e)||(i.add(e),e.then(n,n))}))}}function ml(t,e){var i=e.deletions;if(null!==i)for(var n=0;n<i.length;n++){var s=i[n];try{var r=t,a=e,l=a;t:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,cl=!1;break t;case 3:case 4:ul=l.stateNode.containerInfo,cl=!0;break t}l=l.return}if(null===ul)throw Error(o(160));fl(r,a,s),ul=null,cl=!1;var h=s.alternate;null!==h&&(h.return=null),s.return=null}catch(u){Ph(s,e,u)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)pl(e,t),e=e.sibling}function pl(t,e){var i=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ml(e,t),yl(t),4&n){try{il(3,t,t.return),nl(3,t)}catch(p){Ph(t,t.return,p)}try{il(5,t,t.return)}catch(p){Ph(t,t.return,p)}}break;case 1:ml(e,t),yl(t),512&n&&null!==i&&Qa(i,i.return);break;case 5:if(ml(e,t),yl(t),512&n&&null!==i&&Qa(i,i.return),32&t.flags){var s=t.stateNode;try{dt(s,"")}catch(p){Ph(t,t.return,p)}}if(4&n&&null!=(s=t.stateNode)){var r=t.memoizedProps,a=null!==i?i.memoizedProps:r,l=t.type,h=t.updateQueue;if(t.updateQueue=null,null!==h)try{"input"===l&&"radio"===r.type&&null!=r.name&&J(s,r),bt(l,a);var u=bt(l,r);for(a=0;a<h.length;a+=2){var c=h[a],d=h[a+1];"style"===c?pt(s,d):"dangerouslySetInnerHTML"===c?ct(s,d):"children"===c?dt(s,d):b(s,c,d,u)}switch(l){case"input":Z(s,r);break;case"textarea":ot(s,r);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!r.multiple;var g=r.value;null!=g?it(s,!!r.multiple,g,!1):f!==!!r.multiple&&(null!=r.defaultValue?it(s,!!r.multiple,r.defaultValue,!0):it(s,!!r.multiple,r.multiple?[]:"",!1))}s[fs]=r}catch(p){Ph(t,t.return,p)}}break;case 6:if(ml(e,t),yl(t),4&n){if(null===t.stateNode)throw Error(o(162));s=t.stateNode,r=t.memoizedProps;try{s.nodeValue=r}catch(p){Ph(t,t.return,p)}}break;case 3:if(ml(e,t),yl(t),4&n&&null!==i&&i.memoizedState.isDehydrated)try{Ke(e.containerInfo)}catch(p){Ph(t,t.return,p)}break;case 4:default:ml(e,t),yl(t);break;case 13:ml(e,t),yl(t),8192&(s=t.child).flags&&(r=null!==s.memoizedState,s.stateNode.isHidden=r,!r||null!==s.alternate&&null!==s.alternate.memoizedState||(Ul=Jt())),4&n&&gl(t);break;case 22:if(c=null!==i&&null!==i.memoizedState,1&t.mode?($a=(u=$a)||c,ml(e,t),$a=u):ml(e,t),yl(t),8192&n){if(u=null!==t.memoizedState,(t.stateNode.isHidden=u)&&!c&&0!==(1&t.mode))for(Za=t,c=t.child;null!==c;){for(d=Za=c;null!==Za;){switch(g=(f=Za).child,f.tag){case 0:case 11:case 14:case 15:il(4,f,f.return);break;case 1:Qa(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){n=f,i=f.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){Ph(n,i,p)}}break;case 5:Qa(f,f.return);break;case 22:if(null!==f.memoizedState){wl(d);continue}}null!==g?(g.return=f,Za=g):wl(d)}c=c.sibling}t:for(c=null,d=t;;){if(5===d.tag){if(null===c){c=d;try{s=d.stateNode,u?"function"===typeof(r=s.style).setProperty?r.setProperty("display","none","important"):r.display="none":(l=d.stateNode,a=void 0!==(h=d.memoizedProps.style)&&null!==h&&h.hasOwnProperty("display")?h.display:null,l.style.display=mt("display",a))}catch(p){Ph(t,t.return,p)}}}else if(6===d.tag){if(null===c)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(p){Ph(t,t.return,p)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(e,t),yl(t),4&n&&gl(t);case 21:}}function yl(t){var e=t.flags;if(2&e){try{t:{for(var i=t.return;null!==i;){if(rl(i)){var n=i;break t}i=i.return}throw Error(o(160))}switch(n.tag){case 5:var s=n.stateNode;32&n.flags&&(dt(s,""),n.flags&=-33),hl(t,al(t),s);break;case 3:case 4:var r=n.stateNode.containerInfo;ll(t,al(t),r);break;default:throw Error(o(161))}}catch(a){Ph(t,t.return,a)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function vl(t,e,i){Za=t,bl(t,e,i)}function bl(t,e,i){for(var n=0!==(1&t.mode);null!==Za;){var s=Za,o=s.child;if(22===s.tag&&n){var r=null!==s.memoizedState||Wa;if(!r){var a=s.alternate,l=null!==a&&null!==a.memoizedState||$a;a=Wa;var h=$a;if(Wa=r,($a=l)&&!h)for(Za=s;null!==Za;)l=(r=Za).child,22===r.tag&&null!==r.memoizedState?kl(s):null!==l?(l.return=r,Za=l):kl(s);for(;null!==o;)Za=o,bl(o,e,i),o=o.sibling;Za=s,Wa=a,$a=h}xl(t)}else 0!==(8772&s.subtreeFlags)&&null!==o?(o.return=s,Za=o):xl(t)}}function xl(t){for(;null!==Za;){var e=Za;if(0!==(8772&e.flags)){var i=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:$a||nl(5,e);break;case 1:var n=e.stateNode;if(4&e.flags&&!$a)if(null===i)n.componentDidMount();else{var s=e.elementType===e.type?i.memoizedProps:ia(e.type,i.memoizedProps);n.componentDidUpdate(s,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;null!==r&&Xo(e,r,n);break;case 3:var a=e.updateQueue;if(null!==a){if(i=null,null!==e.child)switch(e.child.tag){case 5:case 1:i=e.child.stateNode}Xo(e,a,i)}break;case 5:var l=e.stateNode;if(null===i&&4&e.flags){i=l;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&i.focus();break;case"img":h.src&&(i.src=h.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var u=e.alternate;if(null!==u){var c=u.memoizedState;if(null!==c){var d=c.dehydrated;null!==d&&Ke(d)}}}break;default:throw Error(o(163))}$a||512&e.flags&&sl(e)}catch(f){Ph(e,e.return,f)}}if(e===t){Za=null;break}if(null!==(i=e.sibling)){i.return=e.return,Za=i;break}Za=e.return}}function wl(t){for(;null!==Za;){var e=Za;if(e===t){Za=null;break}var i=e.sibling;if(null!==i){i.return=e.return,Za=i;break}Za=e.return}}function kl(t){for(;null!==Za;){var e=Za;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{nl(4,e)}catch(l){Ph(e,i,l)}break;case 1:var n=e.stateNode;if("function"===typeof n.componentDidMount){var s=e.return;try{n.componentDidMount()}catch(l){Ph(e,s,l)}}var o=e.return;try{sl(e)}catch(l){Ph(e,o,l)}break;case 5:var r=e.return;try{sl(e)}catch(l){Ph(e,r,l)}}}catch(l){Ph(e,e.return,l)}if(e===t){Za=null;break}var a=e.sibling;if(null!==a){a.return=e.return,Za=a;break}Za=e.return}}var Sl,Pl=Math.ceil,Ml=x.ReactCurrentDispatcher,Cl=x.ReactCurrentOwner,Nl=x.ReactCurrentBatchConfig,Ll=0,Tl=null,Al=null,Dl=0,Fl=0,Ol=Ps(0),Rl=0,El=null,Bl=0,Il=0,Vl=0,zl=null,jl=null,Ul=0,Kl=1/0,Gl=null,Xl=!1,Yl=null,_l=null,Hl=!1,ql=null,Wl=0,$l=0,Jl=null,Zl=-1,Ql=0;function th(){return 0!==(6&Ll)?Jt():-1!==Zl?Zl:Zl=Jt()}function eh(t){return 0===(1&t.mode)?1:0!==(2&Ll)&&0!==Dl?Dl&-Dl:null!==po.transition?(0===Ql&&(Ql=me()),Ql):0!==(t=be)?t:t=void 0===(t=window.event)?16:$e(t.type)}function ih(t,e,i,n){if(50<$l)throw $l=0,Jl=null,Error(o(185));ye(t,i,n),0!==(2&Ll)&&t===Tl||(t===Tl&&(0===(2&Ll)&&(Il|=i),4===Rl&&ah(t,Dl)),nh(t,n),1===i&&0===Ll&&0===(1&e.mode)&&(Kl=Jt()+500,zs&&Ks()))}function nh(t,e){var i=t.callbackNode;!function(t,e){for(var i=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var r=31-re(o),a=1<<r,l=s[r];-1===l?0!==(a&i)&&0===(a&n)||(s[r]=fe(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}(t,e);var n=de(t,t===Tl?Dl:0);if(0===n)null!==i&&qt(i),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(null!=i&&qt(i),1===e)0===t.tag?function(t){zs=!0,Us(t)}(lh.bind(null,t)):Us(lh.bind(null,t)),rs((function(){0===(6&Ll)&&Ks()})),i=null;else{switch(xe(n)){case 1:i=Qt;break;case 4:i=te;break;case 16:default:i=ee;break;case 536870912:i=ne}i=Th(i,sh.bind(null,t))}t.callbackPriority=e,t.callbackNode=i}}function sh(t,e){if(Zl=-1,Ql=0,0!==(6&Ll))throw Error(o(327));var i=t.callbackNode;if(kh()&&t.callbackNode!==i)return null;var n=de(t,t===Tl?Dl:0);if(0===n)return null;if(0!==(30&n)||0!==(n&t.expiredLanes)||e)e=ph(t,n);else{e=n;var s=Ll;Ll|=2;var r=gh();for(Tl===t&&Dl===e||(Gl=null,Kl=Jt()+500,dh(t,e));;)try{vh();break}catch(l){fh(t,l)}No(),Ml.current=r,Ll=s,null!==Al?e=0:(Tl=null,Dl=0,e=Rl)}if(0!==e){if(2===e&&(0!==(s=ge(t))&&(n=s,e=oh(t,s))),1===e)throw i=El,dh(t,0),ah(t,n),nh(t,Jt()),i;if(6===e)ah(t,n);else{if(s=t.current.alternate,0===(30&n)&&!function(t){for(var e=t;;){if(16384&e.flags){var i=e.updateQueue;if(null!==i&&null!==(i=i.stores))for(var n=0;n<i.length;n++){var s=i[n],o=s.getSnapshot;s=s.value;try{if(!an(o(),s))return!1}catch(a){return!1}}}if(i=e.child,16384&e.subtreeFlags&&null!==i)i.return=e,e=i;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(s)&&(2===(e=ph(t,n))&&(0!==(r=ge(t))&&(n=r,e=oh(t,r))),1===e))throw i=El,dh(t,0),ah(t,n),nh(t,Jt()),i;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(o(345));case 2:case 5:wh(t,jl,Gl);break;case 3:if(ah(t,n),(130023424&n)===n&&10<(e=Ul+500-Jt())){if(0!==de(t,0))break;if(((s=t.suspendedLanes)&n)!==n){th(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ns(wh.bind(null,t,jl,Gl),e);break}wh(t,jl,Gl);break;case 4:if(ah(t,n),(4194240&n)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-re(n);r=1<<a,(a=e[a])>s&&(s=a),n&=~r}if(n=s,10<(n=(120>(n=Jt()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Pl(n/1960))-n)){t.timeoutHandle=ns(wh.bind(null,t,jl,Gl),n);break}wh(t,jl,Gl);break;default:throw Error(o(329))}}}return nh(t,Jt()),t.callbackNode===i?sh.bind(null,t):null}function oh(t,e){var i=zl;return t.current.memoizedState.isDehydrated&&(dh(t,e).flags|=256),2!==(t=ph(t,e))&&(e=jl,jl=i,null!==e&&rh(e)),t}function rh(t){null===jl?jl=t:jl.push.apply(jl,t)}function ah(t,e){for(e&=~Vl,e&=~Il,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var i=31-re(e),n=1<<i;t[i]=-1,e&=~n}}function lh(t){if(0!==(6&Ll))throw Error(o(327));kh();var e=de(t,0);if(0===(1&e))return nh(t,Jt()),null;var i=ph(t,e);if(0!==t.tag&&2===i){var n=ge(t);0!==n&&(e=n,i=oh(t,n))}if(1===i)throw i=El,dh(t,0),ah(t,e),nh(t,Jt()),i;if(6===i)throw Error(o(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,wh(t,jl,Gl),nh(t,Jt()),null}function hh(t,e){var i=Ll;Ll|=1;try{return t(e)}finally{0===(Ll=i)&&(Kl=Jt()+500,zs&&Ks())}}function uh(t){null!==ql&&0===ql.tag&&0===(6&Ll)&&kh();var e=Ll;Ll|=1;var i=Nl.transition,n=be;try{if(Nl.transition=null,be=1,t)return t()}finally{be=n,Nl.transition=i,0===(6&(Ll=e))&&Ks()}}function ch(){Fl=Ol.current,Ms(Ol)}function dh(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;if(-1!==i&&(t.timeoutHandle=-1,ss(i)),null!==Al)for(i=Al.return;null!==i;){var n=i;switch(eo(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Os();break;case 3:Jo(),Ms(Ts),Ms(Ls),nr();break;case 5:Qo(n);break;case 4:Jo();break;case 13:case 19:Ms(tr);break;case 10:Lo(n.type._context);break;case 22:case 23:ch()}i=i.return}if(Tl=t,Al=t=Oh(t.current,null),Dl=Fl=e,Rl=0,El=null,Vl=Il=Bl=0,jl=zl=null,null!==Fo){for(e=0;e<Fo.length;e++)if(null!==(n=(i=Fo[e]).interleaved)){i.interleaved=null;var s=n.next,o=i.pending;if(null!==o){var r=o.next;o.next=s,n.next=r}i.pending=n}Fo=null}return t}function fh(t,e){for(;;){var i=Al;try{if(No(),sr.current=Zr,ur){for(var n=ar.memoizedState;null!==n;){var s=n.queue;null!==s&&(s.pending=null),n=n.next}ur=!1}if(rr=0,hr=lr=ar=null,cr=!1,dr=0,Cl.current=null,null===i||null===i.return){Rl=1,El=e,Al=null;break}t:{var r=t,a=i.return,l=i,h=e;if(e=Dl,l.flags|=32768,null!==h&&"object"===typeof h&&"function"===typeof h.then){var u=h,c=l,d=c.tag;if(0===(1&c.mode)&&(0===d||11===d||15===d)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=pa(a);if(null!==g){g.flags&=-257,ya(g,a,l,0,e),1&g.mode&&ma(r,u,e),h=u;var m=(e=g).updateQueue;if(null===m){var p=new Set;p.add(h),e.updateQueue=p}else m.add(h);break t}if(0===(1&e)){ma(r,u,e),mh();break t}h=Error(o(426))}else if(so&&1&l.mode){var y=pa(a);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ya(y,a,l,0,e),mo(ha(h,l));break t}}r=h=ha(h,l),4!==Rl&&(Rl=2),null===zl?zl=[r]:zl.push(r),r=a;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e,Ko(r,fa(0,h,e));break t;case 1:l=h;var v=r.type,b=r.stateNode;if(0===(128&r.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===_l||!_l.has(b)))){r.flags|=65536,e&=-e,r.lanes|=e,Ko(r,ga(r,l,e));break t}}r=r.return}while(null!==r)}xh(i)}catch(x){e=x,Al===i&&null!==i&&(Al=i=i.return);continue}break}}function gh(){var t=Ml.current;return Ml.current=Zr,null===t?Zr:t}function mh(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Tl||0===(268435455&Bl)&&0===(268435455&Il)||ah(Tl,Dl)}function ph(t,e){var i=Ll;Ll|=2;var n=gh();for(Tl===t&&Dl===e||(Gl=null,dh(t,e));;)try{yh();break}catch(s){fh(t,s)}if(No(),Ll=i,Ml.current=n,null!==Al)throw Error(o(261));return Tl=null,Dl=0,Rl}function yh(){for(;null!==Al;)bh(Al)}function vh(){for(;null!==Al&&!Wt();)bh(Al)}function bh(t){var e=Sl(t.alternate,t,Fl);t.memoizedProps=t.pendingProps,null===e?xh(t):Al=e,Cl.current=null}function xh(t){var e=t;do{var i=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(i=Ha(i,e,Fl)))return void(Al=i)}else{if(null!==(i=qa(i,e)))return i.flags&=32767,void(Al=i);if(null===t)return Rl=6,void(Al=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Al=e);Al=e=t}while(null!==e);0===Rl&&(Rl=5)}function wh(t,e,i){var n=be,s=Nl.transition;try{Nl.transition=null,be=1,function(t,e,i,n){do{kh()}while(null!==ql);if(0!==(6&Ll))throw Error(o(327));i=t.finishedWork;var s=t.finishedLanes;if(null===i)return null;if(t.finishedWork=null,t.finishedLanes=0,i===t.current)throw Error(o(177));t.callbackNode=null,t.callbackPriority=0;var r=i.lanes|i.childLanes;if(function(t,e){var i=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<i;){var s=31-re(i),o=1<<s;e[s]=0,n[s]=-1,t[s]=-1,i&=~o}}(t,r),t===Tl&&(Al=Tl=null,Dl=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||Hl||(Hl=!0,Th(ee,(function(){return kh(),null}))),r=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||r){r=Nl.transition,Nl.transition=null;var a=be;be=1;var l=Ll;Ll|=4,Cl.current=null,function(t,e){if(ts=Xe,fn(t=dn())){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else t:{var n=(i=(i=t.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var s=n.anchorOffset,r=n.focusNode;n=n.focusOffset;try{i.nodeType,r.nodeType}catch(w){i=null;break t}var a=0,l=-1,h=-1,u=0,c=0,d=t,f=null;e:for(;;){for(var g;d!==i||0!==s&&3!==d.nodeType||(l=a+s),d!==r||0!==n&&3!==d.nodeType||(h=a+n),3===d.nodeType&&(a+=d.nodeValue.length),null!==(g=d.firstChild);)f=d,d=g;for(;;){if(d===t)break e;if(f===i&&++u===s&&(l=a),f===r&&++c===n&&(h=a),null!==(g=d.nextSibling))break;f=(d=f).parentNode}d=g}i=-1===l||-1===h?null:{start:l,end:h}}else i=null}i=i||{start:0,end:0}}else i=null;for(es={focusedElem:t,selectionRange:i},Xe=!1,Za=e;null!==Za;)if(t=(e=Za).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Za=t;else for(;null!==Za;){e=Za;try{var m=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var p=m.memoizedProps,y=m.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:ia(e.type,p),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=e.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(o(163))}}catch(w){Ph(e,e.return,w)}if(null!==(t=e.sibling)){t.return=e.return,Za=t;break}Za=e.return}m=el,el=!1}(t,i),pl(i,t),gn(es),Xe=!!ts,es=ts=null,t.current=i,vl(i,t,s),$t(),Ll=l,be=a,Nl.transition=r}else t.current=i;if(Hl&&(Hl=!1,ql=t,Wl=s),r=t.pendingLanes,0===r&&(_l=null),function(t){if(oe&&"function"===typeof oe.onCommitFiberRoot)try{oe.onCommitFiberRoot(se,t,void 0,128===(128&t.current.flags))}catch(e){}}(i.stateNode),nh(t,Jt()),null!==e)for(n=t.onRecoverableError,i=0;i<e.length;i++)s=e[i],n(s.value,{componentStack:s.stack,digest:s.digest});if(Xl)throw Xl=!1,t=Yl,Yl=null,t;0!==(1&Wl)&&0!==t.tag&&kh(),r=t.pendingLanes,0!==(1&r)?t===Jl?$l++:($l=0,Jl=t):$l=0,Ks()}(t,e,i,n)}finally{Nl.transition=s,be=n}return null}function kh(){if(null!==ql){var t=xe(Wl),e=Nl.transition,i=be;try{if(Nl.transition=null,be=16>t?16:t,null===ql)var n=!1;else{if(t=ql,ql=null,Wl=0,0!==(6&Ll))throw Error(o(331));var s=Ll;for(Ll|=4,Za=t.current;null!==Za;){var r=Za,a=r.child;if(0!==(16&Za.flags)){var l=r.deletions;if(null!==l){for(var h=0;h<l.length;h++){var u=l[h];for(Za=u;null!==Za;){var c=Za;switch(c.tag){case 0:case 11:case 15:il(8,c,r)}var d=c.child;if(null!==d)d.return=c,Za=d;else for(;null!==Za;){var f=(c=Za).sibling,g=c.return;if(ol(c),c===u){Za=null;break}if(null!==f){f.return=g,Za=f;break}Za=g}}}var m=r.alternate;if(null!==m){var p=m.child;if(null!==p){m.child=null;do{var y=p.sibling;p.sibling=null,p=y}while(null!==p)}}Za=r}}if(0!==(2064&r.subtreeFlags)&&null!==a)a.return=r,Za=a;else t:for(;null!==Za;){if(0!==(2048&(r=Za).flags))switch(r.tag){case 0:case 11:case 15:il(9,r,r.return)}var v=r.sibling;if(null!==v){v.return=r.return,Za=v;break t}Za=r.return}}var b=t.current;for(Za=b;null!==Za;){var x=(a=Za).child;if(0!==(2064&a.subtreeFlags)&&null!==x)x.return=a,Za=x;else t:for(a=b;null!==Za;){if(0!==(2048&(l=Za).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(k){Ph(l,l.return,k)}if(l===a){Za=null;break t}var w=l.sibling;if(null!==w){w.return=l.return,Za=w;break t}Za=l.return}}if(Ll=s,Ks(),oe&&"function"===typeof oe.onPostCommitFiberRoot)try{oe.onPostCommitFiberRoot(se,t)}catch(k){}n=!0}return n}finally{be=i,Nl.transition=e}}return!1}function Sh(t,e,i){t=jo(t,e=fa(0,e=ha(i,e),1),1),e=th(),null!==t&&(ye(t,1,e),nh(t,e))}function Ph(t,e,i){if(3===t.tag)Sh(t,t,i);else for(;null!==e;){if(3===e.tag){Sh(e,t,i);break}if(1===e.tag){var n=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===_l||!_l.has(n))){e=jo(e,t=ga(e,t=ha(i,t),1),1),t=th(),null!==e&&(ye(e,1,t),nh(e,t));break}}e=e.return}}function Mh(t,e,i){var n=t.pingCache;null!==n&&n.delete(e),e=th(),t.pingedLanes|=t.suspendedLanes&i,Tl===t&&(Dl&i)===i&&(4===Rl||3===Rl&&(130023424&Dl)===Dl&&500>Jt()-Ul?dh(t,0):Vl|=i),nh(t,e)}function Ch(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ue,0===(130023424&(ue<<=1))&&(ue=4194304)));var i=th();null!==(t=Eo(t,e))&&(ye(t,e,i),nh(t,i))}function Nh(t){var e=t.memoizedState,i=0;null!==e&&(i=e.retryLane),Ch(t,i)}function Lh(t,e){var i=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;null!==s&&(i=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(o(314))}null!==n&&n.delete(e),Ch(t,i)}function Th(t,e){return Ht(t,e)}function Ah(t,e,i,n){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dh(t,e,i,n){return new Ah(t,e,i,n)}function Fh(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Oh(t,e){var i=t.alternate;return null===i?((i=Dh(t.tag,e,t.key,t.mode)).elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&t.flags,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function Rh(t,e,i,n,s,r){var a=2;if(n=t,"function"===typeof t)Fh(t)&&(a=1);else if("string"===typeof t)a=5;else t:switch(t){case S:return Eh(i.children,s,r,e);case P:a=8,s|=8;break;case M:return(t=Dh(12,i,e,2|s)).elementType=M,t.lanes=r,t;case T:return(t=Dh(13,i,e,s)).elementType=T,t.lanes=r,t;case A:return(t=Dh(19,i,e,s)).elementType=A,t.lanes=r,t;case O:return Bh(i,s,r,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case C:a=10;break t;case N:a=9;break t;case L:a=11;break t;case D:a=14;break t;case F:a=16,n=null;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=Dh(a,i,e,s)).elementType=t,e.type=n,e.lanes=r,e}function Eh(t,e,i,n){return(t=Dh(7,t,n,e)).lanes=i,t}function Bh(t,e,i,n){return(t=Dh(22,t,n,e)).elementType=O,t.lanes=i,t.stateNode={isHidden:!1},t}function Ih(t,e,i){return(t=Dh(6,t,null,e)).lanes=i,t}function Vh(t,e,i){return(e=Dh(4,null!==t.children?t.children:[],t.key,e)).lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function zh(t,e,i,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pe(0),this.expirationTimes=pe(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pe(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function jh(t,e,i,n,s,o,r,a,l){return t=new zh(t,e,i,a,l),1===e?(e=1,!0===o&&(e|=8)):e=0,o=Dh(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Io(o),t}function Uh(t){if(!t)return Ns;t:{if(Kt(t=t._reactInternals)!==t||1!==t.tag)throw Error(o(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Fs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(o(171))}if(1===t.tag){var i=t.type;if(Fs(i))return Es(t,i,e)}return e}function Kh(t,e,i,n,s,o,r,a,l){return(t=jh(i,n,!0,t,0,o,0,a,l)).context=Uh(null),i=t.current,(o=zo(n=th(),s=eh(i))).callback=void 0!==e&&null!==e?e:null,jo(i,o,s),t.current.lanes=s,ye(t,s,n),nh(t,n),t}function Gh(t,e,i,n){var s=e.current,o=th(),r=eh(s);return i=Uh(i),null===e.context?e.context=i:e.pendingContext=i,(e=zo(o,r)).payload={element:t},null!==(n=void 0===n?null:n)&&(e.callback=n),null!==(t=jo(s,e,r))&&(ih(t,s,r,o),Uo(t,s,r)),r}function Xh(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Yh(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var i=t.retryLane;t.retryLane=0!==i&&i<e?i:e}}function _h(t,e){Yh(t,e),(t=t.alternate)&&Yh(t,e)}Sl=function(t,e,i){if(null!==t)if(t.memoizedProps!==e.pendingProps||Ts.current)ba=!0;else{if(0===(t.lanes&i)&&0===(128&e.flags))return ba=!1,function(t,e,i){switch(e.tag){case 3:Ta(e),go();break;case 5:Zo(e);break;case 1:Fs(e.type)&&Bs(e);break;case 4:$o(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Cs(So,n._currentValue),n._currentValue=s;break;case 13:if(null!==(n=e.memoizedState))return null!==n.dehydrated?(Cs(tr,1&tr.current),e.flags|=128,null):0!==(i&e.child.childLanes)?Ia(t,e,i):(Cs(tr,1&tr.current),null!==(t=Xa(t,e,i))?t.sibling:null);Cs(tr,1&tr.current);break;case 19:if(n=0!==(i&e.childLanes),0!==(128&t.flags)){if(n)return Ka(t,e,i);e.flags|=128}if(null!==(s=e.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Cs(tr,tr.current),n)break;return null;case 22:case 23:return e.lanes=0,Pa(t,e,i)}return Xa(t,e,i)}(t,e,i);ba=0!==(131072&t.flags)}else ba=!1,so&&0!==(1048576&e.flags)&&Qs(e,_s,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Ga(t,e),t=e.pendingProps;var s=Ds(e,Ls.current);Ao(e,i),s=pr(null,e,n,t,s,i);var r=yr();return e.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Fs(n)?(r=!0,Bs(e)):r=!1,e.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Io(e),s.updater=sa,e.stateNode=s,s._reactInternals=e,la(e,n,t,i),e=La(null,e,n,!0,r,i)):(e.tag=0,so&&r&&to(e),xa(null,e,s,i),e=e.child),e;case 16:n=e.elementType;t:{switch(Ga(t,e),t=e.pendingProps,n=(s=n._init)(n._payload),e.type=n,s=e.tag=function(t){if("function"===typeof t)return Fh(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===L)return 11;if(t===D)return 14}return 2}(n),t=ia(n,t),s){case 0:e=Ca(null,e,n,t,i);break t;case 1:e=Na(null,e,n,t,i);break t;case 11:e=wa(null,e,n,t,i);break t;case 14:e=ka(null,e,n,ia(n.type,t),i);break t}throw Error(o(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,Ca(t,e,n,s=e.elementType===n?s:ia(n,s),i);case 1:return n=e.type,s=e.pendingProps,Na(t,e,n,s=e.elementType===n?s:ia(n,s),i);case 3:t:{if(Ta(e),null===t)throw Error(o(387));n=e.pendingProps,s=(r=e.memoizedState).element,Vo(t,e),Go(e,n,null,i);var a=e.memoizedState;if(n=a.element,r.isDehydrated){if(r={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=r,e.memoizedState=r,256&e.flags){e=Aa(t,e,n,i,s=ha(Error(o(423)),e));break t}if(n!==s){e=Aa(t,e,n,i,s=ha(Error(o(424)),e));break t}for(no=hs(e.stateNode.containerInfo.firstChild),io=e,so=!0,oo=null,i=ko(e,null,n,i),e.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(go(),n===s){e=Xa(t,e,i);break t}xa(t,e,n,i)}e=e.child}return e;case 5:return Zo(e),null===t&&ho(e),n=e.type,s=e.pendingProps,r=null!==t?t.memoizedProps:null,a=s.children,is(n,s)?a=null:null!==r&&is(n,r)&&(e.flags|=32),Ma(t,e),xa(t,e,a,i),e.child;case 6:return null===t&&ho(e),null;case 13:return Ia(t,e,i);case 4:return $o(e,e.stateNode.containerInfo),n=e.pendingProps,null===t?e.child=wo(e,null,n,i):xa(t,e,n,i),e.child;case 11:return n=e.type,s=e.pendingProps,wa(t,e,n,s=e.elementType===n?s:ia(n,s),i);case 7:return xa(t,e,e.pendingProps,i),e.child;case 8:case 12:return xa(t,e,e.pendingProps.children,i),e.child;case 10:t:{if(n=e.type._context,s=e.pendingProps,r=e.memoizedProps,a=s.value,Cs(So,n._currentValue),n._currentValue=a,null!==r)if(an(r.value,a)){if(r.children===s.children&&!Ts.current){e=Xa(t,e,i);break t}}else for(null!==(r=e.child)&&(r.return=e);null!==r;){var l=r.dependencies;if(null!==l){a=r.child;for(var h=l.firstContext;null!==h;){if(h.context===n){if(1===r.tag){(h=zo(-1,i&-i)).tag=2;var u=r.updateQueue;if(null!==u){var c=(u=u.shared).pending;null===c?h.next=h:(h.next=c.next,c.next=h),u.pending=h}}r.lanes|=i,null!==(h=r.alternate)&&(h.lanes|=i),To(r.return,i,e),l.lanes|=i;break}h=h.next}}else if(10===r.tag)a=r.type===e.type?null:r.child;else if(18===r.tag){if(null===(a=r.return))throw Error(o(341));a.lanes|=i,null!==(l=a.alternate)&&(l.lanes|=i),To(a,i,e),a=r.sibling}else a=r.child;if(null!==a)a.return=r;else for(a=r;null!==a;){if(a===e){a=null;break}if(null!==(r=a.sibling)){r.return=a.return,a=r;break}a=a.return}r=a}xa(t,e,s.children,i),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Ao(e,i),n=n(s=Do(s)),e.flags|=1,xa(t,e,n,i),e.child;case 14:return s=ia(n=e.type,e.pendingProps),ka(t,e,n,s=ia(n.type,s),i);case 15:return Sa(t,e,e.type,e.pendingProps,i);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ia(n,s),Ga(t,e),e.tag=1,Fs(n)?(t=!0,Bs(e)):t=!1,Ao(e,i),ra(e,n,s),la(e,n,s,i),La(null,e,n,!0,t,i);case 19:return Ka(t,e,i);case 22:return Pa(t,e,i)}throw Error(o(156,e.tag))};var Hh="function"===typeof reportError?reportError:function(t){console.error(t)};function qh(t){this._internalRoot=t}function Wh(t){this._internalRoot=t}function $h(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Jh(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Zh(){}function Qh(t,e,i,n,s){var o=i._reactRootContainer;if(o){var r=o;if("function"===typeof s){var a=s;s=function(){var t=Xh(r);a.call(t)}}Gh(e,r,t,s)}else r=function(t,e,i,n,s){if(s){if("function"===typeof n){var o=n;n=function(){var t=Xh(r);o.call(t)}}var r=Kh(e,n,t,0,null,!1,0,"",Zh);return t._reactRootContainer=r,t[gs]=r.current,Kn(8===t.nodeType?t.parentNode:t),uh(),r}for(;s=t.lastChild;)t.removeChild(s);if("function"===typeof n){var a=n;n=function(){var t=Xh(l);a.call(t)}}var l=jh(t,0,!1,null,0,!1,0,"",Zh);return t._reactRootContainer=l,t[gs]=l.current,Kn(8===t.nodeType?t.parentNode:t),uh((function(){Gh(e,l,i,n)})),l}(i,e,t,s,n);return Xh(r)}Wh.prototype.render=qh.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(o(409));Gh(t,e,null,null)},Wh.prototype.unmount=qh.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;uh((function(){Gh(null,t,null,null)})),e[gs]=null}},Wh.prototype.unstable_scheduleHydration=function(t){if(t){var e=Pe();t={blockedOn:null,target:t,priority:e};for(var i=0;i<Oe.length&&0!==e&&e<Oe[i].priority;i++);Oe.splice(i,0,t),0===i&&Ie(t)}},we=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var i=ce(e.pendingLanes);0!==i&&(ve(e,1|i),nh(e,Jt()),0===(6&Ll)&&(Kl=Jt()+500,Ks()))}break;case 13:uh((function(){var e=Eo(t,1);if(null!==e){var i=th();ih(e,t,1,i)}})),_h(t,1)}},ke=function(t){if(13===t.tag){var e=Eo(t,134217728);if(null!==e)ih(e,t,134217728,th());_h(t,134217728)}},Se=function(t){if(13===t.tag){var e=eh(t),i=Eo(t,e);if(null!==i)ih(i,t,e,th());_h(t,e)}},Pe=function(){return be},Me=function(t,e){var i=be;try{return be=t,e()}finally{be=i}},kt=function(t,e,i){switch(e){case"input":if(Z(t,i),e=i.name,"radio"===i.type&&null!=e){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var n=i[e];if(n!==t&&n.form===t.form){var s=ws(n);if(!s)throw Error(o(90));H(n),Z(n,s)}}}break;case"textarea":ot(t,i);break;case"select":null!=(e=i.value)&&it(t,!!i.multiple,e,!1)}},Lt=hh,Tt=uh;var tu={usingClientEntryPoint:!1,Events:[bs,xs,ws,Ct,Nt,hh]},eu={findFiberByHostInstance:vs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Yt(t))?null:t.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{se=nu.inject(iu),oe=nu}catch(ut){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,e.createPortal=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$h(e))throw Error(o(200));return function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==n?null:""+n,children:t,containerInfo:e,implementation:i}}(t,e,null,i)},e.createRoot=function(t,e){if(!$h(t))throw Error(o(299));var i=!1,n="",s=Hh;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(i=!0),void 0!==e.identifierPrefix&&(n=e.identifierPrefix),void 0!==e.onRecoverableError&&(s=e.onRecoverableError)),e=jh(t,1,!1,null,0,i,0,n,s),t[gs]=e.current,Kn(8===t.nodeType?t.parentNode:t),new qh(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(o(188));throw t=Object.keys(t).join(","),Error(o(268,t))}return t=null===(t=Yt(e))?null:t.stateNode},e.flushSync=function(t){return uh(t)},e.hydrate=function(t,e,i){if(!Jh(e))throw Error(o(200));return Qh(null,t,e,!0,i)},e.hydrateRoot=function(t,e,i){if(!$h(t))throw Error(o(405));var n=null!=i&&i.hydratedSources||null,s=!1,r="",a=Hh;if(null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(s=!0),void 0!==i.identifierPrefix&&(r=i.identifierPrefix),void 0!==i.onRecoverableError&&(a=i.onRecoverableError)),e=Kh(e,null,t,1,null!=i?i:null,s,0,r,a),t[gs]=e.current,Kn(t),n)for(t=0;t<n.length;t++)s=(s=(i=n[t])._getVersion)(i._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[i,s]:e.mutableSourceEagerHydrationData.push(i,s);return new Wh(e)},e.render=function(t,e,i){if(!Jh(e))throw Error(o(200));return Qh(null,t,e,!1,i)},e.unmountComponentAtNode=function(t){if(!Jh(t))throw Error(o(40));return!!t._reactRootContainer&&(uh((function(){Qh(null,null,t,!1,(function(){t._reactRootContainer=null,t[gs]=null}))})),!0)},e.unstable_batchedUpdates=hh,e.unstable_renderSubtreeIntoContainer=function(t,e,i,n){if(!Jh(i))throw Error(o(200));if(null==t||void 0===t._reactInternals)throw Error(o(38));return Qh(t,e,i,!1,n)},e.version="18.3.1-next-f1338f8080-20240426"},391:(t,e,i)=>{var n=i(950);e.createRoot=n.createRoot,e.hydrateRoot=n.hydrateRoot},950:(t,e,i)=>{!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=i(730)},153:(t,e,i)=>{var n=i(43),s=Symbol.for("react.element"),o=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function h(t,e,i){var n,o={},h=null,u=null;for(n in void 0!==i&&(h=""+i),void 0!==e.key&&(h=""+e.key),void 0!==e.ref&&(u=e.ref),e)r.call(e,n)&&!l.hasOwnProperty(n)&&(o[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps)void 0===o[n]&&(o[n]=e[n]);return{$$typeof:s,type:t,key:h,ref:u,props:o,_owner:a.current}}e.jsx=h,e.jsxs=h},202:(t,e)=>{var i=Symbol.for("react.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,p={};function y(t,e,i){this.props=t,this.context=e,this.refs=p,this.updater=i||g}function v(){}function b(t,e,i){this.props=t,this.context=e,this.refs=p,this.updater=i||g}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,m(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,S={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function M(t,e,n){var s,o={},r=null,a=null;if(null!=e)for(s in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(r=""+e.key),e)k.call(e,s)&&!P.hasOwnProperty(s)&&(o[s]=e[s]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var h=Array(l),u=0;u<l;u++)h[u]=arguments[u+2];o.children=h}if(t&&t.defaultProps)for(s in l=t.defaultProps)void 0===o[s]&&(o[s]=l[s]);return{$$typeof:i,type:t,key:r,ref:a,props:o,_owner:S.current}}function C(t){return"object"===typeof t&&null!==t&&t.$$typeof===i}var N=/\/+/g;function L(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function T(t,e,s,o,r){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var l=!1;if(null===t)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case i:case n:l=!0}}if(l)return r=r(l=t),t=""===o?"."+L(l,0):o,w(r)?(s="",null!=t&&(s=t.replace(N,"$&/")+"/"),T(r,e,s,"",(function(t){return t}))):null!=r&&(C(r)&&(r=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(r,s+(!r.key||l&&l.key===r.key?"":(""+r.key).replace(N,"$&/")+"/")+t)),e.push(r)),1;if(l=0,o=""===o?".":o+":",w(t))for(var h=0;h<t.length;h++){var u=o+L(a=t[h],h);l+=T(a,e,s,u,r)}else if(u=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof u)for(t=u.call(t),h=0;!(a=t.next()).done;)l+=T(a=a.value,e,s,u=o+L(a,h++),r);else if("object"===a)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function A(t,e,i){if(null==t)return t;var n=[],s=0;return T(t,n,"","",(function(t){return e.call(i,t,s++)})),n}function D(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var F={current:null},O={transition:null},R={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};function E(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:A,forEach:function(t,e,i){A(t,(function(){e.apply(this,arguments)}),i)},count:function(t){var e=0;return A(t,(function(){e++})),e},toArray:function(t){return A(t,(function(t){return t}))||[]},only:function(t){if(!C(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=s,e.Profiler=r,e.PureComponent=b,e.StrictMode=o,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,e.act=E,e.cloneElement=function(t,e,n){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=m({},t.props),o=t.key,r=t.ref,a=t._owner;if(null!=e){if(void 0!==e.ref&&(r=e.ref,a=S.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(h in e)k.call(e,h)&&!P.hasOwnProperty(h)&&(s[h]=void 0===e[h]&&void 0!==l?l[h]:e[h])}var h=arguments.length-2;if(1===h)s.children=n;else if(1<h){l=Array(h);for(var u=0;u<h;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:i,type:t.type,key:o,ref:r,props:s,_owner:a}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=M,e.createFactory=function(t){var e=M.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:h,render:t}},e.isValidElement=C,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:D}},e.memo=function(t,e){return{$$typeof:c,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=O.transition;O.transition={};try{t()}finally{O.transition=e}},e.unstable_act=E,e.useCallback=function(t,e){return F.current.useCallback(t,e)},e.useContext=function(t){return F.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return F.current.useDeferredValue(t)},e.useEffect=function(t,e){return F.current.useEffect(t,e)},e.useId=function(){return F.current.useId()},e.useImperativeHandle=function(t,e,i){return F.current.useImperativeHandle(t,e,i)},e.useInsertionEffect=function(t,e){return F.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return F.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return F.current.useMemo(t,e)},e.useReducer=function(t,e,i){return F.current.useReducer(t,e,i)},e.useRef=function(t){return F.current.useRef(t)},e.useState=function(t){return F.current.useState(t)},e.useSyncExternalStore=function(t,e,i){return F.current.useSyncExternalStore(t,e,i)},e.useTransition=function(){return F.current.useTransition()},e.version="18.3.1"},43:(t,e,i)=>{t.exports=i(202)},579:(t,e,i)=>{t.exports=i(153)},234:(t,e)=>{function i(t,e){var i=t.length;t.push(e);t:for(;0<i;){var n=i-1>>>1,s=t[n];if(!(0<o(s,e)))break t;t[n]=e,t[i]=s,i=n}}function n(t){return 0===t.length?null:t[0]}function s(t){if(0===t.length)return null;var e=t[0],i=t.pop();if(i!==e){t[0]=i;t:for(var n=0,s=t.length,r=s>>>1;n<r;){var a=2*(n+1)-1,l=t[a],h=a+1,u=t[h];if(0>o(l,i))h<s&&0>o(u,l)?(t[n]=u,t[h]=i,n=h):(t[n]=l,t[a]=i,n=a);else{if(!(h<s&&0>o(u,i)))break t;t[n]=u,t[h]=i,n=h}}}return e}function o(t,e){var i=t.sortIndex-e.sortIndex;return 0!==i?i:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var r=performance;e.unstable_now=function(){return r.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var h=[],u=[],c=1,d=null,f=3,g=!1,m=!1,p=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(t){for(var e=n(u);null!==e;){if(null===e.callback)s(u);else{if(!(e.startTime<=t))break;s(u),e.sortIndex=e.expirationTime,i(h,e)}e=n(u)}}function w(t){if(p=!1,x(t),!m)if(null!==n(h))m=!0,O(k);else{var e=n(u);null!==e&&R(w,e.startTime-t)}}function k(t,i){m=!1,p&&(p=!1,v(C),C=-1),g=!0;var o=f;try{for(x(i),d=n(h);null!==d&&(!(d.expirationTime>i)||t&&!T());){var r=d.callback;if("function"===typeof r){d.callback=null,f=d.priorityLevel;var a=r(d.expirationTime<=i);i=e.unstable_now(),"function"===typeof a?d.callback=a:d===n(h)&&s(h),x(i)}else s(h);d=n(h)}if(null!==d)var l=!0;else{var c=n(u);null!==c&&R(w,c.startTime-i),l=!1}return l}finally{d=null,f=o,g=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,P=!1,M=null,C=-1,N=5,L=-1;function T(){return!(e.unstable_now()-L<N)}function A(){if(null!==M){var t=e.unstable_now();L=t;var i=!0;try{i=M(!0,t)}finally{i?S():(P=!1,M=null)}}else P=!1}if("function"===typeof b)S=function(){b(A)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,F=D.port2;D.port1.onmessage=A,S=function(){F.postMessage(null)}}else S=function(){y(A,0)};function O(t){M=t,P||(P=!0,S())}function R(t,i){C=y((function(){t(e.unstable_now())}),i)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||g||(m=!0,O(k))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(h)},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var i=f;f=e;try{return t()}finally{f=i}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var i=f;f=t;try{return e()}finally{f=i}},e.unstable_scheduleCallback=function(t,s,o){var r=e.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?r+o:r:o=r,t){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return t={id:c++,callback:s,priorityLevel:t,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>r?(t.sortIndex=o,i(u,t),null===n(h)&&t===n(u)&&(p?(v(C),C=-1):p=!0,R(w,o-r))):(t.sortIndex=a,i(h,t),m||g||(m=!0,O(k))),t},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(t){var e=f;return function(){var i=f;f=e;try{return t.apply(this,arguments)}finally{f=i}}}},853:(t,e,i)=>{t.exports=i(234)}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,i),o.exports}i.m=t,i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.f={},i.e=t=>Promise.all(Object.keys(i.f).reduce(((e,n)=>(i.f[n](t,e),e)),[])),i.u=t=>"static/js/"+t+".06de5d9b.chunk.js",i.miniCssF=t=>{},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="menu-tree-app:";i.l=(n,s,o,r)=>{if(t[n])t[n].push(s);else{var a,l;if(void 0!==o)for(var h=document.getElementsByTagName("script"),u=0;u<h.length;u++){var c=h[u];if(c.getAttribute("src")==n||c.getAttribute("data-webpack")==e+o){a=c;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",e+o),a.src=n),t[n]=[s];var d=(e,i)=>{a.onerror=a.onload=null,clearTimeout(f);var s=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),s&&s.forEach((t=>t(i))),e)return e(i)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),i.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.p="/menu-tree-app/",(()=>{var t={792:0};i.f.j=(e,n)=>{var s=i.o(t,e)?t[e]:void 0;if(0!==s)if(s)n.push(s[2]);else{var o=new Promise(((i,n)=>s=t[e]=[i,n]));n.push(s[2]=o);var r=i.p+i.u(e),a=new Error;i.l(r,(n=>{if(i.o(t,e)&&(0!==(s=t[e])&&(t[e]=void 0),s)){var o=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+o+": "+r+")",a.name="ChunkLoadError",a.type=o,a.request=r,s[1](a)}}),"chunk-"+e,e)}};var e=(e,n)=>{var s,o,r=n[0],a=n[1],l=n[2],h=0;if(r.some((e=>0!==t[e]))){for(s in a)i.o(a,s)&&(i.m[s]=a[s]);if(l)l(i)}for(e&&e(n);h<r.length;h++)o=r[h],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0},n=self.webpackChunkmenu_tree_app=self.webpackChunkmenu_tree_app||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),(()=>{var t=i(43),e=i(391);const n="#ABFDF1",s="#E7BCFF",o="#C18145",r="#BCD9FF",a="#3AB48B",l="#C46FD5",h="#F1E187",u="#E7B579",c=[{id:"apm",label:"Application",groups:["apm"],color:{background:s},shape:"circle"},{id:"server",label:"Server",groups:["server"],color:{background:o},shape:"circle"},{id:"k8s",label:"Kubernetes",groups:["k8s"],color:{background:r},shape:"circle"},{id:"db",label:"Database",groups:["db"],color:{background:a},shape:"circle"},{id:"url",label:"URL",groups:["url"],color:{background:"#4AC353"},shape:"circle"},{id:"cloud",label:"Cloud",groups:["cloud"],color:{background:h},shape:"circle"},{id:"browser",label:"Browser",groups:["browser"],color:{background:l},shape:"circle"},{id:"npm",label:"NPM",groups:["npm"],color:{background:u},shape:"circle"},{id:"urlList",label:"URL \ubaa9\ub85d",groups:["url","mid"],color:{background:a}},{id:"vendorService",label:"Cloud(Vender) \ubaa8\ub2c8\ud130\ub9c1",groups:["cloud","mid"],color:{background:h}},{id:"dashboard",label:"\ub300\uc2dc\ubcf4\ub4dc",groups:["apm","server","k8s","db","browser","npm","mid"],color:{background:n}},{id:"serverList",label:"\uc11c\ubc84 \ubaa9\ub85d",groups:["server","mid"],color:{background:o}},{id:"container",label:"\ucee8\ud14c\uc774\ub108",groups:["k8s","mid"],color:{background:r}},{id:"workload",label:"\uc6cc\ud06c\ub85c\ub4dc",groups:["k8s","mid"],color:{background:r}},{id:"cluster",label:"\ud074\ub7ec\uc2a4\ud130",groups:["k8s","mid"],color:{background:r}},{id:"analysis",label:"\ubd84\uc11d",groups:["apm","server","k8s","db","browser","npm","mid"],color:{background:n}},{id:"topology",label:"\ud1a0\ud3f4\ub85c\uc9c0",groups:["apm","mid"],color:{background:s}},{id:"statReport",label:"\ud1b5\uacc4/\ubcf4\uace0\uc11c",groups:["db","mid"],color:{background:a}},{id:"log",label:"\ub85c\uadf8",groups:["apm","log","server","k8s","db","mid"],color:{background:n}},{id:"static",label:"\ud1b5\uacc4",groups:["apm","mid"],color:{background:s}},{id:"report",label:"\ubcf4\uace0\uc11c",groups:["apm","server","k8s","mid"],color:{background:n}},{id:"cloudMetrics",label:"\uba54\ud2b8\ub9ad\uc2a4",groups:["cloud","mid"],color:{background:h}},{id:"alert",label:"\uacbd\uace0 \uc54c\ub9bc",groups:["apm","server","k8s","db","url","cloud","browser","npm","mid"],color:{background:n}},{id:"setserver",label:"\uc11c\ubc84 \uc124\uc815",groups:["server","mid"],color:{background:o}},{id:"instanceperf",label:"\uc778\uc2a4\ud134\uc2a4 \uc131\ub2a5 \uad00\ub9ac",groups:["apm","mid"],color:{background:s}},{id:"management",label:"\uad00\ub9ac",groups:["apm","k8s","server","db","url","cloud","browser","npm","mid"],color:{background:n}},{id:"appdashboard",label:"\uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ub300\uc2dc\ubcf4\ub4dc",groups:["apm"],color:{background:s}},{id:"txmap",label:"\ud2b8\ub79c\uc7ad\uc158 \ub9f5",groups:["apm"],color:{background:s}},{id:"acttx",label:"\uc561\ud2f0\ube0c \ud2b8\ub79c\uc7ad\uc158",groups:["apm"],color:{background:s}},{id:"resourceboard",label:"\ub9ac\uc18c\uc2a4 \ubcf4\ub4dc",groups:["server"],color:{background:o}},{id:"resourceequalizer",label:"\ub9ac\uc18c\uc2a4 \uc774\ud004\ub77c\uc774\uc800",groups:["server"],color:{background:o}},{id:"compouneye",label:"\ucef4\ud30c\uc6b4\ub4dc \uc544\uc774",groups:["server"],color:{background:o}},{id:"containermap",label:"\ucee8\ud14c\uc774\ub108 \ub9f5",groups:["k8s"],color:{background:r}},{id:"integcontainermap",label:"\ud1b5\ud569 \ucee8\ud14c\uc774\ub108 \ub9f5",groups:["k8s"],color:{background:r}},{id:"apmservicedashboard",label:"\uc560\ud50c\ub9ac\ucf00\uc774\uc158 \uc11c\ube44\uc2a4 \ub300\uc2dc\ubcf4\ub4dc",groups:["k8s"],color:{background:r}},{id:"perfsummary",label:"\ud37c\ud3ec\uba3c\uc2a4 \uc694\uc57d",groups:["k8s"],color:{background:r}},{id:"remoteaccess",label:"\uc678\ubd80 \ud638\ucd9c \uc0c1\ud0dc",groups:["k8s"],color:{background:r}},{id:"instanceList",label:"\uc778\uc2a4\ud134\uc2a4 \ubaa9\ub85d",groups:["db"],color:{background:a}},{id:"instanceMonitoring",label:"\uc778\uc2a4\ud134\uc2a4 \ubaa8\ub2c8\ud130\ub9c1",groups:["db"],color:{background:a}},{id:"multiMonitoring",label:"\uba40\ud2f0 \uc778\uc2a4\ud134\uc2a4 \ubaa8\ub2c8\ud130\ub9c1",groups:["db"],color:{background:a}},{id:"slowquery",label:"\uc2ac\ub85c\uc6b0 \ucffc\ub9ac",groups:["db"],color:{background:a}},{id:"browserDashboard",label:"\ube0c\ub77c\uc6b0\uc800 \ubaa8\ub2c8\ud130\ub9c1 \ub300\uc2dc\ubcf4\ub4dc",groups:["browser"],color:{background:l}},{id:"browserError",label:"\ube0c\ub77c\uc6b0\uc800 \uc5d0\ub7ec",groups:["browser"],color:{background:l}},{id:"pageload",label:"\ud398\uc774\uc9c0 \ub85c\ub4dc",groups:["browser"],color:{background:l}},{id:"Resource",label:"\ub9ac\uc18c\uc2a4",groups:["browser"],color:{background:l}},{id:"ajax",label:"AJXAX",groups:["browser"],color:{background:l}},{id:"flexboard",label:"Flex \ubcf4\ub4dc",groups:["apm","server","k8s","db","cloud","browser"],color:{background:n}},{id:"networktopology",label:"\ub124\ud2b8\uc6cc\ud06c \ud1a0\ud3f4\ub85c\uc9c0",groups:["npm"],color:{background:u}},{id:"networktrend",label:"\ub124\ud2b8\uc6cc\ud06c \ucd94\uc774(TCP)",groups:["npm"],color:{background:u}},{id:"serversubList",label:"\uc11c\ubc84 \ubaa9\ub85d",groups:["server"],color:{background:o}},{id:"serverdetail",label:"\uc11c\ubc84 \uc0c1\uc138",groups:["server"],color:{background:o}},{id:"containerList",label:"\ucee8\ud14c\uc774\ub108 \ubaa9\ub85d",groups:["k8s"],color:{background:r}},{id:"containervolume",label:"\ucee8\ud14c\uc774\ub108 \ubcfc\ub968",groups:["k8s"],color:{background:r}},{id:"containerimage",label:"\ucee8\ud14c\uc774\ub108 \uc774\ubbf8\uc9c0",groups:["k8s"],color:{background:r}},{id:"oomkilled",label:"Out Of Memory Killed \ucee8\ud14c\uc774\ub108",groups:["k8s"],color:{background:r}},{id:"podlist",label:"Pod \ubaa9\ub85d",groups:["k8s"],color:{background:r}},{id:"containerapp",label:"\ucee8\ud14c\uc774\ub108 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ubaa9\ub85d",groups:["k8s"],color:{background:r}},{id:"deployment",label:"Deployment \ubaa9\ub85d",groups:["k8s"],color:{background:r}},{id:"nodelist",label:"\ub178\ub4dc \ubaa9\ub85d",groups:["k8s"],color:{background:r}},{id:"nodedetail",label:"\ub178\ub4dc \uc0c1\uc138",groups:["k8s"],color:{background:r}},{id:"objectmanifest",label:"\uc624\ube0c\uc81d\ud2b8 \ub9e4\ub2c8\ud398\uc2a4\ud2b8",groups:["k8s"],color:{background:r}},{id:"kuberevent",label:"\ucfe0\ubc84\ub124\ud2f0\uc2a4 \uc774\ubca4\ud2b8",groups:["k8s"],color:{background:r}},{id:"k8sapidashboard",label:"kube-apiserver \ub300\uc2dc\ubcf4\ub4dc",groups:["k8s"],color:{background:r}},{id:"k8sapidashmetrics",label:"kube-apiserver \uba54\ud2b8\ub9ad\uc2a4 \uc870\ud68c",groups:["k8s"],color:{background:r}},{id:"namespace",label:"\ub124\uc784\uc2a4\ud398\uc774\uc2a4 \ud604\ud669",groups:["k8s"],color:{background:r}},{id:"dailyapptrend",label:"\uc77c\uc790\ubcc4 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ud604\ud669",groups:["apm"],color:{background:s}},{id:"perftrend",label:"\uc131\ub2a5 \ucd94\uc774",groups:["apm"],color:{background:s}},{id:"stack",label:"\uc2a4\ud0dd",groups:["apm"],color:{background:s}},{id:"cube",label:"\ud050\ube0c",groups:["apm","server"],color:{background:n}},{id:"hitmap",label:"\ud788\ud2b8\ub9f5",groups:["apm"],color:{background:s}},{id:"multitx",label:"\uba40\ud2f0 \ud2b8\ub79c\uc7ad\uc158 \ucd94\uc801",groups:["apm"],color:{background:s}},{id:"txsearch",label:"\ud2b8\ub79c\uc7ad\uc158 \uac80\uc0c9",groups:["apm"],color:{background:s}},{id:"downcheck",label:"\uac00\uc6a9\uc131 (\ub2e4\uc6b4\uccb4\ud06c)",groups:["server"],color:{background:o}},{id:"podstartup",label:"Pod \uc2dc\uc791 \ubd84\uc11d",groups:["k8s"],color:{background:r}},{id:"appHitmap",label:"\uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ud788\ud2b8\ub9f5",groups:["k8s"],color:{background:r}},{id:"multiHitmap",label:"\uba40\ud2f0\uc11c\ube44\uc2a4 \ud788\ud2b8\ub9f5",groups:["k8s"],color:{background:r}},{id:"msa",label:"MSA \ubd84\uc11d",groups:["k8s"],color:{background:r}},{id:"appstack",label:"\uc560\ud50c\ub9ac\ucf00\uc774\uc158 \uc2a4\ud0dd",groups:["k8s"],color:{background:r}},{id:"compareCount",label:"\uce74\uc6b4\ud2b8 \ucd94\uc774 \ube44\uad50",groups:["db"],color:{background:a}},{id:"locktree",label:"\ub77d \ud2b8\ub9ac",groups:["db"],color:{background:a}},{id:"sessionhistory",label:"\uc138\uc158 \ud788\uc2a4\ud1a0\ub9ac",groups:["db"],color:{background:a}},{id:"wait",label:"Wait \ubd84\uc11d",groups:["db"],color:{background:a}},{id:"topobject",label:"Top \uc624\ube0c\uc81d\ud2b8",groups:["db"],color:{background:a}},{id:"dbparameter",label:"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \ud30c\ub77c\ubbf8\ud130",groups:["db"],color:{background:a}},{id:"pageloadhitmap",label:"\ud398\uc774\uc9c0 \ub85c\ub4dc \ud788\ud2b8\ub9f5",groups:["browser"],color:{background:l}},{id:"ajaxhitmap",label:"AJAX \ud788\ud2b8\ub9f5",groups:["browser"],color:{background:l}},{id:"traceError",label:"\uc5d0\ub7ec \ucd94\uc801",groups:["browser"],color:{background:l}},{id:"traceUsersession",label:"\uc0ac\uc6a9\uc790 \uc138\uc158 \ub85c\uadf8 \uac80\uc0c9",groups:["browser"],color:{background:l}},{id:"tcpsession",label:"TCP \uc138\uc158",groups:["npm"],color:{background:u}},{id:"udpsession",label:"UDP \uc138\uc158",groups:["npm"],color:{background:u}},{id:"metricchart",label:"\uba54\ud2b8\ub9ad\uc2a4 \ucc28\ud2b8",groups:["apm","server","k8s","db","cloud","browser"],color:{background:n}},{id:"metricsearch",label:"\uba54\ud2b8\ub9ad\uc2a4 \uc870\ud68c",groups:["apm","server","k8s","db","cloud"],color:{background:n}},{id:"metricabnormal",label:"\uba54\ud2b8\ub9ad\uc2a4 \uc774\uc0c1 \ud0d0\uc9c0",groups:["apm","server","k8s","db","cloud"],color:{background:n}},{id:"apmtopology",label:"\uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ud1a0\ud3f4\ub85c\uc9c0",groups:["apm"],color:{background:s}},{id:"sqlstat",label:"SQL \ud1b5\uacc4",groups:["db"],color:{background:a}},{id:"pgsqlstat",label:"PG SQL \ud1b5\uacc4",groups:["db"],color:{background:a}},{id:"dbsize",label:"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc0ac\uc774\uc988",groups:["db"],color:{background:a}},{id:"subreport",label:"\ubcf4\uace0\uc11c",groups:["db"],color:{background:a}},{id:"livetail",label:"\ub77c\uc774\ube0c \ud14c\uc77c",groups:["apm","log","server","k8s","db"],color:{background:n}},{id:"logtrend",label:"\ub85c\uadf8 \ud2b8\ub80c\ub4dc",groups:["apm","log","server","k8s","db"],color:{background:n}},{id:"logsearch",label:"\ub85c\uadf8 \uac80\uc0c9",groups:["apm","log","server","k8s","db"],color:{background:n}},{id:"logsetting",label:"\ub85c\uadf8 \uc124\uc815",groups:["apm","log","server","k8s","db"],color:{background:n}},{id:"statictx",label:"\ud2b8\ub79c\uc7ad\uc158",groups:["apm"],color:{background:s}},{id:"staticdomain",label:"\ub3c4\uba54\uc778",groups:["apm"],color:{background:s}},{id:"staticcaller",label:"Caller",groups:["apm"],color:{background:s}},{id:"staticlogin",label:"\ub85c\uadf8\uc778",groups:["apm"],color:{background:s}},{id:"staticrefer",label:"\ub9ac\ud37c\ub7ec",groups:["apm"],color:{background:s}},{id:"staticerror",label:"\uc5d0\ub7ec",groups:["apm"],color:{background:s}},{id:"staticsql",label:"SQL",groups:["apm"],color:{background:s}},{id:"statichttpcall",label:"HTTP \ud638\ucd9c",groups:["apm"],color:{background:s}},{id:"staticclientip",label:"\ud074\ub77c\uc774\uc5b8\ud2b8 IP",groups:["apm"],color:{background:s}},{id:"staticuseragent",label:"\uc720\uc800 \uc5d0\uc774\uc804\ud2b8",groups:["apm"],color:{background:s}},{id:"staticbrowser",label:"\ud074\ub77c\uc774\uc5b8\ud2b8 \ube0c\ub77c\uc6b0\uc800",groups:["apm"],color:{background:s}},{id:"setevent",label:"\uc774\ubca4\ud2b8 \uc124\uc815",groups:["apm","server","k8s","db","url","cloud","browser","npm"],color:{background:n}},{id:"eventconfig",label:"\uc774\ubca4\ud2b8 \uc218\uc2e0 \uc124\uc815",groups:["apm","server","k8s","db","url","cloud","browser","npm"],color:{background:n}},{id:"eventhistory",label:"\uc774\ubca4\ud2b8 \uae30\ub85d",groups:["apm","server","k8s","db","url","cloud","browser","npm"],color:{background:n}},{id:"whatapevent",label:"WhaTap \uc774\ubca4\ud2b8",groups:["k8s"],color:{background:r}},{id:"subsetserver",label:"\uc11c\ubc84 \uc124\uc815",groups:["server"],color:{background:o}},{id:"agentlogviewer",label:"\uc5d0\uc774\uc804\ud2b8 \ub85c\uadf8 \ubdf0\uc5b4",groups:["server"],color:{background:o}},{id:"runenv",label:"\uc2e4\ud589 \ud658\uacbd \ubcc0\uc218",groups:["apm","server"],color:{background:n}},{id:"env",label:"\ud658\uacbd \ubcc0\uc218",groups:["apm","server"],color:{background:n}},{id:"heap",label:"\ud799 \ud788\uc2a4\ud1a0\uadf8\ub7a8",groups:["apm"],color:{background:s}},{id:"loadclass",label:"\ub85c\ub529\ub41c \ud074\ub798\uc2a4",groups:["apm"],color:{background:s}},{id:"library",label:"\ub77c\uc774\ube0c\ub7ec\ub9ac \ubc84\uc804",groups:["apm"],color:{background:s}},{id:"thread",label:"\uc2a4\ub808\ub4dc \ubaa9\ub85d/\ub364\ud504",groups:["apm"],color:{background:s}},{id:"socket",label:"\uc18c\ucf13 \uc624\ud508 \uac1c\uc218",groups:["apm"],color:{background:s}},{id:"method",label:"\uba54\uc18c\ub4dc \uc131\ub2a5 \uc0c1\ud0dc",groups:["apm"],color:{background:s}},{id:"datasource",label:"\ub370\uc774\ud130\uc18c\uc2a4 \uc0c1\ud0dc",groups:["apm"],color:{background:s}},{id:"agentlog",label:"\uc5d0\uc774\uc804\ud2b8 \ub85c\uadf8",groups:["apm"],color:{background:s}},{id:"systemgc",label:"\uc2dc\uc2a4\ud15c GC",groups:["apm"],color:{background:s}},{id:"heapdump",label:"\ud799 \ub364\ud504",groups:["apm"],color:{background:s}},{id:"throttle",label:"\uc4f0\ub85c\ud2c0\ub9c1 \uc124\uc815",groups:["apm","k8s"],color:{background:s}},{id:"setagentold",label:"\uc5d0\uc774\uc804\ud2b8 \uc124\uc815 Old",groups:["apm"],color:{background:s}},{id:"moduledepen",label:"\ubaa8\ub4c8 \uc758\uc874\uc131",groups:["apm"],color:{background:s}},{id:"agentstatus",label:"\uc5d0\uc774\uc804\ud2b8 \uc0c1\ud0dc",groups:["apm"],color:{background:s}},{id:"manageproject",label:"\ud504\ub85c\uc81d\ud2b8 \uad00\ub9ac",groups:["apm","server","k8s","db","url","cloud","browser","npm"],color:{background:n}},{id:"pmember",label:"\ud504\ub85c\uc81d\ud2b8 \uba64\ubc84",groups:["apm","server","k8s","db","url","cloud","browser","npm"],color:{background:n}},{id:"agentlist",label:"\uc5d0\uc774\uc804\ud2b8 \ubaa9\ub85d",groups:["apm","db"],color:{background:n}},{id:"agentupdate",label:"\uc5d0\uc774\uc804\ud2b8 \uc5c5\ub370\uc774\ud2b8",groups:["apm","db"],color:{background:n}},{id:"setagent",label:"\uc5d0\uc774\uc804\ud2b8 \uc124\uc815",groups:["apm","k8s"],color:{background:n}},{id:"agentinstall",label:"\uc5d0\uc774\uc804\ud2b8 \uc124\uce58",groups:["apm","server","k8s","db","cloud","browser","npm"],color:{background:n}},{id:"kubeAgentlist",label:"\ucfe0\ubc84\ub124\ud2f0\uc2a4 \uc5d0\uc774\uc804\ud2b8 \ubaa9\ub85d",groups:["k8s"],color:{background:r}},{id:"manageNamespace",label:"\ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uad00\ub9ac",groups:["k8s"],color:{background:r}},{id:"cloudinteg",label:"\ud074\ub77c\uc6b0\ub4dc \ubaa8\ub2c8\ud130\ub9c1",groups:["apm","server"],color:{background:n}},{id:"maintenance",label:"\uc815\ube44 \uacc4\ud68d",groups:["apm","server","k8s","db","url","npm"],color:{background:n}},{id:"intgeproject",label:"\uc5f0\uacc4 \ud504\ub85c\uc81d\ud2b8 \uad00\ub9ac",groups:["k8s"],color:{background:r}},{id:"logfileviewr",label:"\ub85c\uadf8 \ud30c\uc77c \ubdf0\uc5b4",groups:["db"],color:{background:a}},{id:"filelog",label:"\ud30c\uc77c \ub85c\uadf8 \uc54c\ub9bc",groups:["db"],color:{background:a}},{id:"metricscube",label:"\uba54\ud2b8\ub9ad\uc2a4 \ud050\ube0c",groups:["cloud"],color:{background:h}}],d=[{from:"apm",to:"dashboard"},{from:"npm",to:"dashboard"},{from:"apm",to:"analysis"},{from:"apm",to:"topology"},{from:"apm",to:"log"},{from:"apm",to:"static"},{from:"apm",to:"report"},{from:"apm",to:"alert"},{from:"apm",to:"instanceperf"},{from:"apm",to:"management"},{from:"server",to:"dashboard"},{from:"server",to:"report"},{from:"server",to:"serverList"},{from:"server",to:"analysis"},{from:"server",to:"log"},{from:"server",to:"alert"},{from:"server",to:"setserver"},{from:"server",to:"management"},{from:"k8s",to:"dashboard"},{from:"k8s",to:"container"},{from:"k8s",to:"workload"},{from:"k8s",to:"cluster"},{from:"k8s",to:"analysis"},{from:"k8s",to:"log"},{from:"k8s",to:"report"},{from:"k8s",to:"alert"},{from:"k8s",to:"management"},{from:"db",to:"dashboard"},{from:"db",to:"analysis"},{from:"db",to:"statReport"},{from:"db",to:"log"},{from:"db",to:"alert"},{from:"db",to:"management"},{from:"url",to:"urlList"},{from:"url",to:"alert"},{from:"url",to:"management"},{from:"cloud",to:"flexboard"},{from:"cloud",to:"vendorService"},{from:"cloud",to:"cloudMetrics"},{from:"cloud",to:"alert"},{from:"cloud",to:"management"},{from:"browser",to:"dashboard"},{from:"browser",to:"flexboard"},{from:"browser",to:"analysis"},{from:"browser",to:"report"},{from:"browser",to:"alert"},{from:"browser",to:"management"},{from:"npm",to:"dashboard"},{from:"npm",to:"analysis"},{from:"npm",to:"alert"},{from:"npm",to:"management"},{from:"dashboard",to:"appdashboard"},{from:"dashboard",to:"txmap"},{from:"dashboard",to:"acttx"},{from:"dashboard",to:"flexboard"},{from:"dashboard",to:"resourceboard"},{from:"dashboard",to:"resourceequalizer"},{from:"dashboard",to:"compouneye"},{from:"dashboard",to:"containermap"},{from:"dashboard",to:"integcontainermap"},{from:"dashboard",to:"apmservicedashboard"},{from:"dashboard",to:"perfsummary"},{from:"dashboard",to:"remoteaccess"},{from:"dashboard",to:"instanceList"},{from:"dashboard",to:"instanceMonitoring"},{from:"dashboard",to:"multiMonitoring"},{from:"dashboard",to:"slowquery"},{from:"dashboard",to:"browserDashboard"},{from:"dashboard",to:"browserError"},{from:"dashboard",to:"pageload"},{from:"dashboard",to:"Resource"},{from:"dashboard",to:"ajax"},{from:"dashboard",to:"networktopology"},{from:"dashboard",to:"networktrend"},{from:"analysis",to:"dailyapptrend"},{from:"analysis",to:"perftrend"},{from:"analysis",to:"metricchart"},{from:"analysis",to:"metricsearch"},{from:"analysis",to:"metricabnormal"},{from:"analysis",to:"stack"},{from:"analysis",to:"cube"},{from:"analysis",to:"hitmap"},{from:"analysis",to:"multitx"},{from:"analysis",to:"txsearch"},{from:"analysis",to:"podstartup"},{from:"analysis",to:"appHitmap"},{from:"analysis",to:"multiHitmap"},{from:"analysis",to:"msa"},{from:"analysis",to:"appstack"},{from:"analysis",to:"compareCount"},{from:"analysis",to:"locktree"},{from:"analysis",to:"sessionhistory"},{from:"analysis",to:"wait"},{from:"analysis",to:"topobject"},{from:"analysis",to:"dbparameter"},{from:"analysis",to:"pageloadhitmap"},{from:"analysis",to:"ajaxhitmap"},{from:"analysis",to:"traceError"},{from:"analysis",to:"traceUsersession"},{from:"analysis",to:"tcpsession"},{from:"analysis",to:"udpsession"},{from:"topology",to:"apmtopology"},{from:"log",to:"livetail"},{from:"log",to:"logtrend"},{from:"log",to:"logsearch"},{from:"log",to:"logsetting"},{from:"static",to:"statictx"},{from:"static",to:"staticdomain"},{from:"static",to:"staticcaller"},{from:"static",to:"staticlogin"},{from:"static",to:"staticrefer"},{from:"static",to:"staticerror"},{from:"static",to:"staticsql"},{from:"static",to:"statichttpcall"},{from:"static",to:"staticclientip"},{from:"static",to:"staticuseragent"},{from:"static",to:"staticbrowser"},{from:"alert",to:"setevent"},{from:"alert",to:"eventconfig"},{from:"alert",to:"eventhistory"},{from:"alert",to:"whatapevent"},{from:"instanceperf",to:"runenv"},{from:"instanceperf",to:"env"},{from:"instanceperf",to:"heap"},{from:"instanceperf",to:"loadclass"},{from:"instanceperf",to:"library"},{from:"instanceperf",to:"thread"},{from:"instanceperf",to:"socket"},{from:"instanceperf",to:"method"},{from:"instanceperf",to:"datasource"},{from:"instanceperf",to:"agentlog"},{from:"instanceperf",to:"systemgc"},{from:"instanceperf",to:"heapdump"},{from:"instanceperf",to:"throttle"},{from:"instanceperf",to:"setagentold"},{from:"instanceperf",to:"moduledepen"},{from:"instanceperf",to:"agentstatus"},{from:"management",to:"manageproject"},{from:"management",to:"pmember"},{from:"management",to:"agentlist"},{from:"management",to:"agentupdate"},{from:"management",to:"setagent"},{from:"management",to:"agentinstall"},{from:"management",to:"maintenance"},{from:"management",to:"cloudinteg"},{from:"management",to:"throttle"},{from:"management",to:"intgeproject"},{from:"management",to:"logfileviewr"},{from:"management",to:"filelog"},{from:"management",to:"kubeAgentlist"},{from:"management",to:"manageNamespace"},{from:"serverList",to:"serversubList"},{from:"serverList",to:"serverdetail"},{from:"analysis",to:"downcheck"},{from:"setserver",to:"subsetserver"},{from:"setserver",to:"agentlogviewer"},{from:"setserver",to:"runenv"},{from:"setserver",to:"env"},{from:"container",to:"containerList"},{from:"container",to:"containervolume"},{from:"container",to:"containerimage"},{from:"container",to:"oomkilled"},{from:"workload",to:"podlist"},{from:"workload",to:"containerapp"},{from:"workload",to:"deployment"},{from:"cluster",to:"nodelist"},{from:"cluster",to:"nodedetail"},{from:"cluster",to:"objectmanifest"},{from:"cluster",to:"kuberevent"},{from:"cluster",to:"k8sapidashboard"},{from:"cluster",to:"k8sapidashmetrics"},{from:"cluster",to:"namespace"},{from:"statReport",to:"sqlstat"},{from:"statReport",to:"pgsqlstat"},{from:"statReport",to:"dbsize"},{from:"statReport",to:"subreport"},{from:"cloudMetrics",to:"metricscube"},{from:"cloudMetrics",to:"metricchart"},{from:"cloudMetrics",to:"metricsearch"},{from:"cloudMetrics",to:"metricabnormal"}];var f=i(579);const g=t=>{let{filters:e}=t;const i=c.filter((t=>t.groups.includes("mid"))),n=Object.keys(e).filter((t=>e[t])),s=i.filter((t=>t.groups.some((t=>n.includes(t)))));return(0,f.jsx)("div",{className:"menutable",children:(0,f.jsxs)("table",{border:"1",children:[(0,f.jsx)("thead",{children:(0,f.jsx)("tr",{children:s.map((t=>(0,f.jsx)("th",{groups:t.groups.join(", "),children:t.label},t.id)))})}),(0,f.jsx)("tbody",{children:(0,f.jsx)("tr",{children:s.map((t=>{return(0,f.jsx)("td",{children:(e=t.id,d.filter((t=>t.from===e)).map((t=>t.to)).filter((t=>{const e=c.find((e=>e.id===t));return e&&e.groups.some((t=>n.includes(t)))}))).map((t=>{const e=c.find((e=>e.id===t));return(0,f.jsx)("div",{id:"menuitem",groups:e.groups.join(", "),className:e.color.background.replace("#","color-"),children:e.label},t)}))},t.id);var e}))})})]})})};function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function p(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}function y(t,e,i){return(e=p(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}!function(t,e,i,n,s,o,r,a,l,h,u){const c="object"==typeof globalThis&&globalThis||"object"==typeof global&&global.global===global&&global||"object"==typeof self&&self.self===self&&self||{};void 0===c.requestAnimationFrame&&(void 0===c.setImmediate?c.requestAnimationFrame=t=>c.setTimeout(t,0):c.requestAnimationFrame=c.setImmediate);class d{static Sk(t,e,i){let n=-1;return function(){const s=this,o=arguments;-1!==n&&d.Eg(n),n=d.Ih((()=>{n=-1,i||t.apply(s,o)}),e),i&&!n&&t.apply(s,o)}}static Ih(t,e){return c.setTimeout(t,e)}static Eg(t){c.clearTimeout(t)}static sn(t){return c.document.createElement(t)}static o(t){throw new Error(t)}static D(t,e){let i="The object is frozen, so its properties cannot be set: "+t.toString();void 0!==e&&(i+="  to value: "+e),d.o(i)}static jI(t,e,i,n){}static i(t,e,i,n){}static qI(t,e,i){}static WI(t,e,i){}static ke(t,e,i,n){}static tt(t,e,i,n){let s=d.kD(i);void 0!==n&&(s+="."+n),d.o(s+" is not in the range "+e+": "+t)}static Ee(t){}static ar(t,e){}static ri(t){c.console&&c.console.log(t)}static wt(t){return"object"==typeof t&&null!==t}static JI(t,e,i){}static eu(t,e,i){Array.isArray(t)?e>=t.length?t.push(i):t.splice(e,0,i):d.o("Cannot insert an object into an HTMLCollection or NodeList: "+i+" at "+e)}static _a(t,e){Array.isArray(t)?e>=t.length?t.pop():t.splice(e,1):d.o("Cannot remove an object from an HTMLCollection or NodeList at "+e)}static rt(){const t=d.Nk.pop();return void 0===t?[]:t}static it(t){t.length=0,d.Nk.push(t)}static kD(t){return null===t?"*":"string"==typeof t?t:"function"==typeof t?t.name:""}static nn(t){return"function"==typeof t?t.className?t.className:t.name:d.wt(t)&&t.constructor?d.nn(t.constructor):typeof t}static Eh(t,e){return null==e||""===e?null:d.wt(t)&&e in t||t[e]?t[e]:null}static toString(t){let e=t;return d.wt(t)&&(t.text?e=t.text:t.name?e=t.name:void 0!==t.key?e=t.key:void 0!==t.id?e=t.id:t.constructor===Object&&(t.Text?e=t.Text:t.Name?e=t.Name:void 0!==t.Key?e=t.Key:void 0!==t.Id?e=t.Id:void 0!==t.ID&&(e=t.ID))),void 0===e?"undefined":null===e?"null":e.toString()}static fw(t,e){if(t.hasOwnProperty(e))return!0;let i=Object.getPrototypeOf(t);for(;i&&i!==Function;){if(i.hasOwnProperty(e))return!0;const t=i.ZI;if(t&&t[e])return!0;i=Object.getPrototypeOf(i)}return!1}static PD(t){const e=[];let i=0;for(i=0;i<256;i++)e[i]=i;let n=0,s=0;for(i=0;i<256;i++)n=(n+e[i]+119)%256,s=e[i],e[i]=e[n],e[n]=s;i=0,n=0;let o="";for(let r=0;r<t.length;r++)i=(i+1)%256,n=(n+e[i])%256,s=e[i],e[i]=e[n],e[n]=s,o+=String.fromCharCode(t.charCodeAt(r)^e[(e[i]+e[n])%256]);return o}static MD(t){const e="0123456789abcdef",i=[];for(let r=0;r<256;r++)i[e.charAt(r>>4)+e.charAt(15&r)]=String.fromCharCode(r);t.length%2&&(t="0"+t);const n=[];let s=0;for(let r=0;r<t.length;r+=2)n[s++]=i[t.substring(r,r+2)];const o=n.join("");return""===o?"0":o}static Ts(t){return d.PD(d.MD(t))}}y(d,"hr",void 0!==c.navigator&&void 0!==c.navigator.platform&&null!==c.navigator.platform.match(/(iPhone|iPod|iPad|Mac)/i)),y(d,"Nk",[]),y(d,"$I",Object.freeze([])),y(d,"color1","@COLOR1"),y(d,"color2","@COLOR2"),y(d,"uw","32ab5ff3b26f42dc0ed90f21402913b5"),d.vfo="29e646fdb1";class f{constructor(){y(this,"Ck",void 0),this.Ck=[]}toString(){return this.Ck.join("")}add(t){""!==t&&this.Ck.push(t)}}class g{}class m{constructor(){y(this,"p",void 0),y(this,"key",void 0),y(this,"value",void 0),this.p=[]}[Symbol.iterator](){return this.p.values()}get iterator(){return this}reset(){}next(){return!1}hasNext(){return!1}first(){return null}any(){return!1}all(){return!0}each(){return this}map(t){return this}filter(){return this}get count(){return 0}yl(){}toString(){return"EmptyIterator"}}y(m,"instance",new m);class p{constructor(t){y(this,"key",void 0),y(this,"value",void 0),this.key=-1,this.value=t}[Symbol.iterator](){return[this.value].values()}get iterator(){return this}reset(){this.key=-1}next(){return-1===this.key&&(this.key=0,!0)}hasNext(){return this.next()}first(){return this.key=0,this.value}any(t){return this.key=-1,t(this.value)}all(t){return this.key=-1,t(this.value)}each(t){return this.key=-1,t(this.value),this}map(t){return new p(t(this.value))}filter(t){return t(this.value)?new p(this.value):m.instance}get count(){return 1}yl(){this.value=null}toString(){return"SingletonIterator("+this.value+")"}}class v{constructor(t){y(this,"qt",void 0),y(this,"Ds",void 0),y(this,"Yt",void 0),y(this,"Dt",void 0),y(this,"key",void 0),y(this,"value",void 0),this.qt=t,this.Ds=null,t.cr=null,this.Yt=t.ct,this.Dt=-1}[Symbol.iterator](){return null===this.Ds?this.qt.r.values():this.qt.r.filter(this.Ds).values()}get iterator(){return this}get predicate(){return this.Ds}set predicate(t){this.Ds=t}reset(){const t=this.qt;t.cr=null,this.Yt=t.ct,this.Dt=-1}next(){const t=this.qt;if(t.ct!==this.Yt){if(this.key<0)return!1;d.Ee(t)}const e=t.r,i=e.length;let n=++this.Dt;const s=this.Ds;if(null!==s)for(;n<i;){const t=e[n];if(s(t))return this.Dt=n,this.key=n,this.value=t,!0;n++}else{if(n<i)return this.key=n,this.value=e[n],!0;this.yl()}return!1}hasNext(){return this.next()}first(){const t=this.qt;this.Yt=t.ct,this.Dt=0;const e=t.r,i=e.length,n=this.Ds;if(null!==n){let t=0;for(;t<i;){const i=e[t];if(n(i))return this.Dt=t,this.key=t,this.value=i,i;t++}return null}if(i>0){const t=e[0];return this.key=0,this.value=t,t}return null}any(t){const e=this.qt;e.cr=null;const i=e.ct;this.Dt=-1;const n=e.r,s=n.length,o=this.Ds;for(let r=0;r<s;r++){const s=n[r];if(null===o||o(s)){if(t(s))return!0;e.ct!==i&&d.Ee(e)}}return!1}all(t){const e=this.qt;e.cr=null;const i=e.ct;this.Dt=-1;const n=e.r,s=n.length,o=this.Ds;for(let r=0;r<s;r++){const s=n[r];if(null===o||o(s)){if(!t(s))return!1;e.ct!==i&&d.Ee(e)}}return!0}each(t){const e=this.qt;e.cr=null;const i=e.ct;this.Dt=-1;const n=e.r,s=n.length,o=this.Ds;for(let r=0;r<s;r++){const s=n[r];null!==o&&!o(s)||(t(s),e.ct!==i&&d.Ee(e))}return this}map(t){const e=this.qt;e.cr=null;const i=e.ct;this.Dt=-1;const n=[],s=e.r,o=s.length,r=this.Ds;for(let l=0;l<o;l++){const o=s[l];null!==r&&!r(o)||(n.push(t(o)),e.ct!==i&&d.Ee(e))}const a=new x;return a.r=n,a.Ve(),a.iterator}filter(t){const e=this.qt;e.cr=null;const i=e.ct;this.Dt=-1;const n=[],s=e.r,o=s.length,r=this.Ds;for(let l=0;l<o;l++){const o=s[l];null!==r&&!r(o)||(t(o)&&n.push(o),e.ct!==i&&d.Ee(e))}const a=new x;return a.r=n,a.Ve(),a.iterator}get count(){const t=this.Ds;if(null!==t){let e=0;const i=this.qt.r,n=i.length;for(let s=0;s<n;s++)t(i[s])&&e++;return e}return this.qt.r.length}yl(){this.key=-1,this.value=null,this.Yt=-1,this.Ds=null,this.qt.cr=this}toString(){return"ListIterator@"+this.Dt+"/"+this.qt.count}}class b{constructor(t){y(this,"qt",void 0),y(this,"Yt",void 0),y(this,"Dt",void 0),y(this,"key",void 0),y(this,"value",void 0),this.qt=t,t.fr=null,this.Yt=t.ct,this.Dt=t.r.length}[Symbol.iterator](){return this.qt.r.reverse().values()}get iterator(){return this}reset(){const t=this.qt;t.fr=null,this.Yt=t.ct,this.Dt=t.r.length}next(){const t=this.qt;if(t.ct!==this.Yt){if(this.key<0)return!1;d.Ee(t)}const e=--this.Dt;return e>=0?(this.key=e,this.value=t.r[e],!0):(this.yl(),!1)}hasNext(){return this.next()}first(){const t=this.qt;this.Yt=t.ct;const e=t.r,i=e.length-1;if(this.Dt=i,i>=0){const t=e[i];return this.key=i,this.value=t,t}return null}any(t){const e=this.qt;e.fr=null;const i=e.ct,n=e.r,s=n.length;this.Dt=s;for(let o=s-1;o>=0;o--){if(t(n[o]))return!0;e.ct!==i&&d.Ee(e)}return!1}all(t){const e=this.qt;e.fr=null;const i=e.ct,n=e.r,s=n.length;this.Dt=s;for(let o=s-1;o>=0;o--){if(!t(n[o]))return!1;e.ct!==i&&d.Ee(e)}return!0}each(t){const e=this.qt;e.fr=null;const i=e.ct,n=e.r,s=n.length;this.Dt=s;for(let o=s-1;o>=0;o--){t(n[o]),e.ct!==i&&d.Ee(e)}return this}map(t){const e=this.qt;e.fr=null;const i=e.ct,n=[],s=e.r,o=s.length;this.Dt=o;for(let a=o-1;a>=0;a--){const o=s[a];n.push(t(o)),e.ct!==i&&d.Ee(e)}const r=new x;return r.r=n,r.Ve(),r.iterator}filter(t){const e=this.qt;e.fr=null;const i=e.ct,n=[],s=e.r,o=s.length;this.Dt=o;for(let a=o-1;a>=0;a--){const o=s[a];t(o)&&n.push(o),e.ct!==i&&d.Ee(e)}const r=new x;return r.r=n,r.Ve(),r.iterator}get count(){return this.qt.r.length}yl(){this.key=-1,this.value=null,this.Yt=-1,this.qt.fr=this}toString(){return"ListIteratorBackwards("+this.Dt+"/"+this.qt.count+")"}}class x{constructor(t){y(this,"h",void 0),y(this,"r",void 0),y(this,"ct",void 0),y(this,"cr",void 0),y(this,"fr",void 0),k.Yi(this),this.h=!1,this.r=[],this.ct=0,this.cr=null,this.fr=null,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.r.values()}Ve(){let t=this.ct;t++,t>999999999&&(t=0),this.ct=t}g(){return this.h=!0,this}lt(){return this.h=!1,this}toString(){return"List()#"+k.fs(this)}add(t){return this.h&&d.D(this,t),this.r.push(t),this.Ve(),this}push(t){this.add(t)}addAll(t){if(null===t)return this;this.h&&d.D(this);const e=this.r;if(Array.isArray(t)){const i=t.length;for(let n=0;n<i;n++){const i=t[n];e.push(i)}}else{const i=t.iterator;for(;i.next();){const t=i.value;e.push(t)}}return this.Ve(),this}clear(){this.h&&d.D(this),this.r.length=0,this.Ve()}contains(t){return null!==t&&-1!==this.r.indexOf(t)}has(t){return this.contains(t)}indexOf(t){return null===t?-1:this.r.indexOf(t)}elt(t){const e=this.r;return(t<0||t>=e.length)&&d.tt(t,"0 <= i < length",x,"elt:i"),e[t]}get(t){return this.elt(t)}setElt(t,e){const i=this.r;(t<0||t>=i.length)&&d.tt(t,"0 <= i < length",x,"setElt:i"),this.h&&d.D(this,t),i[t]=e}set(t,e){this.setElt(t,e)}first(){const t=this.r;return 0===t.length?null:t[0]}last(){const t=this.r,e=t.length;return e>0?t[e-1]:null}pop(){this.h&&d.D(this);const t=this.r;return t.length>0?t.pop():null}any(t){const e=this.r,i=this.ct,n=e.length;for(let s=0;s<n;s++){if(t(e[s]))return!0;this.ct!==i&&d.Ee(this)}return!1}all(t){const e=this.r,i=this.ct,n=e.length;for(let s=0;s<n;s++){if(!t(e[s]))return!1;this.ct!==i&&d.Ee(this)}return!0}each(t){const e=this.r,i=this.ct,n=e.length;for(let s=0;s<n;s++)t(e[s]),this.ct!==i&&d.Ee(this);return this}map(t){const e=new x,i=[],n=this.r,s=this.ct,o=n.length;for(let r=0;r<o;r++)i.push(t(n[r])),this.ct!==s&&d.Ee(this);return e.r=i,e.Ve(),e}filter(t){const e=new x,i=[],n=this.r,s=this.ct,o=n.length;for(let r=0;r<o;r++){const e=n[r];t(e)&&i.push(e),this.ct!==s&&d.Ee(this)}return e.r=i,e.Ve(),e}insertAt(t,e){t<0&&d.tt(t,">= 0",x,"insertAt:i"),this.h&&d.D(this,t);const i=this.r;t>=i.length?i.push(e):i.splice(t,0,e),this.Ve()}remove(t){if(null===t)return!1;this.h&&d.D(this,t);const e=this.r,i=e.indexOf(t);return-1!==i&&(i===e.length-1?e.pop():e.splice(i,1),this.Ve(),!0)}delete(t){return this.remove(t)}removeAt(t){const e=this.r;(t<0||t>=e.length)&&d.tt(t,"0 <= i < length",x,"removeAt:i"),this.h&&d.D(this,t),t===e.length-1?e.pop():e.splice(t,1),this.Ve()}removeRange(t,e){const i=this.r,n=i.length;if(t<0)t=0;else if(t>=n)return this;if(e<0)return this;if(e>=n&&(e=n-1),t>e)return this;this.h&&d.D(this);let s=t,o=e+1;for(;o<n;)i[s++]=i[o++];return i.length=n-(e-t+1),this.Ve(),this}copy(){const t=new x,e=this.r;return e.length>0&&(t.r=Array.prototype.slice.call(e)),t}toArray(){const t=this.r,e=this.count,i=new Array(e);for(let n=0;n<e;n++)i[n]=t[n];return i}get HN(){return this.r}toSet(){const t=new k,e=this.r,i=this.count;for(let n=0;n<i;n++)t.add(e[n]);return t}sort(t){return this.h&&d.D(this),this.r.sort(t),this.Ve(),this}sortRange(t,e,i){const n=this.r,s=n.length;void 0===e&&(e=0),void 0===i&&(i=s),this.h&&d.D(this);const o=i-e;if(o<=1)return this;if((e<0||e>=s-1)&&d.tt(e,"0 <= from < length",x,"sortRange:from"),2===o){const i=n[e],s=n[e+1];return t(i,s)>0&&(n[e]=s,n[e+1]=i,this.Ve()),this}if(0===e)if(i>=s)n.sort(t);else{const e=n.slice(0,i);e.sort(t);for(let t=0;t<i;t++)n[t]=e[t]}else if(i>=s){const i=n.slice(e);i.sort(t);for(let t=e;t<s;t++)n[t]=i[t-e]}else{const s=n.slice(e,i);s.sort(t);for(let t=e;t<i;t++)n[t]=s[t-e]}return this.Ve(),this}reverse(){return this.h&&d.D(this),this.r.reverse(),this.Ve(),this}get count(){return this.r.length}get size(){return this.r.length}get length(){return this.r.length}get iterator(){if(this.r.length<=0)return m.instance;const t=this.cr;return null!==t?(t.reset(),t):new v(this)}get iteratorBackwards(){if(this.r.length<=0)return m.instance;const t=this.fr;return null!==t?(t.reset(),t):new b(this)}}class w{constructor(t){y(this,"Po",void 0),y(this,"ii",void 0),y(this,"key",void 0),y(this,"value",void 0),this.Po=t,this.ii=t.p.values()}[Symbol.iterator](){return this.Po.p.values()}get iterator(){return this}reset(){const t=this.Po;this.ii=t.p.values()}next(){const t=this.ii.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.Po.p.size?null:(this.ii=this.Po.p.values(),this.ii.next().value)}any(t){return this.Po.any(t)}all(t){return this.Po.all(t)}each(t){return this.Po.each(t),this}map(t){const e=new x;return this.Po.p.forEach((i=>e.add(t(i)))),e.iterator}filter(t){const e=new x;return this.Po.p.forEach((i=>{t(i)&&e.add(i)})),e.iterator}get count(){return this.Po.count}yl(){this.key=null,this.value=null,this.ii=null}toString(){return"SetIterator"}}class k{constructor(t){y(this,"h",void 0),y(this,"p",void 0),this.h=!1,this.p=new Set,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.p.values()}values(){return this.p.values()}g(){return this.h=!0,this}lt(){return this.h=!1,this}toString(){return"Set()#"+k.fs(this)}add(t){return null===t||this.p.add(t),this}addAll(t){if(null===t)return this;if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++){const e=t[i];null!==e&&this.p.add(e)}}else{const e=t.iterator;for(;e.next();){const t=e.value;null!==t&&this.p.add(t)}}return this}has(t){return this.p.has(t)}contains(t){return this.has(t)}containsAll(t){if(null===t)return!0;const e=t.iterator;for(;e.next();)if(!this.has(e.value))return!1;return!0}containsAny(t){if(null===t)return!0;const e=t.iterator;for(;e.next();)if(this.has(e.value))return!0;return!1}first(){return 0===this.p.size?null:this.p.values().next().value}any(t){for(const e of this.p)if(t(e))return!0;return!1}all(t){for(const e of this.p)if(!t(e))return!1;return!0}each(t){for(const e of this.p)t(e);return this}map(t){const e=new k;for(const i of this.p)e.add(t(i));return e}filter(t){const e=new k;for(const i of this.p)t(i)&&e.add(i);return e}delete(t){return this.h&&d.D(this),this.p.delete(t)}remove(t){return this.delete(t)}removeAll(t){if(null===t)return this;if(this.h&&d.D(this),Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.delete(t[i])}else{const e=t.iterator;for(;e.next();)this.delete(e.value)}return this}retainAll(t){if(null===t)return this;if(0===this.count)return this;this.h&&d.D(this);const e=new k;e.addAll(t);const i=[],n=this.iterator;for(;n.next();){const t=n.value;e.contains(t)||i.push(t)}return this.removeAll(i),this}clear(){this.h&&d.D(this),this.p.clear()}copy(){const t=new k;return this.p.forEach((e=>t.add(e))),t}toArray(){return Array.from(this.p)}toList(){const t=new x;return this.p.forEach((e=>t.add(e))),t}get count(){return this.p.size}get size(){return this.p.size}get iterator(){return this.p.size<=0?m.instance:new w(this)}entries(){return this.p.entries()}keys(){return this.p.keys()}forEach(t,e){return this.p.forEach(t,e)}static Yi(t){t.__gohashid=k.su++}static fs(t){return t.__gohashid}}y(k,"su",1);class S{constructor(t){y(this,"Z",void 0),y(this,"ii",void 0),y(this,"key",void 0),y(this,"value",void 0),this.Z=t,this.ii=t.p.keys()}[Symbol.iterator](){return this.Z.p.keys()}get iterator(){return this}reset(){const t=this.Z;this.ii=t.p.keys()}next(){const t=this.ii.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.Z.p.size?null:(this.ii=this.Z.p.keys(),this.ii.next().value)}any(t){for(const e of this.Z.p)if(t(e[0]))return!0;return!1}all(t){for(const e of this.Z.p)if(!t(e[0]))return!1;return!0}each(t){for(const e of this.Z.p)t(e[0]);return this}map(t){const e=this.Z,i=new x;for(const n of e.p)i.add(t(n[0]));return i.iterator}filter(t){const e=this.Z,i=new x;for(const n of e.p){const e=n[0];t(e)&&i.add(e)}return i.iterator}get count(){return this.Z.size}yl(){this.key=null,this.value=null,this.ii=null}toString(){return"MapKeySetIterator"}}class P extends k{constructor(t){super(),y(this,"Z",void 0),k.Yi(this),this.h=!0,this.Z=t}[Symbol.iterator](){return this.p.keys()}values(){return this.p.keys()}g(){return this}lt(){return this}toString(){return"MapKeySet("+this.Z.toString()+")"}add(t){d.o("This Set is read-only: "+this.toString())}has(t){return this.Z.contains(t)}contains(t){return this.has(t)}delete(t){d.o("This Set is read-only: "+this.toString())}remove(t){return this.delete(t)}clear(){d.o("This Set is read-only: "+this.toString())}first(){return 0===this.Z.p.size?null:this.Z.p.keys().next().value}any(t){for(const e of this.Z.p)if(t(e[0]))return!0;return!1}all(t){for(const e of this.Z.p)if(!t(e[0]))return!1;return!0}each(t){for(const e of this.Z.p)t(e[0]);return this}map(t){const e=new k;for(const i of this.Z.p)e.add(t(i[0]));return e}filter(t){const e=new k;for(const i of this.Z.p){const n=i[0];t(n)&&e.add(n)}return e}copy(){return new P(this.Z)}toSet(){const t=new k,e=this.Z.p;for(const i of e)t.add(i[0]);return t}toArray(){const t=this.Z.p,e=new Array(t.size);let i=0;for(const n of t)e[i]=n[0],i++;return e}toList(){const t=new x,e=this.Z.p;for(const i of e)t.add(i[0]);return t}get count(){return this.Z.size}get size(){return this.Z.size}get iterator(){return this.Z.size<=0?m.instance:new S(this.Z)}}class M{constructor(t){y(this,"Z",void 0),y(this,"ii",void 0),y(this,"key",void 0),y(this,"value",void 0),this.Z=t,this.ii=t.p.values()}[Symbol.iterator](){return this.Z.p.values()}get iterator(){return this}reset(){const t=this.Z;this.ii=t.p.values()}next(){const t=this.ii.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.Z.p.size?null:(this.ii=this.Z.p.values(),this.ii.next().value)}any(t){for(const e of this.Z.p)if(t(e[1]))return!0;return!1}all(t){for(const e of this.Z.p)if(!t(e[1]))return!1;return!0}each(t){for(const e of this.Z.p)t(e[1]);return this}map(t){const e=this.Z,i=new x;for(const n of e.p)i.add(t(n[1]));return i.iterator}filter(t){const e=this.Z,i=new x;for(const n of e.p){const e=n[1];t(e)&&i.add(e)}return i.iterator}get count(){return this.Z.size}yl(){this.key=null,this.value=null,this.ii=null}toString(){return"MapValueSetIterator"}}class C{constructor(t,e){y(this,"key",void 0),y(this,"value",void 0),this.key=t,this.value=e}toString(){return"{"+this.key+":"+this.value+"}"}}class N{constructor(t){y(this,"Z",void 0),y(this,"ii",void 0),y(this,"key",void 0),y(this,"value",void 0),this.Z=t,this.ii=t.p.entries()}[Symbol.iterator](){return this.Z.p.entries()}get iterator(){return this}reset(){const t=this.Z;this.ii=t.p.entries()}next(){const t=this.ii.next();return t.done?(this.key=null,this.value=null,!1):(this.key=t.value[0],this.value=t.value[1],!0)}hasNext(){return this.next()}first(){if(0===this.Z.p.size)return null;this.ii=this.Z.p.entries();const t=this.ii.next().value;return this.key=t[0],this.value=t[1],new C(t[0],t[1])}any(t){return this.Z.any(t)}all(t){return this.Z.all(t)}each(t){return this.Z.each(t),this}map(t){const e=new x;let i=null;return this.Z.p.forEach(((n,s)=>{null===i?i=new C(s,n):(i.key=s,i.value=n),e.add(t(i))})),e.iterator}filter(t){const e=new x;let i=null;return this.Z.p.forEach(((n,s)=>{null===i?i=new C(s,n):(i.key=s,i.value=n),t(i)&&(e.add(i),i=null)})),e.iterator}get count(){return this.Z.size}yl(){this.key=null,this.value=null,this.ii=null}toString(){return"MapIterator"}}class L{constructor(t){y(this,"h",void 0),y(this,"p",void 0),k.Yi(this),this.h=!1,this.p=new Map,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.p.entries()}entries(){return this.p.entries()}g(){return this.h=!0,this}lt(){return this.h=!1,this}toString(){return"Map()#"+k.fs(this)}set(t,e){return this.h&&d.D(this,t),this.p.set(t,e),this}add(t,e){return this.set(t,e)}addAll(t){if(null===t)return this;if(this.h&&d.D(this),Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++){const e=t[i];this.set(e.key,e.value)}}else if(t instanceof L){const e=t.iterator;for(;e.next();)this.set(e.key,e.value)}else{const e=t.iterator;for(;e.next();){const t=e.value;this.set(t.key,t.value)}}return this}first(){if(0===this.p.size)return null;const t=this.p.entries().next().value;return new C(t[0],t[1])}any(t){let e=null;for(const[i,n]of this.p)if(null===e?e=new C(i,n):(e.key=i,e.value=n),t(e))return!0;return!1}all(t){let e=null;for(const[i,n]of this.p)if(null===e?e=new C(i,n):(e.key=i,e.value=n),!t(e))return!1;return!0}each(t){let e=null;for(const[i,n]of this.p)null===e?e=new C(i,n):(e.key=i,e.value=n),t(e);return this}map(t){const e=new L;let i=null;for(const[n,s]of this.p)null===i?i=new C(n,s):(i.key=n,i.value=s),e.set(n,t(i));return e}filter(t){const e=new L;let i=null;for(const[n,s]of this.p)null===i?i=new C(n,s):(i.key=n,i.value=s),t(i)&&e.set(n,s);return e}has(t){return this.p.has(t)}contains(t){return this.has(t)}get(t){const e=this.p.get(t);return void 0===e?null:e}getValue(t){return this.get(t)}delete(t){return null!==t&&(this.h&&d.D(this,t),this.p.delete(t))}remove(t){return this.delete(t)}clear(){this.h&&d.D(this),this.p.clear()}copy(){const t=new L;return t.p=new Map(this.p),t}toArray(){const t=this.p,e=new Array(t.size);let i=0;for(const n of t)e[i]=new C(n[0],n[1]),i++;return e}toKeySet(){return new P(this)}get count(){return this.p.size}get size(){return this.p.size}get iterator(){return this.p.size<=0?m.instance:new N(this)}get iteratorKeys(){return this.count<=0?m.instance:new S(this)}keys(){return this.p.keys()}get iteratorValues(){return this.count<=0?m.instance:new M(this)}values(){return this.p.values()}forEach(t,e){return this.p.forEach(t,e)}}class T{constructor(t,e){y(this,"w",void 0),y(this,"b",void 0),y(this,"h",void 0),void 0===t?(this.w=0,this.b=0):"number"==typeof t&&"number"==typeof e?(this.w=t,this.b=e):d.o("Invalid arguments to Point constructor: "+t+", "+e),this.h=!1}a(t){return this.w=t.w,this.b=t.b,this}e(t,e){return this.w=t,this.b=e,this}setTo(t,e){return this.w=t,this.b=e,this}set(t){return this.w=t.w,this.b=t.b,this}copy(){const t=new T;return t.w=this.w,t.b=this.b,t}et(){return this.h=!0,Object.freeze(this),this}N(){return this.h||Object.isFrozen(this)?this:this.copy().g()}g(){return this.h=!0,this}lt(){return Object.isFrozen(this)&&d.o("cannot thaw constant: "+this),this.h=!1,this}dw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];s&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;return s=e[i++],s&&(o=parseFloat(s)),new T(n,o)}return new T}static stringify(t){return t.x.toString()+" "+t.y.toString()}static stringifyFixed(t){return d.i(t,"number",T,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)}toString(){return"Point("+this.x+","+this.y+")"}equals(t){return t instanceof T&&(this.w===t.x&&this.b===t.y)}equalTo(t,e){return this.w===t&&this.b===e}equalsApprox(t){return E.u(this.w,t.x)&&E.u(this.b,t.y)}add(t){return this.w+=t.x,this.b+=t.y,this}subtract(t){return this.w-=t.x,this.b-=t.y,this}offset(t,e){return this.w+=t,this.b+=e,this}rotate(t){if(0===t)return this;const e=this.w,i=this.b;if(0===e&&0===i)return this;let n=0,s=0;if(t>=360?t-=360:t<0&&(t+=360),90===t)n=0,s=1;else if(180===t)n=-1,s=0;else if(270===t)n=0,s=-1;else{const e=t*Math.PI/180;n=Math.cos(e),s=Math.sin(e)}return this.w=n*e-s*i,this.b=s*e+n*i,this}scale(t,e){return this.w*=t,this.b*=e,this}distanceSquaredPoint(t){const e=t.x-this.w,i=t.y-this.b;return e*e+i*i}distanceSquared(t,e){const i=t-this.w,n=e-this.b;return i*i+n*n}normalize(){const t=this.w,e=this.b,i=Math.sqrt(t*t+e*e);return i>0&&(this.w=t/i,this.b=e/i),this}directionPoint(t){return this.jN(t.x-this.w,t.y-this.b)}direction(t,e){return this.jN(t-this.w,e-this.b)}jN(t,e){if(0===t)return e>0?90:e<0?270:0;if(0===e)return t>0?0:180;{if(isNaN(t)||isNaN(e))return 0;let i=180*Math.atan(Math.abs(e/t))/Math.PI;return t<0?e<0?i+=180:i=180-i:e<0&&(i=360-i),i}}static compareWithLineSegment(t,e,i,n,s,o){return E.nu(t,e,i,n,s,o)}compareWithLineSegmentPoint(t,e){return E.nu(t.x,t.y,e.x,e.y,this.x,this.y)}static intersectingLineSegments(t,e,i,n,s,o,r,a){return E.ou(t,e,i,n,s,o,r,a)}projectOntoLineSegment(t,e,i,n){return E.wl(t,e,i,n,this.w,this.b,this),this}projectOntoLineSegmentPoint(t,e){return E.wl(t.x,t.y,e.x,e.y,this.w,this.b,this),this}snapToGrid(t,e,i,n){return E.Vg(this.w,this.b,t,e,i,n,this),this}snapToGridPoint(t,e){return E.Vg(this.w,this.b,t.x,t.y,e.width,e.height,this),this}setRectSpot(t,e){return this.w=t.x+e.x*t.width+e.offsetX,this.b=t.y+e.y*t.height+e.offsetY,this}setSpot(t,e,i,n,s){return this.w=t+s.x*i+s.offsetX,this.b=e+s.y*n+s.offsetY,this}L(t){return t.xt(this),this}Ue(t){return t.is(this),this}static distanceLineSegmentSquared(t,e,i,n,s,o){let r=s-i,a=o-n;const l=r*r+a*a,h=i-t,u=n-e,c=-h*r-u*a;if(c<=0||c>=l)return r=s-t,a=o-e,Math.min(h*h+u*u,r*r+a*a);{const t=r*u-a*h;return t*t/l}}static distanceSquared(t,e,i,n){const s=i-t,o=n-e;return s*s+o*o}static direction(t,e,i,n){const s=i-t,o=n-e;if(0===s)return o>0?90:o<0?270:0;if(0===o)return s>0?0:180;{if(isNaN(s)||isNaN(o))return 0;let t=180*Math.atan(Math.abs(o/s))/Math.PI;return s<0?o<0?t+=180:t=180-t:o<0&&(t=360-t),t}}get x(){return this.w}set x(t){this.w=t}get y(){return this.b}set y(t){this.b=t}isReal(){return isFinite(this.x)&&isFinite(this.y)}static l(){const t=T.Ak.pop();return void 0===t?new T:t}static X(t,e){const i=T.Ak.pop();return void 0===i?new T(t,e):(i.x=t,i.y=e,i)}static s(t){T.Ak.push(t)}}y(T,"Mo",new(e=T)(0,0).et()),y(T,"qN",new e(-1/0,-1/0).et()),y(T,"WN",new e(1/0,1/0).et()),y(T,"JN",new e(6,6).et()),y(T,"Lk",new e(NaN,NaN).et()),y(T,"Ak",[]);class A{constructor(t,e){y(this,"j",void 0),y(this,"q",void 0),y(this,"h",void 0),void 0===t?(this.j=0,this.q=0):"number"==typeof t&&(t>=0||isNaN(t))&&"number"==typeof e&&(e>=0||isNaN(e))?(this.j=t,this.q=e):d.o("Invalid arguments to Size constructor: "+t+", "+e),this.h=!1}a(t){return this.j=t.j,this.q=t.q,this}e(t,e){return this.j=t,this.q=e,this}setTo(t,e){return this.j=t,this.q=e,this}set(t){return this.j=t.j,this.q=t.q,this}copy(){const t=new A;return t.j=this.j,t.q=this.q,t}et(){return this.h=!0,Object.freeze(this),this}N(){return this.h||Object.isFrozen(this)?this:this.copy().g()}g(){return this.h=!0,this}lt(){return Object.isFrozen(this)&&d.o("cannot thaw constant: "+this),this.h=!1,this}dw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];s&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;return s=e[i++],s&&(o=parseFloat(s)),new A(n,o)}return new A}static stringify(t){return t.width.toString()+" "+t.height.toString()}static stringifyFixed(t){return d.i(t,"number",A,"stringifyFixed:digits"),e=>e.width.toFixed(t)+" "+e.height.toFixed(t)}toString(){return"Size("+this.width+","+this.height+")"}equals(t){return t instanceof A&&(this.j===t.width&&this.q===t.height)}equalTo(t,e){return this.j===t&&this.q===e}equalsApprox(t){return E.u(this.j,t.width)&&E.u(this.q,t.height)}inflate(t,e){const i=this.width+t;this.j=i>=0?i:0;const n=this.height+e;return this.q=n>=0?n:0,this}get width(){return this.j}set width(t){t<0&&d.tt(t,">= 0",A,"width"),this.j=t}get height(){return this.q}set height(t){t<0&&d.tt(t,">= 0",A,"height"),this.q=t}isReal(){return isFinite(this.width)&&isFinite(this.height)}static l(){const t=A._N.pop();return void 0===t?new A:t}static s(t){A._N.push(t)}}y(A,"ru",new(i=A)(0,0).et()),y(A,"Tk",new i(1,1).et()),y(A,"$N",new i(6,6).et()),y(A,"lu",new i(8,8).et()),y(A,"ZN",new i(10,10).et()),y(A,"QN",new i(1/0,1/0).et()),y(A,"gw",new i(NaN,NaN).et()),y(A,"_N",[]);class D{constructor(t,e,i,n){if(y(this,"w",void 0),y(this,"b",void 0),y(this,"j",void 0),y(this,"q",void 0),y(this,"h",void 0),void 0===t)this.w=0,this.b=0,this.j=0,this.q=0;else if("number"==typeof t&&"number"==typeof e&&"number"==typeof i&&(i>=0||isNaN(i))&&"number"==typeof n&&(n>=0||isNaN(n)))this.w=t,this.b=e,this.j=i,this.q=n;else if(t instanceof T){const i=t.x,n=t.y;if(e instanceof T){const t=e.x,s=e.y;this.w=Math.min(i,t),this.b=Math.min(n,s),this.j=Math.abs(i-t),this.q=Math.abs(n-s)}else e instanceof A?(this.w=i,this.b=n,this.j=e.width,this.q=e.height):d.o("Incorrect second argument supplied to Rect constructor "+e)}else d.o("Invalid arguments to Rect constructor: "+t+", "+e+", "+i+", "+n);this.h=!1}a(t){return this.w=t.w,this.b=t.b,this.j=t.j,this.q=t.q,this}e(t,e,i,n){return this.w=t,this.b=e,this.j=i,this.q=n,this}So(t,e){return this.j=t,this.q=e,this}setTo(t,e,i,n){return this.w=t,this.b=e,this.j=i,this.q=n,this}set(t){return this.w=t.w,this.b=t.b,this.j=t.j,this.q=t.q,this}setPoint(t){return this.w=t.x,this.b=t.y,this}setSize(t){return this.j=t.width,this.q=t.height,this}copy(){const t=new D;return t.w=this.w,t.b=this.b,t.j=this.j,t.q=this.q,t}et(){return this.h=!0,Object.freeze(this),this}N(){return this.h||Object.isFrozen(this)?this:this.copy().g()}g(){return this.h=!0,this}lt(){return Object.isFrozen(this)&&d.o("cannot thaw constant: "+this),this.h=!1,this}dw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];s&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;s=e[i++],s&&(o=parseFloat(s));let r=0;for(;""===e[i];)i++;s=e[i++],s&&(r=parseFloat(s));let a=0;for(;""===e[i];)i++;return s=e[i++],s&&(a=parseFloat(s)),new D(n,o,r,a)}return new D}static stringify(t){return t.x.toString()+" "+t.y.toString()+" "+t.width.toString()+" "+t.height.toString()}static stringifyFixed(t){return d.i(t,"number",D,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)+" "+e.width.toFixed(t)+" "+e.height.toFixed(t)}toString(){return"Rect("+this.x+","+this.y+","+this.width+","+this.height+")"}equals(t){return t instanceof D&&(this.w===t.x&&this.b===t.y&&this.j===t.width&&this.q===t.height)}equalTo(t,e,i,n){return this.w===t&&this.b===e&&this.j===i&&this.q===n}equalsApprox(t){return E.u(this.w,t.x)&&E.u(this.b,t.y)&&E.u(this.j,t.width)&&E.u(this.q,t.height)}equalsApproxTo(t,e,i,n){return E.u(this.w,t)&&E.u(this.b,e)&&E.u(this.j,i)&&E.u(this.q,n)}equalsApproxClose(t){return E.Y(this.w,t.x)&&E.Y(this.b,t.y)&&E.Y(this.j,t.width)&&E.Y(this.q,t.height)}containsPoint(t){return this.w<=t.x&&this.w+this.j>=t.x&&this.b<=t.y&&this.b+this.q>=t.y}containsRect(t){return this.w<=t.x&&t.x+t.width<=this.w+this.j&&this.b<=t.y&&t.y+t.height<=this.b+this.q}contains(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),this.w<=t&&t+i<=this.w+this.j&&this.b<=e&&e+n<=this.b+this.q}offset(t,e){return this.w+=t,this.b+=e,this}inflate(t,e){return this.mw(e,t,e,t)}addMargin(t){return this.mw(t.top,t.right,t.bottom,t.left)}subtractMargin(t){return this.mw(-t.top,-t.right,-t.bottom,-t.left)}grow(t,e,i,n){return this.mw(t,e,i,n)}mw(t,e,i,n){const s=this.j;e+n<=-s?(this.w+=s/2,this.j=0):(this.w-=n,this.j+=e+n);const o=this.q;return t+i<=-o?(this.b+=o/2,this.q=0):(this.b-=t,this.q+=t+i),this}intersectRect(t){return this.tC(t.x,t.y,t.width,t.height)}intersect(t,e,i,n){return this.tC(t,e,i,n)}tC(t,e,i,n){const s=Math.max(this.w,t),o=Math.max(this.b,e),r=Math.min(this.w+this.j,t+i),a=Math.min(this.b+this.q,e+n);return this.w=s,this.b=o,this.j=Math.max(0,r-s),this.q=Math.max(0,a-o),this}intersectsRect(t){return this.intersects(t.x,t.y,t.width,t.height)}intersects(t,e,i,n){let s=this.j;const o=this.w;if(s!==1/0&&i!==1/0&&(s+=o,i+=t,isNaN(i)||isNaN(s)||o>i||t>s))return!1;let r=this.q;const a=this.b;return!(r!==1/0&&n!==1/0&&(r+=a,n+=e,isNaN(n)||isNaN(r)||a>n||e>r))}intersectsRectPlus(t,e){let i=this.j,n=t.width+e+e;const s=this.w,o=t.x-e;if(i+=s,n+=o,s>n||o>i)return!1;let r=this.q,a=t.height+e+e;const l=this.b,h=t.y-e;return r+=l,a+=h,!(l>a||h>r)}unionPoint(t){return this.unionNoCheck(t.x,t.y,0,0)}unionRect(t){return this.unionNoCheck(t.w,t.b,t.j,t.q)}union(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),this.unionNoCheck(t,e,i,n)}unionNoCheck(t,e,i,n){const s=Math.min(this.w,t),o=Math.min(this.b,e),r=Math.max(this.w+this.j,t+i),a=Math.max(this.b+this.q,e+n);return this.w=s,this.b=o,this.j=r-s,this.q=a-o,this}setSpot(t,e,i){return this.w=t-i.offsetX-i.x*this.j,this.b=e-i.offsetY-i.y*this.q,this}static contains(t,e,i,n,s,o,r,a){return void 0===r&&(r=0),void 0===a&&(a=0),t<=s&&s+r<=t+i&&e<=o&&o+a<=e+n}static intersects(t,e,i,n,s,o,r,a){let l=i,h=r;if(l+=t,h+=s,t>h||s>l)return!1;let u=n,c=a;return u+=e,c+=o,!(e>c||o>u)}static intersectsLineSegment(t,e,i,n,s,o,r,a){return E.iC(t,e,i,n,s,o,r,a)}get x(){return this.w}set x(t){this.w=t}get y(){return this.b}set y(t){this.b=t}get width(){return this.j}set width(t){t<0&&d.tt(t,">= 0",D,"width"),this.j=t}get height(){return this.q}set height(t){t<0&&d.tt(t,">= 0",D,"height"),this.q=t}get left(){return this.w}set left(t){this.w=t}get top(){return this.b}set top(t){this.b=t}get right(){return this.w+this.j}set right(t){this.w+=t-(this.w+this.j)}get bottom(){return this.b+this.q}set bottom(t){this.b+=t-(this.b+this.q)}get position(){return new T(this.w,this.b)}set position(t){this.w=t.x,this.b=t.y}get size(){return new A(this.j,this.q)}set size(t){this.j=t.width,this.q=t.height}get center(){return new T(this.w+this.j/2,this.b+this.q/2)}set center(t){this.w=t.x-this.j/2,this.b=t.y-this.q/2}get centerX(){return this.w+this.j/2}set centerX(t){this.w=t-this.j/2}get centerY(){return this.b+this.q/2}set centerY(t){this.b=t-this.q/2}isReal(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)}isEmpty(){return 0===this.width&&0===this.height}static l(){const t=D.Fk.pop();return void 0===t?new D:t}static X(t,e,i,n){const s=D.Fk.pop();return void 0===s?new D(t,e,i,n):s.e(t,e,i,n)}static s(t){D.Fk.push(t)}}y(D,"Dk",new(n=D)(0,0,0,0).et()),y(D,"SD",new n(NaN,NaN,NaN,NaN).et()),y(D,"Fk",[]);class F{constructor(t,e,i,n){y(this,"on",void 0),y(this,"rn",void 0),y(this,"ln",void 0),y(this,"hn",void 0),y(this,"h",void 0),void 0===t?(this.on=0,this.rn=0,this.ln=0,this.hn=0):void 0===e?(e=t,i=t,n=t,this.top=t,this.right=e,this.bottom=i,this.left=n):void 0===i?(i=t,n=e,this.top=t,this.right=e,this.bottom=i,this.left=n):void 0!==n?(this.top=t,this.right=e,this.bottom=i,this.left=n):d.o("Invalid arguments to Margin constructor: "+t+", "+e+", "+i+", "+n),this.h=!1}a(t){return this.on=t.on,this.rn=t.rn,this.ln=t.ln,this.hn=t.hn,this}setTo(t,e,i,n){return this.on=t,this.rn=e,this.ln=i,this.hn=n,this}set(t){return this.on=t.on,this.rn=t.rn,this.ln=t.ln,this.hn=t.hn,this}copy(){const t=new F;return t.on=this.on,t.rn=this.rn,t.ln=this.ln,t.hn=this.hn,t}et(){return this.h=!0,Object.freeze(this),this}N(){return this.h||Object.isFrozen(this)?this:this.copy().g()}g(){return this.h=!0,this}lt(){return Object.isFrozen(this)&&d.o("cannot thaw constant: "+this),this.h=!1,this}dw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=NaN;for(;""===e[i];)i++;let s=e[i++];if(s&&(n=parseFloat(s)),isNaN(n))return new F;let o=NaN;for(;""===e[i];)i++;if(s=e[i++],s&&(o=parseFloat(s)),isNaN(o))return new F(n);let r=NaN;for(;""===e[i];)i++;if(s=e[i++],s&&(r=parseFloat(s)),isNaN(r))return new F(n,o);let a=NaN;for(;""===e[i];)i++;return s=e[i++],s&&(a=parseFloat(s)),isNaN(a)?new F(n,o):new F(n,o,r,a)}return new F}static stringify(t){return t.top.toString()+" "+t.right.toString()+" "+t.bottom.toString()+" "+t.left.toString()}static stringifyFixed(t){return d.i(t,"number",F,"stringifyFixed:digits"),e=>e.top.toFixed(t)+" "+e.right.toFixed(t)+" "+e.bottom.toFixed(t)+" "+e.left.toFixed(t)}toString(){return"Margin("+this.top+","+this.right+","+this.bottom+","+this.left+")"}equals(t){return t instanceof F&&(this.on===t.top&&this.rn===t.right&&this.ln===t.bottom&&this.hn===t.left)}equalTo(t,e,i,n){return this.on===t&&this.rn===e&&this.ln===i&&this.hn===n}equalsApprox(t){return E.u(this.on,t.top)&&E.u(this.rn,t.right)&&E.u(this.ln,t.bottom)&&E.u(this.hn,t.left)}get top(){return this.on}set top(t){this.on=t}get right(){return this.rn}set right(t){this.rn=t}get bottom(){return this.ln}set bottom(t){this.ln=t}get left(){return this.hn}set left(t){this.hn=t}isReal(){return isFinite(this.top)&&isFinite(this.right)&&isFinite(this.bottom)&&isFinite(this.left)}static l(){const t=F.sC.pop();return void 0===t?new F:t}static s(t){F.sC.push(t)}}y(F,"Ug",new(s=F)(0,0,0,0).et()),y(F,"eC",new s(2,2,2,2).et()),y(F,"sC",[]);class O{constructor(t,e,i,n){y(this,"w",void 0),y(this,"b",void 0),y(this,"Fs",void 0),y(this,"Rs",void 0),y(this,"h",void 0),void 0===t?(this.w=0,this.b=0,this.Fs=0,this.Rs=0):(void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.offsetX=i,this.offsetY=n),this.h=!1}a(t){return this.w=t.w,this.b=t.b,this.Fs=t.Fs,this.Rs=t.Rs,this}setTo(t,e,i,n){return this.w=t,this.b=e,this.Fs=i,this.Rs=n,this}set(t){return this.w=t.w,this.b=t.b,this.Fs=t.Fs,this.Rs=t.Rs,this}copy(){const t=new O;return t.w=this.w,t.b=this.b,t.Fs=this.Fs,t.Rs=this.Rs,t}et(){return this.h=!0,Object.freeze(this),this}N(){return this.h||Object.isFrozen(this)?this:this.copy().g()}g(){return this.h=!0,this}lt(){return Object.isFrozen(this)&&d.o("cannot thaw constant: "+this),this.h=!1,this}dw(t){}Be(t){return this.w=NaN,this.b=NaN,this.Fs=t,this}QI(t,e){(isNaN(t)||t>1||t<0)&&d.tt(t,"0 <= "+e+" <= 1",O,e)}_I(t,e){(isNaN(t)||t===1/0||t===-1/0)&&d.tt(t,"real number, not NaN or Infinity",O,e)}static parse(t){if("string"==typeof t){if("None"===(t=t.trim()))return O.None;if("TopLeft"===t)return O.TopLeft;if("Top"===t||"TopCenter"===t||"MiddleTop"===t)return O.TopCenter;if("TopRight"===t)return O.TopRight;if("Left"===t||"LeftCenter"===t||"MiddleLeft"===t)return O.LeftCenter;if("Center"===t)return O.Center;if("Right"===t||"RightCenter"===t||"MiddleRight"===t)return O.RightCenter;if("BottomLeft"===t)return O.BottomLeft;if("Bottom"===t||"BottomCenter"===t||"MiddleBottom"===t)return O.BottomCenter;if("BottomRight"===t)return O.BottomRight;if("TopSide"===t)return O.TopSide;if("LeftSide"===t)return O.LeftSide;if("RightSide"===t)return O.RightSide;if("BottomSide"===t)return O.BottomSide;if("TopBottomSides"===t)return O.TopBottomSides;if("LeftRightSides"===t)return O.LeftRightSides;if("TopLeftSides"===t)return O.TopLeftSides;if("TopRightSides"===t)return O.TopRightSides;if("BottomLeftSides"===t)return O.BottomLeftSides;if("BottomRightSides"===t)return O.BottomRightSides;if("NotTopSide"===t)return O.NotTopSide;if("NotLeftSide"===t)return O.NotLeftSide;if("NotRightSide"===t)return O.NotRightSide;if("NotBottomSide"===t)return O.NotBottomSide;if("AllSides"===t)return O.AllSides;if("Default"===t)return O.Default;const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];void 0!==s&&s.length>0&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;s=e[i++],void 0!==s&&s.length>0&&(o=parseFloat(s));let r=0;for(;""===e[i];)i++;s=e[i++],void 0!==s&&s.length>0&&(r=parseFloat(s));let a=0;for(;""===e[i];)i++;return s=e[i++],void 0!==s&&s.length>0&&(a=parseFloat(s)),new O(n,o,r,a)}return new O}static stringify(t){return t.isSpot()?t.x.toString()+" "+t.y.toString()+" "+t.offsetX.toString()+" "+t.offsetY.toString():t.toString()}static stringifyFixed(t){return d.i(t,"number",O,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)+" "+e.offsetX.toFixed(t)+" "+e.offsetY.toFixed(t)}toString(){return this.isSpot()?0===this.Fs&&0===this.Rs?"Spot("+this.x+","+this.y+")":"Spot("+this.x+","+this.y+","+this.offsetX+","+this.offsetY+")":this.equals(O.None)?"None":this.equals(O.TopLeft)?"TopLeft":this.equals(O.TopCenter)?"Top":this.equals(O.TopRight)?"TopRight":this.equals(O.LeftCenter)?"Left":this.equals(O.Center)?"Center":this.equals(O.RightCenter)?"Right":this.equals(O.BottomLeft)?"BottomLeft":this.equals(O.BottomCenter)?"Bottom":this.equals(O.BottomRight)?"BottomRight":this.equals(O.TopSide)?"TopSide":this.equals(O.LeftSide)?"LeftSide":this.equals(O.RightSide)?"RightSide":this.equals(O.BottomSide)?"BottomSide":this.equals(O.TopBottomSides)?"TopBottomSides":this.equals(O.LeftRightSides)?"LeftRightSides":this.equals(O.TopLeftSides)?"TopLeftSides":this.equals(O.TopRightSides)?"TopRightSides":this.equals(O.BottomLeftSides)?"BottomLeftSides":this.equals(O.BottomRightSides)?"BottomRightSides":this.equals(O.NotTopSide)?"NotTopSide":this.equals(O.NotLeftSide)?"NotLeftSide":this.equals(O.NotRightSide)?"NotRightSide":this.equals(O.NotBottomSide)?"NotBottomSide":this.equals(O.AllSides)?"AllSides":this.equals(O.Default)?"Default":"None"}equals(t){return t instanceof O&&((this.w===t.x||isNaN(this.w)&&isNaN(t.x))&&(this.b===t.y||isNaN(this.b)&&isNaN(t.y))&&this.Fs===t.offsetX&&this.Rs===t.offsetY)}opposite(){return new O(.5-(this.w-.5),.5-(this.b-.5),-this.Fs,-this.Rs)}includesSide(t){if(!this.isSide())return!1;if(!t.isSide())if(t.equals(O.Left))t=O.LeftSide;else if(t.equals(O.Right))t=O.RightSide;else if(t.equals(O.Top))t=O.TopSide;else{if(!t.equals(O.Bottom))return!1;t=O.BottomSide}const e=this.Rs,i=t.offsetY;return(e&i)===i}get x(){return this.w}set x(t){this.w=t}get y(){return this.b}set y(t){this.b=t}get offsetX(){return this.Fs}set offsetX(t){this.Fs=t}get offsetY(){return this.Rs}set offsetY(t){this.Rs=t}isSpot(){return!isNaN(this.x)&&!isNaN(this.y)}isNoSpot(){return isNaN(this.x)||isNaN(this.y)}isSide(){return isNaN(this.x)&&isNaN(this.y)&&1===this.offsetX&&0!==this.offsetY}isNone(){return isNaN(this.x)&&isNaN(this.y)&&0===this.offsetX&&0===this.offsetY}isDefault(){return isNaN(this.x)&&isNaN(this.y)&&-1===this.offsetX&&0===this.offsetY}static l(){const t=O.nC.pop();return void 0===t?new O:t}static s(t){O.nC.push(t)}}y(O,"None",new(o=O)(0,0,0,0).Be(0).et()),y(O,"Default",new o(0,0,-1,0).Be(-1).et()),y(O,"TopLeft",new o(0,0,0,0).et()),y(O,"TopCenter",new o(.5,0,0,0).et()),y(O,"TopRight",new o(1,0,0,0).et()),y(O,"LeftCenter",new o(0,.5,0,0).et()),y(O,"Center",new o(.5,.5,0,0).et()),y(O,"RightCenter",new o(1,.5,0,0).et()),y(O,"BottomLeft",new o(0,1,0,0).et()),y(O,"BottomCenter",new o(.5,1,0,0).et()),y(O,"BottomRight",new o(1,1,0,0).et()),y(O,"MiddleTop",o.TopCenter),y(O,"MiddleLeft",o.LeftCenter),y(O,"MiddleRight",o.RightCenter),y(O,"MiddleBottom",o.BottomCenter),y(O,"Top",o.TopCenter),y(O,"Left",o.LeftCenter),y(O,"Right",o.RightCenter),y(O,"Bottom",o.BottomCenter),y(O,"TopSide",new o(0,0,1,1).Be(1).et()),y(O,"LeftSide",new o(0,0,1,2).Be(1).et()),y(O,"RightSide",new o(0,0,1,4).Be(1).et()),y(O,"BottomSide",new o(0,0,1,8).Be(1).et()),y(O,"TopBottomSides",new o(0,0,1,9).Be(1).et()),y(O,"LeftRightSides",new o(0,0,1,6).Be(1).et()),y(O,"TopLeftSides",new o(0,0,1,3).Be(1).et()),y(O,"TopRightSides",new o(0,0,1,5).Be(1).et()),y(O,"BottomLeftSides",new o(0,0,1,10).Be(1).et()),y(O,"BottomRightSides",new o(0,0,1,12).Be(1).et()),y(O,"NotTopSide",new o(0,0,1,14).Be(1).et()),y(O,"NotLeftSide",new o(0,0,1,13).Be(1).et()),y(O,"NotRightSide",new o(0,0,1,11).Be(1).et()),y(O,"NotBottomSide",new o(0,0,1,7).Be(1).et()),y(O,"AllSides",new o(0,0,1,15).Be(1).et()),y(O,"Rk",new o(.156,.156).et()),y(O,"vk",new o(.844,.844).et()),y(O,"nC",[]);class R{constructor(){y(this,"m11",void 0),y(this,"m12",void 0),y(this,"m21",void 0),y(this,"m22",void 0),y(this,"dx",void 0),y(this,"dy",void 0),this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=0,this.dy=0}set(t){return this.m11=t.m11,this.m12=t.m12,this.m21=t.m21,this.m22=t.m22,this.dx=t.dx,this.dy=t.dy,this}setTo(t,e,i,n,s,o){return this.m11=t,this.m12=e,this.m21=i,this.m22=n,this.dx=s,this.dy=o,this}copy(){const t=new R;return t.m11=this.m11,t.m12=this.m12,t.m21=this.m21,t.m22=this.m22,t.dx=this.dx,t.dy=this.dy,t}toString(){return"Transform("+this.m11+","+this.m12+","+this.m21+","+this.m22+","+this.dx+","+this.dy+")"}equals(t){return this.m11===t.m11&&this.m12===t.m12&&this.m21===t.m21&&this.m22===t.m22&&this.dx===t.dx&&this.dy===t.dy}Ok(){return 0===this.dx&&0===this.dy&&1===this.m11&&0===this.m12&&0===this.m21&&1===this.m22}Jt(){return this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=0,this.dy=0,this}tc(t){const e=this.m11*t.m11+this.m21*t.m12,i=this.m12*t.m11+this.m22*t.m12,n=this.m11*t.m21+this.m21*t.m22,s=this.m12*t.m21+this.m22*t.m22;return this.dx=this.m11*t.dx+this.m21*t.dy+this.dx,this.dy=this.m12*t.dx+this.m22*t.dy+this.dy,this.m11=e,this.m12=i,this.m21=n,this.m22=s,this}oC(t){const e=1/(t.m11*t.m22-t.m12*t.m21),i=t.m22*e,n=-t.m12*e,s=-t.m21*e,o=t.m11*e,r=e*(t.m21*t.dy-t.m22*t.dx),a=e*(t.m12*t.dx-t.m11*t.dy),l=this.m11*i+this.m21*n,h=this.m12*i+this.m22*n,u=this.m11*s+this.m21*o,c=this.m12*s+this.m22*o;return this.dx=this.m11*r+this.m21*a+this.dx,this.dy=this.m12*r+this.m22*a+this.dy,this.m11=l,this.m12=h,this.m21=u,this.m22=c,this}pw(){const t=1/(this.m11*this.m22-this.m12*this.m21),e=this.m22*t,i=-this.m12*t,n=-this.m21*t,s=this.m11*t,o=t*(this.m21*this.dy-this.m22*this.dx),r=t*(this.m12*this.dx-this.m11*this.dy);return this.m11=e,this.m12=i,this.m21=n,this.m22=s,this.dx=o,this.dy=r,this}us(t,e,i){if(t>=360?t-=360:t<0&&(t+=360),0===t)return this;this.Qi(e,i);let n=0,s=0;if(90===t)n=0,s=1;else if(180===t)n=-1,s=0;else if(270===t)n=0,s=-1;else{const e=t*Math.PI/180;n=Math.cos(e),s=Math.sin(e)}const o=this.m11*n+this.m21*s,r=this.m12*n+this.m22*s,a=this.m11*-s+this.m21*n,l=this.m12*-s+this.m22*n;return this.m11=o,this.m12=r,this.m21=a,this.m22=l,this.Qi(-e,-i),this}Qi(t,e){return this.dx+=this.m11*t+this.m21*e,this.dy+=this.m12*t+this.m22*e,this}K(t,e){return void 0===e&&(e=t),this.m11*=t,this.m12*=t,this.m21*=e,this.m22*=e,this}ND(){if(1===this.m11&&0===this.m12)return 0;let t=180*Math.atan2(this.m12,this.m11)/Math.PI;return t<0&&(t+=360),t}xt(t){const e=t.x,i=t.y;return t.e(e*this.m11+i*this.m21+this.dx,e*this.m12+i*this.m22+this.dy)}is(t){const e=1/(this.m11*this.m22-this.m12*this.m21),i=this.m22*e,n=-this.m12*e,s=-this.m21*e,o=this.m11*e,r=e*(this.m21*this.dy-this.m22*this.dx),a=e*(this.m12*this.dx-this.m11*this.dy),l=t.x,h=t.y;return t.e(l*i+h*s+r,l*n+h*o+a)}yw(t){const e=1/(this.m11*this.m22-this.m12*this.m21),i=this.m22*e,n=-this.m12*e,s=-this.m21*e,o=this.m11*e,r=e*(this.m21*this.dy-this.m22*this.dx),a=e*(this.m12*this.dx-this.m11*this.dy),l=1.25*t.x,h=1.2*t.y;return t.e(l*i+h*s+r,l*n+h*o+a)}ww(t){const e=t.x,i=t.y,n=e+t.width,s=i+t.height,o=this.m11,r=this.m12,a=this.m21,l=this.m22,h=this.dx,u=this.dy,c=e*o+i*a+h,d=e*r+i*l+u,f=n*o+i*a+h,g=n*r+i*l+u,m=e*o+s*a+h,p=e*r+s*l+u,y=n*o+s*a+h,v=n*r+s*l+u;let b=c,x=c,w=d,k=d;return b=Math.min(b,f),x=Math.max(x,f),w=Math.min(w,g),k=Math.max(k,g),b=Math.min(b,m),x=Math.max(x,m),w=Math.min(w,p),k=Math.max(k,p),b=Math.min(b,y),x=Math.max(x,y),w=Math.min(w,v),k=Math.max(k,v),t.e(b,w,x-b,k-w),t}static l(){const t=R.rC.pop();return void 0===t?new R:t}static s(t){R.rC.push(t)}}y(R,"rC",[]),y(R,"Ik","54a702f3e53909c447824c6706603faf4c");const E={CD:"7da71ca0ad381e90",Un:(Math.sqrt(2)-1)/3*4,lC:null,xw:t=>{if(t<=0)return 0;let e=E.lC;if(null===e){e=[];for(let t=0;t<=2e3;t++)e[t]=Math.sqrt(t);E.lC=e}if(t<1){const i=1/t;return i<=2e3?1/e[0|i]:Math.sqrt(t)}return t<=2e3?e[0|t]:Math.sqrt(t)},u:(t,e)=>{const i=t-e;return i<.5&&i>-.5},Y:(t,e)=>{const i=t-e;return i<5e-8&&i>-5e-8},vi:(t,e,i,n,s,o,r)=>{s<=0&&(s=1e-6);let a=0,l=0,h=0,u=0;if(t<i?(l=t,a=i):(l=i,a=t),e<n?(u=e,h=n):(u=n,h=e),t===i)return u<=r&&r<=h&&t-s<=o&&o<=t+s;if(e===n)return l<=o&&o<=a&&e-s<=r&&r<=e+s;const c=a+s,d=l-s;if(d<=o&&o<=c){const a=h+s,l=u-s;if(l<=r&&r<=a)if(c-d>a-l){if(!(t-i>s||i-t>s))return!0;{const a=(n-e)/(i-t)*(o-t)+e;if(a-s<=r&&r<=a+s)return!0}}else{if(!(e-n>s||n-e>s))return!0;{const a=(i-t)/(n-e)*(r-e)+t;if(a-s<=o&&o<=a+s)return!0}}}return!1},bw:(t,e,i,n,s,o,r,a,l,h,u,c)=>{if(E.vi(t,e,r,a,c,i,n)&&E.vi(t,e,r,a,c,s,o))return E.vi(t,e,r,a,c,h,u);{const d=(t+i)/2,f=(e+n)/2,g=(i+s)/2,m=(n+o)/2,p=(s+r)/2,y=(o+a)/2,v=(d+g)/2,b=(f+m)/2,x=(g+p)/2,w=(m+y)/2,k=(v+x)/2,S=(b+w)/2;return E.bw(t,e,d,f,v,b,k,S,l,h,u,c)||E.bw(k,S,x,w,p,y,r,a,l,h,u,c)}},hC:(t,e,i,n,s,o,r,a,l)=>{const h=(i+s)/2,u=(n+o)/2,c=((t+i)/2+h)/2,d=((e+n)/2+u)/2,f=(h+(s+r)/2)/2,g=(u+(o+a)/2)/2;return l.e((c+f)/2,(d+g)/2),l},LD:(t,e,i,n,s,o,r,a)=>{const l=(i+s)/2,h=(n+o)/2,u=((t+i)/2+l)/2,c=((e+n)/2+h)/2,d=(l+(s+r)/2)/2,f=(h+(o+a)/2)/2;return T.direction(u,c,d,f)},hu:(t,e,i,n,s,o,r,a,l,h)=>{if(E.vi(t,e,r,a,l,i,n)&&E.vi(t,e,r,a,l,s,o))h.unionNoCheck(t,e,0,0),h.unionNoCheck(r,a,0,0);else{const u=(t+i)/2,c=(e+n)/2,d=(i+s)/2,f=(n+o)/2,g=(s+r)/2,m=(o+a)/2,p=(u+d)/2,y=(c+f)/2,v=(d+g)/2,b=(f+m)/2,x=(p+v)/2,w=(y+b)/2;E.hu(t,e,u,c,p,y,x,w,l,h),E.hu(x,w,v,b,g,m,r,a,l,h)}return h},Bn:(t,e,i,n,s,o,r,a,l,h)=>{if(E.vi(t,e,r,a,l,i,n)&&E.vi(t,e,r,a,l,s,o))0===h.length&&(h.push(t),h.push(e)),h.push(r),h.push(a);else{const u=(t+i)/2,c=(e+n)/2,d=(i+s)/2,f=(n+o)/2,g=(s+r)/2,m=(o+a)/2,p=(u+d)/2,y=(c+f)/2,v=(d+g)/2,b=(f+m)/2,x=(p+v)/2,w=(y+b)/2;E.Bn(t,e,u,c,p,y,x,w,l,h),E.Bn(x,w,v,b,g,m,r,a,l,h)}return h},Ek:(t,e,i,n,s,o,r,a,l,h)=>{if(E.vi(t,e,s,o,h,i,n))return E.vi(t,e,s,o,h,a,l);{const u=(t+i)/2,c=(e+n)/2,d=(i+s)/2,f=(n+o)/2,g=(u+d)/2,m=(c+f)/2;return E.Ek(t,e,u,c,g,m,r,a,l,h)||E.Ek(g,m,d,f,s,o,r,a,l,h)}},tE:(t,e,i,n,s,o,r)=>{const a=(t+i)/2,l=(e+n)/2,h=(i+s)/2,u=(n+o)/2;return r.e((a+h)/2,(l+u)/2),r},Vk:(t,e,i,n,s,o,r,a)=>{if(E.vi(t,e,s,o,r,i,n))a.unionNoCheck(t,e,0,0),a.unionNoCheck(s,o,0,0);else{const l=(t+i)/2,h=(e+n)/2,u=(i+s)/2,c=(n+o)/2,d=(l+u)/2,f=(h+c)/2;E.Vk(t,e,l,h,d,f,r,a),E.Vk(d,f,u,c,s,o,r,a)}return a},Bg:(t,e,i,n,s,o,r,a)=>{if(E.vi(t,e,s,o,r,i,n))0===a.length&&(a.push(t),a.push(e)),a.push(s),a.push(o);else{const l=(t+i)/2,h=(e+n)/2,u=(i+s)/2,c=(n+o)/2,d=(l+u)/2,f=(h+c)/2;E.Bg(t,e,l,h,d,f,r,a),E.Bg(d,f,u,c,s,o,r,a)}return a},zg:(t,e,i,n,s,o,r,a,l,h,u,c,d,f)=>{if(E.vi(t,e,r,a,d,i,n)&&E.vi(t,e,r,a,d,s,o)){if(!E.ou(t,e,r,a,l,h,u,c))return!1;const i=(t-r)*(h-c)-(e-a)*(l-u);if(0===i)return!1;const n=((t*a-e*r)*(l-u)-(t-r)*(l*c-h*u))/i,s=((t*a-e*r)*(h-c)-(e-a)*(l*c-h*u))/i;return f.e(n,s),!0}{const g=(t+i)/2,m=(e+n)/2,p=(i+s)/2,y=(n+o)/2,v=(s+r)/2,b=(o+a)/2,x=(g+p)/2,w=(m+y)/2,k=(p+v)/2,S=(y+b)/2,P=(x+k)/2,M=(w+S)/2;let C=1/0,N=!1,L=0,T=0;if(E.zg(t,e,g,m,x,w,P,M,l,h,u,c,d,f)){const t=(f.x-l)*(f.x-l)+(f.y-h)*(f.y-h);t<C&&(C=t,N=!0,L=f.x,T=f.y)}if(E.zg(P,M,k,S,v,b,r,a,l,h,u,c,d,f)){const t=(f.x-l)*(f.x-l)+(f.y-h)*(f.y-h);t<C&&(C=t,N=!0,L=f.x,T=f.y)}return N&&(f.x=L,f.y=T),N}},Xg:(t,e,i,n,s,o,r,a,l,h,u,c,d)=>{let f=0;if(E.vi(t,e,r,a,d,i,n)&&E.vi(t,e,r,a,d,s,o)){const i=(t-r)*(h-c)-(e-a)*(l-u);if(0===i)return f;const n=((t*a-e*r)*(l-u)-(t-r)*(l*c-h*u))/i,s=((t*a-e*r)*(h-c)-(e-a)*(l*c-h*u))/i;if(n>=u)return f;let o=0,d=0;if((l>u?l-u:u-l)<(h>c?h-c:c-h)){if(e<a?(o=e,d=a):(o=a,d=e),s<o||s>d)return f}else if(t<r?(o=t,d=r):(o=r,d=t),n<o||n>d)return f;i>0?f++:i<0&&f--}else{const g=(t+i)/2,m=(e+n)/2,p=(i+s)/2,y=(n+o)/2,v=(s+r)/2,b=(o+a)/2,x=(g+p)/2,w=(m+y)/2,k=(p+v)/2,S=(y+b)/2,P=(x+k)/2,M=(w+S)/2;f+=E.Xg(t,e,g,m,x,w,P,M,l,h,u,c,d),f+=E.Xg(P,M,k,S,v,b,r,a,l,h,u,c,d)}return f},wl:(t,e,i,n,s,o,r)=>{if(E.Y(t,i)){let i=0,s=0;e<n?(i=e,s=n):(i=n,s=e);const a=o;return a<i?(r.e(t,i),!1):a>s?(r.e(t,s),!1):(r.e(t,a),!0)}if(E.Y(e,n)){let n=0,o=0;t<i?(n=t,o=i):(n=i,o=t);const a=s;return a<n?(r.e(n,e),!1):a>o?(r.e(o,e),!1):(r.e(a,e),!0)}{const a=((t-s)*(t-i)+(e-o)*(e-n))/((i-t)*(i-t)+(n-e)*(n-e));if(a<-5e-6)return r.e(t,e),!1;if(a>1.000005)return r.e(i,n),!1;{const s=t+a*(i-t),o=e+a*(n-e);return r.e(s,o),!0}}},zn:(t,e,i,n,s,o,r,a,l)=>{if(E.u(t,i)&&E.u(e,n))return l.e(t,e),!1;if(E.Y(s,r)){if(E.Y(t,i))return E.wl(t,e,i,n,s,o,l),!1;{const o=(n-e)/(i-t)*(s-t)+e;return E.wl(t,e,i,n,s,o,l)}}{const h=(a-o)/(r-s);if(E.Y(t,i)){const i=h*(t-s)+o;let r=0,a=0;return e<n?(r=e,a=n):(r=n,a=e),i<r?(l.e(t,r),!1):i>a?(l.e(t,a),!1):(l.e(t,i),!0)}{const r=(n-e)/(i-t);if(E.Y(h,r))return E.wl(t,e,i,n,s,o,l),!1;{const a=(r*t-h*s+o-e)/(r-h);if(E.Y(r,0)){let n=0,s=0;return t<i?(n=t,s=i):(n=i,s=t),a<n?(l.e(n,e),!1):a>s?(l.e(s,e),!1):(l.e(a,e),!0)}{const s=r*(a-t)+e;return E.wl(t,e,i,n,a,s,l)}}}}},iE:(t,e,i,n,s)=>E.zn(i.x,i.y,n.x,n.y,t.x,t.y,e.x,e.y,s),eE:(t,e,i,n,s,o,r,a,l,h)=>{let u=1/0;function c(i,n){const s=(i-t)*(i-t)+(n-e)*(n-e);s<u&&(u=s,l.e(i,n))}c(l.x,l.y);let d=0,f=0,g=0,m=0;s<r?(d=s,f=r):(d=r,f=s),o<a?(g=s,m=r):(g=r,m=s);const p=(f-d)/2+h,y=(m-g)/2+h,v=(s+r)/2,b=(o+a)/2;if(0===p||0===y)return l;if((i>t?i-t:t-i)<.5){const t=1-(i-v)*(i-v)/(p*p);if(t<0)return l;const e=Math.sqrt(t),n=-y*e+b;c(i,y*e+b),c(i,n)}else{const s=(n-e)/(i-t),o=1/(p*p)+s*s/(y*y),r=2*s*(e-s*t)/(y*y)-2*s*b/(y*y)-2*v/(p*p),a=r*r-4*o*(2*s*t*b/(y*y)-2*e*b/(y*y)+b*b/(y*y)+v*v/(p*p)-1+(e-s*t)*(e-s*t)/(y*y));if(a<0)return l;const h=Math.sqrt(a),u=(-r+h)/(2*o);c(u,s*u-s*t+e);const d=(-r-h)/(2*o);c(d,s*d-s*t+e)}return l},xl:(t,e,i,n,s,o,r,a,l)=>{let h=1e21,u=t,c=e;if(E.zn(t,e,t,n,s,o,r,a,l)){const t=(l.x-s)*(l.x-s)+(l.y-o)*(l.y-o);t<h&&(h=t,u=l.x,c=l.y)}if(E.zn(i,e,i,n,s,o,r,a,l)){const t=(l.x-s)*(l.x-s)+(l.y-o)*(l.y-o);t<h&&(h=t,u=l.x,c=l.y)}if(E.zn(t,e,i,e,s,o,r,a,l)){const t=(l.x-s)*(l.x-s)+(l.y-o)*(l.y-o);t<h&&(h=t,u=l.x,c=l.y)}if(E.zn(t,n,i,n,s,o,r,a,l)){const t=(l.x-s)*(l.x-s)+(l.y-o)*(l.y-o);t<h&&(h=t,u=l.x,c=l.y)}return l.e(u,c),h<1e21},kw:(t,e,i)=>E.iC(t.x,t.y,t.width,t.height,e.x,e.y,i.x,i.y),iC:(t,e,i,n,s,o,r,a)=>{const l=t,h=t+i,u=e,c=e+n;if(s===r){let t=0,e=0;return o<a?(t=o,e=a):(t=a,e=o),l<=s&&s<=h&&t<=c&&e>=u}if(o===a){let t=0,e=0;return s<r?(t=s,e=r):(t=r,e=s),u<=o&&o<=c&&t<=h&&e>=l}return!!(D.contains(t,e,i,n,s,o)||D.contains(t,e,i,n,r,a)||E.ou(l,u,h,u,s,o,r,a)||E.ou(h,u,h,c,s,o,r,a)||E.ou(h,c,l,c,s,o,r,a)||E.ou(l,c,l,u,s,o,r,a))},ou:(t,e,i,n,s,o,r,a)=>t===i&&e===n&&s===r&&o===a?t===s&&e===o:E.nu(t,e,i,n,s,o)*E.nu(t,e,i,n,r,a)<=0&&E.nu(s,o,r,a,t,e)*E.nu(s,o,r,a,i,n)<=0,nu:(t,e,i,n,s,o)=>{const r=i-t,a=n-e;let l=s-t,h=o-e,u=l*a-h*r;return 0===u&&(u=l*r+h*a,u>0&&(l-=r,h-=a,u=l*r+h*a,u<0&&(u=0))),u},Kg:t=>(t<0&&(t+=360),t>=360&&(t-=360),t),aC:(t,e,i,n,s,o)=>{const r=Math.PI;o||(n*=r/180,s*=r/180);const a=n>s?-1:1,l=1e-5,h=2*r,u=[],c=r/2;let d=n,f=Math.min(h,Math.abs(s-n));if(f<l){const n=d+a*Math.min(f,c),s=t+i*Math.cos(d),o=e+i*Math.sin(d),r=t+i*Math.cos(n),l=e+i*Math.sin(n),h=(s+r)/2,g=(o+l)/2;return u.push([s,o,h,g,h,g,r,l]),u}for(;f>l;){const n=d+a*Math.min(f,c);u.push(E.AD(i,d,n,t,e)),f-=Math.abs(n-d),d=n}return u},AD:(t,e,i,n,s)=>{const o=(i-e)/2,r=t*Math.cos(o),a=t*Math.sin(o),l=r,h=-a,u=l*l+h*h,c=u+l*r+h*a,d=4/3*(Math.sqrt(2*u*c)-c)/(l*a-h*r),f=l-d*h,g=h+d*l,m=f,p=-g,y=o+e,v=Math.cos(y),b=Math.sin(y);return[n+t*Math.cos(e),s+t*Math.sin(e),n+f*v-g*b,s+f*b+g*v,n+m*v-p*b,s+m*b+p*v,n+t*Math.cos(i),s+t*Math.sin(i)]},Vg:(t,e,i,n,s,o,r)=>{const a=s,l=o,h=Math.floor((t-i)/a)*a+i,u=Math.floor((e-n)/l)*l+n;let c=h;h+a-t<a/2&&(c=h+a);let d=u;return u+l-e<l/2&&(d=u+l),r.e(c,d),r},cC:(t,e)=>{let i=Math.max(t,e),n=Math.min(t,e),s=1,o=1;do{s=i%n,o=n,i=n,n=s}while(s>0);return o},TD:(t,e,i,n)=>{const s=i<0,o=n<0;let r=0,a=0,l=0;t<e?(a=1,l=0):(a=0,l=1);let h=0,u=0,c=0,d=0;return r=a,h=0===r?t:e,c=0===r?i:n,(0===r?s:o)&&(c=-c),r=l,u=0===r?t:e,d=0===r?i:n,(0===r?s:o)&&(d=-d),E.DD(h,u,c,d,0,0)},DD:(t,e,i,n,s,o)=>{let r=0;if(n>0)if(i>0){const a=t*t,l=e*e,h=t*i,u=e*n;let c=-l+u,d=-l+Math.sqrt(h*h+u*u),f=c;const g=9999999999;for(let t=0;t<g&&(f=.5*(c+d),f!==c&&f!==d);++t){const t=h/(f+a),e=u/(f+l),i=t*t+e*e-1;if(i>0)c=f;else{if(!(i<0))break;d=f}}const m=(s=a*i/(f+a))-i,p=(o=l*n/(f+l))-n;r=Math.sqrt(m*m+p*p)}else s=0,o=e,r=Math.abs(n-e);else{const n=t*t-e*e,a=t*i;if(a<n){const l=a/n,h=l*l;s=t*l,o=e*Math.sqrt(Math.abs(1-h));const u=s-i;r=Math.sqrt(u*u+o*o)}else s=t,o=0,r=Math.abs(i-t)}return r},No:new g,Yg:new g,ur:new g,dr:0,Gg:100};E.za=E.CD;var B,I=((B=I||{})[B.Line=1]="Line",B[B.Rectangle=2]="Rectangle",B[B.Ellipse=3]="Ellipse",B[B.Path=4]="Path",B),V=(t=>(t[t.None=0]="None",t[t.Default=1]="Default",t[t.Fill=2]="Fill",t[t.Uniform=6]="Uniform",t))(V||{});class z{constructor(t){y(this,"n",void 0),y(this,"Hg",void 0),y(this,"jg",void 0),y(this,"ic",void 0),y(this,"au",void 0),y(this,"cu",void 0),y(this,"Xn",void 0),y(this,"Kn",void 0),y(this,"Yn",void 0),y(this,"_",void 0),y(this,"Pe",void 0),y(this,"Me",void 0),y(this,"_i",void 0),y(this,"te",void 0),y(this,"vs",void 0),y(this,"ec",void 0),y(this,"sc",void 0),k.Yi(this),this.n=2,void 0===t&&(t=4),this._=t,this.Pe=0,this.Me=0,this._i=0,this.te=0,this.vs=4===t?new x:z.Pw,this.Hg=this.vs.ct,this.jg=(new D).g(),this.ic=null,this.au=null,this.cu=NaN,this.Xn=O.TopLeft,this.Kn=O.BottomRight,this.ec=NaN,this.sc=NaN,this.Yn=2}copy(){const t=new z;if(t.n=-2&this.n,t._=this._,t.Pe=this.Pe,t.Me=this.Me,t._i=this._i,t.te=this.te,4===this._){const e=this.vs.r,i=t.vs;for(let t=0;t<e.length;t++){const n=e[t];i.add(n.copy())}t.vs=i}else t.vs=this.vs;return t.Hg=this.Hg,t.jg.a(this.jg),t.ic=this.ic,t.au=this.au,t.cu=this.cu,t.Xn=this.Xn.N(),t.Kn=this.Kn.N(),t.ec=this.ec,t.sc=this.sc,t.Yn=this.Yn,t}get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get bt(){return 0!==(2&this.n)}set bt(t){t?this.n|=2:this.n&=-3}et(){return this.g(),Object.freeze(this),this}g(){if(this.h=!0,4!==this.type)return this;const t=this.figures;t.g();for(const e of t)e.g();return this}lt(){if(Object.isFrozen(this)&&d.o("cannot thaw constant: "+this),this.h=!1,4!==this.type)return this;const t=this.figures;t.lt();for(const e of t)e.lt();return this}equalsApprox(t){if(!(t instanceof z))return!1;if(this.type!==t.type)return 1===this.type&&4===t.type?this.fC(t):1===t.type&&4===this.type&&t.fC(this);if(4===this.type){const e=this.figures.r,i=t.figures.r,n=e.length;if(n!==i.length)return!1;for(let t=0;t<n;t++){const n=e[t],s=i[t];if(!n.equalsApprox(s))return!1}return!0}return E.u(this.startX,t.startX)&&E.u(this.startY,t.startY)&&E.u(this.endX,t.endX)&&E.u(this.endY,t.endY)}fC(t){if(1!==this.type||4!==t.type)return!1;if(1===t.figures.count){const e=t.figures.elt(0);if(1===e.segments.count&&E.u(this.startX,e.startX)&&E.u(this.startY,e.startY)){const t=e.segments.elt(0);if(2===t.type&&E.u(this.endX,t.endX)&&E.u(this.endY,t.endY))return!0}}return!1}static stringify(t){return t.toString()}static stringifyFixed(t){return d.i(t,"number",z,"stringifyFixed:digits"),e=>e.toString(t)}li(t){t in I?this.type=t:d.ar(this,t)}toString(t){void 0===t&&(t=-1);const e=e=>0===e?"0":e.toFixed(t);let i;switch(this.type){case 1:return t<0?"M"+this.startX.toString()+" "+this.startY.toString()+"L"+this.endX.toString()+" "+this.endY.toString():"M"+e(this.startX)+" "+e(this.startY)+"L"+e(this.endX)+" "+e(this.endY);case 2:return i=new D(this.startX,this.startY,0,0),i.union(this.endX,this.endY,0,0),t<0?"M"+i.x.toString()+" "+i.y.toString()+"H"+i.right.toString()+"V"+i.bottom.toString()+"H"+i.left.toString()+"z":"M"+e(i.x)+" "+e(i.y)+"H"+e(i.right)+"V"+e(i.bottom)+"H"+e(i.left)+"z";case 3:if(i=new D(this.startX,this.startY,0,0),i.union(this.endX,this.endY,0,0),t<0){const t=i.left.toString()+" "+(i.y+i.height/2).toString(),e=i.right.toString()+" "+(i.y+i.height/2).toString();return"M"+t+"A"+(i.width/2).toString()+" "+(i.height/2).toString()+" 0 0 1 "+e+"A"+(i.width/2).toString()+" "+(i.height/2).toString()+" 0 0 1 "+t}{const t=e(i.left)+" "+e(i.y+i.height/2),n=e(i.right)+" "+e(i.y+i.height/2);return"M"+t+"A"+e(i.width/2)+" "+e(i.height/2)+" 0 0 1 "+n+"A"+e(i.width/2)+" "+e(i.height/2)+" 0 0 1 "+t}case 4:let n="";const s=this.figures.r,o=s.length;for(let e=0;e<o;e++){const i=s[e];e>0&&(n+=" x "),i.isFilled&&(n+="F "),n+=i.toString(t)}return n;default:return I[this.type]}}static fillPath(t){"string"!=typeof t&&d.ke(t,"string",z,"fillPath:str");const e=t.split(/[Xx]/),i=e.length;let n="";for(let s=0;s<i;s++){const t=e[s];null===t.match(/[Ff]/)?n+=(0===s?"":"X ")+"F"+(" "===t[0]?"":" ")+t:n+=0===s?t:"X"+(" "===t[0]?"":" ")+t}return n}static parse(t,e){void 0===e&&(e=!1),"string"!=typeof t&&d.ke(t,"string",z,"parse:str");const i=new RegExp("(["+z.qg+"])(["+z.qg+"])","gm"),n=new RegExp("(["+z.qg+"])([^s])","gm"),s=new RegExp("([^s])(["+z.qg+"])","gm"),o=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/,/gm," ")).replace(i,"$1 $2")).replace(i,"$1 $2")).replace(n,"$1 $2")).replace(s,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2")).replace(/[\s\r\t\n]+/gm," ")).replace(/^\s+|\s+$/g,"")).split(" ");for(let T=0;T<o.length;T++){const t=o[T];if(null!==t.match(/(\.[0-9]*)(\.)/gm)){const e=d.rt();let i="",n=!1;for(let s=0;s<t.length;s++){const o=t[s];"."!==o||n?"."===o?(e.push(i),i="."):i+=o:(n=!0,i+=o)}e.push(i),o.splice(T,1);for(let t=0;t<e.length;t++)o.splice(T+t,0,e[t]);T+=e.length-1,d.it(e)}}let r=-1,a="",l="";const h=new T(0,0),u=new T(0,0),c=new T(0,0);let f=!0;function g(){return r>=x-1||null!==o[r+1].match(N)||(f=!1,!1)}function m(){return r++,o[r]}function p(t){let e=parseFloat(m()),i=parseFloat(m());a===a.toLowerCase()&&(e=c.x+e,i=c.y+i),t.e(e,i)}function y(){return p(c),c}function v(){return p(u),u}function b(){const t=l.toLowerCase();return"c"===t||"s"===t||"q"===t||"t"===t?new T(2*c.x-u.x,2*c.y-u.y):new T(c.x,c.y)}const x=o.length,w=xe.uC(null);let k=!1,S=!1,P=!1,M=!0,C=null;const N=new RegExp("["+z.qg+"]");for(;!(r>=x-1);){if(l=a,a=m(),""===a)continue;f=!0;let e=!1;switch(a.toUpperCase()){case"X":M=!0,k=!1,S=!1;break;case"M":for(C=y(),null===w.Mi||!0===M?(w.fu(C.x,C.y,k,!1,!S,P),M=!1):w.FD(C.x,C.y),h.a(c);!g();)C=y(),w.gr(C.x,C.y);break;case"L":for(;!g();)C=y(),w.gr(C.x,C.y);f&&(e=!0);break;case"H":for(;!g();)c.e((a===a.toLowerCase()?c.x:0)+parseFloat(m()),c.y),w.gr(c.x,c.y);break;case"V":for(;!g();)c.e(c.x,(a===a.toLowerCase()?c.y:0)+parseFloat(m())),w.gr(c.x,c.y);f&&(e=!0);break;case"C":for(;!g();){const t=new T;p(t);const e=v(),i=y();w.mr(t.x,t.y,e.x,e.y,i.x,i.y)}f&&(e=!0);break;case"S":for(;!g();){const t=b(),e=v(),i=y();w.mr(t.x,t.y,e.x,e.y,i.x,i.y)}f&&(e=!0);break;case"Q":for(;!g();){const t=v(),e=y();w.Mw(t.x,t.y,e.x,e.y)}f&&(e=!0);break;case"T":for(;!g();){const t=b();u.a(t);const e=y();w.Mw(t.x,t.y,e.x,e.y),u.a(e)}f&&(e=!0);break;case"B":for(;!g();){const t=parseFloat(m()),e=parseFloat(m());let i=parseFloat(m()),n=parseFloat(m());const s=parseFloat(m());let o=s,r=!1;g()||(o=parseFloat(m()),g()||(r=0!==parseFloat(m()))),a===a.toLowerCase()&&(i+=c.x,n+=c.y),w.RD(t,e,i,n,s,o,r)}f&&(e=!0);break;case"A":for(;!g();){const t=Math.abs(parseFloat(m())),e=Math.abs(parseFloat(m())),i=parseFloat(m());let n=!1,s=!1,o=0,r=0;const l=m();1===l.length?(n=!!parseFloat(l),s=!!parseFloat(m()),o=parseFloat(m()),r=parseFloat(m())):2===l.length?(n=!!parseFloat(l[0]),s=!!parseFloat(l[1]),o=parseFloat(m()),r=parseFloat(m())):(n=!!parseFloat(l[0]),s=!!parseFloat(l[1]),o=parseFloat(l.slice(2)),r=parseFloat(m())),a===a.toLowerCase()&&(o=c.x+o,r=c.y+r),c.e(o,r),w.vD(t,e,i,n,s,o,r)}f&&(e=!0);break;case"Z":w.OD(),c.a(h);break;case"F":{let t="",e=1;for(;o[r+e];)if("0"!==o[r+e])if(null===o[r+e].match(/[Uu]/)){if(null!==o[r+e].match(N)){t=o[r+e];break}e++}else e++;else P=!0,e++;t.match(/[Mm]/)?k=!0:w.ID();break}case"U":{let t="",e=1;for(;o[r+e];)if(null===o[r+e].match(/[Ff]/)){if(null!==o[r+e].match(N)){t=o[r+e];break}e++}else e++;t.match(/[Mm]/)?S=!0:w.ED(!1);break}default:if("0"===a||"1"===a)break;d.ri("Unknown geometry command: "+a)}if(e){d.ri("Bad geometry command: ".concat(a,", next token: ").concat(m(),",\nstring: ").concat(t));break}}const L=w.Wg;if(xe.dC(w),e){const t=L.figures.iterator;for(;t.next();){t.value.isFilled=!0}}return L}static gC(t,e){const i=t.length,n=T.l();for(let s=0;s<i;s++){const i=t[s];n.x=i[0],n.y=i[1],e.xt(n),i[0]=n.x,i[1]=n.y,n.x=i[2],n.y=i[3],e.xt(n),i[2]=n.x,i[3]=n.y,n.x=i[4],n.y=i[5],e.xt(n),i[4]=n.x,i[5]=n.y,n.x=i[6],n.y=i[7],e.xt(n),i[6]=n.x,i[7]=n.y}T.s(n)}Uk(){if(this.bt)return!0;if(4===this.type){const t=this.figures;if(this.Hg!==t.ct)return!0;const e=this.figures.r,i=e.length;for(let n=0;n<i;n++)if(e[n].Uk())return!0}return!1}Sw(){if(this.bt=!1,this.ic=null,this.au=null,this.cu=NaN,4===this.type){const t=this.figures;this.Hg=t.ct;const e=this.figures.r,i=e.length;for(let n=0;n<i;n++)e[n].VD()}const t=this.jg;t.lt(),isNaN(this.ec)||isNaN(this.sc)?t.e(0,0,0,0):t.e(0,0,this.ec,this.sc),this.mC(t,!1),t.unionNoCheck(0,0,0,0),t.g()}computeBoundsWithoutOrigin(){const t=new D;return this.mC(t,!0),t}mC(t,e){switch(this.type){case 1:case 2:case 3:e?t.e(this.Pe,this.Me,0,0):t.unionNoCheck(this.Pe,this.Me,0,0),t.unionNoCheck(this._i,this.te,0,0);break;case 4:const i=this.figures,n=i.r,s=i.length;for(let o=0;o<s;o++){const i=n[o];e&&0===o?t.e(i.startX,i.startY,0,0):t.unionNoCheck(i.startX,i.startY,0,0);const s=i.segments.r,r=s.length;let a=i.startX,l=i.startY;for(let e=0;e<r;e++){const n=s[e];switch(n.type){case 2:case 1:a=n.endX,l=n.endY,t.unionNoCheck(a,l,0,0);break;case 3:E.hu(a,l,n.point1X,n.point1Y,n.point2X,n.point2Y,n.endX,n.endY,.5,t),a=n.endX,l=n.endY;break;case 4:E.Vk(a,l,n.point1X,n.point1Y,n.endX,n.endY,.5,t),a=n.endX,l=n.endY;break;case 5:case 6:const e=5===n.type?n.Co(i):n.Vh(i,a,l),s=e.length;if(0===s){a=5===n.type?n.centerX:n.endX,l=5===n.type?n.centerY:n.endY,t.unionNoCheck(a,l,0,0);break}let o=null;for(let i=0;i<s;i++)o=e[i],E.hu(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],.5,t);null!==o&&(a=o[6],l=o[7]);break;default:d.o("Unknown Segment type: "+n.type)}}}break;default:d.o("Unknown Geometry type: "+this.type)}}UD(t,e){const i=this.bounds;let n=t/i.width,s=e/i.height;return isFinite(n)||(n=1),isFinite(s)||(s=1),1===n&&1===s?this:this.copy().scale(n,s)}normalize(){this.h&&d.D(this);const t=this.computeBoundsWithoutOrigin();return this.offset(-t.x,-t.y),new T(-t.x,-t.y)}offset(t,e){return this.h&&d.D(this),this.L(1,0,0,1,t,e),this}scale(t,e){return this.h&&d.D(this),this.L(t,0,0,e,0,0),this}rotate(t,e,i){this.h&&d.D(this),void 0===e&&(e=0),void 0===i&&(i=0);const n=R.l();return n.Jt(),n.us(t,e,i),this.L(n.m11,n.m12,n.m21,n.m22,n.dx,n.dy),R.s(n),this}L(t,e,i,n,s,o){let r=0,a=0;switch(this.type){case 1:case 2:case 3:r=this.Pe,a=this.Me,this.Pe=r*t+a*i+s,this.Me=r*e+a*n+o,r=this._i,a=this.te,this._i=r*t+a*i+s,this.te=r*e+a*n+o;break;case 4:const l=this.figures.r,h=l.length;for(let u=0;u<h;u++){const h=l[u];r=h.startX,a=h.startY,h.startX=r*t+a*i+s,h.startY=r*e+a*n+o;const c=h.segments.r,f=c.length;for(let l=0;l<f;l++){const h=c[l];switch(h.type){case 2:case 1:r=h.endX,a=h.endY,h.endX=r*t+a*i+s,h.endY=r*e+a*n+o;break;case 3:r=h.point1X,a=h.point1Y,h.point1X=r*t+a*i+s,h.point1Y=r*e+a*n+o,r=h.point2X,a=h.point2Y,h.point2X=r*t+a*i+s,h.point2Y=r*e+a*n+o,r=h.endX,a=h.endY,h.endX=r*t+a*i+s,h.endY=r*e+a*n+o;break;case 4:r=h.point1X,a=h.point1Y,h.point1X=r*t+a*i+s,h.point1Y=r*e+a*n+o,r=h.endX,a=h.endY,h.endX=r*t+a*i+s,h.endY=r*e+a*n+o;break;case 5:if(r=h.centerX,a=h.centerY,h.centerX=r*t+a*i+s,h.centerY=r*e+a*n+o,0!==e){let i=180*Math.atan2(e,t)/Math.PI;i<0&&(i+=360),h.startAngle+=i}t<0&&(h.startAngle=180-h.startAngle,h.sweepAngle=-h.sweepAngle),n<0&&(h.startAngle=-h.startAngle,h.sweepAngle=-h.sweepAngle),h.radiusX*=Math.sqrt(t*t+i*i),void 0!==h.radiusY&&(h.radiusY*=Math.sqrt(e*e+n*n));break;case 6:if(r=h.endX,a=h.endY,h.endX=r*t+a*i+s,h.endY=r*e+a*n+o,0===h.radiusX||0===h.radiusY)break;if(0!==e){let i=180*Math.atan2(e,t)/Math.PI;i<0&&(i+=360),h.xAxisRotation+=i}t<0&&(h.xAxisRotation=180-h.xAxisRotation,h.isClockwiseArc=!h.isClockwiseArc),n<0&&(h.xAxisRotation=-h.xAxisRotation,h.isClockwiseArc=!h.isClockwiseArc),h.radiusX*=Math.sqrt(t*t+i*i),h.radiusY*=Math.sqrt(e*e+n*n);break;default:d.o("Unknown Segment type: "+h.type)}}}}return this.bt=!0,this}containsPoint(t,e){void 0===e&&(e=0);const i=this.Pe,n=this.Me,s=this._i,o=this.te;switch(this.type){case 1:return E.vi(i,n,s,o,e,t.x,t.y);case 2:{const r=Math.min(i,s)-e,a=Math.min(n,o)-e,l=Math.abs(s-i)+2*e,h=Math.abs(o-n)+2*e,u=D.X(r,a,l,h),c=u.containsPoint(t);return D.s(u),c}case 3:{let r=Math.min(i,s)-e,a=Math.min(n,o)-e;const l=(Math.abs(s-i)+2*e)/2,h=(Math.abs(o-n)+2*e)/2;return!(l<=0||h<=0)&&(r=t.x-(r+l),a=t.y-(a+h),r*r/(l*l)+a*a/(h*h)<=1)}case 4:return this.Bk(t,e,!0,!1);default:return!1}}Bk(t,e,i,n){const s=t.x,o=t.y,r=this.bounds.x-20,a=o;let l=0,h=0,u=0,c=0,f=0,g=0;const m=this.figures.r,p=m.length;for(let y=0;y<p;y++){const t=m[y],p=!t.isEvenOdd;if(!t.isFilled){if(t.zk(s,o,n?e:e+2))return!0;continue}if(i&&t.zk(s,o,e))return!0;const v=t.segments;h=t.startX,u=t.startY;let b=h,x=u;const w=v.r;for(let e=0;e<=v.length;e++){let i,n;switch(e!==v.length?(i=w[e],n=i.type,f=i.endX,g=i.endY):(n=2,f=b,g=x),n){case 1:{const t=this.Nw(s,o,r,a,h,u,b,x);if(isNaN(t))return!0;l+=t,b=f,x=g;break}case 2:{const t=this.Nw(s,o,r,a,h,u,f,g);if(isNaN(t))return!0;l+=t;break}case 3:c=E.Xg(h,u,i.point1X,i.point1Y,i.point2X,i.point2Y,f,g,r,a,s,o,.5),l+=c;break;case 4:{const t=(h+2*i.point1X)/3,e=(u+2*i.point1Y)/3,n=(2*i.point1X+f)/3,d=(2*i.point1Y+g)/3;c=E.Xg(h,u,t,e,n,d,f,g,r,a,s,o,.5),l+=c;break}case 5:case 6:{const e=5===i.type?i.Co(t):i.Vh(t,h,u),n=e.length;if(0===n){const t=this.Nw(s,o,r,a,h,u,5===i.type?i.centerX:i.endX,5===i.type?i.centerY:i.endY);if(isNaN(t))return!0;l+=t;break}let d=null;for(let t=0;t<n;t++){if(d=e[t],0===t){const t=this.Nw(s,o,r,a,h,u,d[0],d[1]);if(isNaN(t))return!0;l+=t}c=E.Xg(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],r,a,s,o,.5),l+=c}null!==d&&(f=d[6],g=d[7]);break}default:d.o("Unknown Segment type: "+i.type)}h=f,u=g}if(p){if(0!==l)return!0}else if(l%2!==0)return!0;l=0}return!1}Nw(t,e,i,n,s,o,r,a){if(E.vi(s,o,r,a,.05,t,e))return NaN;const l=(t-i)*(o-a);if(0===l)return 0;const h=((t*n-e*i)*(s-r)-(t-i)*(s*a-o*r))/l,u=(t*n-e*i)*(o-a)/l;if(h>=t)return 0;if((s>r?s-r:r-s)<(o>a?o-a:a-o)){if(o<a){if(u<o||u>a)return 0}else if(u<a||u>o)return 0}else if(s<r){if(h<s||h>r)return 0}else if(h<r||h>s)return 0;return l>0?1:-1}pC(t,e,i){const n=this.figures.r,s=n.length;for(let o=0;o<s;o++)if(n[o].zk(t,e,i))return!0;return!1}getPointAlongPath(t,e){if(t<0?t=0:t>1&&(t=1),void 0===e&&(e=new T),1===this.type)return e.e(this.startX+t*(this.endX-this.startX),this.startY+t*(this.endY-this.startY)),e;const i=this.flattenedSegments,n=this.flattenedLengths,s=this.flattenedTotalLength,o=i.length,r=s*t;let a=0;for(let l=0;l<o;l++){const t=n[l],s=t.length;for(let n=0;n<s;n++){const s=t[n];if(a+s>=r){const t=0===s?0:(r-a)/s,o=i[l],h=o[2*n],u=o[2*n+1],c=o[2*n+2],d=o[2*n+3];return e.e(h+(c-h)*t,u+(d-u)*t),e}a+=s}}return e}getAngleAlongPath(t){if(t<0?t=0:t>1&&(t=1),1===this.type)return 180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI;const e=this.flattenedSegments,i=this.flattenedLengths,n=this.flattenedTotalLength,s=e.length,o=n*t;let r=0;for(let a=0;a<s;a++){const t=i[a],n=t.length;for(let i=0;i<n;i++){const n=t[i];if(r+n>=o){const t=e[a],n=t[2*i],s=t[2*i+1],o=t[2*i+2],r=t[2*i+3];return Math.abs(o-n)<1&&Math.abs(r-s)<1?0:Math.abs(o-n)<1?r-s>=0?90:270:Math.abs(r-s)<1?o-n>=0?0:180:180*Math.atan2(r-s,o-n)/Math.PI}r+=n}}return NaN}getPointAndAngleAlongPath(t,e){if(t<0?t=0:t>1&&(t=1),void 0===e&&(e=[]),e.length=3,1===this.type)return e[0]=this.startX+t*(this.endX-this.startX),e[1]=this.startY+t*(this.endY-this.startY),e[2]=180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI,e;const i=this.flattenedSegments,n=this.flattenedLengths,s=this.flattenedTotalLength,o=i.length,r=s*t;let a=0;for(let l=0;l<o;l++){const t=n[l],s=t.length;for(let n=0;n<s;n++){const s=t[n];if(a+s>=r){const t=0===s?0:(r-a)/s,o=i[l],h=o[2*n],u=o[2*n+1],c=o[2*n+2],d=o[2*n+3];let f;return e[0]=h+(c-h)*t,e[1]=u+(d-u)*t,f=Math.abs(c-h)<1&&Math.abs(d-u)<1?0:Math.abs(c-h)<1?d-u>=0?90:270:Math.abs(d-u)<1?c-h>=0?0:180:180*Math.atan2(d-u,c-h)/Math.PI,e[2]=f,e}a+=s}}return e}getFractionForPoint(t){if(1===this.type){const e=this.startX,i=this.startY,n=this.endX,s=this.endY;if(e===n&&i===s)return 0;{const o=t.x,r=t.y;let a=0,l=0;if(e===n)return i<s?(a=i,l=s):(a=s,l=i),r<=a?a===i?0:1:r>=l?l===i?0:1:Math.abs(r-i)/(l-a);if(i===s)return e<n?(a=e,l=n):(a=n,l=e),o<=a?a===e?0:1:o>=l?l===e?0:1:Math.abs(o-e)/(l-a);{const t=(n-e)*(n-e)+(s-i)*(s-i),a=T.l();E.wl(e,i,n,s,o,r,a);const l=a.x,h=a.y;return T.s(a),Math.sqrt(((l-e)*(l-e)+(h-i)*(h-i))/t)}}}if(2!==this.type){const e=this.flattenedSegments,i=this.flattenedLengths,n=this.flattenedTotalLength,s=T.l();let o=1/0,r=0,a=0;const l=e.length;let h=0,u=0;for(let d=0;d<l;d++){const n=e[d],l=i[d],c=n.length;for(let e=0;e<c;e+=2){const i=n[e],c=n[e+1];if(0===e){h=i,u=c;continue}E.wl(h,u,i,c,t.x,t.y,s);const d=(s.x-t.x)*(s.x-t.x)+(s.y-t.y)*(s.y-t.y);d<o&&(o=d,r=a,r+=Math.sqrt((s.x-h)*(s.x-h)+(s.y-u)*(s.y-u))),a+=l[(e-2)/2],h=i,u=c}}T.s(s);const c=r/n;return c<0?0:c>1?1:c}{const e=this.startX,i=this.startY,n=this.endX,s=this.endY;if(e===n&&i===s)return 0;{const o=n-e,r=s-i,a=2*o+2*r;let l=t.x,h=t.y;l=Math.min(Math.max(l,e),n),h=Math.min(Math.max(h,i),s);const u=Math.abs(l-e),c=Math.abs(l-n),d=Math.abs(h-i),f=Math.abs(h-s),g=Math.min(u,c,d,f);if(g===d)return l/a;if(g===c)return(o+h)/a;if(g===f)return(2*o+r-l)/a;if(g===u)return(2*o+2*r-h)/a}}return 0}get flattenedSegments(){return this.yC(),this.ic}yC(){if(null===this.ic){const t=this.ic=[],e=this.au=[];this.BD(t,e)}}get flattenedLengths(){return this.yC(),this.au}get flattenedTotalLength(){let t=this.cu;if(isNaN(t)){if(1===this.type){const e=Math.abs(this.endX-this.startX),i=Math.abs(this.endY-this.startY);t=Math.sqrt(e*e+i*i)}else if(2===this.type){t=2*Math.abs(this.endX-this.startX)+2*Math.abs(this.endY-this.startY)}else{const e=this.flattenedLengths,i=e.length;t=0;for(let n=0;n<i;n++){const i=e[n],s=i.length;for(let e=0;e<s;e++)t+=i[e]}}this.cu=t}return t}Xk(t){const e=[];let i=0,n=0;const s=t.length;for(let o=0;o<s;o+=2){const s=t[o],r=t[o+1];if(0===o){i=s,n=r;continue}const a=Math.sqrt(T.distanceSquared(i,n,s,r));e.push(a),i=s,n=r}return e}BD(t,e){let i=[];const n=[];if(1===this.type)i.push(this.startX),i.push(this.startY),i.push(this.endX),i.push(this.endY),t.push(i),n.push(Math.sqrt((this.startX-this.endX)*(this.startX-this.endX)+(this.startY-this.endY)*(this.startY-this.endY))),e.push(n);else if(2===this.type)i.push(this.startX),i.push(this.startY),i.push(this.endX),i.push(this.startY),i.push(this.endX),i.push(this.endY),i.push(this.startX),i.push(this.endY),i.push(this.startX),i.push(this.startY),t.push(i),n.push(Math.abs(this.startX-this.endX)),n.push(Math.abs(this.startY-this.endY)),n.push(Math.abs(this.startX-this.endX)),n.push(Math.abs(this.startY-this.endY)),e.push(n);else if(3===this.type){const n=new j;n.startX=this.endX,n.startY=(this.startY+this.endY)/2;const s=new K(5);s.startAngle=0,s.sweepAngle=360,s.centerX=(this.startX+this.endX)/2,s.centerY=(this.startY+this.endY)/2,s.radiusX=Math.abs(this.startX-this.endX)/2,s.radiusY=Math.abs(this.startY-this.endY)/2,n.add(s);const o=s.Co(n),r=o.length;if(0===r)i.push(s.centerX),i.push(s.centerY);else{let t=n.startX,e=n.startY;for(let n=0;n<r;n++){const s=o[n];E.Bn(t,e,s[2],s[3],s[4],s[5],s[6],s[7],.5,i),t=s[6],e=s[7]}}t.push(i),e.push(this.Xk(i))}else{const n=this.figures.iterator;for(;n.next();){const s=n.value;i=[],i.push(s.startX),i.push(s.startY);let o=s.startX,r=s.startY,a=o,l=r;const h=s.segments.r,u=h.length;for(let n=0;n<u;n++){const u=h[n];switch(u.type){case 1:i.length>=4&&(t.push(i),e.push(this.Xk(i))),i=[],i.push(u.endX),i.push(u.endY),o=u.endX,r=u.endY,a=o,l=r;break;case 2:i.push(u.endX),i.push(u.endY),o=u.endX,r=u.endY;break;case 3:E.Bn(o,r,u.point1X,u.point1Y,u.point2X,u.point2Y,u.endX,u.endY,.5,i),o=u.endX,r=u.endY;break;case 4:E.Bg(o,r,u.point1X,u.point1Y,u.endX,u.endY,.5,i),o=u.endX,r=u.endY;break;case 5:{const t=u.Co(s),e=t.length;if(0===e){i.push(u.centerX),i.push(u.centerY),o=u.centerX,r=u.centerY;break}for(let n=0;n<e;n++){const e=t[n];E.Bn(o,r,e[2],e[3],e[4],e[5],e[6],e[7],.5,i),o=e[6],r=e[7]}break}case 6:{const t=u.Vh(s,o,r),e=t.length,n=u.endX,a=u.endY;if(0===e){i.push(n),i.push(a),o=n,r=a;break}for(let s=0;s<e;s++){const e=t[s];E.Bn(o,r,e[2],e[3],e[4],e[5],e[6],e[7],.5,i),o=e[6],r=e[7]}break}default:d.o("Segment not of valid type: "+u.type)}u.isClosed&&(i.push(a),i.push(l))}i.length>=4&&(t.push(i),e.push(this.Xk(i)))}}}get type(){return this._}set type(t){this._!==t&&(this.h&&d.D(this,t),this._=t,4===t?this.vs=new x:(null===z.Pw&&(z.Pw=(new x).g()),this.vs=z.Pw),this.bt=!0)}get startX(){return this.Pe}set startX(t){this.Pe!==t&&(this.h&&d.D(this,t),this.Pe=t,this.bt=!0)}get startY(){return this.Me}set startY(t){this.Me!==t&&(this.h&&d.D(this,t),this.Me=t,this.bt=!0)}get endX(){return this._i}set endX(t){this._i!==t&&(this.h&&d.D(this,t),this._i=t,this.bt=!0)}get endY(){return this.te}set endY(t){this.te!==t&&(this.h&&d.D(this,t),this.te=t,this.bt=!0)}get figures(){return this.vs}set figures(t){this.vs!==t&&(this.h&&d.D(this,t),this.vs=t,this.bt=!0)}add(t){return this.vs.add(t),this}setSpots(t,e,i,n,s,o,r,a){return this.h&&d.D(this),this.Xn=new O(t,e,s,o).g(),this.Kn=new O(i,n,r,a).g(),this}get spot1(){return this.Xn}set spot1(t){this.h&&d.D(this,t),this.Xn=t.N()}get spot2(){return this.Kn}set spot2(t){this.h&&d.D(this,t),this.Kn=t.N()}get defaultStretch(){return this.Yn}set defaultStretch(t){this.Yn=t}get bounds(){return this.Uk()&&this.Sw(),this.jg}}y(z,"Line",1),y(z,"Rectangle",2),y(z,"Ellipse",3),y(z,"Path",4),y(z,"Pw",(new x).g()),y(z,"qg","UuBbMmZzLlHhVvCcSsQqTtAaFfXx"),z.stringify=z.stringify,z.stringifyFixed=z.stringifyFixed,z.fillPath=z.fillPath,z.parse=z.parse;class j{constructor(t,e,i,n,s){y(this,"n",void 0),y(this,"Pe",void 0),y(this,"Me",void 0),y(this,"nc",void 0),y(this,"Jg",void 0),y(this,"ze",void 0),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===s&&(s=!1),this.n=2|(i?4:0)|(n?8:0)|(s?16:0),this.Pe=void 0!==t?t:0,this.Me=void 0!==e?e:0,this.nc=new x,this.Jg=this.nc.ct,this.ze=null}copy(){const t=new j;t.n=-2&this.n,t.Pe=this.Pe,t.Me=this.Me;const e=this.nc.r,i=e.length,n=t.nc;for(let s=0;s<i;s++){const t=e[s].copy();n.add(t)}return t.Jg=this.Jg,t.ze=this.ze,t}equalsApprox(t){if(!(t instanceof j)||!E.u(this.startX,t.startX)||!E.u(this.startY,t.startY))return!1;const e=this.segments.r,i=t.segments.r,n=e.length;if(n!==i.length)return!1;for(let s=0;s<n;s++){const t=e[s],n=i[s];if(!t.equalsApprox(n))return!1}return!0}toString(t){void 0===t&&(t=-1);let e="";if(t<0)e="M"+this.startX.toString()+" "+this.startY.toString();else{const i=e=>0===e?"0":e.toFixed(t);e="M"+i(this.startX)+" "+i(this.startY)}const i=this.segments.r,n=i.length;for(let s=0;s<n;s++){e+=" "+i[s].toString(t)}return e}get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get bt(){return 0!==(2&this.n)}set bt(t){t?this.n|=2:this.n&=-3}g(){this.h=!0;const t=this.segments;t.g();const e=t.r,i=t.length;for(let n=0;n<i;n++)e[n].g();return this}lt(){this.h=!1;const t=this.segments;t.lt();const e=t.r,i=e.length;for(let n=0;n<i;n++)e[n].lt();return this}Uk(){if(this.bt)return!0;const t=this.segments;if(this.Jg!==t.ct)return!0;for(const e of t)if(e.bt)return!0;return!1}VD(){this.bt=!1,this.ze=null;const t=this.segments;this.Jg=t.ct;for(const e of t)e.bt=!1,e.Os=null}get isFilled(){return 0!==(4&this.n)}set isFilled(t){this.h&&d.D(this,t),t?this.n|=4:this.n&=-5}get isShadowed(){return 0!==(8&this.n)}set isShadowed(t){this.h&&d.D(this,t),t?this.n|=8:this.n&=-9}get isEvenOdd(){return 0!==(16&this.n)}set isEvenOdd(t){this.h&&d.D(this,t),t?this.n|=16:this.n&=-17}get startX(){return this.Pe}set startX(t){this.h&&d.D(this,t),this.Pe=t,this.ze=null,this.bt=!0}get startY(){return this.Me}set startY(t){this.h&&d.D(this,t),this.Me=t,this.ze=null,this.bt=!0}get segments(){return this.nc}set segments(t){this.h&&d.D(this,t),this.nc=t,this.ze=null,this.bt=!0}add(t){return this.nc.add(t),this.ze=null,this}zk(t,e,i){const n=this;let s=n.startX,o=n.startY,r=s,a=o;const l=n.segments.r,h=l.length;for(let u=0;u<h;u++){const h=l[u];switch(h.type){case 1:r=h.endX,a=h.endY,s=h.endX,o=h.endY;break;case 2:if(E.vi(s,o,h.endX,h.endY,i,t,e))return!0;s=h.endX,o=h.endY;break;case 3:if(E.bw(s,o,h.point1X,h.point1Y,h.point2X,h.point2Y,h.endX,h.endY,.5,t,e,i))return!0;s=h.endX,o=h.endY;break;case 4:if(E.Ek(s,o,h.point1X,h.point1Y,h.endX,h.endY,.5,t,e,i))return!0;s=h.endX,o=h.endY;break;case 5:case 6:const l=5===h.type?h.Co(n):h.Vh(n,s,o),u=l.length,c=5===h.type?h.centerX:h.endX,f=5===h.type?h.centerY:h.endY;if(0===u){if(E.vi(s,o,c,f,i,t,e))return!0;s=c,o=f;break}let g=null;for(let n=0;n<u;n++)if(g=l[n],0===n&&E.vi(s,o,g[0],g[1],i,t,e)||E.bw(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],.5,t,e,i))return!0;null!==g&&(s=g[6],o=g[7]);break;default:d.o("Unknown Segment type: "+h.type)}if(h.isClosed&&(s!==r||o!==a)&&E.vi(s,o,r,a,i,t,e))return!0}return!1}}var U=(t=>(t[t.Move=1]="Move",t[t.Line=2]="Line",t[t.Bezier=3]="Bezier",t[t.QuadraticBezier=4]="QuadraticBezier",t[t.Arc=5]="Arc",t[t.SvgArc=6]="SvgArc",t))(U||{});class K{constructor(t,e,i,n,s,o,r,a){if(y(this,"_",void 0),y(this,"n",void 0),y(this,"_i",void 0),y(this,"te",void 0),y(this,"an",void 0),y(this,"bl",void 0),y(this,"kl",void 0),y(this,"pr",void 0),y(this,"Os",void 0),k.Yi(this),void 0===t&&(t=2),this._=t,this.n=2,this._i=void 0!==e?e:0,this.te=void 0!==i?i:0,void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===r&&(r=0),6===t){let t=o;t%=360,t<0&&(t+=360),this.an=t,this.bl=0,this.kl=Math.max(n,0),this.pr=Math.max(s,0),"boolean"==typeof r?r&&(this.isLargeArc=!0):"number"==typeof r&&r&&(this.isLargeArc=!0),a&&(this.isClockwiseArc=!0)}else this.an=n,this.bl=s,5===t&&(o=Math.max(o,0)),this.kl=o,"number"==typeof r?(5===t&&(r=Math.max(r,0)),this.pr=r):this.pr=0;this.Os=null}copy(){const t=new K;return t._=this._,t.n=-2&this.n,t._i=this._i,t.te=this.te,t.an=this.an,t.bl=this.bl,t.kl=this.kl,t.pr=this.pr,t}equalsApprox(t){if(!(t instanceof K)||this.type!==t.type||this.isClosed!==t.isClosed)return!1;switch(this.type){case 1:case 2:return E.u(this.endX,t.endX)&&E.u(this.endY,t.endY);case 3:return E.u(this.endX,t.endX)&&E.u(this.endY,t.endY)&&E.u(this.point1X,t.point1X)&&E.u(this.point1Y,t.point1Y)&&E.u(this.point2X,t.point2X)&&E.u(this.point2Y,t.point2Y);case 4:return E.u(this.endX,t.endX)&&E.u(this.endY,t.endY)&&E.u(this.point1X,t.point1X)&&E.u(this.point1Y,t.point1Y);case 5:return E.u(this.startAngle,t.startAngle)&&E.u(this.sweepAngle,t.sweepAngle)&&E.u(this.centerX,t.centerX)&&E.u(this.centerY,t.centerY)&&E.u(this.radiusX,t.radiusX)&&E.u(this.radiusY,t.radiusY);case 6:return this.isClockwiseArc===t.isClockwiseArc&&this.isLargeArc===t.isLargeArc&&E.u(this.xAxisRotation,t.xAxisRotation)&&E.u(this.endX,t.endX)&&E.u(this.endY,t.endY)&&E.u(this.radiusX,t.radiusX)&&E.u(this.radiusY,t.radiusY);default:return!1}}li(t){t in U?this.type=t:d.ar(this,t)}toString(t){void 0===t&&(t=-1);const e=e=>0===e?"0":e.toFixed(t);let i="";switch(this.type){case 1:i=t<0?"M"+this.endX.toString()+" "+this.endY.toString():"M"+e(this.endX)+" "+e(this.endY);break;case 2:i=t<0?"L"+this.endX.toString()+" "+this.endY.toString():"L"+e(this.endX)+" "+e(this.endY);break;case 3:i=t<0?"C"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.point2X.toString()+" "+this.point2Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"C"+e(this.point1X)+" "+e(this.point1Y)+" "+e(this.point2X)+" "+e(this.point2Y)+" "+e(this.endX)+" "+e(this.endY);break;case 4:i=t<0?"Q"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"Q"+e(this.point1X)+" "+e(this.point1Y)+" "+e(this.endX)+" "+e(this.endY);break;case 5:i=t<0?"B"+this.startAngle.toString()+" "+this.sweepAngle.toString()+" "+this.centerX.toString()+" "+this.centerY.toString()+" "+this.radiusX.toString()+" "+this.radiusY.toString():"B"+e(this.startAngle)+" "+e(this.sweepAngle)+" "+e(this.centerX)+" "+e(this.centerY)+" "+e(this.radiusX)+" "+e(this.radiusY);break;case 6:i=t<0?"A"+this.radiusX.toString()+" "+this.radiusY.toString()+" "+this.xAxisRotation.toString()+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toString()+" "+this.endY.toString():"A"+e(this.radiusX)+" "+e(this.radiusY)+" "+e(this.xAxisRotation)+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+e(this.endX)+" "+e(this.endY);break;default:i=U[this.type]}return i+(this.isClosed?"z":"")}get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get bt(){return 0!==(2&this.n)}set bt(t){t?this.n|=2:this.n&=-3}g(){return this.h=!0,this}lt(){return this.h=!1,this}close(){return this.isClosed=!0,this}Co(t){if(null!==this.Os&&!1===t.bt)return this.Os;const e=this.radiusX;let i=this.radiusY;if(void 0===i&&(i=e),0===e||0===i)return this.Os=[],this.Os;const n=this.an,s=this.bl,o=E.aC(0,0,e<i?e:i,this.startAngle,this.startAngle+this.sweepAngle,!1);if(e!==i){const t=R.l();t.Jt(),e<i?t.K(1,i/e):t.K(e/i,1),z.gC(o,t),R.s(t)}const r=o.length;for(let a=0;a<r;a++){const t=o[a];t[0]+=n,t[1]+=s,t[2]+=n,t[3]+=s,t[4]+=n,t[5]+=s,t[6]+=n,t[7]+=s}return this.Os=o,this.Os}Vh(t,e,i){if(null!==this.Os&&!1===t.bt)return this.Os;if(0===this.radiusX||0===this.radiusY)return this.Os=[],this.Os;const n=e,s=i;let o=this.kl,r=this.pr;0===o&&(o=1e-4),0===r&&(r=1e-4);const a=this.an*(Math.PI/180),l=this.isLargeArc,h=this.isClockwiseArc,u=this._i,c=this.te,d=Math.cos(a),f=Math.sin(a),g=d*(n-u)/2+f*(s-c)/2,m=-f*(n-u)/2+d*(s-c)/2,p=g*g/(o*o)+m*m/(r*r);p>1&&(o*=Math.sqrt(p),r*=Math.sqrt(p));let y=(l===h?-1:1)*Math.sqrt((o*o*r*r-o*o*m*m-r*r*g*g)/(o*o*m*m+r*r*g*g));isNaN(y)&&(y=0);let v=y*o*m/r,b=y*-r*g/o;isNaN(v)&&(v=0),isNaN(b)&&(b=0);const x=(n+u)/2+d*v-f*b,w=(s+c)/2+f*v+d*b,k=(t,e)=>Math.sqrt(t*t+e*e),S=(t,e,i,n)=>(t*i+e*n)/(k(t,e)*k(i,n)),P=(t,e,i,n)=>(t*n<e*i?-1:1)*Math.acos(S(t,e,i,n)),M=P(1,0,(g-v)/o,(m-b)/r),C=(g-v)/o,N=(m-b)/r,L=(-g-v)/o,T=(-m-b)/r;let A=P(C,N,L,T);const D=S(C,N,L,T);D<=-1?A=Math.PI:D>=1&&(A=0),!h&&A>0&&(A-=2*Math.PI),h&&A<0&&(A+=2*Math.PI);const F=o>r?o:r,O=o>r?1:o/r,B=o>r?r/o:1,I=E.aC(0,0,F,M,M+A,!0),V=R.l();return V.Jt(),V.Qi(x,w),V.us(this.an,0,0),V.K(O,B),z.gC(I,V),R.s(V),this.Os=I,this.Os}get isClosed(){return 0!==(8&this.n)}set isClosed(t){this.isClosed!==t&&(t?this.n|=8:this.n&=-9,this.bt=!0)}get type(){return this._}set type(t){this.h&&d.D(this,t),this._=t,this.bt=!0}get endX(){return this._i}set endX(t){this.h&&d.D(this,t),this._i=t,this.bt=!0}get endY(){return this.te}set endY(t){this.h&&d.D(this,t),this.te=t,this.bt=!0}get point1X(){return this.an}set point1X(t){this.h&&d.D(this,t),this.an=t,this.bt=!0}get point1Y(){return this.bl}set point1Y(t){this.h&&d.D(this,t),this.bl=t,this.bt=!0}get point2X(){return this.kl}set point2X(t){this.h&&d.D(this,t),this.kl=t,this.bt=!0}get point2Y(){return this.pr}set point2Y(t){this.h&&d.D(this,t),this.pr=t,this.bt=!0}get centerX(){return this.an}set centerX(t){this.h&&d.D(this,t),this.an=t,this.bt=!0}get centerY(){return this.bl}set centerY(t){this.h&&d.D(this,t),this.bl=t,this.bt=!0}get radiusX(){return this.kl}set radiusX(t){t<0&&d.tt(t,">= zero",K,"radiusX"),this.h&&d.D(this,t),this.kl=t,this.bt=!0}get radiusY(){return this.pr}set radiusY(t){t<0&&d.tt(t,">= zero",K,"radiusY"),this.h&&d.D(this,t),this.pr=t,this.bt=!0}get startAngle(){return this._i}set startAngle(t){this.h&&d.D(this,t),(t%=360)<0&&(t+=360),this._i=t,this.bt=!0}get sweepAngle(){return this.te}set sweepAngle(t){this.h&&d.D(this,t),t>360&&(t=360),t<-360&&(t=-360),this.te=t,this.bt=!0}get isClockwiseArc(){return 0!==(4&this.n)}set isClockwiseArc(t){this.h&&d.D(this,t),t?this.n|=4:this.n&=-5,this.bt=!0}get isLargeArc(){return 0!==(16&this.n)}set isLargeArc(t){this.h&&d.D(this,t),t?this.n|=16:this.n&=-17,this.bt=!0}get xAxisRotation(){return this.an}set xAxisRotation(t){this.h&&d.D(this,t),(t%=360)<0&&(t+=360),this.an=t,this.bt=!0}}y(K,"Move",1),y(K,"Line",2),y(K,"Bezier",3),y(K,"QuadraticBezier",4),y(K,"Arc",5),y(K,"SvgArc",6);class G{constructor(){y(this,"k",void 0),y(this,"Cw",void 0),y(this,"Lw",void 0),y(this,"$g",void 0),y(this,"Zg",void 0),y(this,"Qg",void 0),y(this,"_g",void 0),y(this,"tm",void 0),y(this,"im",void 0),y(this,"em",void 0),y(this,"sm",void 0),y(this,"nm",void 0),y(this,"om",void 0),y(this,"rm",void 0),y(this,"Lo",void 0),y(this,"lm",void 0),y(this,"hm",void 0),y(this,"am",void 0),y(this,"Se",void 0),this.k=null,this.Cw=new T(0,0).g(),this.Lw=new T(0,0).g(),this.$g=0,this.Zg=0,this.Qg=1,this._g="",this.tm="",this.im=!1,this.em=!1,this.sm=0,this.nm=0,this.om=!1,this.rm=!1,this.Lo=!1,this.lm=null,this.hm=0,this.am=null,this.Se=null}copy(){const t=new G;return this.clone(t)}clone(t){return t.k=this.k,t.Cw.a(this.viewPoint),t.Lw.a(this.documentPoint),t.$g=this.$g,t.Zg=this.Zg,t.Qg=this.Qg,t._g=this._g,t.tm=this.tm,t.im=this.im,t.em=this.em,t.sm=this.sm,t.nm=this.nm,t.om=this.om,t.rm=this.rm,t.Lo=this.Lo,t.lm=this.lm,t.hm=this.hm,t.am=this.am,t.Se=this.Se,t}toString(){let t="^";return 0!==this.modifiers&&(t+="M:"+this.modifiers),0!==this.button&&(t+="B:"+this.button),""!==this.key&&(t+="K:"+this.key),0!==this.clickCount&&(t+="C:"+this.clickCount),0!==this.delta&&(t+="D:"+this.delta),this.handled&&(t+="h"),this.bubbles&&(t+="b"),null!==this.documentPoint&&(t+="@"+this.documentPoint.toString()),t}get diagram(){return this.k}set diagram(t){this.k=t}get viewPoint(){return this.Cw}set viewPoint(t){this.Cw.a(t)}get documentPoint(){return this.Lw}set documentPoint(t){this.Lw.a(t)}getMultiTouchViewPoint(t,e){const i=this.diagram;return null===i||i.wC(this.event,t,e),e}getMultiTouchDocumentPoint(t,e){const i=this.diagram;return null===i||(i.wC(this.event,t,e),e.a(i.transformViewToDoc(e))),e}get modifiers(){return this.$g}set modifiers(t){this.$g=t}get button(){return this.Zg}set button(t){if(this.Zg=t,null===this.event)switch(t){case 0:return void(this.buttons=1);case 1:return void(this.buttons=4);case 2:return void(this.buttons=2)}}get buttons(){return this.Qg}set buttons(t){this.Qg=t}get key(){return this._g}set key(t){this._g=t}get code(){return this.tm}set code(t){this.tm=t}get down(){return this.im}set down(t){this.im=t}get up(){return this.em}set up(t){this.em=t}get clickCount(){return this.sm}set clickCount(t){this.sm=t}get delta(){return this.nm}set delta(t){this.nm=t}get isMultiTouch(){return this.om}set isMultiTouch(t){this.om=t}get handled(){return this.rm}set handled(t){this.rm=t}get bubbles(){return this.Lo}set bubbles(t){this.Lo=t}get event(){return this.lm}set event(t){this.lm=t}get isTouchEvent(){const t=this.event;return null!==t&&("touch"===t.pointerType||"pen"===t.pointerType)}get timestamp(){return this.hm}set timestamp(t){this.hm=t}get targetDiagram(){return this.am}set targetDiagram(t){this.am=t}get targetObject(){return this.Se}set targetObject(t){this.Se=t}get control(){return 0!==(1&this.modifiers)}set control(t){this.modifiers=t?1|this.modifiers:-2&this.modifiers}get shift(){return 0!==(4&this.modifiers)}set shift(t){this.modifiers=t?4|this.modifiers:-5&this.modifiers}get alt(){return 0!==(2&this.modifiers)}set alt(t){this.modifiers=t?2|this.modifiers:-3&this.modifiers}get meta(){return 0!==(8&this.modifiers)}set meta(t){this.modifiers=t?8|this.modifiers:-9&this.modifiers}get left(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(1&this.buttons):0===this.button}set left(t){t?this.buttons|=1:this.buttons&=-2}get right(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(2&this.buttons):2===this.button}set right(t){t?this.buttons|=2:this.buttons&=-3}get middle(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(4&this.buttons):1===this.button}set middle(t){t?this.buttons|=4:this.buttons&=-5}}class X{constructor(){y(this,"k",void 0),y(this,"St",void 0),y(this,"cm",void 0),y(this,"fm",void 0),this.k=null,this.St="",this.cm=null,this.fm=null}copy(){const t=new X;return t.k=this.k,t.St=this.St,t.cm=this.cm,t.fm=this.fm,t}toString(){let t="*"+this.name;return null!==this.subject&&(t+=":"+this.subject.toString()),null!==this.parameter&&(t+="("+this.parameter.toString()+")"),t}get diagram(){return this.k}set diagram(t){this.k=t}get name(){return this.St}set name(t){this.St=t}get subject(){return this.cm}set subject(t){this.cm=t}get parameter(){return this.fm}set parameter(t){this.fm=t}}var Y=(t=>(t[t.Transaction=1]="Transaction",t[t.Property=2]="Property",t[t.Insert=3]="Insert",t[t.Remove=4]="Remove",t))(Y||{});class _{constructor(){y(this,"uu",void 0),y(this,"um",void 0),y(this,"cn",void 0),y(this,"Si",void 0),y(this,"k",void 0),y(this,"du",void 0),y(this,"oc",void 0),y(this,"rc",void 0),y(this,"lc",void 0),y(this,"hc",void 0),this.uu=2,this.um="",this.cn="",this.Si=null,this.k=null,this.du=null,this.oc=null,this.rc=null,this.lc=null,this.hc=null}clear(){this.Si=null,this.k=null,this.du=null,this.oc=null,this.rc=null,this.lc=null,this.hc=null}copy(){const t=new _;t.uu=this.uu,t.um=this.um,t.cn=this.cn,t.Si=this.Si,t.k=this.k,t.du=this.du;let e=this.oc;return d.wt(e)&&"function"==typeof e.copyFrozen?t.oc=e.copyFrozen():t.oc=e,e=this.rc,d.wt(e)&&"function"==typeof e.copyFrozen?t.rc=e.copyFrozen():t.rc=e,e=this.lc,d.wt(e)&&"function"==typeof e.copyFrozen?t.lc=e.copyFrozen():t.lc=e,e=this.hc,d.wt(e)&&"function"==typeof e.copyFrozen?t.hc=e.copyFrozen():t.hc=e,t}li(t){t in Y?this.change=t:d.ar(this,t)}toString(){let t="";return 1===this.change?t+="* ":2===this.change?t+=null!==this.model?"!m":"!d":t+=(null!==this.model?"!m":"!d")+this.change,this.propertyName&&"string"==typeof this.propertyName&&(t+=" "+this.propertyName),this.modelChange&&this.modelChange!==this.propertyName&&(t+=" "+this.modelChange),t+=": ",1===this.change?null!==this.oldValue&&(t+=" "+this.oldValue):(null!==this.object&&(t+=d.toString(this.object)),null!==this.oldValue&&(t+="  old: "+d.toString(this.oldValue)),null!==this.oldParam&&(t+=" "+this.oldParam),null!==this.newValue&&(t+="  new: "+d.toString(this.newValue)),null!==this.newParam&&(t+=" "+this.newParam)),t}getValue(t){return t?this.oldValue:this.newValue}getParam(t){return t?this.oldParam:this.newParam}canUndo(){return null!==this.model||null!==this.diagram}undo(){this.canUndo()&&(null!==this.model?this.model.changeState(this,!0):null!==this.diagram&&this.diagram.xC(this,!0))}canRedo(){return null!==this.model||null!==this.diagram}redo(){this.canRedo()&&(null!==this.model?this.model.changeState(this,!1):null!==this.diagram&&this.diagram.xC(this,!1))}get model(){return this.Si}set model(t){this.Si=t}get diagram(){return this.k}set diagram(t){this.k=t}get change(){return this.uu}set change(t){this.uu=t}get modelChange(){return this.um}set modelChange(t){this.um=t}get propertyName(){return this.cn}set propertyName(t){this.cn=t}get isTransactionFinished(){return 1===this.uu&&("CommittedTransaction"===this.cn||"FinishedUndo"===this.cn||"FinishedRedo"===this.cn)}get object(){return this.du}set object(t){this.du=t}get oldValue(){return this.oc}set oldValue(t){this.oc=t}get oldParam(){return this.rc}set oldParam(t){this.rc=t}get newValue(){return this.lc}set newValue(t){this.lc=t}get newParam(){return this.hc}set newParam(t){this.hc=t}}y(_,"Transaction",1),y(_,"Property",2),y(_,"Insert",3),y(_,"Remove",4);class H{constructor(){y(this,"bC",void 0),y(this,"St",void 0),y(this,"Kk",void 0),this.bC=(new x).g(),this.St="",this.Kk=!1}toString(t){let e="Transaction: "+this.name+" "+this.changes.count.toString()+(this.isComplete?"":", incomplete");if(void 0!==t&&t>0){const t=this.changes.count;for(let i=0;i<t;i++){const t=this.changes.elt(i);null!==t&&(e+="\n  "+t.toString())}}return e}clear(){const t=this.changes;t.lt();for(let e=t.count-1;e>=0;e--){const i=t.elt(e);null!==i&&i.clear()}t.clear(),t.g()}canUndo(){return this.isComplete}undo(){if(this.canUndo())for(let t=this.changes.count-1;t>=0;t--){const e=this.changes.elt(t);null!==e&&e.undo()}}canRedo(){return this.isComplete}redo(){if(!this.canRedo())return;const t=this.changes.count;for(let e=0;e<t;e++){const t=this.changes.elt(e);null!==t&&t.redo()}}zD(t){const e=this.changes;for(let i=e.count-1;i>=t;i--){const t=e.elt(i);null!==t&&t.undo(),e.lt(),e.removeAt(i)}e.g()}optimize(){if(!this.isComplete)return;const t=this.changes;t.lt();const e=new L;for(let n=0;n<t.count;n++){const i=t.elt(n);if(null===i||2!==i.change||!i.object)continue;let s=e.get(i.object);s||(s=new L,e.set(i.object,s));const o=s.get(i.propertyName);null===o?s.set(i.propertyName,-1):(o>0&&t.setElt(o,null),s.set(i.propertyName,n))}let i=0;for(let n=0;n<t.count;n++){const e=t.elt(n);null!==e&&(n>i&&t.setElt(i,e),i++)}for(;t.length>i;)t.pop();t.g()}get changes(){return this.bC}get name(){return this.St}set name(t){this.St=t}get isComplete(){return this.Kk}set isComplete(t){this.Kk=t}}class q{constructor(t){y(this,"Aw",void 0),y(this,"Oi",void 0),y(this,"kC",void 0),y(this,"Is",void 0),y(this,"Yk",void 0),y(this,"dm",void 0),y(this,"Gn",void 0),y(this,"Gk",void 0),y(this,"Hk",void 0),y(this,"fn",void 0),y(this,"ac",void 0),y(this,"Tw",void 0),y(this,"Es",void 0),y(this,"Dw",void 0),y(this,"Fw",void 0),y(this,"gm",void 0),y(this,"Rw",void 0),this.Aw=new k,this.Oi=!1,this.kC=(new x).g(),this.Is=-1,this.Yk=999,this.Es=!1,this.dm=null,this.Gn=0,this.Gk=!1,this.Hk=23,this.fn=(new x).g(),this.ac=new x,this.Tw=!0,this.Dw=!1,this.Fw=!1,this.gm=!1,this.Rw=!1,t&&Object.assign(this,t)}toString(t){let e="UndoManager "+this.historyIndex+"<"+this.history.count+"<="+this.maxHistoryLength;e+="[";let i=this.nestedTransactionNames.count;for(let n=0;n<i;n++)n>0&&(e+=" "),e+=this.nestedTransactionNames.elt(n);if(e+="]",void 0!==t&&t>0){i=this.history.count;for(let n=0;n<i;n++)e+="\n "+this.history.elt(n).toString(t-1)}return e}clear(){const t=this.history;t.lt();for(let e=t.count-1;e>=0;e--){const i=t.elt(e);null!==i&&i.clear()}t.clear(),this.Is=-1,t.g(),this.Es=!1,this.dm=null,this.Gn=0,this.fn.lt(),this.fn.clear(),this.fn.g(),this.ac.clear(),this.Dw=!1,this.Fw=!1,this.gm=!1,this.Rw=!1}copyProperties(t){this.isEnabled=t.isEnabled,this.maxHistoryLength=t.maxHistoryLength,this.mm=t.mm}addModel(t){this.Aw.add(t)}removeModel(t){this.Aw.remove(t)}startTransaction(t){if(void 0===t&&(t=""),null===t&&(t=""),this.isUndoingRedoing)return!1;!0===this.Tw&&(this.Tw=!1,this.Gn++,this.Pl||this.t("StartingFirstTransaction",t,this.currentTransaction),this.Gn>0&&this.Gn--),this.isEnabled&&(this.fn.lt(),this.fn.add(t),this.fn.g(),null===this.currentTransaction?this.ac.add(0):this.ac.add(this.currentTransaction.changes.count)),this.Gn++;const e=1===this.transactionLevel;return e&&(this.Pl||this.t("StartedTransaction",t,this.currentTransaction)),e}commitTransaction(t){return void 0===t&&(t=""),this.PC(!0,t)}rollbackTransaction(){return this.PC(!1,"")}PC(t,e){if(this.isUndoingRedoing)return!1;this.mm&&this.transactionLevel<1&&d.ri("Ending transaction without having started a transaction: "+e);const i=1===this.transactionLevel;let n=this.currentTransaction;i&&t&&(this.Pl||this.t("CommittingTransaction",e,n));let s=0;if(this.transactionLevel>0&&(this.Gn--,this.isEnabled)){const t=this.fn.count;t>0&&(""===e&&(e=this.fn.elt(0)),this.fn.lt(),this.fn.removeAt(t-1),this.fn.g());const i=this.ac.count;i>0&&(s=this.ac.elt(i-1),this.ac.removeAt(i-1))}if(i){if(t){if(this.gm=!1,null===n&&""!==e&&(n=this.currentTransaction),this.isEnabled&&null!==n){const t=n;t.isComplete||(t.isComplete=!0,t.name=e),this.discardHistoryAfterIndex();const i=this.history;i.lt();const s=this.maxHistoryLength;if(s>=0)if(0===s)i.clear();else if(i.count>=s){const t=i.elt(0);null!==t&&t.clear(),i.removeAt(0),this.Is--}0!==s&&(0===i.count||i.get(i.count-1)!==t)&&(i.add(t),this.Is++),i.g(),n=t}this.Pl||this.t("CommittedTransaction",e,n)}else{this.Es=!0;try{this.isEnabled&&null!==n&&(n.isComplete=!0,n.undo())}finally{this.Pl||this.t("RolledBackTransaction",e,n),this.Es=!1}null!==n&&n.clear()}return this.dm=null,this.vw&&this.clear(),this.vw=!1,this.Ow=!1,!0}return this.isEnabled&&!t&&null!==n&&n.zD(s),!1}discardHistoryAfterIndex(){if(this.isUndoingRedoing||!this.canRedo())return;const t=this.history;t.lt();for(let e=t.count-1;e>this.historyIndex;e--){const i=t.elt(e);null!==i&&i.clear(),t.removeAt(e),this.gm=!0}t.g()}sE(t){this.Gn+=t,this.Gn<0&&(this.Gn=0)}canUndo(){if(!this.isEnabled||this.transactionLevel>0)return!1;const t=this.transactionToUndo;return!(null===t||!t.canUndo())}undo(){if(!this.canUndo())return;const t=this.transactionToUndo;try{this.Es=!0,this.t("StartingUndo","Undo",t),this.Is--,t.undo()}catch(e){d.ri("undo error: "+e.toString())}finally{this.t("FinishedUndo","Undo",t),this.Es=!1}}canRedo(){if(!this.isEnabled||this.transactionLevel>0)return!1;const t=this.transactionToRedo;return!(null===t||!t.canRedo())}redo(){if(!this.canRedo())return;const t=this.transactionToRedo;try{this.Es=!0,this.t("StartingRedo","Redo",t),this.Is++,t.redo()}catch(e){d.ri("redo error: "+e.toString())}finally{this.t("FinishedRedo","Redo",t),this.Es=!1}}t(t,e,i){void 0===i&&(i=null);const n=new _;n.change=1,n.propertyName=t,n.object=i,n.oldValue=e;const s=this.models;for(;s.next();){const t=s.value;n.model=t,t.Iw(n)}}handleChanged(t){if(this.isEnabled&&!this.isUndoingRedoing&&!this.skipsEvent(t)){let e=this.currentTransaction;null===e&&(e=new H,this.dm=e);const i=t.copy(),n=e.changes;if(n.lt(),n.add(i),n.g(),this.mm&&this.Hk>0&&this.transactionLevel<=0&&!this.Tw){const e=t.diagram;if(null!==e&&!1===e.Uh)return;d.ri("Change not within a transaction: "+i.toString()),this.Hk--}}}skipsEvent(t){if(null===t||1===t.change)return!0;const e=t.object;if(null===e)return!1;if(void 0!==e.layer){const t=e.layer;if(null!==t&&t.isTemporary)return!0}else if(e.isTemporary)return!0;return!1}get models(){return this.Aw.iterator}get isEnabled(){return this.Oi}set isEnabled(t){this.Oi=t}get transactionToUndo(){return this.historyIndex>=0&&this.historyIndex<=this.history.count-1?this.history.elt(this.historyIndex):null}get transactionToRedo(){return this.historyIndex<this.history.count-1?this.history.elt(this.historyIndex+1):null}get isUndoingRedoing(){return this.Es}get history(){return this.kC}get maxHistoryLength(){return this.Yk}set maxHistoryLength(t){this.Yk=t}get historyIndex(){return this.Is}get currentTransaction(){return this.dm}get transactionLevel(){return this.Gn}get isInTransaction(){return this.Gn>0}get mm(){return this.Gk}set mm(t){this.Gk=t}get nestedTransactionNames(){return this.fn}get vw(){return this.Dw}set vw(t){this.Dw=t}get Ow(){return this.Fw}set Ow(t){this.Fw=t}get Pl(){return this.Rw}set Pl(t){this.Rw=t}get isJustDiscarded(){return this.gm}}class W{constructor(){y(this,"k",void 0),y(this,"St",void 0),y(this,"Oi",void 0),y(this,"jk",void 0),y(this,"qk",void 0),y(this,"pm",void 0),y(this,"MC",void 0),k.Yi(this),this.k=Dt.ym(),this.St="",this.Oi=!0,this.jk=!1,this.qk=null,this.MC=new G,this.pm=-1}get diagram(){return this.k}set diagram(t){t instanceof Dt&&(this.k=t)}toString(){return""!==this.name?this.name+" Tool":d.nn(this.constructor)}updateAdornments(t){}canStart(){return this.isEnabled}doStart(){}doActivate(){this.isActive=!0}doDeactivate(){this.isActive=!1}doStop(){}doCancel(){this.transactionResult=null,this.stopTool()}stopTool(){const t=this.diagram;t.currentTool===this&&(t.currentTool=null,t.currentCursor="")}doMouseDown(){!this.isActive&&this.canStart()&&this.doActivate()}doMouseMove(){}doMouseUp(){this.stopTool()}doMouseWheel(){}canStartMultiTouch(){return!0}standardPinchZoomStart(){const t=this.diagram,e=t.lastInput,i=e.getMultiTouchViewPoint(0,T.X(NaN,NaN)),n=e.getMultiTouchViewPoint(1,T.X(NaN,NaN));if(!i.isReal()||!n.isReal())return T.s(i),void T.s(n);if(this.doCancel(),t.getInputOption("hasGestureZoom")){t.Wk=t.scale;const s=n.x-i.x,o=n.y-i.y,r=Math.sqrt(s*s+o*o);t.Jk=r,e.bubbles=!1}T.s(i),T.s(n)}standardPinchZoomMove(){const t=this.diagram,e=t.lastInput,i=e.getMultiTouchViewPoint(0,T.X(NaN,NaN)),n=e.getMultiTouchViewPoint(1,T.X(NaN,NaN));if(!i.isReal()||!n.isReal())return T.s(i),void T.s(n);if(this.doCancel(),t.getInputOption("hasGestureZoom")){const s=n.x-i.x,o=n.y-i.y,r=Math.sqrt(s*s+o*o)/t.Jk,a=new T((Math.min(n.x,i.x)+Math.max(n.x,i.x))/2,(Math.min(n.y,i.y)+Math.max(n.y,i.y))/2),l=t.Wk*r,h=t.commandHandler;if(l!==t.scale&&h.canResetZoom(l)){const e=t.zoomPoint;t.zoomPoint=a,h.resetZoom(l),t.zoomPoint=e}e.bubbles=!1}T.s(i),T.s(n)}doKeyDown(){"Escape"===this.diagram.lastInput.code&&this.doCancel()}doKeyUp(){}startTransaction(t){return void 0===t&&(t=this.name),this.transactionResult=null,this.diagram.startTransaction(t)}stopTransaction(){const t=this.diagram;return null===this.transactionResult?t.rollbackTransaction():t.commitTransaction(this.transactionResult)}standardMouseSelect(){const t=this.diagram;if(!t.allowSelect)return;const e=t.lastInput,i=t.findPartAt(e.documentPoint,!1);if(null!==i){if(d.hr?e.meta:e.control){t.v("ChangingSelection",t.selection);let e=i;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&(e.isSelected=!e.isSelected),t.v("ChangedSelection",t.selection)}else if(e.shift){if(!i.isSelected){t.v("ChangingSelection",t.selection);let e=i;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&(e.isSelected=!0),t.v("ChangedSelection",t.selection)}}else if(!i.isSelected){let e=i;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&t.select(e)}}else e.left&&!(d.hr?e.meta:e.control)&&!e.shift&&t.clearSelection()}standardMouseClick(t,e){void 0===t&&(t=null),void 0===e&&(e=t=>!t.layer.isTemporary);const i=this.diagram,n=i.lastInput,s=i.findObjectAt(n.documentPoint,t,e);return n.targetObject=s,this.XD(s,n,i),n.handled}XD(t,e,i){if(e.handled=!1,null!==t&&!t.isEnabledObject())return;let n=0;e.left?n=1===e.clickCount?1:2===e.clickCount?2:1:e.right&&1===e.clickCount&&(n=3);let s="ObjectSingleClicked";if(null!==t){switch(n){case 1:s="ObjectSingleClicked";break;case 2:s="ObjectDoubleClicked";break;case 3:s="ObjectContextClicked"}0!==n&&i.v(s,t)}else{switch(n){case 1:s="BackgroundSingleClicked";break;case 2:s="BackgroundDoubleClicked";break;case 3:s="BackgroundContextClicked"}0!==n&&i.v(s)}if(null!==t)for(;null!==t;){let i=null;switch(n){case 1:i=t.click;break;case 2:i=t.doubleClick?t.doubleClick:t.click;break;case 3:i=t.contextClick}if(null!==i&&(i(e,t),e.handled))break;t=t.panel}else{let t=null;switch(n){case 1:t=i.click;break;case 2:t=i.doubleClick?i.doubleClick:i.click;break;case 3:t=i.contextClick}null!==t&&t(e)}}standardMouseOver(){const t=this.diagram,e=t.lastInput;if(!0===t.animationManager.xi)return;const i=t.skipsUndoManager;t.skipsUndoManager=!0;let n=t.viewportBounds.containsPoint(e.documentPoint)?t.findObjectAt(e.documentPoint,null,null):null;e.event&&("pointercancel"===e.event.type||"pointerout"===e.event.type)&&(n=null),e.targetObject=n;let s=!1;if(n!==t.cc){let i=t.cc;const o=i;for(t.cc=n,this.doCurrentObjectChanged(i,n),e.handled=!1;null!==i;){const t=i.mouseLeave;if(null!==t&&(n===i||null!==n&&n.isContainedBy(i)||(t(e,i,n),s=!0,e.handled)))break;i=i.panel}for(i=o,e.handled=!1;null!==n;){const t=n.mouseEnter;if(null!==t&&(i===n||null!==i&&i.isContainedBy(n)||(t(e,n,i),s=!0,e.handled)))break;n=n.panel}n=t.cc}if(null!==n){let i=n,o="";for(;null!==i&&(o=i.cursor,""===o);)i=i.panel;for(t.currentCursor=o,e.handled=!1,i=n;null!==i;){const t=i.mouseOver;if(null!==t&&(t(e,i),s=!0,e.handled))break;i=i.panel}}else{this.doUpdateCursor(null);const i=t.mouseOver;null!==i&&(i(e),s=!0)}s&&t.requestUpdate(),t.skipsUndoManager=i}doUpdateCursor(t){const e=this.diagram;e&&(e.currentCursor="")}doCurrentObjectChanged(t,e){}standardMouseWheel(){const t=this.diagram,e=t.lastInput;let i=e.delta;if(0===i||!t.documentBounds.isReal())return;const n=t.commandHandler,s=t.toolManager.mouseWheelBehavior;if(null!==n&&(2===s&&!e.shift||1===s&&e.control)){if(i>0?n.canIncreaseZoom():n.canDecreaseZoom()){const s=t.zoomPoint;t.zoomPoint=e.viewPoint,i>0?n.increaseZoom():n.decreaseZoom(),t.zoomPoint=s}e.bubbles=!1}else if(2===s&&e.shift||1===s&&!e.control){const n=t.position.copy(),s=e.event,o=s.deltaMode;let r=s.deltaX,a=s.deltaY,l="pixel";if(0===r&&0===a||e.shift)!e.shift&&t.allowVerticalScroll?(i=3*i*t.scrollVerticalLineChange,t.scroll(l,i>0?"up":"down",Math.abs(i))):e.shift&&t.allowHorizontalScroll&&(i=3*i*t.scrollHorizontalLineChange,t.scroll(l,i>0?"left":"right",Math.abs(i)));else{switch(o){case 0:l="pixel";break;case 1:l="line";break;case 2:l="page"}if(0!==r&&t.allowHorizontalScroll){r*=t.scrollHorizontalLineChange/16,t.scroll(l,r>0?"right":"left",Math.abs(r))}if(0!==a&&t.allowVerticalScroll){a*=t.scrollVerticalLineChange/16,t.scroll(l,a>0?"down":"up",Math.abs(a))}}this.doWheelChange(t,n,e)}}doWheelChange(t,e,i){(!t.position.equals(e)||0!==i.event.wheelDeltaX)&&(i.bubbles=!1)}standardWaitAfter(t,e){void 0===e&&(e=this.diagram.lastInput),this.cancelWaitAfter();const i=this,n=e.clone(this.MC);this.pm=d.Ih((()=>i.doWaitAfter(n)),t)}cancelWaitAfter(){-1!==this.pm&&d.Eg(this.pm),this.pm=-1}doWaitAfter(t){}findToolHandleAt(t,e){const i=this.diagram.findObjectAt(t,(t=>{for(;null!==t&&!(t.panel instanceof Pe);)t=t.panel;return t}));return null===i?null:i.part.category===e?i:null}isBeyondDragSize(t,e){const i=this.diagram;void 0===t&&(t=i.firstInput.viewPoint),void 0===e&&(e=i.lastInput.viewPoint);const n=i.toolManager.dragSize;let s=n.width,o=n.height;return i.firstInput.isTouchEvent&&(s+=6,o+=6),Math.abs(e.x-t.x)>s||Math.abs(e.y-t.y)>o}get name(){return this.St}set name(t){d.i(t,"string",W,"name"),this.St=t}get isEnabled(){return this.Oi}set isEnabled(t){d.i(t,"boolean",W,"isEnabled"),this.Oi=t}get isActive(){return this.jk}set isActive(t){d.i(t,"boolean",W,"isActive"),this.jk=t}get transactionResult(){return this.qk}set transactionResult(t){null!==t&&d.i(t,"string",W,"transactionResult"),this.qk=t}}var $=(t=>(t[t.Scroll=1]="Scroll",t[t.Zoom=2]="Zoom",t[t.None=3]="None",t))($||{}),J=(t=>(t[t.Zoom=1]="Zoom",t[t.Cancel=2]="Cancel",t[t.None=3]="None",t))(J||{});class Z extends W{constructor(t){super(),y(this,"SC",void 0),y(this,"NC",void 0),y(this,"CC",void 0),y(this,"$k",void 0),y(this,"Zk",void 0),y(this,"Qk",void 0),y(this,"_k",void 0),y(this,"tP",void 0),y(this,"iP",void 0),y(this,"eP",void 0),y(this,"wm",void 0),y(this,"Bh",void 0),this.name="ToolManager",this.SC=new x,this.NC=new x,this.CC=new x,this.$k=850,this.Zk=850,this.Qk=new A(2,2).et(),this._k=5e3,this.tP=1,this.iP=1,this.eP=null,this.wm=null,this.Bh=-1,t&&Object.assign(this,t)}get mouseWheelBehavior(){return this.tP}set mouseWheelBehavior(t){this.tP=t}get gestureBehavior(){return this.iP}set gestureBehavior(t){this.iP=t}initializeStandardTools(){}updateAdornments(t){const e=this.currentToolTip;if(e instanceof Pe&&this.wm===t){const i=e.adornedObject;(null!==t?i.part===t:null===i)?this.showToolTip(e,i):this.hideToolTip()}}doMouseDown(){const t=this.diagram,e=t.lastInput;if(e.isTouchEvent&&2===this.gestureBehavior&&(e.bubbles=!1),e.isMultiTouch){if(this.cancelWaitAfter(),3===this.gestureBehavior)return void(e.bubbles=!0);if(2===this.gestureBehavior)return;if(t.currentTool.canStartMultiTouch())return void t.currentTool.standardPinchZoomStart()}t.undoManager;const i=this.mouseDownTools.length;for(let n=0;n<i;n++){const e=this.mouseDownTools.elt(n);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseDown()))}1===t.lastInput.button&&(1===this.mouseWheelBehavior?this.mouseWheelBehavior=2:2===this.mouseWheelBehavior&&(this.mouseWheelBehavior=1)),this.doActivate(),this.standardWaitAfter(this.holdDelay,e)}doMouseMove(){const t=this.diagram,e=t.lastInput;if(e.isMultiTouch){if(3===this.gestureBehavior)return void(e.bubbles=!0);if(2===this.gestureBehavior)return;if(t.currentTool.canStartMultiTouch())return void t.currentTool.standardPinchZoomMove()}if(this.isActive){const e=this.mouseMoveTools.length;for(let i=0;i<e;i++){const e=this.mouseMoveTools.elt(i);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseMove()))}}this.standardMouseActivity(t);const i=e.event;null!==i&&("pointermove"===i.type||!i.cancelable)&&(e.bubbles=!0)}standardMouseActivity(t){this.standardMouseOver(),this.isBeyondDragSize()&&this.standardWaitAfter(this.isActive?this.holdDelay:this.hoverDelay,t.lastInput)}doCurrentObjectChanged(t,e){const i=this.currentToolTip;null!==i&&(null!==e&&i instanceof Pe&&(e===i||e.isContainedBy(i))||this.hideToolTip())}doWaitAfter(t){const e=this.diagram;if(e.KD()&&(this.doMouseHover(),this.isActive||this.doToolTip(),t.isTouchEvent&&!e.lastInput.handled)){const i=t.copy();return i.button=2,i.buttons=2,e.lastInput=i,e.Ew=!0,void e.doMouseUp()}}doMouseHover(){const t=this.diagram,e=t.lastInput;null===e.targetObject&&(e.targetObject=t.findObjectAt(e.documentPoint,null,null));let i=e.targetObject;if(null!==i)for(e.handled=!1;null!==i;){const t=this.isActive?i.mouseHold:i.mouseHover;if(null!==t&&(t(e,i),e.handled))break;i=i.panel}else{const i=this.isActive?t.mouseHold:t.mouseHover;null!==i&&i(e)}}doToolTip(){const t=this.diagram,e=t.lastInput;null===e.targetObject&&(e.targetObject=t.findObjectAt(e.documentPoint,null,null));let i=e.targetObject;if(null!==i){const t=this.currentToolTip;if(t instanceof Pe&&(i===t||i.isContainedBy(t)))return;for(;null!==i;){const t=i.toolTip;if(null!==t)return void this.showToolTip(t,i);i=i.panel}this.hideToolTip()}else{const e=t.toolTip;null!==e?this.showToolTip(e,null):this.hideToolTip()}}showToolTip(t,e){const i=this.diagram;if(t!==this.currentToolTip&&this.hideToolTip(),t instanceof Pe){t.layerName="Tool",t.selectable=!1,t.scale=1/i.scale,t.category="ToolTip",t.hasPlaceholder()&&(t.placeholder.scale=i.scale);const n=t.diagram;null!==n&&n!==i&&n.remove(t),i.add(t),null!==e?t.adornedObject=e:t.data=i.model,t.ensureBounds(),this.positionToolTip(t,e)}else t instanceof ft&&t!==this.currentToolTip&&t.show(e,i,this);this.currentToolTip=t,-1!==this.Bh&&(d.Eg(this.Bh),this.Bh=-1);const n=this.toolTipDuration;if(n>0&&n!==1/0){const t=this;this.Bh=d.Ih((()=>t.hideToolTip()),n)}}positionToolTip(t,e){if(t.hasPlaceholder())return;const i=t,n=this.diagram,s=n.lastInput.documentPoint.copy(),o=i.measuredBounds,r=n.viewportBounds;n.lastInput.isTouchEvent&&(s.x-=o.width),s.x+o.width>r.right&&(s.x-=o.width+5/n.scale),s.x<r.x&&(s.x=r.x),s.y+20/n.scale+o.height>r.bottom?s.y-=o.height+5/n.scale:s.y+=20/n.scale,s.y<r.y&&(s.y=r.y),i.position=s}hideToolTip(){-1!==this.Bh&&(d.Eg(this.Bh),this.Bh=-1);const t=this.diagram,e=this.currentToolTip;null!==e&&(e instanceof Pe?(t.remove(e),null!==this.wm&&this.wm.removeAdornment(e.category),e.data=null,e.adornedObject=null):e instanceof ft&&null!==e.hide&&e.hide(t,this),this.currentToolTip=null)}get currentToolTip(){return this.eP}set currentToolTip(t){this.eP=t,this.wm=null!==t&&t instanceof Pe?t.adornedPart:null}doMouseUp(){this.cancelWaitAfter();const t=this.diagram;if(this.isActive){const e=this.mouseUpTools.length;for(let i=0;i<e;i++){const e=this.mouseUpTools.elt(i);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseUp()))}}t.doFocus(),this.doDeactivate()}doMouseWheel(){this.standardMouseWheel()}doKeyDown(){const t=this.diagram;null!==t.commandHandler&&t.commandHandler.doKeyDown()}doKeyUp(){const t=this.diagram;null!==t.commandHandler&&t.commandHandler.doKeyUp()}findTool(t){d.i(t,"string",Z,"findTool:name");let e=this.mouseDownTools.length;for(let i=0;i<e;i++){const e=this.mouseDownTools.elt(i);if(e.name===t)return e}e=this.mouseMoveTools.length;for(let i=0;i<e;i++){const e=this.mouseMoveTools.elt(i);if(e.name===t)return e}e=this.mouseUpTools.length;for(let i=0;i<e;i++){const e=this.mouseUpTools.elt(i);if(e.name===t)return e}return null}replaceTool(t,e){d.i(t,"string",Z,"replaceTool:name"),null!==e&&(e.diagram=this.diagram);let i=this.mouseDownTools.length;for(let n=0;n<i;n++){const i=this.mouseDownTools.elt(n);if(i.name===t)return null!==e?this.mouseDownTools.setElt(n,e):this.mouseDownTools.removeAt(n),i}i=this.mouseMoveTools.length;for(let n=0;n<i;n++){const i=this.mouseMoveTools.elt(n);if(i.name===t)return null!==e?this.mouseMoveTools.setElt(n,e):this.mouseMoveTools.removeAt(n),i}i=this.mouseUpTools.length;for(let n=0;n<i;n++){const i=this.mouseUpTools.elt(n);if(i.name===t)return null!==e?this.mouseUpTools.setElt(n,e):this.mouseUpTools.removeAt(n),i}return null}replaceStandardTool(t,e,i){this.$t(t,e,i)}$t(t,e,i){d.i(t,"string",Z,"replaceStandardTool:name"),null!==e&&(e.name=t,e.diagram=this.diagram),this.findTool(t)?this.replaceTool(t,e):null!==e&&i.add(e)}get mouseDownTools(){return this.SC}get mouseMoveTools(){return this.NC}get mouseUpTools(){return this.CC}get hoverDelay(){return this.$k}set hoverDelay(t){d.i(t,"number",Z,"hoverDelay"),this.$k=t}get holdDelay(){return this.Zk}set holdDelay(t){d.i(t,"number",Z,"holdDelay"),this.Zk=t}get dragSize(){return this.Qk}set dragSize(t){this.Qk=t.N()}get toolTipDuration(){return this._k}set toolTipDuration(t){d.i(t,"number",Z,"toolTipDuration"),this._k=t}get actionTool(){return this.findTool("Action")}set actionTool(t){this.$t("Action",t,this.mouseDownTools)}get relinkingTool(){return this.findTool("Relinking")}set relinkingTool(t){this.$t("Relinking",t,this.mouseDownTools)}get linkReshapingTool(){return this.findTool("LinkReshaping")}set linkReshapingTool(t){this.$t("LinkReshaping",t,this.mouseDownTools)}get resizingTool(){return this.findTool("Resizing")}set resizingTool(t){this.$t("Resizing",t,this.mouseDownTools)}get rotatingTool(){return this.findTool("Rotating")}set rotatingTool(t){this.$t("Rotating",t,this.mouseDownTools)}get linkingTool(){return this.findTool("Linking")}set linkingTool(t){this.$t("Linking",t,this.mouseMoveTools)}get draggingTool(){return this.findTool("Dragging")}set draggingTool(t){this.$t("Dragging",t,this.mouseMoveTools)}get dragSelectingTool(){return this.findTool("DragSelecting")}set dragSelectingTool(t){this.$t("DragSelecting",t,this.mouseMoveTools)}get panningTool(){return this.findTool("Panning")}set panningTool(t){this.$t("Panning",t,this.mouseMoveTools)}get contextMenuTool(){return this.findTool("ContextMenu")}set contextMenuTool(t){this.$t("ContextMenu",t,this.mouseUpTools)}get textEditingTool(){return this.findTool("TextEditing")}set textEditingTool(t){this.$t("TextEditing",t,this.mouseUpTools)}get clickCreatingTool(){return this.findTool("ClickCreating")}set clickCreatingTool(t){this.$t("ClickCreating",t,this.mouseUpTools)}get clickSelectingTool(){return this.findTool("ClickSelecting")}set clickSelectingTool(t){this.$t("ClickSelecting",t,this.mouseUpTools)}}y(Z,"WheelScroll",1),y(Z,"WheelZoom",2),y(Z,"WheelNone",3),y(Z,"GestureZoom",1),y(Z,"GestureCancel",2),y(Z,"GestureNone",3);class Q extends W{constructor(t){super(),y(this,"sP",void 0),y(this,"nP",void 0),y(this,"un",void 0),y(this,"oP",void 0),y(this,"rP",void 0),y(this,"lP",void 0),y(this,"hP",void 0),y(this,"fc",void 0),y(this,"xm",void 0),y(this,"aP",void 0),y(this,"zh",void 0),y(this,"yr",void 0),y(this,"LC",void 0),y(this,"cP",void 0),y(this,"gu",void 0),y(this,"mu",void 0),y(this,"fP",void 0),y(this,"uP",void 0),y(this,"dP",void 0),y(this,"gP",void 0),this.name="Dragging",this.sP=!0,this.gP=!0,this.nP=!0,this.un=null,this.oP=null,this.rP=null,this.lP=null,this.hP=!1,this.gu=!1,this.fc=new T(NaN,NaN),this.xm=new T,this.aP=!0,this.zh=100,this.yr=[],this.LC=(new k).g(),this.cP=new Et,this.mu=null,this.fP="copy",this.uP="",this.dP="no-drop",t&&Object.assign(this,t)}get isCopyEnabled(){return this.sP}set isCopyEnabled(t){d.i(t,"boolean",Q,"isCopyEnabled"),this.sP=t}get copiesEffectiveCollection(){return this.nP}set copiesEffectiveCollection(t){d.i(t,"boolean",Q,"copiesEffectiveCollection"),this.nP=t}get dragOptions(){return this.cP}set dragOptions(t){this.cP=t}get isGridSnapEnabled(){return this.dragOptions.isGridSnapEnabled}set isGridSnapEnabled(t){d.i(t,"boolean",Q,"isGridSnapEnabled"),this.dragOptions.isGridSnapEnabled=t}get isComplexRoutingRealtime(){return this.aP}set isComplexRoutingRealtime(t){this.aP=t;const e=this.diagram.findRouter("AvoidsLinks");null!==e&&(e.isRealtime=t)}get isGridSnapRealtime(){return this.dragOptions.isGridSnapRealtime}set isGridSnapRealtime(t){d.i(t,"boolean",Q,"isGridSnapRealtime"),this.dragOptions.isGridSnapRealtime=t}get gridSnapCellSize(){return this.dragOptions.gridSnapCellSize}set gridSnapCellSize(t){this.dragOptions.gridSnapCellSize.equals(t)||(t=t.N(),this.dragOptions.gridSnapCellSize=t)}get gridSnapCellSpot(){return this.dragOptions.gridSnapCellSpot}set gridSnapCellSpot(t){this.dragOptions.gridSnapCellSpot.equals(t)||(t=t.N(),this.dragOptions.gridSnapCellSpot=t)}get gridSnapOrigin(){return this.dragOptions.gridSnapOrigin}set gridSnapOrigin(t){this.dragOptions.gridSnapOrigin.equals(t)||(t=t.N(),this.dragOptions.gridSnapOrigin=t)}get dragsLink(){return this.dragOptions.dragsLink}set dragsLink(t){d.i(t,"boolean",Q,"dragsLink"),this.dragOptions.dragsLink=t}get dragsTree(){return this.dragOptions.dragsTree}set dragsTree(t){d.i(t,"boolean",Q,"dragsTree"),this.dragOptions.dragsTree=t}get copyCursor(){return this.fP}set copyCursor(t){this.fP=t}get moveCursor(){return this.uP}set moveCursor(t){this.uP=t}get nodropCursor(){return this.dP}set nodropCursor(t){this.dP=t}get currentPart(){return this.oP}set currentPart(t){this.oP=t}get copiedParts(){return this.lP}set copiedParts(t){this.lP=t}get draggedParts(){return this.rP}set draggedParts(t){this.rP=t}get draggingParts(){return null!==this.copiedParts?this.copiedParts.toKeySet():null!==this.draggedParts?this.draggedParts.toKeySet():this.LC}get draggedLink(){return this.diagram.draggedLink}set draggedLink(t){this.diagram.draggedLink=t}get isDragOutStarted(){return this.hP}set isDragOutStarted(t){this.hP=t}get startPoint(){return this.xm}set startPoint(t){this.xm.equals(t)||this.xm.a(t)}get delay(){return this.zh}set delay(t){d.i(t,"number",Q,"delay"),this.zh=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(t.isReadOnly&&!t.allowDragOut||!t.allowMove&&!t.allowCopy&&!t.allowDragOut||!t.allowSelect)return!1;const e=t.lastInput;return!(!e.left||t.currentTool!==this&&(!this.isBeyondDragSize()||e.isTouchEvent&&e.timestamp-t.firstInput.timestamp<this.zh))&&null!==this.findDraggablePart()}findDraggablePart(){const t=this.diagram;let e=t.findPartAt(t.firstInput.documentPoint,!1);if(null===e)return null;for(;null!==e&&!e.canSelect();)e=e.containingGroup;return null!==e&&(e.canMove()||e.canCopy())?e:null}standardMouseSelect(){const t=this.diagram;if(!t.allowSelect)return;let e=t.findPartAt(t.firstInput.documentPoint,!1);if(null!==e){for(;null!==e&&!e.canSelect();)e=e.containingGroup;if(this.currentPart=e,null!==this.currentPart&&!this.currentPart.isSelected){t.v("ChangingSelection",t.selection);const e=t.lastInput;!(d.hr?e.meta:e.control)&&!e.shift&&t.clearSelection(!0),this.currentPart.isSelected=!0,t.v("ChangedSelection",t.selection)}}}doActivate(){const t=this.diagram;this.mu=null,null===this.currentPart&&this.standardMouseSelect();const e=this.currentPart;if(null===e||!e.canMove()&&!e.canCopy())return;t.cacheGroupExternalLinks(!0),Q.yt=null,this.isActive=!0,this.fc.set(t.position),this.mP(t.selection),this.yr.length=0,t.animationManager.stopAnimation();const i=this.computeEffectiveCollection(t.selection,this.dragOptions);this.draggedParts=i,this.gP=this.diagram.layout.isRealtime,this.diagram.layout.isRealtime=!1,t.bm=!0,!0===t.getRenderingHint("temporaryPixelRatio")&&t.avgSpf>30&&t.Vw(),t.Uw(this.draggedParts),t.pu=!0,this.startTransaction("Drag"),this.startPoint=t.firstInput.documentPoint,t.isMouseCaptured=!0,t.allowDragOut&&this.YD()}mP(t){if(this.dragsLink){const e=this.diagram;if(!e.allowRelink)return;e.model.uc()&&1===t.count&&t.first()instanceof De?(this.draggedLink=t.first(),this.draggedLink.canRelinkFrom()&&this.draggedLink.canRelinkTo()&&this.draggedLink.clearAdornments(),this.un=e.toolManager.findTool("Relinking"),null===this.un&&(this.un=new nt,this.un.diagram=e),this.un.originalLink=this.draggedLink):(this.draggedLink=null,this.un=null)}}computeEffectiveCollection(t,e){return this.diagram.commandHandler.computeEffectiveCollection(t,e)}Vs(t){return void 0===t?new Ot(T.Mo):this.isGridSnapEnabled?new Ot(new T(Math.round(1e3*t.x)/1e3,Math.round(1e3*t.y)/1e3)):new Ot(t.copy())}doDeactivate(){this.isActive=!1;const t=this.diagram;this.diagram.layout.isRealtime=this.gP,t.pu=!1,t.Ml=!0,t.cacheGroupExternalLinks(!1),t.stopAutoScroll(),this.pP(),t.km(this.draggedParts),this.mu=null,this.currentPart=null,this.draggedParts=null,this.isDragOutStarted=!1,this.gu=!1,Q.GD(),this.AC(),this.fc.e(NaN,NaN),null!==Q.Xh&&(Q.Xh.currentCursor=""),Q.Xh=null,Q.yt=null,this.Sl(),t.isMouseCaptured=!1,t.currentCursor="",t.bm=!1,this.stopTransaction(),t.yP(!0)}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}pP(){const t=this.diagram,e=t.skipsUndoManager;t.skipsUndoManager=!0;const i=t.lastInput;this.TC(i,null),t.skipsUndoManager=e,this.yr.length=0}DC(){this.Sl(),this.wP();const t=this.diagram;this.fc.isReal()&&(t.position=this.fc),t.stopAutoScroll()}doCancel(){this.Sl(),this.wP();const t=this.diagram;this.fc.isReal()&&(t.position=this.fc),this.stopTool()}doKeyDown(){const t=this.diagram,e=t.lastInput;this.isActive&&("Escape"===e.code?this.doCancel():e.code!==t.previousInput.code&&this.doMouseMove())}doKeyUp(){this.isActive&&this.doMouseMove()}HD(t,e){let i=1/0,n=1/0,s=-1/0,o=-1/0;const r=t.iterator;for(;r.next();){const t=r.value;if(!t.isVisible())continue;const e=t.location,a=e.x,l=e.y;isNaN(a)||isNaN(l)||(a<i&&(i=a),l<n&&(n=l),a>s&&(s=a),l>o&&(o=l))}return i===1/0?e.e(0,0,0,0):e.e(i,n,s-i,o-n),e}xP(t){if(null!==this.copiedParts)return;const e=this.diagram;if(t&&(e.isReadOnly||e.isModelReadOnly)||null===this.draggedParts)return;const i=e.undoManager;i.isEnabled&&i.isInTransaction?null!==i.currentTransaction&&i.currentTransaction.changes.count>0&&(e.undoManager.rollbackTransaction(),e.startTransaction("Drag")):this.wP(),e.skipsUndoManager=!t,e.partManager.addsToTemporaryLayer=!t,this.startPoint=e.firstInput.documentPoint;const n=this.copiesEffectiveCollection?this.draggedParts.toKeySet():e.selection,s=e.copyParts(n,e,!0),o=new L,r=this.draggedParts.iterator;for(;r.next();){const t=r.key;if(t.Ne()&&t.canCopy()){const e=s.getValue(t);if(null===e)continue;e.location=t.location,e.ensureBounds(),o.add(e,this.Vs(e.location))}}const a=s.iterator;for(;a.next();){const t=a.value;t instanceof De&&t.canCopy()&&o.add(t,this.Vs())}if(this.copiedParts=o,this.mP(o.toKeySet()),null!==this.draggedLink){const t=this.draggedLink,e=t.routeBounds;t.wr(this.startPoint.x-(e.x+e.width/2),this.startPoint.y-(e.y+e.height/2))}this.doUpdateCursor(null)}Sl(){const t=this.diagram;if(null!==this.copiedParts){if(t.removeParts(this.copiedParts.toKeySet(),!1),this.copiedParts=null,null!==this.draggedParts){const t=this.draggedParts.iterator;for(;t.next();)if(t.key instanceof De){t.value.point=new T(0,0)}}this.doUpdateCursor(null)}t.skipsUndoManager=!1,t.partManager.addsToTemporaryLayer=!1,this.startPoint=t.firstInput.documentPoint}AC(){null!==this.draggedLink&&(this.dragsLink&&null!==this.un&&(this.un.stopDraggingMouseMove(),this.un.originalLink=null),this.draggedLink=null,this.un=null)}dc(t,e){const i=this.diagram,n=this.startPoint,s=T.l();s.a(i.lastInput.documentPoint),this.moveParts(t,s.subtract(n),e),T.s(s),!0===i.getRenderingHint("temporaryPixelRatio")&&null===i.Nl&&i.avgSpf>30&&(i.Vw(),i.yu())}moveParts(t,e,i){void 0===i&&(i=!1);const n=this.diagram;null!==n&&n.bP(t,e,this.dragOptions,i)}wP(){if(null===this.draggedParts)return;const t=this.diagram;let e=this.draggedParts.iterator;for(;e.next();){const t=e.key;t.Ne()&&(t.location=e.value.point)}for(e=this.draggedParts.iterator;e.next();){const t=e.key;if(t instanceof De&&t.dn){const i=e.value.point;this.draggedParts.add(t,this.Vs()),t.wr(-i.x,-i.y)}}t.maybeUpdate()}jD(t){if(null===t)return!0;const e=t.part;return!!(null===e||e instanceof Pe||e.layer.isTemporary||this.draggedParts&&this.draggedParts.contains(e)||this.copiedParts&&this.copiedParts.contains(e))}kP(t){const e=this.diagram;this.dragsLink&&(null!==this.draggedLink&&(this.draggedLink.fromNode=null,this.draggedLink.toNode=null),this.FC(!1));const i=this.findDragOverObject(t),n=e.lastInput;n.targetObject=i,this.doUpdateCursor(i);const s=e.skipsUndoManager;let o=!1;try{if(e.skipsUndoManager=!0,o=this.TC(n,i),!this.isActive&&null===Q.yt)return;const s=null!==i?i.part:null;if(null===s||e.handlesDragDropForTopLevelParts&&s.isTopLevel&&!(s instanceof Ve)){const t=e.mouseDragOver;null!==t&&(t(n),o=!0)}if(!this.isActive&&null===Q.yt||(this.doDragOver(t,i),!this.isActive&&null===Q.yt))return}finally{e.skipsUndoManager=s,o&&e.maybeUpdate()}this.mu=i,!e.isReadOnly&&(e.allowMove||e.allowCopy)&&(e.allowHorizontalScroll||e.allowVerticalScroll)&&e.doAutoScroll(n.viewPoint)}findDragOverObject(t){return this.diagram.PP(t,null,(t=>!this.jD(t)))}doUpdateCursor(t){const e=this.diagram;(null===t||this.mu!==t)&&(!this.diagram.currentTool.isActive||this.mayCopy()?e.currentCursor=this.copyCursor:this.mayMove()?e.currentCursor=this.moveCursor:this.mayDragOut()&&(e.currentCursor=this.nodropCursor))}TC(t,e){let i=!1,n=this.yr.length;const s=n>0?this.yr[0]:null;if(e===s)return!1;t.handled=!1;for(let r=0;r<n;r++){const n=this.yr[r],s=n.mouseDragLeave;if(null!==s&&(s(t,n,e),i=!0,t.handled))break}if(this.yr.length=0,!this.isActive&&null===Q.yt||null===e)return i;t.handled=!1;let o=e;for(;null!==o;)this.yr.push(o),o=this.RC(o);n=this.yr.length;for(let r=0;r<n;r++){const e=this.yr[r],n=e.mouseDragEnter;if(null!==n&&(n(t,e,s),i=!0,t.handled))break}return i}nE(t,e){return null!==t&&!!(t===e||t.isContainedBy(e)||e instanceof Ve&&!(t instanceof Ve)&&e.handlesDragDropForMembers&&t.part.isMemberOf(e))}RC(t){const e=t.panel;if(null!==e)return e;if(t instanceof ke&&!(t instanceof Ve)){const e=t.containingGroup;if(null!==e&&e.handlesDragDropForMembers)return e}return null}vC(t,e){const i=this.diagram,n=this.un;if(null===n)return null;const s=n.portGravity,o=i.findObjectsNear(t,s,(t=>n.findValidLinkablePort(t,e))),r=T.l();let a=1/0,l=null;for(const h=o.iterator;h.next();){const e=h.value;if(null===e.part)continue;const i=e.getDocumentPoint(O.Center,r),n=t.distanceSquaredPoint(i);n<a&&(l=e,a=n)}return T.s(r),l}FC(t){const e=this.draggedLink;if(null!==e){if(e.pointsCount<2)return;const i=this.diagram;if(i.isReadOnly)return;const n=this.un;if(null===n)return;let s=null,o=null;null===e.fromNode&&(s=this.vC(e.getPoint(0),!1),null!==s&&(o=s.part));let r=null,a=null;null===e.toNode&&(r=this.vC(e.getPoint(e.pointsCount-1),!0),null!==r&&(a=r.part)),n.isValidLink(o,s,a,r)?t?(e.defaultFromPoint=e.getPoint(0),e.defaultToPoint=e.getPoint(e.pointsCount-1),e.dn=!1,e.fromNode=o,null!==s&&(e.fromPortId=s.portId),e.toNode=a,null!==r&&(e.toPortId=r.portId),e.fromPort!==i.MP&&i.v("LinkRelinked",e,i.MP),e.toPort!==i.SP&&i.v("LinkRelinked",e,i.SP)):n.doDraggingMouseMove(o,s,a,r):n.doDraggingMouseMove(null,null,null,null)}}doDragOver(t,e){}OC(t){const e=this.diagram;this.dragsLink&&this.FC(!0),this.pP();const i=this.findDragOverObject(t),n=e.lastInput;if(n.targetObject=i,null!==i){n.handled=!1;let t=i;for(;null!==t;){const e=t.mouseDrop;if(null!==e&&(e(n,t),n.handled))break;this.qD(n,t),t=this.RC(t)}}else{const t=e.mouseDrop;null!==t&&t(n)}if(!this.isActive&&null===Q.yt)return;const s=(this.copiedParts||this.draggedParts).iterator;for(;s.next();){const t=s.key;t instanceof Ce&&t.linksConnected.each((t=>t.dn=!1))}if(this.doDropOnto(t,i),!this.isActive&&null===Q.yt)return;const o=D.l(),r=e.selection.iterator;for(;r.next();){const t=r.value;t instanceof Ce&&this.WD(e,t,o)}D.s(o)}qD(t,e){const i=this.diagram,n=e.part;if(i.handlesDragDropForTopLevelParts&&n.isTopLevel&&!(n instanceof Ve)){const e=i.mouseDrop;null!==e&&e(t)}}WD(t,e,i){if(!e.canAvoid())return;let n=!1;i=e.getAvoidableRect(i),t.viewportBounds.containsRect(i)&&(n=!0);const s=this.copiedParts||this.draggedParts,o=t.NP(i,(t=>t.part),(t=>t instanceof De),!0,(t=>t instanceof De),n);if(0===o.count)return;const r=o.iterator;for(;r.next();){const t=r.value;s.contains(t)&&s.contains(e)||!t.isMemberOf(e)&&t.isAvoiding&&t.invalidateRoute()}}doDropOnto(t,e){}doMouseMove(){if(!this.isActive)return;const t=this.diagram,e=t.lastInput;this.simulatedMouseMove(e.event,e.documentPoint,e.targetDiagram)||null!==this.currentPart&&null!==this.draggedParts&&(this.mayCopy()?(this.xP(!1),t.Uw(this.copiedParts),this.dc(this.copiedParts,!1),t.km(this.copiedParts)):this.mayMove()?(this.Sl(),this.dc(this.draggedParts,!0)):this.mayDragOut()?(this.xP(!1),this.dc(this.copiedParts,!1)):this.Sl(),this.kP(t.lastInput.documentPoint))}doMouseUp(){if(!this.isActive)return;const t=this.diagram,e=t.lastInput;if(this.simulatedMouseUp(e.event,e.documentPoint,e.targetDiagram))return;let i=!1;const n=this.mayCopy();if(n&&null!==this.copiedParts?(this.Sl(),this.xP(!0),t.Uw(this.copiedParts),this.dc(this.copiedParts,!1),t.km(this.copiedParts),null!==this.copiedParts&&(t.v("ChangingSelection",t.selection),t.clearSelection(!0),this.copiedParts.iteratorKeys.each((t=>{t.isSelected=!0})))):(i=!0,this.Sl(),this.mayMove()&&(this.dc(this.draggedParts,!0),this.kP(t.lastInput.documentPoint))),this.gu=!0,this.OC(t.lastInput.documentPoint),this.isActive){const e=n?this.copiedParts.toKeySet():this.draggedParts.toKeySet();this.copiedParts=null,i&&this.JD(),t.invalidateDocumentBounds(),t.km(this.draggedParts),this.transactionResult=n?"Copy":"Move",t.v(n?"SelectionCopied":"SelectionMoved",e)}this.stopTool(),n&&t.v("ChangedSelection",t.selection)}simulatedMouseMove(t,e,i){if(null===Q.yt)return!1;const n=Q.yt.diagram;i instanceof Dt||(i=null);const s=Q.Xh;if(i!==s){if(null!==s&&s!==n){s.stopAutoScroll(),Q.yt.isDragOutStarted=!1;const t=s.toolManager.findTool("Dragging");null!==t&&t.doSimulatedDragLeave()}if(Q.Xh=i,null!==i&&i!==n){Q.yt.DC();const t=i.toolManager.findTool("Dragging");null!==t&&(t.IC(),t.doSimulatedDragEnter())}this.doUpdateCursor(null)}if(null===i||i===n||!i.allowDrop||i.isReadOnly||!i.allowInsert)return!1;const o=i.toolManager.findTool("Dragging");if(null!==o){let n=e;null!==t&&(void 0!==t.targetTouches&&(t.targetTouches.length>0?t=t.targetTouches[0]:t.changedTouches.length>0&&(t=t.changedTouches[0])),n=i.getMouse(t)),i.lastInput.documentPoint=n,i.lastInput.viewPoint=i.transformDocToView(n),i.lastInput.down=!1,i.lastInput.up=!1,o.doSimulatedDragOver()}return!0}simulatedMouseUp(t,e,i){if(null===Q.yt)return!1;const n=Q.Xh,s=Q.yt.diagram;if(null===i)return Q.yt.doCancel(),!0;if(i!==n){const t=n.toolManager.findTool("Dragging");if(null!==n&&n!==s&&null!==t)return n.stopAutoScroll(),Q.yt.isDragOutStarted=!1,t.doSimulatedDragLeave(),!1;Q.Xh=i;const e=i.toolManager.findTool("Dragging");null!==e&&(Q.yt.DC(),e.IC(),e.doSimulatedDragEnter())}if(i!==this.diagram){let n=e;null!==t?(void 0!==t.targetTouches&&(t.targetTouches.length>0?t=t.targetTouches[0]:t.changedTouches.length>0&&(t=t.changedTouches[0])),n=i.getMouse(t)):null===n&&(n=new T),i.lastInput.documentPoint=n,i.lastInput.viewPoint=i.transformDocToView(n),i.lastInput.down=!1,i.lastInput.up=!0;const s=i.toolManager.findTool("Dragging");null!==s&&s.doSimulatedDrop();const o=Q.yt;if(null!==o){const t=o.mayCopy();o.transactionResult=t?"Copy":"Move",o.stopTool()}return!0}return!1}JD(){if(null===this.draggedParts)return;const t=this.draggedParts.iterator;for(;t.next();){const e=t.key;if(e instanceof Ce){const t=e.containingGroup;null!==t&&t.hasPlaceholder()&&!this.draggedParts.contains(t)&&t.placeholder.c()}}}mayCopy(){if(!this.isCopyEnabled)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.allowCopy||!(d.hr?t.lastInput.alt:t.lastInput.control))return!1;const e=t.selection.iterator;for(;e.next();)if(e.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())}mayDragOut(){if(!this.isCopyEnabled)return!1;const t=this.diagram;if(!t.allowDragOut||!t.allowCopy||t.allowMove)return!1;const e=t.selection.iterator;for(;e.next();)if(e.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())}mayMove(){const t=this.diagram;if(t.isReadOnly||!t.allowMove)return!1;const e=t.selection.iterator;for(;e.next();)if(e.value.canMove())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canMove())}IC(){Q.Bw.contains(this)||Q.Bw.add(this)}static GD(){if(Q.Bw.count>0){const t=Q.Bw,e=t.length;for(let i=0;i<e;i++){const e=t.elt(i);e.AC(),e.Sl(),e.pP(),e.diagram.stopAutoScroll()}t.clear()}}computeBorder(t,e,i){return this.gu||null===this.draggedParts||this.draggedParts.contains(t)?null:i.a(e)}getDraggingSource(){return Q.yt}mayDragIn(){const t=this.diagram;if(!t.allowDrop||t.isReadOnly||t.isModelReadOnly||!t.allowInsert)return!1;const e=Q.yt;return!(null===e||e.diagram.model.dataFormat!==t.model.dataFormat)}doSimulatedDragEnter(){if(!this.mayDragIn())return;const t=this.diagram;t.animationManager.stopAnimation(),t.xr(),t.animationManager.stopAnimation();const e=Q.yt;null!==e&&(e.diagram.bm=!1,null===t.lastInput.event&&(t.lastInput.event=e.diagram.lastInput.event)),this.doUpdateCursor(null)}doSimulatedDragLeave(){const t=Q.yt;null!==t&&t.doSimulatedDragOut(),this.doCancel()}doSimulatedDragOver(){const t=this.diagram;t.animationManager.wu=!0;const e=Q.yt;if(null!==e&&null!==e.draggedParts){if(!this.mayDragIn())return;this.EC(e.draggedParts.toKeySet(),!1,t.firstInput),this.dc(this.copiedParts,!1),this.kP(t.lastInput.documentPoint)}t.animationManager.wu=!1}doSimulatedDrop(){const t=this.diagram,e=Q.yt;if(null!==e){const i=e.diagram;if(e.gu=!0,this.Sl(),!this.mayDragIn())return;t.animationManager.wu=!0,t.v("ChangingSelection",t.selection),this.startTransaction("Drop"),this.EC(e.draggedParts.toKeySet(),!0,t.lastInput),this.dc(this.copiedParts,!1);const n=new k;null!==this.copiedParts&&(t.clearSelection(!0),this.copiedParts.iteratorKeys.each((t=>{t.isSelected=!0,n.add(t)}))),this.OC(t.lastInput.documentPoint),t.invalidateDocumentBounds(),null!==this.copiedParts&&(this.transactionResult="ExternalCopy"),this.copiedParts=null,t.doFocus(),t.v("ExternalObjectsDropped",n,i),this.stopTransaction(),t.v("ChangedSelection",t.selection)}t.animationManager.wu=!1}EC(t,e,i){if(null!==this.copiedParts)return;const n=this.diagram;if(n.isReadOnly||n.isModelReadOnly)return;n.skipsUndoManager=!e,n.partManager.addsToTemporaryLayer=!e,this.startPoint=i.documentPoint;const s=n.copyParts(t,n,!0),o=D.l();this.HD(t,o);const r=o.x+o.width/2,a=o.y+o.height/2;D.s(o);const l=this.xm,h=new L,u=T.l(),c=t.iterator;for(;c.next();){const t=c.value;if(t instanceof De&&t.canCopy()){const e=s.getValue(t);if(null===e)continue;e.points=t.points,e.wr(l.x-r,l.y-a),e.dn=!0,h.add(e,this.Vs())}}const d=t.iterator;for(;d.next();){const t=d.value;if(t.Ne()&&t.canCopy()){const e=s.getValue(t);if(null===e)continue;const i=t.location;u.e(l.x-(r-i.x),l.y-(a-i.y)),e.location=u,e.ensureBounds(),h.add(e,this.Vs(u))}}if(T.s(u),this.copiedParts=h,this.mP(h.toKeySet()),null!==this.draggedLink){const t=this.draggedLink,e=t.routeBounds;t.wr(this.startPoint.x-(e.x+e.width/2),this.startPoint.y-(e.y+e.height/2))}this.doUpdateCursor(null)}YD(){this.isDragOutStarted=!0,this.gu=!1,Q.yt=this,Q.Xh=this.diagram,this.doSimulatedDragOut()}doSimulatedDragOut(){const t=this.diagram;t.bm=!1,this.mayCopy()||this.mayMove()?t.currentCursor="":t.currentCursor=this.nodropCursor,this.mu=null}computeMove(t,e,i,n){const s=this.diagram;return null!==s?s.computeMove(t,e,this.dragOptions,n):new T}}y(Q,"Bw",new x),y(Q,"yt",null),y(Q,"Xh",null),Z.prototype.doCancel=function(){null!==Q.yt&&Q.yt.doCancel(),W.prototype.doCancel.call(this)};class tt extends W{constructor(){super(),y(this,"CP",void 0),y(this,"LP",void 0),y(this,"Cl",void 0),y(this,"AP",void 0),y(this,"TP",void 0),y(this,"Kh",void 0),y(this,"DP",void 0),y(this,"Yh",void 0),y(this,"FP",void 0),y(this,"RP",void 0),y(this,"vP",void 0),y(this,"OP",void 0),y(this,"IP",void 0),y(this,"EP",void 0),y(this,"VC",void 0),y(this,"VP",void 0),y(this,"Ll",void 0),y(this,"UP",void 0),this.CP=100,this.LP=!1,this.Cl="pointer",this.AP=new De({layerName:"Tool"}).add(new le({isPanelMain:!0,stroke:"blue"}).theme("stroke","tempLink"),new le({toArrow:"Standard",fill:"blue",stroke:"blue"}).theme("fill","tempLink").theme("stroke","tempLink")).hi(),this.Kh=new le("Rectangle",{portId:"",fill:null,stroke:"magenta",strokeWidth:2,desiredSize:A.Tk}).theme("stroke","tempPort"),this.TP=new Ce({selectable:!1,layerName:"Tool"}).add(this.Kh).hi(),this.Yh=new le("Rectangle",{portId:"",fill:null,stroke:"magenta",strokeWidth:2,desiredSize:A.Tk}).theme("stroke","tempPort"),this.DP=new Ce({selectable:!1,layerName:"Tool"}).add(this.Yh).hi(),this.FP=null,this.RP=null,this.vP=null,this.OP=null,this.IP=null,this.EP=!0,this.VC=new L,this.VP=null,this.Ll=null,this.UP=null}doStop(){this.diagram.stopAutoScroll(),this.originalLink=null,this.originalFromNode=null,this.originalFromPort=null,this.originalToNode=null,this.originalToPort=null,this.validPortsCache.clear(),this.targetPort=null}get portGravity(){return this.CP}set portGravity(t){d.i(t,"number",tt,"portGravity"),t>=0&&(this.CP=t)}get isUnconnectedLinkValid(){return this.LP}set isUnconnectedLinkValid(t){d.i(t,"boolean",tt,"isUnconnectedLinkValid"),this.LP=t}get linkingCursor(){return this.Cl}set linkingCursor(t){this.Cl=t}get temporaryLink(){return this.AP}set temporaryLink(t){t.hi(),this.AP=t}get temporaryFromNode(){return this.TP}set temporaryFromNode(t){t.hi(),this.TP=t,t&&(this.Kh=t.port)}get temporaryFromPort(){return this.Kh}set temporaryFromPort(t){if(null!==this.Kh){const e=this.Kh.panel;if(null!==e){const i=e.T.indexOf(this.Kh);e.removeAt(i),e.insertAt(i,t)}}this.Kh=t}get temporaryToNode(){return this.DP}set temporaryToNode(t){t.hi(),this.DP=t,t&&(this.Yh=t.port)}get temporaryToPort(){return this.Yh}set temporaryToPort(t){if(null!==this.Yh){const e=this.Yh.panel;if(null!==e){const i=e.T.indexOf(this.Yh);e.removeAt(i),e.insertAt(i,t)}}this.Yh=t}get originalLink(){return this.FP}set originalLink(t){this.FP=t}get originalFromNode(){return this.RP}set originalFromNode(t){this.RP=t}get originalFromPort(){return this.vP}set originalFromPort(t){this.vP=t}get originalToNode(){return this.OP}set originalToNode(t){this.OP=t}get originalToPort(){return this.IP}set originalToPort(t){this.IP=t}get isForwards(){return this.EP}set isForwards(t){this.EP=t}get validPortsCache(){return this.VC}get targetPort(){return this.VP}set targetPort(t){this.VP=t}copyPortProperties(t,e,i,n,s){if(null===t||null===e||null===i||null===n)return;const o=e.getDocumentScale(),r=A.l();r.width=e.naturalBounds.width*o,r.height=e.naturalBounds.height*o,n.desiredSize=r,A.s(r),s?(n.toSpot=e.toSpot,n.toEndSegmentLength=e.toEndSegmentLength):(n.fromSpot=e.fromSpot,n.fromEndSegmentLength=e.fromEndSegmentLength),i.locationSpot=O.Center;const a=T.l();i.location=e.getDocumentPoint(O.Center,a),T.s(a),n.angle=e.getDocumentAngle(),null!==this.portTargeted&&this.portTargeted(t,e,i,n,s)}setNoTargetPortProperties(t,e,i){null!==e&&(e.desiredSize=A.Tk,e.fromSpot=O.None,e.toSpot=O.None),null!==t&&(t.location=this.diagram.lastInput.documentPoint),null!==this.portTargeted&&this.portTargeted(null,null,t,e,i)}doMouseDown(){this.isActive&&this.doMouseMove()}doMouseMove(){if(this.isActive){const t=this.diagram;if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort&&this.targetPort.part instanceof Ce){const t=this.targetPort.part;this.isForwards?this.copyPortProperties(t,this.targetPort,this.temporaryToNode,this.temporaryToPort,!0):this.copyPortProperties(t,this.targetPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else this.isForwards?this.setNoTargetPortProperties(this.temporaryToNode,this.temporaryToPort,!0):this.setNoTargetPortProperties(this.temporaryFromNode,this.temporaryFromPort,!1);(t.allowHorizontalScroll||t.allowVerticalScroll)&&t.doAutoScroll(t.lastInput.viewPoint)}}findValidLinkablePort(t,e){if(null===t)return null;const i=t.part;if(!(i instanceof Ce))return null;for(;null!==t;){const n=e?t.toLinkable:t.fromLinkable;if(!0===n&&(null!==t.portId||t instanceof Ce)&&(e?this.isValidTo(i,t):this.isValidFrom(i,t)))return t;if(!1===n)return null;t=t.panel}return null}findTargetPort(t){const e=this.diagram,i=e.lastInput.documentPoint;let n=this.portGravity;n<=0&&(n=.1);const s=this;let o=1/0,r=null;const a=e.findObjectsNear(i,n,(e=>s.findValidLinkablePort(e,t)),null,!0).iterator;for(;a.next();){const e=a.value,n=e.part;if(!(n instanceof Ce))continue;const s=e.getDocumentPoint(O.Center,T.l()),l=i.x-s.x,h=i.y-s.y;T.s(s);const u=l*l+h*h;if(u<o){const i=this.validPortsCache.getValue(e);null!==i?i&&(r=e,o=u):t&&this.isValidLink(this.originalFromNode,this.originalFromPort,n,e)||!t&&this.isValidLink(n,e,this.originalToNode,this.originalToPort)?(this.validPortsCache.add(e,!0),r=e,o=u):this.validPortsCache.add(e,!1)}}if(null!==r){const t=r.part;if(t instanceof Ce&&(null===t.layer||t.layer.allowLink))return r}return null}isValidFrom(t,e){if(null===t||null===e)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==t.layer&&!t.layer.allowLink||!0!==e.fromLinkable))return!1;const i=e.fromMaxLinks;if(i<1/0){if(null!==this.originalLink&&t===this.originalFromNode&&e===this.originalFromPort)return!0;let n=e.portId;if(null===n&&(n=""),t.findLinksOutOf(n).count>=i)return!1}return!0}isValidTo(t,e){if(null===t||null===e)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==t.layer&&!t.layer.allowLink||!0!==e.toLinkable))return!1;const i=e.toMaxLinks;if(i<1/0){if(null!==this.originalLink&&t===this.originalToNode&&e===this.originalToPort)return!0;let n=e.portId;if(null===n&&(n=""),t.findLinksInto(n).count>=i)return!1}return!0}isInSameNode(t,e){if(null===t||null===e)return!1;if(t===e)return!0;const i=t.part,n=e.part;return null!==i&&i===n}isLinked(t,e){if(null===t||null===e)return!1;const i=t.part;if(!(i instanceof Ce))return!1;let n=t.portId;null===n&&(n="");const s=e.part;if(!(s instanceof Ce))return!1;let o=e.portId;null===o&&(o="");const r=s.findLinksInto(o);for(;r.next();){const t=r.value;if(t.fromNode===i&&t.fromPortId===n)return!0}return!1}isValidLink(t,e,i,n){if(!this.isValidFrom(t,e)||!this.isValidTo(i,n)||null!==e&&null!==n&&((!e.fromLinkableSelfNode||!n.toLinkableSelfNode)&&this.isInSameNode(e,n)||(!e.fromLinkableDuplicates||!n.toLinkableDuplicates)&&this.isLinked(e,n))||null!==this.originalLink&&(null!==t&&this.isLabelDependentOnLink(t,this.originalLink)||null!==i&&this.isLabelDependentOnLink(i,this.originalLink))||null!==t&&null!==i&&(null===t.data&&null!==i.data||null!==t.data&&null===i.data)||!this.isValidCycle(t,i,this.originalLink))return!1;let s;return!(null!==t&&(s=t.linkValidation,null!==s&&!s(t,e,i,n,this.originalLink))||null!==i&&(s=i.linkValidation,null!==s&&!s(t,e,i,n,this.originalLink)))&&(s=this.linkValidation,null===s||s(t,e,i,n,this.originalLink))}isLabelDependentOnLink(t,e){if(null===t)return!1;const i=t.labeledLink;if(null===i)return!1;if(i===e)return!0;const n=new k;return n.add(t),this.BP(i,e,n)}BP(t,e,i){if(t===e)return!0;const n=t.fromNode;if(null!==n&&n.isLinkLabel&&(i.add(n),this.BP(n.labeledLink,e,i)))return!0;const s=t.toNode;return!(null===s||!s.isLinkLabel||(i.add(s),!this.BP(s.labeledLink,e,i)))}isValidCycle(t,e,i){if(void 0===i&&(i=null),null===t||null===e)return this.isUnconnectedLinkValid;const n=this.diagram.validCycle;if(1===n)return!0;if(5===n){const n=i||this.temporaryLink;if(null!==n&&!n.isTreeLink)return!0;const s=e.linksConnected;for(;s.next();){const t=s.value;if(t!==i&&t.isTreeLink&&t.toNode===e)return!1}return!this.xu(t,e,i,!0)}if(6===n){const n=i||this.temporaryLink;if(null!==n&&!n.isTreeLink)return!0;const s=t.linksConnected;for(;s.next();){const e=s.value;if(e!==i&&e.isTreeLink&&e.fromNode===t)return!1}return!this.xu(t,e,i,!0)}return 2===n?!this.$D(t,e,i):3===n?!this.xu(t,e,i,!1):4!==n||!this.ZD(t,e,i)}xu(t,e,i,n){if(t===e)return!0;if(null===t||null===e)return!1;const s=t.linksConnected;for(;s.next();){const o=s.value;if(o===i||n&&!o.isTreeLink||o.toNode!==t)continue;const r=o.fromNode;if(r!==t&&this.xu(r,e,i,n))return!0}return!1}$D(t,e,i){if(t===e)return!0;const n=new k;return n.add(e),this.UC(n,t,e,i)}UC(t,e,i,n){if(e===i)return!0;if(null===e||null===i||t.contains(e))return!1;t.add(e);const s=e.linksConnected;for(;s.next();){const o=s.value;if(o===n||o.toNode!==e)continue;const r=o.fromNode;if(r!==e&&this.UC(t,r,i,n))return!0}return!1}ZD(t,e,i){if(t===e)return!0;const n=new k;return n.add(e),this.BC(n,t,e,i)}BC(t,e,i,n){if(e===i)return!0;if(null===e||null===i||t.contains(e))return!1;t.add(e);const s=e.linksConnected;for(;s.next();){const o=s.value;if(o===n)continue;const r=o.fromNode,a=o.toNode,l=r===e?a:r;if(l!==e&&this.BC(t,l,i,n))return!0}return!1}get linkValidation(){return this.Ll}set linkValidation(t){null!==t&&d.i(t,"function",tt,"linkValidation"),this.Ll=t}get portTargeted(){return this.UP}set portTargeted(t){null!==t&&d.i(t,"function",tt,"portTargeted"),this.UP=t}}var et=(t=>(t[t.Either=1]="Either",t[t.ForwardsOnly=2]="ForwardsOnly",t[t.BackwardsOnly=3]="BackwardsOnly",t))(et||{});class it extends tt{constructor(t){super(),y(this,"zP",void 0),y(this,"XP",void 0),y(this,"S",void 0),y(this,"KP",void 0),this.name="Linking",this.zP={},this.XP=null,this.S=1,this.KP=null,t&&Object.assign(this,t)}get archetypeLinkData(){return this.zP}set archetypeLinkData(t){null!==t&&d.i(t,"object",it,"archetypeLinkData"),this.zP=t}get archetypeLabelNodeData(){return this.XP}set archetypeLabelNodeData(t){null!==t&&d.i(t,"object",it,"archetypeLabelNodeData"),this.XP=t}get direction(){return this.S}set direction(t){this.S=t}get startObject(){return this.KP}set startObject(t){this.KP=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowLink||!t.model.zw()||!t.lastInput.left||t.currentTool!==this&&!this.isBeyondDragSize())&&null!==this.findLinkablePort()}findLinkablePort(){const t=this.diagram;let e=this.startObject;if(null===e&&(e=t.findObjectAt(t.firstInput.documentPoint,null,null)),null===e)return null;const i=e.part;if(!(i instanceof Ce))return null;const n=this.direction;if(1===n||2===n){const t=this.findValidLinkablePort(e,!1);if(null!==t)return this.isForwards=!0,t;if(this.startObject===i){const t=i.port;if(this.findValidLinkablePort(t,!1))return this.isForwards=!0,t}}if(1===n||3===n){const t=this.findValidLinkablePort(e,!0);if(null!==t)return this.isForwards=!1,t;if(this.startObject===i){const t=i.port;if(this.findValidLinkablePort(t,!0))return this.isForwards=!1,t}}return null}doActivate(){const t=this.diagram,e=this.findLinkablePort();if(null!==e){if(this.startTransaction(this.name),t.isMouseCaptured=!0,t.currentCursor=this.linkingCursor,this.isForwards){null!==this.temporaryToNode&&(this.temporaryToNode.location=t.lastInput.documentPoint),this.originalFromPort=e;const i=this.originalFromPort.part;i instanceof Ce&&(this.originalFromNode=i),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else{null!==this.temporaryFromNode&&(this.temporaryFromNode.location=t.lastInput.documentPoint),this.originalToPort=e;const i=this.originalToPort.part;i instanceof Ce&&(this.originalToNode=i),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0)}t.add(this.temporaryFromNode),this.temporaryFromNode&&this.temporaryFromNode.ensureBounds(),t.add(this.temporaryToNode),this.temporaryToNode&&this.temporaryToNode.ensureBounds(),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.temporaryLink.isTreeLink=this.isNewTreeLink(),this.temporaryLink.invalidateRoute(),t.add(this.temporaryLink)),this.isActive=!0}else this.stopTool()}doDeactivate(){this.isActive=!1;const t=this.diagram;t.remove(this.temporaryLink),t.remove(this.temporaryFromNode),t.remove(this.temporaryToNode),t.isMouseCaptured=!1,t.currentCursor="",this.stopTransaction()}doStop(){super.doStop(),this.startObject=null}doMouseUp(){if(this.isActive){const t=this.diagram;this.transactionResult=null;let e=null,i=null,n=null,s=null,o=null;try{this.targetPort=this.findTargetPort(this.isForwards);const r=this.targetPort;if(null!==r){const t=r.part;t instanceof Ce&&(this.isForwards?(null!==this.originalFromNode&&(e=this.originalFromNode,i=this.originalFromPort),n=t,s=r):(e=t,i=r,null!==this.originalToNode&&(n=this.originalToNode,s=this.originalToPort)))}else this.isForwards?null!==this.originalFromNode&&this.isUnconnectedLinkValid&&(e=this.originalFromNode,i=this.originalFromPort):null!==this.originalToNode&&this.isUnconnectedLinkValid&&(n=this.originalToNode,s=this.originalToPort);null!==e||null!==n?(o=this.insertLink(e,i,n,s),null!==o?(null===r&&(this.isForwards?o.defaultToPoint=t.lastInput.documentPoint:o.defaultFromPoint=t.lastInput.documentPoint),t.allowSelect&&(t.v("ChangingSelection",t.selection),t.clearSelection(!0),o.isSelected=!0),this.transactionResult=this.name,t.v("LinkDrawn",o)):this.doNoLink(e,i,n,s)):this.isForwards?this.doNoLink(this.originalFromNode,this.originalFromPort,null,null):this.doNoLink(null,null,this.originalToNode,this.originalToPort)}finally{this.stopTool(),o&&t.allowSelect&&t.v("ChangedSelection",t.selection)}}}isNewTreeLink(){const t=this.archetypeLinkData;if(null===t)return!0;if(t instanceof De)return t.isTreeLink;const e=this.diagram;if(null===e)return!0;const i=e.partManager.getLinkCategoryForData(t),n=e.partManager.findLinkTemplateForCategory(i);return null===n||n.isTreeLink}insertLink(t,e,i,n){return this.diagram.partManager.insertLink(t,e,i,n)}doNoLink(t,e,i,n){}}y(it,"Either",1),y(it,"ForwardsOnly",2),y(it,"BackwardsOnly",3);class nt extends tt{constructor(t){super(),y(this,"YP",void 0),y(this,"GP",void 0),y(this,"ds",void 0),y(this,"HP",void 0),this.name="Relinking",this.YP=new le("Diamond",{desiredSize:A.lu,fill:"lightblue",stroke:"dodgerblue",cursor:this.linkingCursor,segmentIndex:0}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.GP=new le("Diamond",{desiredSize:A.lu,fill:"lightblue",stroke:"dodgerblue",cursor:this.linkingCursor,segmentIndex:-1}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.ds=null,this.HP=new D,t&&Object.assign(this,t)}updateAdornments(t){if(null===t||!(t instanceof De))return;let e="RelinkFrom",i=null;if(t.isSelected&&!this.diagram.isReadOnly){const n=t.selectionObject;null!==n&&t.canRelinkFrom()&&t.actualBounds.isReal()&&t.isVisible()&&n.actualBounds.isReal()&&n.isVisibleObject()&&(i=t.findAdornment(e),null===i&&(i=this.makeAdornment(n,!1),t.addAdornment(e,i)))}if(null===i&&t.removeAdornment(e),e="RelinkTo",i=null,t.isSelected&&!this.diagram.isReadOnly){const n=t.selectionObject;null!==n&&t.canRelinkTo()&&t.actualBounds.isReal()&&t.isVisible()&&n.actualBounds.isReal()&&n.isVisibleObject()&&(i=t.findAdornment(e),null===i?(i=this.makeAdornment(n,!0),t.addAdornment(e,i)):i.c())}null===i&&t.removeAdornment(e)}makeAdornment(t,e){const i=new Pe;i.type=ie.Link;const n=e?this.toHandleArchetype:this.fromHandleArchetype;return null!==n&&i.add(n.copy().Pm()),i.adornedObject=t,i}get fromHandleArchetype(){return this.YP}set fromHandleArchetype(t){this.YP=t}get toHandleArchetype(){return this.GP}set toHandleArchetype(t){this.GP=t}get handle(){return this.ds}set handle(t){if(null!==t&&!(t.part instanceof Pe))throw new Error("new handle is not in an Adornment: "+t);this.ds=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowRelink||!t.model.zw()||!t.lastInput.left)return!1;let e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkFrom");return null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkTo")),null!==e}doActivate(){const t=this.diagram;if(null===this.originalLink){let e=this.handle;if(null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkFrom"),null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkTo"))),null===e)return;const i=e.part;if(!(i instanceof Pe)||!(i.adornedPart instanceof De))return;this.handle=e,this.isForwards=null===i||"RelinkTo"===i.category,this.originalLink=i.adornedPart}this.startTransaction(this.name),t.isMouseCaptured=!0,t.currentCursor=this.linkingCursor,this.originalFromPort=this.originalLink.fromPort,this.originalFromNode=this.originalLink.fromNode,this.originalToPort=this.originalLink.toPort,this.originalToNode=this.originalLink.toNode,this.HP.set(this.originalLink.actualBounds),null!==this.originalLink&&this.originalLink.pointsCount>0&&(null===this.originalLink.fromNode&&(null!==this.temporaryFromPort&&(this.temporaryFromPort.desiredSize=A.ru),null!==this.temporaryFromNode&&(this.temporaryFromNode.location=this.originalLink.getPoint(0))),null===this.originalLink.toNode&&(null!==this.temporaryToPort&&(this.temporaryToPort.desiredSize=A.ru),null!==this.temporaryToNode&&(this.temporaryToNode.location=this.originalLink.getPoint(this.originalLink.pointsCount-1)))),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0),t.add(this.temporaryFromNode),t.add(this.temporaryToNode),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.copyLinkProperties(this.originalLink,this.temporaryLink),this.temporaryLink.invalidateRoute(),t.add(this.temporaryLink)),this.isActive=!0}copyLinkProperties(t,e){if(null===t||null===e)return;e.adjusting=t.adjusting,e.corner=t.corner;let i=t.curve;(11===i||10===i)&&(i=0),e.curve=i,e.curviness=t.curviness,e.isTreeLink=t.isTreeLink,e.points=t.points,e.routing=t.routing,e.smoothness=t.smoothness,e.fromSpot=t.fromSpot,e.fromEndSegmentLength=t.fromEndSegmentLength,e.fromShortLength=t.fromShortLength,e.toSpot=t.toSpot,e.toEndSegmentLength=t.toEndSegmentLength,e.toShortLength=t.toShortLength}doDeactivate(){this.isActive=!1;const t=this.diagram;t.remove(this.temporaryLink),t.remove(this.temporaryFromNode),t.remove(this.temporaryToNode),t.isMouseCaptured=!1,t.currentCursor="",this.stopTransaction()}doStop(){super.doStop(),this.handle=null}doMouseUp(){if(this.isActive){const t=this.diagram;this.transactionResult=null;let e=this.originalFromNode,i=this.originalFromPort,n=this.originalToNode,s=this.originalToPort,o=this.originalLink;try{if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort){const t=this.targetPort.part;t instanceof Ce&&(this.isForwards?(n=t,s=this.targetPort):(e=t,i=this.targetPort))}else this.isUnconnectedLinkValid?this.isForwards?(n=null,s=null):(e=null,i=null):o=null;null!==o?(this.reconnectLink(o,this.isForwards?n:e,this.isForwards?s:i,this.isForwards),null===this.targetPort&&(this.isForwards?o.defaultToPoint=t.lastInput.documentPoint:o.defaultFromPoint=t.lastInput.documentPoint,o.invalidateRoute()),this.transactionResult=this.name,t.v("LinkRelinked",o,this.isForwards?this.originalToPort:this.originalFromPort)):this.doNoRelink(this.originalLink,this.isForwards),this.originalLink.invalidateOtherJumpOvers(this.HP)}finally{this.stopTool()}}}reconnectLink(t,e,i,n){const s=null!==i&&null!==i.portId?i.portId:"";return n?(t.toNode=e,t.toPortId=s):(t.fromNode=e,t.fromPortId=s),!0}doNoRelink(t,e){}doDraggingMouseMove(t,e,i,n){null!==t?(this.copyPortProperties(t,e,this.temporaryFromNode,this.temporaryFromPort,!1),this.diagram.add(this.temporaryFromNode)):this.diagram.remove(this.temporaryFromNode),null!==i?(this.copyPortProperties(i,n,this.temporaryToNode,this.temporaryToPort,!0),this.diagram.add(this.temporaryToNode)):this.diagram.remove(this.temporaryToNode)}stopDraggingMouseMove(){this.diagram.remove(this.temporaryFromNode),this.diagram.remove(this.temporaryToNode)}}var st=(t=>(t[t.None=0]="None",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.All=3]="All",t))(st||{});class ot extends W{constructor(t){super(),y(this,"Ao",void 0),y(this,"jP",void 0),y(this,"qP",void 0),y(this,"ds",void 0),y(this,"Xw",void 0),y(this,"WP",void 0),y(this,"Mm",void 0),this.name="LinkReshaping",this.Ao=new le("Rectangle",{desiredSize:A.$N,fill:"lightblue",stroke:"dodgerblue"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.jP=new le("Diamond",{desiredSize:A.lu,fill:"lightblue",stroke:"dodgerblue",cursor:"move"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.qP=3,this.ds=null,this.Xw=null,this.WP=new T,this.Mm=new x,t&&Object.assign(this,t)}getReshapingBehavior(t){return t?t.br:0}setReshapingBehavior(t,e){t.br=e}updateAdornments(t){if(null===t||!(t instanceof De))return;let e=null;if(t.isSelected&&!this.diagram.isReadOnly){const i=t.path;null!==i&&t.canReshape()&&t.actualBounds.isReal()&&t.isVisible()&&i.actualBounds.isReal()&&i.isVisibleObject()&&(e=t.findAdornment(this.name),(null===e||e.JP!==t.pointsCount||e.$P!==t.resegmentable)&&(e=this.makeAdornment(i),null!==e&&(e.JP=t.pointsCount,e.$P=t.resegmentable,t.addAdornment(this.name,e))))}null===e&&t.removeAdornment(this.name)}makeAdornment(t){const e=t.part,i=e.points,n=e.pointsCount,s=e.isOrthogonal;let o=null;if(null!==i&&n>1){o=new Pe,o.type=ie.Link;const i=e.firstPickIndex,n=e.lastPickIndex,r=s?1:0;if(e.resegmentable&&9!==e.computeCurve())for(let e=i+r;e<n-r;e++){const i=this.makeResegmentHandle(t,e);null!==i&&(i.segmentIndex=e,i.segmentFraction=.5,i.fromMaxLinks=999,o.add(i))}for(let a=i+1;a<n;a++){const r=this.makeHandle(t,a);if(null!==r){if(r.segmentIndex=a,a!==i)if(a===i+1&&s){const t=e.getPoint(i);let n=e.getPoint(i+1);E.u(t.x,n.x)&&E.u(t.y,n.y)?(n=e.getPoint(i-1),E.u(t.x,n.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):E.u(t.y,n.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")):E.u(t.x,n.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):E.u(t.y,n.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")}else if(a===n-1&&s){let t=e.getPoint(n-1);const i=e.getPoint(n);E.u(t.x,i.x)&&E.u(t.y,i.y)?(t=e.getPoint(n+1),E.u(t.x,i.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):E.u(t.y,i.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")):E.u(t.x,i.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):E.u(t.y,i.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")}else a===n||(this.setReshapingBehavior(r,3),r.cursor="move");o.add(r)}}o.adornedObject=t}return o}makeHandle(t,e){const i=this.handleArchetype;return null===i?null:i.copy().Pm()}get handleArchetype(){return this.Ao}set handleArchetype(t){this.Ao=t}makeResegmentHandle(t,e){const i=this.midHandleArchetype;return null===i?null:i.copy().Pm()}get midHandleArchetype(){return this.jP}set midHandleArchetype(t){this.jP=t}get handle(){return this.ds}set handle(t){if(null!==t&&!(t.part instanceof Pe))throw new Error("new handle is not in an Adornment: "+t);this.ds=t}get adornedLink(){return this.Xw}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowReshape||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;if(null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null===this.handle)return;const e=this.handle.part.adornedPart;if(e instanceof De){if(this.Xw=e,t.isMouseCaptured=!0,this.startTransaction(this.name),e.resegmentable&&999===this.handle.fromMaxLinks){const i=e.points.copy(),n=this.getResegmentingPoint();if(i.insertAt(this.handle.segmentIndex+1,n),e.isOrthogonal&&i.insertAt(this.handle.segmentIndex+1,n),e.points=i,e.invalidateAdornments(),e.updateAdornments(),this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name),null===this.handle)return void this.doDeactivate()}this.WP=e.getPoint(this.handle.segmentIndex),this.Mm=e.points.copy(),this.isActive=!0}}doDeactivate(){this.stopTransaction(),this.handle=null,this.Xw=null;this.diagram.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){const t=this.adornedLink;null!==t&&(t.points=this.Mm),this.stopTool()}getResegmentingPoint(){return this.handle.getDocumentPoint(O.Center)}doMouseMove(){const t=this.diagram;if(this.isActive){const e=this.computeReshape(t.lastInput.documentPoint);this.reshape(e)}}doMouseUp(){const t=this.diagram;if(this.isActive){const e=this.computeReshape(t.lastInput.documentPoint);this.reshape(e);const i=this.adornedLink;if(null!==i&&i.resegmentable){const t=this.handle.segmentIndex,e=i.getPoint(t-1),n=i.getPoint(t),s=i.getPoint(t+1);if(i.isOrthogonal){if(t>i.firstPickIndex+1&&t<i.lastPickIndex-1){let o=i.getPoint(t-2);if(this.isWithinResegmentingDistance(e,n)&&(this.isInLineOrtho(o,e,n,s,!0)||this.isInLineOrtho(o,e,n,s,!1))){const r=i.points.copy();this.isInLineOrtho(o,e,n,s,!0)?(r.setElt(t-2,new T(o.x,(s.y+o.y)/2)),r.setElt(t+1,new T(s.x,(s.y+o.y)/2))):(r.setElt(t-2,new T((s.x+o.x)/2,o.y)),r.setElt(t+1,new T((s.x+o.x)/2,s.y))),r.removeAt(t),r.removeAt(t-1),i.points=r,i.invalidateAdornments()}else if(o=i.getPoint(t+2),this.isWithinResegmentingDistance(n,s)&&(this.isInLineOrtho(e,n,s,o,!0)||this.isInLineOrtho(e,n,s,o,!1))){const r=i.points.copy();this.isInLineOrtho(e,n,s,o,!0)?(r.setElt(t-1,new T(e.x,(e.y+o.y)/2)),r.setElt(t+2,new T(o.x,(e.y+o.y)/2))):(r.setElt(t-1,new T((e.x+o.x)/2,e.y)),r.setElt(t+2,new T((e.x+o.x)/2,o.y))),r.removeAt(t+1),r.removeAt(t),i.points=r,i.invalidateAdornments()}}}else{const o=T.l();if(E.wl(e.x,e.y,s.x,s.y,n.x,n.y,o)&&o.distanceSquaredPoint(n)<this.resegmentingDistance*this.resegmentingDistance){const e=i.points.copy();e.removeAt(t),i.points=e,i.invalidateAdornments()}T.s(o)}}t.invalidateDocumentBounds(),this.transactionResult=this.name,t.v("LinkReshaped",this.adornedLink,this.Mm)}this.stopTool()}isWithinResegmentingDistance(t,e){return Math.abs(t.x-e.x)<this.resegmentingDistance&&Math.abs(t.y-e.y)<this.resegmentingDistance}isInLineOrtho(t,e,i,n,s){return s?Math.abs(t.y-e.y)<this.resegmentingDistance&&Math.abs(e.y-i.y)<this.resegmentingDistance&&Math.abs(i.y-n.y)<this.resegmentingDistance:Math.abs(t.x-e.x)<this.resegmentingDistance&&Math.abs(e.x-i.x)<this.resegmentingDistance&&Math.abs(i.x-n.x)<this.resegmentingDistance}get resegmentingDistance(){return this.qP}set resegmentingDistance(t){d.i(t,"number",ot,"resegmentingDistance"),this.qP=t}reshape(t){const e=this.adornedLink;e.startRoute();let i=this.handle.segmentIndex;const n=this.getReshapingBehavior(this.handle);if(e.isOrthogonal)if(i===e.firstPickIndex+1){const i=e.firstPickIndex+1;2===n?(e.setPointAt(i,e.getPoint(i-1).x,t.y),e.setPointAt(i+1,e.getPoint(i+2).x,t.y)):1===n&&(e.setPointAt(i,t.x,e.getPoint(i-1).y),e.setPointAt(i+1,t.x,e.getPoint(i+2).y))}else if(i===e.lastPickIndex-1){const i=e.lastPickIndex-1;2===n?(e.setPointAt(i-1,e.getPoint(i-2).x,t.y),e.setPointAt(i,e.getPoint(i+1).x,t.y)):1===n&&(e.setPointAt(i-1,t.x,e.getPoint(i-2).y),e.setPointAt(i,t.x,e.getPoint(i+1).y))}else{let n=i;const s=e.getPoint(n),o=e.getPoint(n-1),r=e.getPoint(n+1);E.u(o.x,s.x)&&E.u(s.y,r.y)?(E.u(o.x,e.getPoint(n-2).x)&&!E.u(o.y,e.getPoint(n-2).y)?(e.insertPointAt(n,t.x,o.y),i++,n++):e.setPointAt(n-1,t.x,o.y),E.u(r.y,e.getPoint(n+2).y)&&!E.u(r.x,e.getPoint(n+2).x)?e.insertPointAt(n+1,r.x,t.y):e.setPointAt(n+1,r.x,t.y)):E.u(o.y,s.y)&&E.u(s.x,r.x)?(E.u(o.y,e.getPoint(n-2).y)&&!E.u(o.x,e.getPoint(n-2).x)?(e.insertPointAt(n,o.x,t.y),i++,n++):e.setPointAt(n-1,o.x,t.y),E.u(r.x,e.getPoint(n+2).x)&&!E.u(r.y,e.getPoint(n+2).y)?e.insertPointAt(n+1,t.x,r.y):e.setPointAt(n+1,t.x,r.y)):E.u(o.x,s.x)&&E.u(s.x,r.x)?(E.u(o.x,e.getPoint(n-2).x)&&!E.u(o.y,e.getPoint(n-2).y)?(e.insertPointAt(n,t.x,o.y),i++,n++):e.setPointAt(n-1,t.x,o.y),E.u(r.x,e.getPoint(n+2).x)&&!E.u(r.y,e.getPoint(n+2).y)?e.insertPointAt(n+1,t.x,r.y):e.setPointAt(n+1,t.x,r.y)):E.u(o.y,s.y)&&E.u(s.y,r.y)&&(E.u(o.y,e.getPoint(n-2).y)&&!E.u(o.x,e.getPoint(n-2).x)?(e.insertPointAt(n,o.x,t.y),i++,n++):e.setPointAt(n-1,o.x,t.y),E.u(r.y,e.getPoint(n+2).y)&&!E.u(r.x,e.getPoint(n+2).x)?e.insertPointAt(n+1,r.x,t.y):e.setPointAt(n+1,r.x,t.y)),e.setPointAt(i,t.x,t.y)}else{e.setPointAt(i,t.x,t.y);let n=e.fromNode,s=e.fromPort;if(null!==n){const t=n.findVisibleNode();null!==t&&t!==n&&(n=t,s=n.port)}if(1===i&&e.computeSpot(!0,s).isNoSpot()){const i=s.getDocumentPoint(O.Center,T.l()),o=e.getLinkPointFromPoint(n,s,i,t,!0,T.l());e.setPointAt(0,o.x,o.y),T.s(i),T.s(o)}let o=e.toNode,r=e.toPort;if(null!==o){const t=o.findVisibleNode();null!==t&&t!==o&&(o=t,r=o.port)}if(i===e.pointsCount-2&&e.computeSpot(!1,r).isNoSpot()){const i=r.getDocumentPoint(O.Center,T.l()),n=e.getLinkPointFromPoint(o,r,i,t,!1,T.l());e.setPointAt(e.pointsCount-1,n.x,n.y),T.s(i),T.s(n)}}e.commitRoute()}computeReshape(t){const e=this.adornedLink,i=this.handle.segmentIndex;switch(this.getReshapingBehavior(this.handle)){case 3:return t;case 2:{const n=e.getPoint(i);return new T(n.x,t.y)}case 1:{const n=e.getPoint(i);return new T(t.x,n.y)}default:return e.getPoint(i)}}get originalPoint(){return this.WP}get originalPoints(){return this.Mm}}y(ot,"None",0),y(ot,"Horizontal",1),y(ot,"Vertical",2),y(ot,"All",3);class rt extends W{constructor(t){super(),y(this,"kr",void 0),y(this,"Pr",void 0),y(this,"To",void 0),y(this,"gc",void 0),y(this,"ZP",void 0),y(this,"gs",void 0),y(this,"Ao",void 0),y(this,"ds",void 0),y(this,"Sm",void 0),y(this,"QP",void 0),y(this,"mc",void 0),y(this,"Kw",void 0),y(this,"Yw",void 0),y(this,"Gw",void 0),this.name="Resizing",this.kr=new A(1,1).g(),this.Pr=new A(9999,9999).g(),this.To=new A(NaN,NaN).g(),this.gc=!1,this.ZP=!0,this.gs=null,this.Ao=new le("Rectangle",{alignmentFocus:O.Center,desiredSize:A.$N,fill:"lightblue",stroke:"dodgerblue",strokeWidth:1,cursor:"pointer"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.ds=null,this.Sm=new T,this.QP=new A,this.mc=new T,this.Kw=new A(0,0),this.Yw=new A(1/0,1/0),this.Gw=new A(1,1),t&&Object.assign(this,t)}updateAdornments(t){if(!(null===t||t instanceof De)){if(t.isSelected&&!this.diagram.isReadOnly){const e=t.resizeObject;let i=t.findAdornment(this.name);if(null!==e&&t.canResize()&&t.actualBounds.isReal()&&t.isVisible()&&e.actualBounds.isReal()&&e.isVisibleObject()&&((null===i||i.adornedObject!==e)&&(i=this.makeAdornment(e)),null!==i)){const n=e.getDocumentAngle();return t.Al()&&this.updateResizeHandles(i,n),void t.addAdornment(this.name,i)}}t.removeAdornment(this.name)}}makeAdornment(t){let e=null;const i=t.part.resizeAdornmentTemplate;if(null===i){e=new Pe,e.type=ie.Spot,e.locationSpot=O.Center;const i=new ze;i.isPanelMain=!0,e.add(i),e.add(this.makeHandle(t,O.TopLeft)),e.add(this.makeHandle(t,O.TopRight)),e.add(this.makeHandle(t,O.BottomRight)),e.add(this.makeHandle(t,O.BottomLeft)),e.add(this.makeHandle(t,O.MiddleTop)),e.add(this.makeHandle(t,O.MiddleRight)),e.add(this.makeHandle(t,O.MiddleBottom)),e.add(this.makeHandle(t,O.MiddleLeft))}else if(i.hi(),e=i.copy(),null===e)return null;return e.adornedObject=t,e}makeHandle(t,e){const i=this.handleArchetype;if(null===i)return null;const n=i.copy().Pm();return n.alignment=e,n}updateResizeHandles(t,e){if(null!==t)if(!t.alignment.isDefault()&&("pointer"===t.cursor||t.cursor.indexOf("resize")>0))this.QD(t,e);else if(t instanceof ie){const i=t.elements;for(;i.next();){const t=i.value;this.updateResizeHandles(t,e)}}}QD(t,e){let i=t.alignment;i.isNoSpot()&&(i=O.Center);let n=e;if(i.x<=0)i.y<=0?n+=225:i.y>=1?n+=135:n+=180;else if(i.x>=1)i.y<=0?n+=315:i.y>=1&&(n+=45);else if(i.y<=0)n+=270;else{if(!(i.y>=1))return;n+=90}n<0?n+=360:n>=360&&(n-=360),t.cursor=n<22.5?"e-resize":n<67.5?"se-resize":n<112.5?"s-resize":n<157.5?"sw-resize":n<202.5?"w-resize":n<247.5?"nw-resize":n<292.5?"n-resize":n<337.5?"ne-resize":"e-resize"}get handleArchetype(){return this.Ao}set handleArchetype(t){this.Ao=t}get handle(){return this.ds}set handle(t){if(null!==t&&!(t.part instanceof Pe))throw new Error("new handle is not in an Adornment: "+t);this.ds=t}get adornedObject(){return this.gs}set adornedObject(t){if(null!==t&&t.part instanceof Pe)throw new Error("new handle must not be in an Adornment: "+t);this.gs=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowResize||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null!==this.handle&&(this.adornedObject=this.handle.part.adornedObject,null!==this.adornedObject&&(t.isMouseCaptured=!0,t.animationManager.stopAnimation(),t.pu=!0,this.startTransaction(this.name),this.Sm.set(this.adornedObject.getDocumentPoint(this.handle.alignment.opposite())),this.mc.set(this.adornedObject.part.location),this.QP.set(this.adornedObject.desiredSize),this.Gw=this.computeCellSize(),this.Kw=this.computeMinSize(),this.Yw=this.computeMaxSize(),this.isActive=!0))}doDeactivate(){const t=this.diagram;t.pu=!1,t.Ml=!0,this.stopTransaction(),this.handle=null,this.gs=null,t.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){null!==this.adornedObject&&(this.adornedObject.desiredSize=this.originalDesiredSize,this.adornedObject.part.location=this.originalLocation),this.stopTool()}doMouseMove(){const t=this.diagram;if(!this.isActive)return;const e=this.Kw,i=this.Yw,n=this.Gw,s=t.lastInput.documentPoint,o=this.adornedObject.getLocalPoint(s,T.l()),r=this.computeReshape(),a=this.computeResize(o,this.handle.alignment,e,i,n,r);this.resize(a),t.maybeUpdate(),T.s(o)}doMouseUp(){const t=this.diagram;if(this.isActive){const e=this.Kw,i=this.Yw,n=this.Gw,s=this.adornedObject.getLocalPoint(t.lastInput.documentPoint,T.l()),o=this.computeReshape(),r=this.computeResize(s,this.handle.alignment,e,i,n,o);this.resize(r),T.s(s),t.invalidateDocumentBounds(),this.transactionResult=this.name,t.v("PartResized",this.adornedObject,this.originalDesiredSize)}this.stopTool()}resize(t){const e=this.diagram,i=this.adornedObject;if(null===i)return;i.desiredSize=t.size;const n=i.part;n.ensureBounds();const s=i.getDocumentPoint(this.handle.alignment.opposite());if(n instanceof Ve){const t=new x;let i;t.add(n),!this.dragsMembers&&!n.hasPlaceholder()&&(i=new Et,i.dragsMembers=!1),e.moveParts(t,this.oppositePoint.copy().subtract(s),!0,i)}else n.location=n.location.copy().subtract(s).add(this.oppositePoint);e.maybeUpdate()}computeResize(t,e,i,n,s,o){e.isNoSpot()&&(e=O.Center);const r=this.adornedObject.naturalBounds,a=r.x,l=r.y,h=r.x+r.width,u=r.y+r.height;let c=1;if(!o){let t=r.width,e=r.height;t<=0&&(t=1),e<=0&&(e=1),c=e/t}const d=T.l();E.Vg(t.x,t.y,a,l,s.width,s.height,d);const f=r.copy();return e.x<=0?e.y<=0?(f.x=Math.max(d.x,h-n.width),f.x=Math.min(f.x,h-i.width),f.width=Math.max(h-f.x,i.width),f.y=Math.max(d.y,u-n.height),f.y=Math.min(f.y,u-i.height),f.height=Math.max(u-f.y,i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width),f.x=h-f.width,f.y=u-f.height)):e.y>=1?(f.x=Math.max(d.x,h-n.width),f.x=Math.min(f.x,h-i.width),f.width=Math.max(h-f.x,i.width),f.height=Math.max(Math.min(d.y-l,n.height),i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width),f.x=h-f.width)):(f.x=Math.max(d.x,h-n.width),f.x=Math.min(f.x,h-i.width),f.width=h-f.x,o||(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c,f.y=l+.5*(u-l-f.height))):e.x>=1?e.y<=0?(f.width=Math.max(Math.min(d.x-a,n.width),i.width),f.y=Math.max(d.y,u-n.height),f.y=Math.min(f.y,u-i.height),f.height=Math.max(u-f.y,i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width),f.y=u-f.height)):e.y>=1?(f.width=Math.max(Math.min(d.x-a,n.width),i.width),f.height=Math.max(Math.min(d.y-l,n.height),i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width))):(f.width=Math.max(Math.min(d.x-a,n.width),i.width),o||(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c,f.y=l+.5*(u-l-f.height))):e.y<=0?(f.y=Math.max(d.y,u-n.height),f.y=Math.min(f.y,u-i.height),f.height=u-f.y,o||(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width,f.x=a+.5*(h-a-f.width))):e.y>=1&&(f.height=Math.max(Math.min(d.y-l,n.height),i.height),o||(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width,f.x=a+.5*(h-a-f.width))),T.s(d),f}computeReshape(){let t=0;return this.adornedObject instanceof le&&(t=this.adornedObject._P()),!(6===t||this.diagram.lastInput.shift)}computeMinSize(){const t=this.adornedObject.minSize.copy(),e=this.minSize;return!isNaN(e.width)&&e.width>t.width&&(t.width=e.width),!isNaN(e.height)&&e.height>t.height&&(t.height=e.height),t}computeMaxSize(){const t=this.adornedObject.maxSize.copy(),e=this.maxSize;return!isNaN(e.width)&&e.width<t.width&&(t.width=e.width),!isNaN(e.height)&&e.height<t.height&&(t.height=e.height),t}computeCellSize(){const t=new A(NaN,NaN),e=this.adornedObject.part;if(null!==e){const i=e.resizeCellSize;!isNaN(i.width)&&i.width>0&&(t.width=i.width),!isNaN(i.height)&&i.height>0&&(t.height=i.height)}let i=this.cellSize;isNaN(t.width)&&!isNaN(i.width)&&i.width>0&&(t.width=i.width),isNaN(t.height)&&!isNaN(i.height)&&i.height>0&&(t.height=i.height);const n=this.diagram;if((isNaN(t.width)||isNaN(t.height))&&n){const e=n.grid;null!==e&&e.visible&&this.isGridSnapEnabled&&(i=e.gridCellSize,isNaN(t.width)&&!isNaN(i.width)&&i.width>0&&(t.width=i.width),isNaN(t.height)&&!isNaN(i.height)&&i.height>0&&(t.height=i.height))}return(isNaN(t.width)||0===t.width||t.width===1/0)&&(t.width=1),(isNaN(t.height)||0===t.height||t.height===1/0)&&(t.height=1),t}get minSize(){return this.kr}set minSize(t){if(!this.kr.equals(t)){let e=t.width;isNaN(e)&&(e=0);let i=t.height;isNaN(i)&&(i=0),this.kr.e(e,i)}}get maxSize(){return this.Pr}set maxSize(t){if(!this.Pr.equals(t)){let e=t.width;isNaN(e)&&(e=1/0);let i=t.height;isNaN(i)&&(i=1/0),this.Pr.e(e,i)}}get cellSize(){return this.To}set cellSize(t){this.To.equals(t)||this.To.a(t)}get isGridSnapEnabled(){return this.gc}set isGridSnapEnabled(t){d.i(t,"boolean",rt,"isGridSnapEnabled"),this.gc=t}get dragsMembers(){return this.ZP}set dragsMembers(t){d.i(t,"boolean",rt,"dragsMembers"),this.ZP=t}get oppositePoint(){return this.Sm}set oppositePoint(t){this.Sm.equals(t)||this.Sm.a(t)}get originalDesiredSize(){return this.QP}get originalLocation(){return this.mc}}class at extends W{constructor(t){super(),y(this,"tM",void 0),y(this,"iM",void 0),y(this,"gs",void 0),y(this,"Ao",void 0),y(this,"ds",void 0),y(this,"eM",void 0),y(this,"Nm",void 0),y(this,"mc",void 0),y(this,"sM",void 0),y(this,"nM",void 0),this.name="Rotating",this.tM=45,this.iM=2,this.mc=new T,this.gs=null,this.Ao=new le("Ellipse",{desiredSize:A.lu,fill:"lightblue",stroke:"dodgerblue",strokeWidth:1,cursor:"pointer"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.ds=null,this.eM=0,this.Nm=new T(NaN,NaN),this.sM=0,this.nM=50,t&&Object.assign(this,t)}updateAdornments(t){if(null!==t){if(t.Tl()){const e=t.rotateObject;if(e===t||e===t.path||e.isPanelMain)return}if(t.isSelected&&!this.diagram.isReadOnly){const e=t.rotateObject;if(null!==e&&t.canRotate()&&t.actualBounds.isReal()&&t.isVisible()&&e.actualBounds.isReal()&&e.isVisibleObject()){let i=t.findAdornment(this.name);if((null===i||i.adornedObject!==e)&&(i=this.makeAdornment(e)),null!==i)return i.angle=e.getDocumentAngle(),i.hasPlaceholder()||(i.location=this.computeAdornmentLocation(e)),void t.addAdornment(this.name,i)}}t.removeAdornment(this.name)}}makeAdornment(t){let e=null;const i=t.part.rotateAdornmentTemplate;if(null===i){e=new Pe,e.type=ie.Position,e.locationSpot=O.Center;const t=this.handleArchetype;null!==t&&e.add(t.copy().Pm())}else if(i.hi(),e=i.copy(),null===e)return null;return e.adornedObject=t,e}get handleArchetype(){return this.Ao}set handleArchetype(t){this.Ao=t}get handle(){return this.ds}set handle(t){if(null!==t&&!(t.part instanceof Pe))throw new Error("new handle is not in an Adornment: "+t);this.ds=t}get adornedObject(){return this.gs}set adornedObject(t){if(null!==t&&t.part instanceof Pe)throw new Error("new handle must not be in an Adornment: "+t);this.gs=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowRotate||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;if(null===this.adornedObject){if(null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null===this.handle)return;this.adornedObject=this.handle.part.adornedObject}null!==this.adornedObject&&(t.isMouseCaptured=!0,t.delaysLayout=!0,this.startTransaction(this.name),this.eM=this.adornedObject.angle,this.Nm=this.computeRotationPoint(this.adornedObject),this.mc=this.adornedObject.part.location.copy(),this.isActive=!0)}computeRotationPoint(t){const e=t.part,i=e.locationObject;return e.rotationSpot.isSpot()?t.getDocumentPoint(e.rotationSpot):t===e||t===i?i.getDocumentPoint(e.locationSpot):t.getDocumentPoint(O.Center)}computeAdornmentLocation(t){let e=this.rotationPoint;e.isReal()||(e=this.computeRotationPoint(t));const i=t.getLocalPoint(e);let n=this.handleAngle;n<0?n+=360:n>=360&&(n-=360),n=Math.round(45*Math.round(n/45));const s=this.handleDistance;return 0===n?i.x=t.naturalBounds.width+s:45===n?(i.x=t.naturalBounds.width+s,i.y=t.naturalBounds.height+s):90===n?i.y=t.naturalBounds.height+s:135===n?(i.x=-s,i.y=t.naturalBounds.height+s):180===n?i.x=-s:225===n?(i.x=-s,i.y=-s):270===n?i.y=-s:315===n&&(i.x=t.naturalBounds.width+s,i.y=-s),t.getDocumentPoint(i)}doDeactivate(){const t=this.diagram;this.stopTransaction(),this.handle=null,this.gs=null,this.Nm=new T(NaN,NaN),t.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){this.diagram.delaysLayout=!1,this.rotate(this.originalAngle),this.stopTool()}doMouseMove(){const t=this.diagram;if(this.isActive){const e=this.computeRotate(t.lastInput.documentPoint);this.rotate(e)}}doMouseUp(){const t=this.diagram;if(this.isActive){t.delaysLayout=!1;const e=this.computeRotate(t.lastInput.documentPoint);this.rotate(e),t.invalidateDocumentBounds(),this.transactionResult=this.name,t.v("PartRotated",this.adornedObject,this.originalAngle)}this.stopTool()}rotate(t){const e=this.adornedObject;if(null===e)return;e.angle=t;const i=e.part;i.ensureBounds();const n=i.locationObject,s=i.rotateObject;if(n===s||n.isContainedBy(s)){const e=this.mc.copy();i.location=e.subtract(this.rotationPoint).rotate(t-this.originalAngle).add(this.rotationPoint)}this.diagram.maybeUpdate()}computeRotate(t){let e=this.rotationPoint.directionPoint(t)-this.handleAngle;const i=this.adornedObject.panel;null!==i&&(e-=i.getDocumentAngle()),e>=360?e-=360:e<0&&(e+=360);const n=Math.min(Math.abs(this.snapAngleMultiple),180),s=Math.min(Math.abs(this.snapAngleEpsilon),n/2);return!this.diagram.lastInput.shift&&n>0&&s>0&&(e%n<s?e=Math.floor(e/n)*n:e%n>n-s&&(e=(Math.floor(e/n)+1)*n)),e>=360?e-=360:e<0&&(e+=360),e}get snapAngleMultiple(){return this.tM}set snapAngleMultiple(t){d.i(t,"number",at,"snapAngleMultiple"),this.tM=t}get snapAngleEpsilon(){return this.iM}set snapAngleEpsilon(t){d.i(t,"number",at,"snapAngleEpsilon"),this.iM=t}get originalAngle(){return this.eM}get rotationPoint(){return this.Nm}set rotationPoint(t){this.Nm=t.copy()}get handleAngle(){return this.sM}set handleAngle(t){d.i(t,"number",at,"handleAngle"),this.sM=t}get handleDistance(){return this.nM}set handleDistance(t){d.i(t,"number",at,"handleDistance"),this.nM=t}}class lt extends W{constructor(t){super(),this.name="ClickSelecting",t&&Object.assign(this,t)}canStart(){return!(!this.isEnabled||this.isBeyondDragSize())}doMouseUp(){this.isActive&&(this.standardMouseSelect(),this.standardMouseClick()||this.diagram.lastInput.isTouchEvent&&this.diagram.toolManager.doToolTip()),this.stopTool()}}class ht extends W{constructor(t){super(),y(this,"pc",void 0),this.name="Action",this.pc=null,t&&Object.assign(this,t)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram,e=t.lastInput,i=t.findObjectAt(e.documentPoint,(t=>{for(;null!==t.panel;){if(t.isActionable)return t;t=t.panel}return t}));return!(null===i||!i.isActionable)&&(this.pc=i,t.cc=t.findObjectAt(e.documentPoint,null,null),!0)}doMouseDown(){if(this.isActive){const t=this.diagram.lastInput,e=this.pc;if(null===e)return;t.targetObject=e,null!==e.actionDown&&e.actionDown(t,e)}else this.canStart()&&this.doActivate()}doMouseMove(){if(this.isActive){const t=this.diagram.lastInput,e=this.pc;if(null===e)return;t.targetObject=e,null!==e.actionMove&&e.actionMove(t,e)}}doMouseUp(){if(this.isActive){const t=this.diagram.lastInput,e=this.pc;if(null===e)return;t.targetObject=e,null!==e.actionUp&&e.actionUp(t,e),this.standardMouseClick((t=>{for(;null!==t.panel;){if(t.isActionable&&t===e)return t;t=t.panel}return t}),(t=>t===e))}this.stopTool()}doCancel(){const t=this.diagram.lastInput,e=this.pc;null!==e&&(t.targetObject=e,null!==e.actionCancel&&e.actionCancel(t,e),this.stopTool())}doStop(){this.pc=null}}class ut extends W{constructor(t){super(),y(this,"Dl",void 0),y(this,"oM",void 0),y(this,"gc",void 0),y(this,"rM",void 0),this.name="ClickCreating",this.Dl=null,this.oM=!0,this.gc=!1,this.rM=new T(0,0),t&&Object.assign(this,t)}canStart(){if(!this.isEnabled||null===this.archetypeNodeData)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.lastInput.left||this.isBeyondDragSize())return!1;if(this.isDoubleClick){if(1===t.lastInput.clickCount&&(this.rM=t.lastInput.viewPoint.copy()),2!==t.lastInput.clickCount||this.isBeyondDragSize(this.rM))return!1}else if(1!==t.lastInput.clickCount)return!1;return!(t.currentTool!==this&&null!==t.findPartAt(t.lastInput.documentPoint,!0))}doMouseUp(){const t=this.diagram;this.isActive&&this.insertPart(t.lastInput.documentPoint),this.stopTool()}insertPart(t){const e=this.diagram,i=this.archetypeNodeData;if(null===i)return null;let n=null;try{if(e.v("ChangingSelection",e.selection),this.startTransaction(this.name),i instanceof ke)i.Ne()&&(i.hi(),n=i.copy(),null!==n&&e.add(n));else if(null!==i){const t=e.model.copyNodeData(i);d.wt(t)&&(e.model.addNodeData(t),n=e.findPartForData(t))}if(null!==n){const i=T.X(t.x,t.y);this.isGridSnapEnabled&&this.diagram.lM(n,t,i),n.location=i,e.allowSelect&&(e.clearSelection(!0),n.isSelected=!0),T.s(i)}e.invalidateDocumentBounds(),this.transactionResult=this.name,e.v("PartCreated",n)}finally{this.stopTransaction(),e.v("ChangedSelection",e.selection)}return n}get archetypeNodeData(){return this.Dl}set archetypeNodeData(t){null!==t&&d.i(t,"object",ut,"archetypeNodeData"),this.Dl=t}get isDoubleClick(){return this.oM}set isDoubleClick(t){d.i(t,"boolean",ut,"isDoubleClick"),this.oM=t}get isGridSnapEnabled(){return this.gc}set isGridSnapEnabled(t){d.i(t,"boolean",ut,"isGridSnapEnabled"),this.gc=t}}class ct extends W{constructor(t){super(),y(this,"zh",void 0),y(this,"hM",void 0),y(this,"Fl",void 0),this.name="DragSelecting",this.zh=175,this.hM=!1,this.Fl=new ke({layerName:"Tool",selectable:!1}).add(new le("Rectangle",{name:"SHAPE",fill:null,stroke:"magenta"}).theme("stroke","dragSelect")).hi(),t&&Object.assign(this,t)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(!t.allowSelect)return!1;const e=t.lastInput;return!(!e.left||t.currentTool!==this&&(!this.isBeyondDragSize()||e.timestamp-t.firstInput.timestamp<this.delay||null!==t.findPartAt(e.documentPoint,!0)))}doActivate(){const t=this.diagram;this.isActive=!0,t.isMouseCaptured=!0,t.skipsUndoManager=!0,t.add(this.box),this.doMouseMove()}doDeactivate(){const t=this.diagram;t.stopAutoScroll(),t.remove(this.box),t.skipsUndoManager=!1,t.isMouseCaptured=!1,this.isActive=!1}doMouseMove(){const t=this.diagram;if(this.isActive&&null!==this.box){const e=this.computeBoxBounds();let i=this.box.findObject("SHAPE");null===i&&(i=this.box.findMainElement());const n=A.l().e(e.width,e.height);i.desiredSize=n,this.box.yc(e.x,e.y,!1),A.s(n),(t.allowHorizontalScroll||t.allowVerticalScroll)&&t.doAutoScroll(t.lastInput.viewPoint)}}doMouseUp(){if(this.isActive){const t=this.diagram;t.remove(this.box);try{t.currentCursor="wait",t.v("ChangingSelection",t.selection),this.selectInRect(this.computeBoxBounds()),t.v("ChangedSelection",t.selection)}finally{t.currentCursor=""}}this.stopTool()}computeBoxBounds(){const t=this.diagram;return new D(t.firstInput.documentPoint,t.lastInput.documentPoint)}selectInRect(t){const e=this.diagram,i=e.lastInput,n=e.findPartsIn(t,this.isPartialInclusion);if(d.hr?i.meta:i.control)if(i.shift){const t=n.iterator;for(;t.next();){const e=t.value;e.isSelected&&(e.isSelected=!1)}}else{const t=n.iterator;for(;t.next();){const e=t.value;e.isSelected=!e.isSelected}}else if(i.shift){const t=n.iterator;for(;t.next();){const e=t.value;e.isSelected||(e.isSelected=!0)}}else{const t=new x,i=e.selection.iterator;for(;i.next();){const e=i.value;n.contains(e)||t.add(e)}const s=t.iterator;for(;s.next();){s.value.isSelected=!1}const o=n.iterator;for(;o.next();){const t=o.value;t.isSelected||(t.isSelected=!0)}}}get delay(){return this.zh}set delay(t){d.i(t,"number",ct,"delay"),this.zh=t}get isPartialInclusion(){return this.hM}set isPartialInclusion(t){d.i(t,"boolean",ct,"isPartialInclusion"),this.hM=t}get box(){return this.Fl}set box(t){null!==t&&t.hi(),this.Fl=t}}class dt extends W{constructor(t){super(),y(this,"Hw",void 0),y(this,"zC",void 0),y(this,"Lo",void 0),y(this,"aM",void 0),this.name="Panning",this.Hw=new T,this.zC=new T,this.Lo=!1;const e=this;this.aM=()=>{const t=e.diagram;null!==t&&t.Ni(c.document,"scroll",e.aM,!1),e.stopTool()},t&&Object.assign(this,t)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(!t.allowHorizontalScroll&&!t.allowVerticalScroll||!t.lastInput.left||t.currentTool!==this&&!this.isBeyondDragSize())}doActivate(){const t=this.diagram;this.Lo?(t.lastInput.bubbles=!0,t.Bt(c.document,"scroll",this.aM,!1)):(t.currentCursor="move",t.isMouseCaptured=!0,this.Hw.a(t.position)),this.isActive=!0}doDeactivate(){const t=this.diagram;t.currentCursor="",t.isMouseCaptured=!1,this.isActive=!1}doCancel(){const t=this.diagram;t.position=this.Hw,t.isMouseCaptured=!1,this.stopTool()}doMouseMove(){this.XC()}doMouseUp(){this.XC(),this.stopTool()}XC(){const t=this.diagram;if(this.isActive&&t){if(this.Lo)return void(t.lastInput.bubbles=!0);const e=t.position,i=t.firstInput.documentPoint,n=t.lastInput.documentPoint;let s=e.x+i.x-n.x,o=e.y+i.y-n.y;t.allowHorizontalScroll||(s=e.x),t.allowVerticalScroll||(o=e.y),t.position=this.zC.e(s,o)}}get bubbles(){return this.Lo}set bubbles(t){d.i(t,"boolean",dt,"bubbles"),this.Lo=t}get originalPosition(){return this.Hw}}class ft{constructor(t){y(this,"jw",void 0),y(this,"qw",void 0),y(this,"cM",void 0),y(this,"fM",void 0),this.jw=null,this.qw=null,this.cM=null,this.fM=null,t&&Object.assign(this,t)}get mainElement(){return this.cM}set mainElement(t){this.cM=t}get show(){return this.jw}set show(t){this.jw!==t&&(null!==t&&d.i(t,"function",ft,"show"),this.jw=t)}get hide(){return this.qw}set hide(t){this.qw!==t&&(null!==t&&d.i(t,"function",ft,"hide"),this.qw=t)}get valueFunction(){return this.fM}set valueFunction(t){this.fM=t}}class gt{constructor(t,e,i){y(this,"ai",void 0),y(this,"Cm",void 0),y(this,"wc",void 0),this.ai=t,this.Cm=e,this.wc=i}}class mt extends W{constructor(t){super(),y(this,"uM",void 0),y(this,"Ww",void 0),y(this,"dM",void 0),y(this,"gM",void 0),y(this,"Jw",void 0),y(this,"$w",void 0),y(this,"Zw",void 0),this.name="ContextMenu",this.uM=null,this.Ww=null,this.dM=null,this.gM=new T,this.Jw=null,this.Zw=!1;const e=this;this.$w=()=>e.stopTool(),t&&Object.assign(this,t)}_D(){const t=new ft;t.show=(t,e,i)=>i.showDefaultContextMenu(),t.hide=(t,e)=>e.hideDefaultContextMenu(),mt.bu=t;const e=this;this.$w=()=>e.stopTool();const i=d.sn("div"),n=d.sn("div");i.style.cssText="top: 0px;z-index:10002;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px",n.style.cssText="z-index:10001;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;opacity: 0.8;";const s=d.sn("style");c.document.getElementsByTagName("head")[0].appendChild(s),s.sheet.insertRule(".goCXul { list-style: none; }",0),s.sheet.insertRule(".goCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }",0),s.sheet.insertRule(".goCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }",0);const o=this.diagram;null!==o&&(o.Bt(i,"contextmenu",mt.Gh,!1),o.Bt(i,"selectstart",mt.Gh,!1),o.Bt(n,"contextmenu",mt.Gh,!1)),i.className="goCXforeground",n.className="goCXbackground",c.document.body&&(c.document.body.appendChild(i),c.document.body.appendChild(n)),mt.Lm=i,mt.Am=n,mt.mM=!0}static Gh(t){return t.preventDefault(),!1}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(this.isBeyondDragSize()||!t.lastInput.right||t.lastInput.clickCount>1)&&!!(t.lastInput.isTouchEvent&&null!==this.defaultTouchContextMenu||null!==this.findObjectWithContextMenu())}doStart(){const t=this.diagram;this.gM.set(t.firstInput.documentPoint)}doStop(){this.hideContextMenu(),this.currentObject=null}findObjectWithContextMenu(t){void 0===t&&(t=null);const e=this.diagram,i=e.lastInput;let n=null;if(t instanceof Dt||(n=t instanceof Kt?t:e.findObjectAt(i.documentPoint,null,(t=>!t.layer.isTemporary))),null!==n){let t=n;for(;null!==t;){if(null!==t.contextMenu)return t;t=t.panel}if(e.lastInput.isTouchEvent&&this.defaultTouchContextMenu)return n.part}else if(null!==e.contextMenu)return e;return null}doActivate(){}doMouseDown(){if(super.doMouseDown(),this.isActive&&this.currentContextMenu instanceof Pe){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.canStart()&&(t.doActivate(),t.doMouseDown(),t.doDeactivate())}this.diagram.toolManager.mouseDownTools.contains(this)&&this.doContextClick()}doMouseUp(){if(this.isActive&&this.currentContextMenu instanceof Pe){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.canStart()&&(t.doActivate(),t.doCancel(),t.doDeactivate())}this.doContextClick()}doContextClick(){const t=this.diagram;if(this.isActive){const e=this.currentContextMenu;if(null===e)return;let i=null;e instanceof ft||(i=t.findObjectAt(t.lastInput.documentPoint,null,null),null!==i&&i.isContainedBy(e)&&this.standardMouseClick(null,null)),this.maybeStopTool(i)}else this.canStart()&&(this.openMenu(!0),this.isActive||this.stopTool())}maybeStopTool(t){this.stopTool(),this.canStart()&&(this.diagram.currentTool=this,this.doMouseUp())}openMenu(t,e){if(void 0===e&&(e=null),this.Zw)return;this.Zw=!0,t&&this.standardMouseSelect();const i=this.standardMouseClick();if(this.Zw=!1,!i){this.isActive=!0;const t=mt.bu;if(null===e&&(e=this.findObjectWithContextMenu()),null!==e){const i=e.contextMenu;null!==i?(this.currentObject=e instanceof Kt?e:null,this.showContextMenu(i,this.currentObject)):null!==t&&this.showContextMenu(t,this.currentObject)}else null!==t&&this.showContextMenu(t,null);this.currentContextMenu instanceof Pe&&!this.currentContextMenu.visible&&this.stopTool()}}doMouseMove(){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.doMouseMove(),this.isActive&&this.diagram.toolManager.doMouseMove()}showContextMenu(t,e){const i=this.diagram;if(t!==this.currentContextMenu&&this.hideContextMenu(),t instanceof Pe){const n=t;n.layerName="Tool",n.selectable=!1,n.scale=1/i.scale,n.category=this.name,n.hasPlaceholder()&&(n.placeholder.scale=i.scale);const s=n.diagram;null!==s&&s!==i&&s.remove(n),i.add(n),null!==e?n.adornedObject=e:n.data=i.model,n.ensureBounds(),this.positionContextMenu(n,e)}else t instanceof ft&&t.show(e,i,this);this.currentContextMenu=t}positionContextMenu(t,e){if(t.hasPlaceholder())return;const i=t,n=this.diagram,s=n.lastInput.documentPoint.copy(),o=i.measuredBounds,r=n.viewportBounds;n.lastInput.isTouchEvent&&(s.x-=o.width),s.x+o.width>r.right&&(s.x-=o.width+5/n.scale),s.x<r.x&&(s.x=r.x),s.y+o.height>r.bottom&&(s.y-=o.height+5/n.scale),s.y<r.y&&(s.y=r.y),i.position=s}hideContextMenu(){const t=this.diagram,e=this.currentContextMenu;null!==e&&(e instanceof Pe?(t.remove(e),null!==this.Ww&&this.Ww.removeAdornment(e.category),e.data=null,e.adornedObject=null):e instanceof ft&&(null!==e.hide?e.hide(t,this):null!==e.mainElement&&(e.mainElement.style.display="none")),this.currentContextMenu=null,this.standardMouseOver())}tF(){const t=this,e=new x;return e.add(new gt("Copy",(t=>t.commandHandler.copySelection()),(t=>t.commandHandler.canCopySelection()))),e.add(new gt("Cut",(t=>t.commandHandler.cutSelection()),(t=>t.commandHandler.canCutSelection()))),e.add(new gt("Delete",(t=>t.commandHandler.deleteSelection()),(t=>t.commandHandler.canDeleteSelection()))),e.add(new gt("Paste",(e=>e.commandHandler.pasteSelection(t.mouseDownPoint)),(e=>e.commandHandler.canPasteSelection(t.mouseDownPoint)))),e.add(new gt("Select All",(t=>t.commandHandler.selectAll()),(t=>t.commandHandler.canSelectAll()))),e.add(new gt("Undo",(t=>t.commandHandler.undo()),(t=>t.commandHandler.canUndo()))),e.add(new gt("Redo",(t=>t.commandHandler.redo()),(t=>t.commandHandler.canRedo()))),e.add(new gt("Scroll To Part",(t=>t.commandHandler.scrollToPart()),(t=>t.commandHandler.canScrollToPart()))),e.add(new gt("Zoom To Fit",(t=>t.commandHandler.zoomToFit()),(t=>t.commandHandler.canZoomToFit()))),e.add(new gt("Reset Zoom",(t=>t.commandHandler.resetZoom()),(t=>t.commandHandler.canResetZoom()))),e.add(new gt("Group Selection",(t=>t.commandHandler.groupSelection()),(t=>t.commandHandler.canGroupSelection()))),e.add(new gt("Ungroup Selection",(t=>t.commandHandler.ungroupSelection()),(t=>t.commandHandler.canUngroupSelection()))),e.add(new gt("Edit Text",(t=>t.commandHandler.editTextBlock()),(t=>t.commandHandler.canEditTextBlock()))),e}showDefaultContextMenu(){const t=this.diagram;null===this.Jw&&(this.Jw=this.tF()),mt.Lm.innerHTML="",mt.Am.addEventListener("pointerdown",this.$w,!1);const e=this,i=d.sn("ul");i.className="goCXul",mt.Lm.appendChild(i),i.innerHTML="";const n=this.Jw.iterator;for(;n.next();){const s=n.value,o=s.Cm,r=s.wc;if("function"!=typeof o||"function"==typeof r&&!r(t))continue;const a=d.sn("li");a.className="goCXli";const l=d.sn("a");l.className="goCXa",l.href="#",l.Cm=s.Cm,l.addEventListener("pointerdown",(function(i){return this.Cm(t),e.stopTool(),i.preventDefault(),!1}),!1),l.textContent=s.ai,a.appendChild(l),i.appendChild(a)}mt.Lm.style.display="block",mt.Am.style.display="block"}hideDefaultContextMenu(){if(null===this.currentContextMenu||this.currentContextMenu!==mt.bu)return;mt.Lm.style.display="none",mt.Am.style.display="none";const t=this.diagram;null!==t&&t.Ni(mt.Am,"pointerdown",this.$w,!1),this.currentContextMenu=null}get currentContextMenu(){return this.uM}set currentContextMenu(t){this.uM=t,this.Ww=t instanceof Pe?t.adornedPart:null}get defaultTouchContextMenu(){return!1===mt.mM&&null===mt.bu&&Dt.isUsingDOM()&&this._D(),mt.bu}set defaultTouchContextMenu(t){null===t&&(mt.mM=!0),mt.bu=t}get currentObject(){return this.dM}set currentObject(t){this.dM=t}get mouseDownPoint(){return this.gM}}y(mt,"bu",null),y(mt,"mM",!1),y(mt,"Am",null),y(mt,"Lm",null);var pt=(t=>(t[t.LostFocus=1]="LostFocus",t[t.MouseDown=2]="MouseDown",t[t.Tab=3]="Tab",t[t.Enter=4]="Enter",t))(pt||{}),yt=(t=>(t[t.SingleClick=1]="SingleClick",t[t.SingleClickSelected=2]="SingleClickSelected",t[t.DoubleClick=3]="DoubleClick",t))(yt||{}),vt=(t=>(t[t.None=1]="None",t[t.Active=2]="Active",t[t.Editing=3]="Editing",t[t.Validating=4]="Validating",t[t.Invalid=5]="Invalid",t[t.Validated=6]="Validated",t))(vt||{});class bt extends W{constructor(t){super(),y(this,"Ce",void 0),y(this,"pM",void 0),y(this,"yM",void 0),y(this,"Rl",void 0),y(this,"Yt",void 0),y(this,"wM",void 0),y(this,"xM",void 0),y(this,"bM",void 0),y(this,"Qw",void 0),y(this,"_w",void 0),this.name="TextEditing",this.Ce=new fe,this.pM=null,this.yM=2,this.Rl=null,this.Yt=1,this.wM=1,this.xM=!0,this.bM=null,this.Qw=new ft,this._w=null,this.iF(this.Qw),t&&Object.assign(this,t)}iF(t){if(!Dt.isUsingDOM())return;const e=d.sn("textarea");this._w=e;const i=this;e.addEventListener("input",(function(t){if(null===i.textBlock)return;const e=i.measureTemporaryTextBlock(this.value),n=this.textScale;this.style.width=20+Math.max(i.textBlock.measuredBounds.width,e.measuredBounds.width)*n+"px",this.rows=Math.max(i.textBlock.lineCount,e.lineCount)}),!1),e.addEventListener("keydown",(function(t){if(t.isComposing||null===i.textBlock)return;const e=t.key;return"Enter"===e?(!1===i.textBlock.isMultiline&&t.preventDefault(),void i.acceptText(4)):"Tab"===e?(i.acceptText(3),void t.preventDefault()):void("Escape"===e&&(i.doCancel(),null!==i.diagram&&i.diagram.doFocus()))}),!1),e.addEventListener("focus",(function(t){i.eF(t)}),!1),e.addEventListener("blur",(function(t){i.sF(t)}),!1),t.valueFunction=()=>e.value,t.mainElement=e,t.show=(t,i,n)=>{if(!(t instanceof fe&&n instanceof bt))return;if(5===n.state)return e.style.border="3px solid red",void e.focus();const s=t.getDocumentPoint(O.Center),o=i.position,r=i.scale;let a=t.getDocumentScale()*r;a<n.minimumEditorScale&&(a=n.minimumEditorScale);const l=t.naturalBounds.width*a+6,h=t.naturalBounds.height*a+2,u=(s.x-o.x)*r,c=(s.y-o.y)*r,d=t.verticalAlignment,f=(t.lineHeight+t.spacingAbove+t.spacingBelow)*t.lineCount*a,g=.5*h-.5*f,m=d.y*h-d.y*f+d.offsetY-g-f/2;e.value=t.text,i.div.style.font=t.font;e.style.position="absolute",e.style.zIndex="100",e.style.font="inherit",e.style.fontSize=100*a+"%",e.style.lineHeight="normal",e.style.width=l+"px",e.style.left=(u-l/2|0)-1+"px",e.style.top=(c+m|0)-1+"px",e.style.textAlign=t.textAlign,e.style.margin="0",e.style.padding="1px",e.style.border="0",e.style.outline="none",e.style.whiteSpace="pre-wrap",e.style.overflow="hidden",e.rows=t.lineCount,e.textScale=a,e.className="goTXarea",i.div.appendChild(e),e.focus(),n.selectsTextOnActivate&&(e.select(),e.setSelectionRange(0,9999))},t.hide=(t,i)=>{t.div.removeChild(e)}}get textBlock(){return this.pM}set textBlock(t){this.pM=t}get currentTextEditor(){return this.bM}set currentTextEditor(t){this.bM=t}get defaultTextEditor(){return this.Qw}set defaultTextEditor(t){this.Qw=t}get starting(){return this.yM}set starting(t){this.yM=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(null===t||t.isReadOnly||bt.xc&&bt.xc!==this&&(bt.xc.acceptText(2),bt.xc&&bt.xc!==this)||!t.lastInput.left||this.isBeyondDragSize())return!1;const e=t.lastInput.documentPoint,i=t.findObjectAt(e);if(null===i||!(i instanceof fe)||!i.editable||!i.part.canEdit())return!1;const n=i.part;return!(null===n||2===this.starting&&!n.isSelected||3===this.starting&&t.lastInput.clickCount<2)}doStart(){bt.xc=this,null!==this.textBlock&&this.doActivate()}doActivate(){if(this.isActive)return;const t=this.diagram;if(null===t)return;let e=this.textBlock;if(null===e&&(e=t.findObjectAt(t.lastInput.documentPoint)),null===e||!(e instanceof fe)||(this.textBlock=e,null===e.part))return;t.animationManager.stopAnimation(),this.isActive=!0,this.Yt=2;let i=this.defaultTextEditor;null!==e.textEditor&&(i=e.textEditor),this.Ce=this.textBlock.copy();const n=new D(this.textBlock.getDocumentPoint(O.TopLeft),this.textBlock.getDocumentPoint(O.BottomRight));t.scrollToRect(n),i.show(e,t,this),this.currentTextEditor=i}doCancel(){this.stopTool()}doMouseUp(){this.canStart()&&this.doActivate()}doMouseDown(){this.isActive&&this.acceptText(2)}acceptText(t){switch(t){case 2:6===this.Yt?this.currentTextEditor instanceof HTMLElement&&this.currentTextEditor.focus():(2===this.Yt||5===this.Yt||3===this.Yt)&&(this.Yt=4,this.KC());break;case 1:case 4:case 3:if(4===t&&!0===this.textBlock.isMultiline)return;(2===this.Yt||5===this.Yt||3===this.Yt)&&(this.Yt=4,this.KC())}}KC(){const t=this.textBlock,e=this.diagram,i=this.currentTextEditor;if(null!==t&&null!==i){const n=t.text;let s="";if(null!==i.valueFunction&&(s=i.valueFunction()),!this.isValidText(t,n,s))return this.Yt=5,void this.doError(n,s);this.startTransaction(this.name),this.Yt=6,this.transactionResult=this.name,t.text=s,this.doSuccess(n,s),null!==e&&e.v("TextEdited",t,n),this.stopTransaction(),this.stopTool(),null!==e&&e.doFocus()}}doError(t,e){const i=this.textBlock;null!==i.errorFunction&&i.errorFunction(this,t,e);const n=this.currentTextEditor;n&&n.show(i,this.diagram,this)}doSuccess(t,e){const i=this.textBlock;null!==i.textEdited&&i.textEdited(i,t,e)}doDeactivate(){const t=this.diagram;null!==t&&(this.Yt=1,null!==this.currentTextEditor&&this.currentTextEditor.hide(t,this),this.textBlock=null,this.isActive=!1)}doStop(){bt.xc=null}eF(t){if(null===this.currentTextEditor||1===this.state)return;const e=this._w;2===this.Yt&&(this.Yt=3),"function"==typeof e.select&&this.selectsTextOnActivate&&(e.select(),e.setSelectionRange(0,9999))}sF(t){if(null===this.currentTextEditor||1===this.state)return;const e=this._w;"function"==typeof e.focus&&e.focus(),"function"==typeof e.select&&this.selectsTextOnActivate&&(e.select(),e.setSelectionRange(0,9999))}isValidText(t,e,i){const n=this.textValidation;if(null!==n&&!n(t,e,i))return!1;const s=t.textValidation;return!(null!==s&&!s(t,e,i))}get textValidation(){return this.Rl}set textValidation(t){null!==t&&d.i(t,"function",bt,"textValidation"),this.Rl=t}get minimumEditorScale(){return this.wM}set minimumEditorScale(t){null!==t&&d.i(t,"number",bt,"minimumEditorScale"),this.wM=t}get selectsTextOnActivate(){return this.xM}set selectsTextOnActivate(t){null!==t&&d.i(t,"boolean",bt,"selectsTextOnActivate"),this.xM=t}get state(){return this.Yt}set state(t){this.Yt!==t&&(this.Yt=t)}measureTemporaryTextBlock(t){const e=this.Ce;return e.text=t,e.ut(this.textBlock.vl,1/0),e}}y(bt,"LostFocus",1),y(bt,"MouseDown",2),y(bt,"Tab",3),y(bt,"Enter",4),y(bt,"SingleClick",1),y(bt,"SingleClickSelected",2),y(bt,"DoubleClick",3),y(bt,"StateNone",1),y(bt,"StateActive",2),y(bt,"StateEditing",3),y(bt,"StateValidating",4),y(bt,"StateInvalid",5),y(bt,"StateValidated",6),y(bt,"xc",null);var xt=(t=>(t[t.Default=1]="Default",t[t.AnimateLocations=2]="AnimateLocations",t[t.None=3]="None",t))(xt||{});class wt{constructor(t){y(this,"k",void 0),y(this,"Ci",void 0),y(this,"Oi",void 0),y(this,"Mr",void 0),y(this,"Hn",void 0),y(this,"Do",void 0),y(this,"kM",void 0),y(this,"PM",void 0),y(this,"Tm",void 0),y(this,"xi",void 0),y(this,"bc",void 0),y(this,"gn",void 0),y(this,"Dm",void 0),y(this,"Hh",void 0),y(this,"tx",void 0),y(this,"Fm",void 0),y(this,"ix",void 0),y(this,"kc",void 0),y(this,"wu",void 0),y(this,"Rm",void 0),this.k=Dt.ym(),this.Ci=!1,this.Tm=!1,this.xi=!1,this.bc=!1,this.ix=!0,this.kc=1,this.wu=!1,this.Oi=!0,this.Mr=!0,this.Do=600,this.kM=!1,this.PM=!1,this.Hn=new k,this.gn=new kt,this.Dm=new kt,this.gn.ms=this,this.Hh=new k,this.tx=new k,this.Fm=new k,this.Rm=new k,t&&Object.assign(this,t)}Fo(t){this.k=t}oE(){return this.k}canStart(t){return!0}Ol(t){return!(!this.Oi||!this.canStart(t))&&(this.Hn.add(t),this.defaultAnimation.isAnimating&&this.stopAnimation(),this.k.Li(),this.xi=!0,!0)}getBundleAnimation(){return this.Dm}MM(){if(!this.Oi||(this.Dm.de.count>0&&this.Dm.start(),!this.xi))return;const t=this.gn,e=this.k,i=this.Hn.contains("Model");if(i&&(this.bc=!0,1===this.kc?(t.isViewportUnconstrained=!0,t.de.clear(),t.add(e,"position",e.position.copy().offset(0,-200),e.position),t.add(e,"opacity",0,1)):3===this.kc&&t.de.clear(),2===this.kc&&e.ex.equals(e.st)?this.ix=!0:this.ix=!1,e.v("InitialAnimationStarting",this)),i&&!this.Mr||0===t.de.count)return this.Hn.clear(),this.xi=!1,t.de.clear(),t.sx(e),this.bc=!1,void e.C();this.Hn.clear(),e.Sr=!1;const n=t.de.get(e);1!==e.autoScale&&null!==n&&(delete n.ei.scale,delete n.ps.scale);const s=this;c.requestAnimationFrame((()=>{!1===s.xi||t.Ci||(e.getRenderingHint("temporaryPixelRatio")&&e.Vw(),e.SM(),s.xi=!1,t.start(),t.Ci&&(s.ku(),e.invalidateDocumentBounds(),t.YC(0),e.xr(!0),s.Pu(),e.v("AnimationStarting",s)))}))}NM(){return this.Hn.contains("Trigger")&&1===this.Hn.count}GC(t,e,i,n){this.isTicking||this.NM()||t instanceof De&&(null!==t.fromNode||null!==t.toNode)||this.gn.add(t,"position",e,i,n)}nx(t){return this.gn.nx(t)}CM(t){return this.gn.CM(t)}nF(t){const e=this.Hh,i=this;function n(){if(i.Fm.count>0&&(e.addAll(i.Fm),i.Fm.clear(),i.Ci=!0),!1===i.Ci||0===e.count)return;i.tx.addAll(e);const t=i.tx.iterator;for(;t.next();){const e=t.value;!1!==e.Ci&&(e.oF()?e.HC(!1):e.Pc=!0)}i.tx.clear(),!1!==i.Ci?(i.ku(),i.k.xr(),i.Pu(),c.requestAnimationFrame(n)):c.requestAnimationFrame(n)}this.Ci?this.rF(t):(this.Ci=!0,e.add(t),c.requestAnimationFrame((()=>n())))}rF(t){this.Fm.add(t)}lF(){const t=this.Hh.iterator;for(;t.next();)t.value.Pc=!1}ku(){if(this.Tm)return;const t=this.k;this.kM=t.skipsUndoManager,this.PM=t.ge,t.skipsUndoManager=!0,t.ge=!0,this.Tm=!0}Pu(){const t=this.k;t.skipsUndoManager=this.kM,t.ge=this.PM,this.Tm=!1}stopAnimation(t){const e=this.gn;if(!0===this.xi&&(this.xi=!1,this.bc=!1,this.Hn.clear(),e.hF()&&this.k.requestUpdate()),!this.Ci)return e.de.clear(),void e.sx(this.k);if(e.Mu(!0),e.sx(null),!0===t){const t=this.Hh.toArray();for(let e=0;e<t.length;e++)t[e].Mu(!0)}}Mu(t){this.Hh.remove(t),0===this.Hh.count&&(this.Ci=!1,this.k.requestUpdate()),t===this.defaultAnimation&&this.k.v("AnimationFinished",this)}Mc(t,e){this.xi&&(!this.Hn.contains("Expand Tree")&&!this.Hn.contains("Expand SubGraph")||(this.gn.Mc(t,e),this.jC(t)))}Sc(t,e){this.xi&&(!this.Hn.contains("Collapse Tree")&&!this.Hn.contains("Collapse SubGraph")||(this.gn.Sc(t,e),this.gn.LM(e,"position",e.position,e.position),this.jC(t)))}qC(t,e){!this.xi||t.equals(e)||this.NM()||(this.k.Uh||(t=e.copy()),this.gn.LM(this.k,"position",t,e))}WC(t,e){this.xi&&(this.NM()||this.gn.add(this.k,"scale",t,e))}AM(t,e){t.Le&&(t.Nr=e,this.Rm.add(t))}jC(t){const e=t.findLinksConnected();for(;e.next();){const t=e.value;t.Le&&(t.Nr=t.points.copy(),this.Rm.add(t))}}get isEnabled(){return this.Oi}set isEnabled(t){d.i(t,"boolean",wt,"isEnabled"),this.Oi=t,t&&this.Hh.each((t=>{!t.isAnimating&&t.runCount===1/0&&t.start()}))}get duration(){return this.Do}set duration(t){d.i(t,"number",wt,"duration"),t<1&&d.tt(t,">= 1",wt,"duration"),this.Do=t}get isAnimating(){return this.Ci}get isTicking(){return this.Tm}get isInitial(){return this.Mr}set isInitial(t){d.i(t,"boolean",wt,"isInitial"),this.Mr=t}get defaultAnimation(){return this.gn}get activeAnimations(){return this.Hh}get initialAnimationStyle(){return this.kc}set initialAnimationStyle(t){this.kc=t}static defineAnimationEffect(t,e){wt.ox.add(t,e)}static TM(t,e,i,n,s){null===t&&(t=[0,0,0,0]),null===e&&(e=[0,0,0,0]);let o=t[0],r=t[1];const a=t[2],l=t[3];let h=e[0],u=e[1];const c=e[2],d=e[3];0===a||100===a?(o=h,r=u):(0===c||100===c)&&(h=o,u=r),Math.abs(h-o)>180&&(h>o?o+=360:h+=360);return"hsla("+s(i,o,h-o,n)%360+", "+s(i,r,u-r,n)+"%, "+s(i,a,c-a,n)+"%, "+s(i,l,d-l,n)+")"}}r=wt,y(wt,"ox",new L),(()=>{const t=r.ox,e=(t,e,i,n,s,o)=>{t.position=new T(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))};t.add("position:diagram",e),t.add("position",e),t.add("position:part",((t,e,i,n,s,o)=>{s<o?t.yc(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o),!1):t.position=new T(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))})),t.add("location",((t,e,i,n,s,o)=>{s<o?t.yc(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o),!0):t.location=new T(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))})),t.add("position:placeholder",((t,e,i,n,s,o)=>{s<o?t.yc(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o),!1):t.position=new T(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))})),t.add("position:nodeCollapse",((t,e,i,n,s,o)=>{const r=t.actualBounds,a=i.actualBounds,l=a.x+a.width/2-r.width/2,h=a.y+a.height/2-r.height/2;s<o?t.yc(n(s,e.x,l-e.x,o),n(s,e.y,h-e.y,o),!1):t.position=new T(n(s,e.x,l-e.x,o),n(s,e.y,h-e.y,o))})),t.add("desiredSize",((t,e,i,n,s,o)=>{t.desiredSize=new D(n(s,e.width,i.width-e.width,o),n(s,e.height,i.height-e.height,o))})),t.add("width",((t,e,i,n,s,o)=>{t.width=n(s,e,i-e,o)})),t.add("height",((t,e,i,n,s,o)=>{t.height=n(s,e,i-e,o)})),t.add("fill",((t,e,i,n,s,o)=>{t.fill=r.TM(e,i,s,o,n)})),t.add("stroke",((t,e,i,n,s,o)=>{t.stroke=r.TM(e,i,s,o,n)})),t.add("strokeWidth",((t,e,i,n,s,o)=>{t.strokeWidth=n(s,e,i-e,o)})),t.add("strokeDashOffset",((t,e,i,n,s,o)=>{t.strokeDashOffset=n(s,e,i-e,o)})),t.add("background",((t,e,i,n,s,o)=>{t.background=r.TM(e,i,s,o,n)})),t.add("opacity",((t,e,i,n,s,o)=>{t.opacity=n(s,e,i-e,o)})),t.add("scale",((t,e,i,n,s,o)=>{t.scale=n(s,e,i-e,o)})),t.add("angle",((t,e,i,n,s,o)=>{t.angle=n(s,e,i-e,o)}))})(),y(wt,"Default",1),y(wt,"AnimateLocations",2),y(wt,"None",3);class kt{constructor(t){y(this,"rx",void 0),y(this,"vm",void 0),y(this,"Ci",void 0),y(this,"Su",void 0),y(this,"Do",void 0),y(this,"ys",void 0),y(this,"JC",void 0),y(this,"Nc",void 0),y(this,"de",void 0),y(this,"lx",void 0),y(this,"ei",void 0),y(this,"jn",void 0),y(this,"Nu",void 0),y(this,"Cc",void 0),y(this,"hx",void 0),y(this,"ax",void 0),y(this,"Pc",void 0),y(this,"DM",void 0),y(this,"cx",void 0),y(this,"ms",void 0),y(this,"k",void 0),y(this,"FM",void 0),y(this,"RM",void 0),y(this,"vM",void 0),this.k=null,this.ms=null,this.DM=null,this.cx=null,this.FM=!1,this.Ci=!1,this.Pc=!1,this.ei=0,this.jn=0,this.rx=kt.EaseInOutQuad,this.vm=kt.EaseInOutQuad,this.Nu=!1,this.Cc=!1,this.hx=1,this.ax=0,this.Do=NaN,this.ys=NaN,this.RM=0,this.Su=null,this.JC=T.Mo,this.de=new L,this.lx=new L,this.Nc=new k,this.vM=1,t&&Object.assign(this,t)}suspend(){this.Pc=!0}advanceTo(t,e){e&&(this.Pc=!1),this.Nu&&t>=this.ys&&(this.Cc=!0,t-=this.ys),this.RM=t,this.HC(!0),this.ms.ku(),this.k.xr(),this.ms.Pu(),this.k.redraw()}sx(t){if(this.lx.clear(),this.Cc=!1,this.ax=0,this.ys=NaN,this.Nc.count>0&&this.Nc.clear(),null!==t){const e=t.links;for(;e.next();)e.value.Nr=null}}hF(){return this.de.count>0}start(){if(0===this.de.count)return this;if(this.Ci)return this;let t=this.k;const e=this.de.iterator;for(;e.next();){const i=e.key;null===t&&(i instanceof Dt?t=i:i instanceof Kt&&(t=i.diagram))}if(null===t)return this;this.k=t,this.ms=t.animationManager;const i=this.ms;return!1===i.isEnabled||(this.ys=isNaN(this.Do)?i.duration:this.Do,this.vm=this.rx,i.bc&&1===i.kc&&this===i.defaultAnimation&&(this.vm=kt.EaseOutExpo,this.ys=isNaN(this.Do)?600===i.duration?900:i.duration:this.Do),this.vM=t.scrollMode,this.isViewportUnconstrained&&(t.jh=2),i.ku(),this.Nc.each((e=>{e.data=null,t.add(e)})),i.Pu(),this.Ci=!0,this.ei=+new Date,this.jn=this.ei+this.ys,i.nF(this)),this}addTemporaryPart(t,e){return t.Ne()?(this.Nc.add(t),this.k=e,this):this}add(t,e,i,n,s){if(null===this.k&&(t instanceof Dt?this.k=t:t instanceof Kt&&null!==t.diagram&&(this.k=t.diagram)),t instanceof ke){if(!t.isAnimated)return this;"position"===e&&(e="position:part")}return this.LM(t,e,i,n,s),this}LM(t,e,i,n,s){const o=this.de;let r,a,l;if(t instanceof Dt&&"position"===e&&(e="position:diagram"),("fill"===e||"stroke"===e||"background"===e)&&(Qt.Ro(i),Qt.OM(),i=[Qt.Ii.n0,Qt.Ii.n1,Qt.Ii.n2,Qt.Ii.n3],Qt.Ro(n),Qt.OM(),n=[Qt.Ii.n0,Qt.Ii.n1,Qt.Ii.n2,Qt.Ii.n3]),o.contains(t))r=o.getValue(t),a=r.ei,l=r.ps,void 0===a[e]&&(a[e]=this.Cu(i)),l[e]=this.Cu(n);else{if("position"===e&&i.equalsApprox(n))return;a={},l={},a[e]=this.Cu(i),l[e]=this.Cu(n),r=new St(a,l,s),o.add(t,r)}const h=a[e];h instanceof T&&!h.isReal()&&h.a(this.JC),s&&0===e.indexOf("position:")&&t instanceof ke?r.fx.location=this.Cu(t.location):s&&(r.fx[e]=this.Cu(i))}Cu(t){return t instanceof T||t instanceof A?t.copy():t}aF(t){const e=this.de;if(e.contains(t)){e.getValue(t).ux=!0}}nx(t){if(!this.Ci)return!1;const e=this.de.getValue(t);return null!==e&&e.ux}CM(t){if(!this.Ci)return!1;const e=this.de.getValue(t);return null!==e&&!!(e.ei.position||e.ei["position:part"]||e.ei.location)}oF(){if(this.Nc.count>0)return!0;const t=this.de.iterator;for(;t.next();){const e=t.key;if(e instanceof Kt&&null!==e.diagram||e instanceof Dt)return!0}return!1}HC(t){if(this.Pc&&!t)return;const e=this.ms;if(!1===this.Ci)return;const i=+new Date;let n=i>this.jn?this.ys:i-this.ei;t&&(n=this.RM,n<this.ys?(this.ei=+new Date-n,this.jn=this.ei+this.ys):n=this.ys),e.ku(),this.YC(n),this.k.xr(!0),e.Pu(),i>this.jn&&(this.Nu&&!this.Cc?(this.ei=+new Date,this.jn=this.ei+this.ys,this.Cc=!0):this.Mu(!1))}YC(t){const e=this.ys,i=this.de.iterator,n=this.Cc;for(;i.next();){const s=i.key;if(s instanceof Kt&&null===s.diagram)continue;const o=i.value,r=n?o.ps:o.ei,a=n?o.ei:o.ps,l=wt.ox;for(const i in a)"position"===i&&(a["position:placeholder"]||a["position:nodeCollapse"])||null!==l.get(i)&&l.get(i)(s,r[i],a[i],this.vm,t,e,this)}}stop(){return this.Ci?(this.Mu(!0),this):this}Mu(t){if(null!==this.cx&&this.cx.cF(this.DM),!this.Ci)return;const e=this.k,i=this.ms;i.bc=!1,this.Ci=!1,this.Pc=!1,i.ku();const n=this.de,s=this.Nc.iterator;for(;s.next();)e.remove(s.value);const o=this.Nu,r=n.iterator,a=wt.ox;for(;r.next();){const t=r.key,e=r.value,i=o?e.ps:e.ei,n=o?e.ei:e.ps,s=e.fx;for(const o in n)if(null!==a.get(o)){let r=o;e.gx&&("position:nodeCollapse"===r||"position:placeholder"===r)&&(r="position"),a.get(r)(t,i[o],void 0!==s[o]?s[o]:e.gx?i[o]:n[o],this.vm,this.ys,this.ys,this)}e.gx&&void 0!==s.location&&t instanceof ke&&(t.location=s.location),e.ux&&t instanceof ke&&t.Ei(!1)}this.ax++;const l=!t&&this.hx>this.ax;if(!l&&(this===i.Dm||this===i.defaultAnimation)&&this.de.clear(),e.mx.clear(),e.yP(!1),e.invalidateDocumentBounds(),e.C(),e.xr(!0),i.defaultAnimation===this){const t=i.Rm.iterator;for(;t.next();)t.value.fF();i.Rm.clear()}if(e.xr(!0),this.isViewportUnconstrained&&(e.scrollMode=this.vM),i.Pu(),l)return this.Cc=!1,void this.start();this.sx(null),i.Mu(this),this.Su&&this.Su(this),e.requestUpdate()}Mc(t,e){const i=e.actualBounds;let n=null;if(e instanceof Ve&&(n=e.placeholder),null!==n&&n.visible){const e=n.getDocumentPoint(O.TopLeft),i=n.padding;e.x+=i.left,e.y+=i.top,this.add(t,"position",e,t.position,!1)}else this.add(t,"position",new T(i.x+i.width/2,i.y+i.height/2),t.position,!1);this.add(t,"scale",.01,t.scale,!1),t instanceof Ve&&this.uF(t,e)}uF(t,e){const i=t.memberParts;for(;i.next();){const t=i.value;t instanceof Ce&&this.Mc(t,e)}}Sc(t,e){if(!t.isVisible())return;let i=null;if(e instanceof Ve&&(i=e.placeholder),null!==i&&i.visible){const e=i.getDocumentPoint(O.TopLeft),n=i.padding;e.x+=n.left,e.y+=n.top,this.add(t,"position:placeholder",t.position,e,!0)}else this.add(t,"position:nodeCollapse",t.position,e,!0);this.add(t,"scale",t.scale,.01,!0),this.aF(t),t instanceof Ve&&this.dF(t,e)}dF(t,e){const i=t.memberParts;for(;i.next();){const t=i.value;t instanceof Ce&&this.Sc(t,e)}}get duration(){return this.Do}set duration(t){d.i(t,"number",kt,"duration"),t<1&&d.tt(t,">= 1",kt,"duration"),this.Do=t}get reversible(){return this.Nu}set reversible(t){this.Nu=t}get runCount(){return this.hx}set runCount(t){t>0?this.hx=t:d.o("Animation.runCount value must be a positive integer.")}get finished(){return this.Su}set finished(t){this.Su!==t&&(null!==t&&d.i(t,"function",kt,"finished"),this.Su=t)}get easing(){return this.rx}set easing(t){this.rx=t}get isViewportUnconstrained(){return this.FM}set isViewportUnconstrained(t){this.FM=t}get isAnimating(){return this.Ci}getTemporaryState(t){let e=this.lx.get(t);return null===e&&(e={},this.lx.add(t,e)),e}}y(kt,"EaseLinear",((t,e,i,n)=>i*t/n+e)),y(kt,"EaseInOutQuad",((t,e,i,n)=>(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e)),y(kt,"EaseInQuad",((t,e,i,n)=>i*(t/=n)*t+e)),y(kt,"EaseOutQuad",((t,e,i,n)=>-i*(t/=n)*(t-2)+e)),y(kt,"EaseInExpo",((t,e,i,n)=>0===t?e:i*Math.pow(2,10*(t/n-1))+e)),y(kt,"EaseOutExpo",((t,e,i,n)=>t===n?e+i:i*(1-Math.pow(2,-10*t/n))+e));class St{constructor(t,e,i){y(this,"ei",void 0),y(this,"ps",void 0),y(this,"fx",void 0),y(this,"gx",void 0),y(this,"ux",void 0),this.ei=t,this.ps=e,this.fx={},this.gx=i,this.ux=!1}}var Pt=(t=>(t[t.Default=1]="Default",t[t.Immediate=2]="Immediate",t[t.Bundled=3]="Bundled",t))(Pt||{});class Mt{constructor(t,e,i){y(this,"Se",void 0),y(this,"cn",void 0),y(this,"Lu",void 0),y(this,"Lc",void 0),this.Se=null,this.cn=t,this.Lu=i||1,this.Lc=null,void 0!==e&&(this.Lc=e,void 0===i&&(this.Lu=2))}copy(){const t=new Mt(this.cn);t.Lu=this.Lu;const e=this.Lc;if(null!==e){const i={};void 0!==e.duration&&(i.duration=e.duration),void 0!==e.finished&&(i.finished=e.finished),void 0!==e.easing&&(i.easing=e.easing),t.Lc=i}return t}get propertyName(){return this.cn}set propertyName(t){this.cn=t}get animationSettings(){return this.Lc}set animationSettings(t){this.Lc=t}gF(t){const e=this.Lc;null!==e&&(e.duration&&(t.duration=e.duration),e.finished&&(t.finished=e.finished),e.easing&&(t.easing=e.easing))}get startCondition(){return this.Lu}set startCondition(t){this.Lu=t}}y(Mt,"Default",1),y(Mt,"Immediate",2),y(Mt,"Bundled",3);class Ct{constructor(t){y(this,"k",void 0),y(this,"St",void 0),y(this,"Wt",void 0),y(this,"Cr",void 0),y(this,"Il",void 0),y(this,"El",void 0),y(this,"Vl",void 0),y(this,"Ul",void 0),y(this,"Bl",void 0),y(this,"zl",void 0),y(this,"Xl",void 0),y(this,"Kl",void 0),y(this,"Yl",void 0),y(this,"Gl",void 0),y(this,"Hl",void 0),y(this,"jl",void 0),y(this,"wc",void 0),y(this,"ql",void 0),y(this,"px",void 0),y(this,"Om",void 0),y(this,"Au",void 0),y(this,"At",void 0),k.Yi(this),this.k=null,this.At=new x,this.St="",this.Wt=1,this.Cr=!1,this.Il=!0,this.El=!0,this.Vl=!0,this.Ul=!0,this.Bl=!0,this.zl=!0,this.Xl=!0,this.Kl=!0,this.Yl=!0,this.Gl=!0,this.Hl=!0,this.jl=!0,this.wc=!0,this.ql=!0,this.px=!0,this.Om=!1,this.Au=[],t&&Object.assign(this,t)}mF(){const t=this.At;for(let e=0;e<t.length;e++)t.r[e].IM(null);t.clear(),this.Au.length=0}Fo(t){this.k=t}toString(t){void 0===t&&(t=0);const e='Layer "'+this.name+'"';if(t<=0)return e;let i=0,n=0,s=0,o=0,r=0;const a=this.At.iterator;for(;a.next();){const t=a.value;t instanceof Ve?s++:t instanceof Ce?n++:t instanceof De?o++:t instanceof Pe?r++:i++}let l="";if(i>0&&(l+=i+" Parts "),n>0&&(l+=n+" Nodes "),s>0&&(l+=s+" Groups "),o>0&&(l+=o+" Links "),r>0&&(l+=r+" Adornments "),t>1){const t=this.At.iterator;for(;t.next();){const e=t.value;l+="\n    "+e.toString();const i=e.data;null!==i&&k.fs(i)&&(l+=" #"+k.fs(i)),e instanceof Ce?l+=" "+d.toString(i):e instanceof De&&(l+=" "+d.toString(e.fromNode)+" "+d.toString(e.toNode))}}return e+" "+this.At.count+": "+l}findObjectAt(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),!1===this.ql)return null;let n=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(n=!0);const s=T.l(),o=this.At.r;for(let r=o.length;r--;){const a=o[r];if(!0===n&&!1===a.Al()||!a.isVisible())continue;s.a(t),s.Ue(a.ws);let l=a.$C(s,e,i);if(null!==l&&(null!==e&&(l=e(l)),null!==l&&(null===i||i(l))))return T.s(s),l}return T.s(s),null}findObjectsAt(t,e,i,n){if(void 0===e&&(e=null),void 0===i&&(i=null),!(n instanceof x)&&!(n instanceof k)&&(n=new k),!1===this.ql)return n;let s=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(s=!0);const o=T.l(),r=this.At.r;for(let a=r.length;a--;){const l=r[a];if(!0===s&&!1===l.Al()||!l.isVisible())continue;o.a(t),o.Ue(l.ws);let h=l;l.ZC(o,e,i,n)&&(null!==e&&(h=e(h)),null!==h&&(null===i||i(h))&&n.add(h))}return T.s(o),n}findObjectsIn(t,e,i,n,s){if(void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),!(s instanceof x)&&!(s instanceof k)&&(s=new k),!1===this.ql)return s;let o=!1;null!==this.diagram&&this.diagram.viewportBounds.containsRect(t)&&(o=!0);const r=this.At.r;for(let a=r.length;a--;){const l=r[a];if(!0===o&&!1===l.Al()||!l.isVisible())continue;let h=l;l.Im(t,e,i,n,s)&&(null!==e&&(h=e(h)),null!==h&&(null===i||i(h))&&s.add(h))}return s}NP(t,e,i,n,s,o,r){if(!1===this.ql)return s;const a=this.At.r;for(let l=a.length;l--;){const h=a[l];if(!0===r&&!1===h.Al()||!o(h)||!h.isVisible())continue;let u=h;h.Im(t,e,i,n,s)&&(null!==e&&(u=e(u)),null!==u&&(null===i||i(u))&&s.add(u))}return s}findObjectsNear(t,e,i,n,s,o){if(void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=!0),!1!==s&&!0!==s&&((s instanceof x||s instanceof k)&&(o=s),s=!0),!(o instanceof x)&&!(o instanceof k)&&(o=new k),!1===this.ql)return o;let r=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(r=!0);const a=T.l(),l=T.l(),h=this.At.r;for(let u=h.length;u--;){const c=h[u];if(!0===r&&!1===c.Al()||!c.isVisible())continue;a.a(t),a.Ue(c.ws),l.e(t.x+e,t.y),l.Ue(c.ws);let d=c;c.QC(a,l,i,n,s,o)&&(null!==i&&(d=i(d)),null!==d&&(null===n||n(d))&&o.add(d))}return T.s(a),T.s(l),o}EM(){return this.At.r}Us(t,e){if(!this.visible)return;const i=this.At.r,n=i.length;if(0===n)return;const s=d.rt(),o=d.rt();for(let r=0;r<n;r++){const t=i[r];if(t.VM=r,t instanceof De){if(!1===t.Le)continue}else if(t instanceof Pe&&null!==t.adornedPart)continue;const n=t.actualBounds;t.isVisible()&&n.intersectsRectPlus(e,10)?(t.Us(!0),s.push(t)):(t.Us(!1),null!==t.adornments&&t.adornments.count>0&&o.push(t))}for(let r=0;r<s.length;r++){const t=s[r];t.UM();const e=t.adornments;for(;e.next();){const t=e.value;t.ut(1/0,1/0),t.zt(),t.Us(!0)}}for(let r=0;r<o.length;r++)o[r].UM();d.it(s),d.it(o)}Tu(t){let e=1;return 1!==this.Wt&&(e=t.globalAlpha,t.globalAlpha=e*this.Wt),e}_C(t,e){for(let i=0;i<e;i++)t[i].Du()}Gi(t,e,i){if(!this.visible||0===this.Wt||(void 0===i&&(i=!0),!i&&this.isTemporary))return;const n=this.At.r,s=n.length;if(0===s)return;t.Cr&&this._C(n,s);const o=this.Tu(t),r=this.Au;r.length=0;const a=e.scale,l=D.l();for(let h=0;h<s;h++){const i=n[h];this.Em(t,i,e,r,a,l,!0)}D.s(l),t.Cr&&this._C(n,s),t.globalAlpha=o}rE(t,e,i){if(!this.visible||0===this.Wt)return;const n=this.At.r,s=n.length;if(0===s)return;const o=this.Tu(t),r=this.Au;r.length=0;const a=e.scale,l=D.l();for(let h=0;h<s;h++){const s=n[h];i.contains(s)||this.Em(t,s,e,r,a,l,!0)}D.s(l),t.globalAlpha=o}pF(t,e,i,n){if(!this.visible||0===this.Wt||!n&&this.isTemporary)return;const s=this.At.r,o=s.length;if(0===o)return;const r=this.Tu(t),a=this.Au;a.length=0;const l=e.scale,h=D.l();for(let u=0;u<o;u++){const n=s[u];i.contains(n)&&this.Em(t,n,e,a,l,h,!1)}D.s(h),t.globalAlpha=r}yF(t,e,i,n,s){if(!this.visible||0===this.opacity)return;const o=this.diagram.grid.part;if(!n&&this.isTemporary){if(s&&o.layer===this){const e=this.Tu(t);o.Gi(t,i),t.globalAlpha=e}}else{const e=this.Tu(t),n=i.scale,r=D.l(),a=this.At.r,l=a.length;for(let h=0;h<l;h++){const e=a[h];!s&&e===o||this.Em(t,e,i,null,n,r,!1)}D.s(r),t.globalAlpha=e}}lE(t,e,i){if(!this.visible||0===this.Wt)return;const n=this.Tu(t),s=this.Au;s.length=0;const o=e.scale,r=D.l(),a=this.At.r,l=a.length,h=i.length;for(let u=0;u<l;u++){const n=a[u],l=n.qh(n.actualBounds);this.wF(l,i,h,o)&&this.Em(t,n,e,s,o,r,!0)}D.s(r),t.globalAlpha=n}Em(t,e,i,n,s,o,r){if(r&&!e.Al())return void t.removePartFromView(e);if(null!==n&&e instanceof De&&(e.isOrthogonal&&n.push(e),!1===e.Le))return void t.removePartFromView(e);let a=!1,l=e.containingGroup;for(;null!==l;)a?null!==l.si&&o.intersectRect(l.si):null!==l.si&&(a=!0,o.a(l.si)),l=l.containingGroup;const h=e.actualBounds;let u=!1;if(a&&e.isVisible()){if(!o.intersectsRect(h))return void t.removePartFromView(e);u=!o.containsRect(h)}u&&(t.save(),t instanceof Ht?t.partClipRect=o.copy():(t.beginPath(),t.rect(o.x,o.y,o.width,o.height),t.clip())),h.width*s>i.Vm||h.height*s>i.Vm?e.Gi(t,i):this.xF(t,e),u&&(t.restore(),t.clearContextCache(!0))}xF(t,e){const i=e.actualBounds,n=e.naturalBounds;if(0===i.width||0===i.height||isNaN(i.x)||isNaN(i.y)||!e.isVisible())return;const s=e.L;if(null===e.background&&(e.mn(t,"rgba(0,0,0,0.3)",!0,!1,n,i),t.fillRect(i.x,i.y,i.width,i.height)),null!==e.background&&(t.transform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),e.mn(t,e.background,!0,!1,n,i),t.fillRect(0,0,n.width/2,n.height/2),!s.Ok())){const e=1/(s.m11*s.m22-s.m12*s.m21);t.transform(s.m22*e,-s.m12*e,-s.m21*e,s.m11*e,e*(s.m21*s.dy-s.m22*s.dx),e*(s.m12*s.dx-s.m11*s.dy))}}wF(t,e,i,n){const s=2/n,o=4/n;for(let r=0;r<i;r++){const i=e[r];if(0!==i.width&&0!==i.height&&t.intersects(i.x-s,i.y-s,i.width+o,i.height+o))return!0}return!1}t(t,e,i,n,s){const o=this.diagram;null!==o&&o.raiseChangedEvent(2,t,this,e,i,n,s)}Wh(t,e,i){const n=this.At;if(e.IM(this),t>=n.count)t=n.count;else if(n.elt(t)===e)return-1;n.insertAt(t,e),e.Um(i);const s=this.diagram;return null!==s&&(i?s.C():s.Wh(e)),this.yx(t,e),t}ie(t,e,i){if(!i&&e.layer!==this&&null!==e.layer)return e.layer.ie(t,e,i);const n=this.At;if(t<0||t>=n.length){if((t=n.indexOf(e))<0)return-1}else if(n.elt(t)!==e&&(t=n.indexOf(e))<0)return-1;e.Bm(i),n.removeAt(t);const s=this.diagram;return null!==s&&(i?s.C():s.ie(e)),e.IM(null),t}yx(t,e){t=this.bF(t,e),e instanceof Ve&&this.kF(t,e),null!==e.svg&&e.svg.remove()}bF(t,e){const i=e.zOrder;if(isNaN(i))return t;const n=this.At,s=n.count;if(s<=1)return t;if(t<0&&(t=n.indexOf(e)),t<0)return-1;let o=t-1,r=NaN;for(;o>=0&&(r=n.elt(o).zOrder,isNaN(r));)o--;let a=t+1,l=NaN;for(;a<s&&(l=n.elt(a).zOrder,isNaN(l));)a++;if(!isNaN(r)&&r>i)for(;;){if(-1===o||r<=i)return o++,o===t?t:(n.removeAt(t),n.insertAt(o,e),o);for(r=NaN;--o>=0&&(r=n.elt(o).zOrder,isNaN(r)););}else if(!isNaN(l)&&l<i)for(;;){if(a===s||l>=i)return a--,a===t?t:(n.removeAt(t),n.insertAt(a,e),a);for(l=NaN;++a<s&&(l=n.elt(a).zOrder,isNaN(l)););}return t}kF(t,e){if(null===e||!isNaN(e.zOrder))return;this.PF(t,e);const i=e.containingGroup;null!==i&&this.yx(-1,i)}PF(t,e){if(0===e.memberParts.count)return;let i=-1;const n=this.At.r,s=n.length;for(let o=0;o<s;o++){const s=n[o];if(s===e&&(t=o,i>=0)||i<0&&s.containingGroup===e&&(i=o,t>=0))break}if(!(i<0)&&i<t){const n=this.At;n.removeAt(t),n.insertAt(i,e)}}get parts(){return this.At.iterator}get partsBackwards(){return this.At.iteratorBackwards}get diagram(){return this.k}get name(){return this.St}set name(t){d.i(t,"string",Ct,"name");const e=this.St;if(e!==t){const i=this.diagram;if(null!==i){""===e&&d.o("Cannot rename default Layer to: "+t);const n=i.layers;for(;n.next();)n.value.name===t&&d.o("Layer.name is already present in this diagram: "+t)}this.St=t,this.t("name",e,t);const n=this.At.iterator;for(;n.next();){n.value.layerName=this.St}}}get opacity(){return this.Wt}set opacity(t){const e=this.Wt;if(e!==t){d.i(t,"number",Ct,"opacity"),(t<0||t>1)&&d.tt(t,"0 <= value <= 1",Ct,"opacity"),this.Wt=t;const i=this.diagram;null!==i&&i.C(),this.t("opacity",e,t)}}get isViewportAligned(){return this.Om}set isViewportAligned(t){const e=this.Om;e!==t&&(this.Om=t,this.diagram&&(this.tL(),this.diagram.C()),this.t("isViewportAligned",e,t),t&&(this.isInDocumentBounds=!1))}tL(){if(!this.Om)return;const t=this.diagram,e=this.At.r,i=e.length,n=t.kt,s=t.Pt;for(let o=0;o<i;o++){const i=e[o],r=i.naturalBounds.width,a=i.naturalBounds.height;let l=i.alignment;(l.isDefault()||!l.isSpot())&&(l=O.BottomRight);let h=i.alignmentFocus;h.isDefault()&&(h=new O(l.x,l.y));const u=l.x*n+l.offsetX-(h.x*r+h.offsetX),c=l.y*s+l.offsetY-(h.y*a+h.offsetY),d=T.X(u,c);t.MF(d),i.yc(d.x,d.y,!0),T.s(d),i.K=1/t.scale}}get isTemporary(){return this.Cr}set isTemporary(t){const e=this.Cr;e!==t&&(d.i(t,"boolean",Ct,"isTemporary"),this.Cr=t,this.t("isTemporary",e,t))}get visible(){return this.wc}set visible(t){const e=this.wc;if(e!==t){d.i(t,"boolean",Ct,"visible"),this.wc=t;const i=this.At.iterator;for(;i.next();)i.value.Ei(t);const n=this.diagram;null!==n&&n.C(),this.t("visible",e,t)}}get pickable(){return this.ql}set pickable(t){const e=this.ql;e!==t&&(d.i(t,"boolean",Ct,"pickable"),this.ql=t,this.t("pickable",e,t))}get isInDocumentBounds(){return this.px}set isInDocumentBounds(t){const e=this.px;e!==t&&(this.px=t,null!==this.diagram&&this.diagram.invalidateDocumentBounds(),this.t("isInDocumentBounds",e,t))}get allowCopy(){return this.Il}set allowCopy(t){const e=this.Il;e!==t&&(d.i(t,"boolean",Ct,"allowCopy"),this.Il=t,this.t("allowCopy",e,t))}get allowDelete(){return this.El}set allowDelete(t){const e=this.El;e!==t&&(d.i(t,"boolean",Ct,"allowDelete"),this.El=t,this.t("allowDelete",e,t))}get allowTextEdit(){return this.Vl}set allowTextEdit(t){const e=this.Vl;e!==t&&(d.i(t,"boolean",Ct,"allowTextEdit"),this.Vl=t,this.t("allowTextEdit",e,t))}get allowGroup(){return this.Ul}set allowGroup(t){const e=this.Ul;e!==t&&(d.i(t,"boolean",Ct,"allowGroup"),this.Ul=t,this.t("allowGroup",e,t))}get allowUngroup(){return this.Bl}set allowUngroup(t){const e=this.Bl;e!==t&&(d.i(t,"boolean",Ct,"allowUngroup"),this.Bl=t,this.t("allowUngroup",e,t))}get allowLink(){return this.zl}set allowLink(t){const e=this.zl;e!==t&&(d.i(t,"boolean",Ct,"allowLink"),this.zl=t,this.t("allowLink",e,t))}get allowRelink(){return this.Xl}set allowRelink(t){const e=this.Xl;e!==t&&(d.i(t,"boolean",Ct,"allowRelink"),this.Xl=t,this.t("allowRelink",e,t))}get allowMove(){return this.Kl}set allowMove(t){const e=this.Kl;e!==t&&(d.i(t,"boolean",Ct,"allowMove"),this.Kl=t,this.t("allowMove",e,t))}get allowReshape(){return this.Yl}set allowReshape(t){const e=this.Yl;e!==t&&(d.i(t,"boolean",Ct,"allowReshape"),this.Yl=t,this.t("allowReshape",e,t))}get allowResize(){return this.Gl}set allowResize(t){const e=this.Gl;e!==t&&(d.i(t,"boolean",Ct,"allowResize"),this.Gl=t,this.t("allowResize",e,t))}get allowRotate(){return this.Hl}set allowRotate(t){const e=this.Hl;e!==t&&(d.i(t,"boolean",Ct,"allowRotate"),this.Hl=t,this.t("allowRotate",e,t))}get allowSelect(){return this.jl}set allowSelect(t){const e=this.jl;e!==t&&(d.i(t,"boolean",Ct,"allowSelect"),this.jl=t,this.t("allowSelect",e,t))}}var Nt=(t=>(t[t.None=1]="None",t[t.Uniform=2]="Uniform",t[t.UniformToFill=3]="UniformToFill",t))(Nt||{}),Lt=(t=>(t[t.All=1]="All",t[t.NotDirected=2]="NotDirected",t[t.NotDirectedFast=3]="NotDirectedFast",t[t.NotUndirected=4]="NotUndirected",t[t.DestinationTree=5]="DestinationTree",t[t.SourceTree=6]="SourceTree",t))(Lt||{}),Tt=(t=>(t[t.Document=1]="Document",t[t.Infinite=2]="Infinite",t))(Tt||{}),At=(t=>(t[t.TreeParent=1]="TreeParent",t[t.AllParents=2]="AllParents",t[t.AnyParents=3]="AnyParents",t))(At||{});class Dt{constructor(t,e){if(y(this,"ms",void 0),y(this,"gi",void 0),y(this,"BM",void 0),y(this,"wx",void 0),y(this,"Lr",void 0),y(this,"Fu",void 0),y(this,"xx",void 0),y(this,"bx",void 0),y(this,"kx",void 0),y(this,"Px",void 0),y(this,"Mx",void 0),y(this,"Sx",void 0),y(this,"Ac",void 0),y(this,"jh",void 0),y(this,"Nx",void 0),y(this,"Cx",void 0),y(this,"Lx",void 0),y(this,"Wl",void 0),y(this,"Tc",void 0),y(this,"Ar",void 0),y(this,"zm",void 0),y(this,"Ax",void 0),y(this,"Tx",void 0),y(this,"Ru",void 0),y(this,"qn",void 0),y(this,"Tr",void 0),y(this,"Jh",void 0),y(this,"vo",void 0),y(this,"Xm",void 0),y(this,"Dc",void 0),y(this,"Km",void 0),y(this,"Fc",void 0),y(this,"vu",void 0),y(this,"Dr",void 0),y(this,"Wn",void 0),y(this,"zM",void 0),y(this,"XM",void 0),y(this,"Dx",void 0),y(this,"Fx",void 0),y(this,"KM",void 0),y(this,"Rx",void 0),y(this,"YM",void 0),y(this,"GM",void 0),y(this,"HM",void 0),y(this,"vx",void 0),y(this,"Ym",void 0),y(this,"Fr",void 0),y(this,"Rr",void 0),y(this,"vr",void 0),y(this,"Or",void 0),y(this,"Ir",void 0),y(this,"Er",void 0),y(this,"Ox",void 0),y(this,"Vr",void 0),y(this,"Ix",void 0),y(this,"Ur",void 0),y(this,"Br",void 0),y(this,"zr",void 0),y(this,"Xr",void 0),y(this,"Ex",void 0),y(this,"jM",void 0),y(this,"Oo",void 0),y(this,"qM",void 0),y(this,"Vx",void 0),y(this,"Ux",void 0),y(this,"WM",void 0),y(this,"Si",void 0),y(this,"JM",void 0),y(this,"$M",void 0),y(this,"ZM",void 0),y(this,"Is",void 0),y(this,"Io",void 0),y(this,"Oi",void 0),y(this,"Bx",void 0),y(this,"Il",void 0),y(this,"El",void 0),y(this,"zx",void 0),y(this,"Xx",void 0),y(this,"Vl",void 0),y(this,"Ul",void 0),y(this,"Bl",void 0),y(this,"Kx",void 0),y(this,"zl",void 0),y(this,"Xl",void 0),y(this,"Kl",void 0),y(this,"Yl",void 0),y(this,"Gl",void 0),y(this,"Hl",void 0),y(this,"jl",void 0),y(this,"Yx",void 0),y(this,"Gx",void 0),y(this,"QM",void 0),y(this,"Ou",void 0),y(this,"Iu",void 0),y(this,"Hx",void 0),y(this,"jx",void 0),y(this,"qx",void 0),y(this,"Wx",void 0),y(this,"Gm",void 0),y(this,"Jx",void 0),y(this,"$x",void 0),y(this,"Zx",void 0),y(this,"Zt",void 0),y(this,"_M",void 0),y(this,"Qx",void 0),y(this,"tS",void 0),y(this,"Eu",void 0),y(this,"pn",void 0),y(this,"Jn",void 0),y(this,"ee",void 0),y(this,"$n",void 0),y(this,"iL",void 0),y(this,"Jl",void 0),y(this,"iS",void 0),y(this,"eS",void 0),y(this,"_x",void 0),y(this,"Vu",void 0),y(this,"Hm",void 0),y(this,"tb",void 0),y(this,"Kr",void 0),y(this,"$l",void 0),y(this,"$h",void 0),y(this,"SF",void 0),y(this,"NF",void 0),y(this,"jm",void 0),y(this,"ib",void 0),y(this,"eb",void 0),y(this,"es",void 0),y(this,"qm",void 0),y(this,"Wm",void 0),y(this,"Uu",void 0),y(this,"Zl",void 0),y(this,"Rc",void 0),y(this,"Jm",void 0),y(this,"Yr",void 0),y(this,"Zh",void 0),y(this,"sS",void 0),y(this,"$m",void 0),y(this,"jt",void 0),y(this,"L",void 0),y(this,"Xe",void 0),y(this,"Sr",void 0),y(this,"Vi",void 0),y(this,"xs",void 0),y(this,"CF",void 0),y(this,"Ql",void 0),y(this,"Gr",void 0),y(this,"Ml",void 0),y(this,"Hr",void 0),y(this,"Qh",void 0),y(this,"vc",void 0),y(this,"nS",void 0),y(this,"Bu",void 0),y(this,"_h",void 0),y(this,"zu",void 0),y(this,"Gt",void 0),y(this,"_l",void 0),y(this,"st",void 0),y(this,"K",void 0),y(this,"Xu",void 0),y(this,"kt",void 0),y(this,"Pt",void 0),y(this,"dt",void 0),y(this,"Oc",void 0),y(this,"Ew",void 0),y(this,"sb",void 0),y(this,"ta",void 0),y(this,"Ic",void 0),y(this,"nb",void 0),y(this,"ob",void 0),y(this,"rb",void 0),y(this,"LF",void 0),y(this,"AF",void 0),y(this,"Ui",void 0),y(this,"Nl",void 0),y(this,"Vm",void 0),y(this,"Zm",void 0),y(this,"oS",void 0),y(this,"rS",void 0),y(this,"eL",void 0),y(this,"Qm",void 0),y(this,"TF",void 0),y(this,"DF",void 0),y(this,"FF",void 0),y(this,"lb",void 0),y(this,"RF",void 0),y(this,"vF",void 0),y(this,"OF",void 0),y(this,"ia",void 0),y(this,"sL",void 0),y(this,"th",void 0),y(this,"ea",void 0),y(this,"sa",void 0),y(this,"na",void 0),y(this,"oa",void 0),y(this,"yu",void 0),y(this,"Gh",void 0),y(this,"ni",void 0),y(this,"Tt",void 0),y(this,"Ec",void 0),y(this,"Wk",void 0),y(this,"Jk",void 0),y(this,"cc",void 0),y(this,"Wt",void 0),y(this,"pu",void 0),y(this,"ab",void 0),y(this,"cb",void 0),y(this,"fb",void 0),y(this,"ub",void 0),y(this,"db",void 0),y(this,"_m",void 0),y(this,"aS",void 0),y(this,"t0",void 0),y(this,"i0",void 0),y(this,"e0",void 0),y(this,"ex",void 0),y(this,"cS",void 0),y(this,"gb",void 0),y(this,"Vc",void 0),Dt.uw||(Dt.Ik(),Dt.uw=!0),k.Yi(this),Dt.oL(this),this.jt=!0,this.Tt=null,this.kt=0,this.Pt=0,this.dt=null,Dt.isUsingDOM()){const t=this,e=()=>{t.Ni(c.document,"DOMContentLoaded",e,!1),t.setRTL()};null!==c.document.body?this.setRTL():t.Bt(c.document,"DOMContentLoaded",e,!1)}this.Oc=null,Dt.fS("Model",qe);const i=this;return this.JM=t=>i.partManager.doModelDataChanged(t),this.$M=t=>i.partManager.doModelChanged(t),this.nb=null,this.ob=null,this.rL(),this.model=Ze.initDiagramModel(),this.gb=null,this.themeManager=new Ii,this.Oo=!0,this.lL(),this.layout=new je,this.Oo=!1,this.TF=null,this.DF=null,this.FF=null,this.lb=null,this.RF=null,this.vF=null,this.OF=null,this.ia=null,this.sL=null,this.th=null,this.ea=null,this.sa=null,this.na=null,this.oa=null,this.yu=()=>{},this.Gh=null,this.Uu=!1,this.Ec=new Ft(this),void 0!==t&&("string"==typeof t||c.Element&&t instanceof Element?this.uS(t):e=t),e&&this.setProperties(e),this.jt=!1,this.requestUpdate(),this}KD(){return null!==this.dt}get renderer(){return this.Rc}set renderer(t){if(this instanceof Bt)return;""===t&&(t="default");const e=t.toLowerCase();if(e===this.Rc)return;this.Rc=e;let i=null;"default"===e||"canvas"===e?(i=this.Zl.get("svg"),null!==i&&i.Ft.remove(),this.dt&&(this.ni=this.dt.ci)):"svg"===e?(this.Zl.contains("svg")?i=this.Zl.get("svg"):(i=new _t(this,c.document),this.addRenderer("svg",i)),null!==this.div&&this.div.appendChild(i.Ft),this.ni=i.ci,this.dt&&(this.dt.ci.setTransform(this.Ui,0,0,this.Ui,0,0),this.dt.ci.clearRect(0,0,this.kt,this.Pt))):"debug"===e&&(this.Zl.contains("SVG")||(i=new _t(this,c.document),this.addRenderer("SVG",i),i.Ft.style.backgroundColor="whitesmoke",null!==this.div&&this.div.after(i.Ft))),this.jt||this.redraw()}rL(){this.Vc=new x,this.setupRouters(),this.ms=new wt,this.ms.Fo(this),this.gi=17,this.BM=!1,this.Xu=!1,this.wx="default",this.Gt=new x,this.Zl=new L,this.Rc="default",this.resetRenderingHints(),this.IF(),this.Wt=1,this.st=new T(NaN,NaN).g(),this.ex=new T(NaN,NaN),this.K=1,this.$m=1,this.xx=new T(NaN,NaN).g(),this.bx=NaN,this.kx=1e-4,this.Px=100,this.L=new R,this.Mx=new T(NaN,NaN).g(),this.Sx=new D(NaN,NaN,NaN,NaN).g(),this.Ac=new F(0,0,0,0).g(),this.jh=1,this.Nx=!1,this.Cx=null,this.Lx=null,this.Wl=1,this.Tc=O.Default,this.Ar=1,this.zm=O.Default,this.Ax=O.None,this.Tx=O.None,this.Xe=!0,this.Ru=!1,this.qn=new Set,this.Tr=new k,this.Jh=new k,this.vo=!1,this._l=new L,this.Bu=!0,this.Xm=250,this.Dc=-1,this.Km=new F(16,16,16,16).g(),this.Sr=!1,this.Fc=!1,this.vu=!0,this.Jm=new G,this.Jm.diagram=this,this.Yr=new G,this.Yr.diagram=this,this.Zh=new G,this.Zh.diagram=this,this.Dr=null,this.Wn=null,this.Ew=!1,this.EF(),this.Hr=new k,this.Dx=!0,this.Fx=1,this.KM=!1,this.Rx=1,this.vx="auto",this.Ym="auto",this.Fr=null,this.Rr=null,this.vr=null,this.Or=null,this.Ir=null,this.Er=null,this.Ox=null,this.Vr=null,this.Ix=!1,this.Ur=null,this.Br=null,this.zr=null,this.Xr=null,this.Ex=!1,this.sb={},this.ta=[null,null],this.Oo=!1,this.qM=!1,this.Vx=!1,this.Ux=!1,this.WM=!0,this.xs=!1,this._h=!1,this.ZM=!0,this.Is=-2,this.Ql=new L,this.zu=new x,this.Io=!1,this.Oi=!0,this.Bx=!0,this.Il=!0,this.El=!0,this.zx=!1,this.Xx=!0,this.Vl=!0,this.Ul=!0,this.Bl=!0,this.Kx=!0,this.zl=!0,this.Xl=!0,this.Kl=!0,this.Yl=!0,this.Gl=!0,this.Hl=!0,this.jl=!0,this.Yx=!0,this.Gx=!0,this.QM=!1,this.Ic=!1,this.Ou=!0,this.Iu=!0,this.Hx=!0,this.jx=!0,this.qx=16,this.Wx=16,this.Gm=!1,this.Jx=!1,this.$x=0,this.Zx=0,this.Zt=new F(5).g(),this._M=(new k).g(),this.Qx=999999999,this.tS=(new k).g(),this.Qh=!0,this.Eu=!0,this.vc=!0,this.pn=!1,this.Jn=!1,this.Gr=!0,this.Ml=!1,this.$n=!1,this.iL=new k,this.nS=new k,this.Jl=null,this.iS=new A(8,8),this.eS=999,this.Wk=1,this.Jk=0,this.Vi={scale:1,position:new T,bounds:new D,canvasSize:new A,newCanvasSize:new A,isScroll:!1},this.Vi.canvasSize=this.Vi.canvasSize,this.Vi.newCanvasSize=this.Vi.newCanvasSize,this.Vi.isScroll=!1,this._x=new D(NaN,NaN,NaN,NaN).g(),this.Vu=new A(NaN,NaN).g(),this.Hm=new D(NaN,NaN,NaN,NaN).g(),this.tb=!1,this.VF(),this.es=null,this.qm=!1,this.cc=null,this.partManager=new qe,this.toolManager=new Z,this.toolManager.initializeStandardTools(),this.defaultTool=this.toolManager,this.currentTool=this.defaultTool,this.cb=null,this.fb=new Et,this.ub=null,this.db=null,this.ab=!1,this.pu=!1,this.commandHandler=new Vt,this.i0=null,this.e0=T.Lk,this.cS=!1,this.Ui=1,this.Nl=null,this.Vm=1,this._m=0,this.aS=[0,0,0,0,0],this.t0=0,this.Zm=1,this.oS=0,this.rS=new T,this.eL=500,this.Wm=new T,this.Qm=!1}static isUsingDOM(){return Dt.hL}static useDOM(t){Dt.hL=!!t&&void 0!==c.document}clear(){this.animationManager.stopAnimation(),this.model.clear(),Dt.aL(),this.cL(!1),this.zu.clear(),this.fL(),this.Jl=null,this.invalidateDocumentBounds(),this.ensureBounds(),this.C()}cL(t){this.animationManager.stopAnimation(!0),this._M=(new k).g(),this.tS=(new k).g();const e=this.skipsUndoManager,i=null!==this.Si&&void 0!==this.Si;i&&(this.skipsUndoManager=!0);let n=null;null!==this.es&&(n=this.es.part,null!==n&&this.remove(n));const s=[],o=this.Gt.length;if(t){for(let t=0;t<o;t++){const e=this.Gt.r[t].parts;for(;e.next();){const t=e.value;t!==n&&null===t.data&&s.push(t)}}for(let t=0;t<s.length;t++){const e=s[t];this.remove(e)}}for(let r=0;r<o;r++)this.Gt.r[r].mF();return this.partManager.clear(),this.qn.clear(),this.Tr.clear(),this.Jh.clear(),this._l.clear(),this.Hr.clear(),this.cc=null,this.zu.clear(),this.fL(),d.Nk=[],null!==n&&(this.add(n),this.partManager.parts.remove(n)),i&&(this.skipsUndoManager=e),s}static aL(){Dt.s0=null,Dt.mb=""}static hE(){return null}reset(){this.clear(),this.jt=!0,this.rL(),this.themeManager=new Ii,this.jr(),this.Oo=!0,this.lL(),this.layout=new je,this.Oo=!1,this.model=Ze.initDiagramModel(),this.model.undoManager=new q,this.Uu=!1,this.jt=!1,this.C()}VF(){this.Kr=new L,this.Kr.add("",(new Ce).add(new fe({stroke:"black",font:"10pt sans-serif"}).bind("text","",d.toString).theme("stroke","text").theme("font","normal"))),this.Kr.add("Comment",(new Ce).add(new fe({stroke:"brown",font:"10pt sans-serif"}).bind("text","",d.toString).theme("stroke","comment").theme("font","normal"))),this.Kr.add("LinkLabel",new Ce({selectable:!1,avoidable:!1}).add(new le("Ellipse",{fill:"black",stroke:null,desiredSize:new A(3,3).et()}).theme("fill","link"))),this.$h=new L,this.$h.add("",new Ve(ie.Vertical,{selectionObjectName:"GROUPPANEL"}).add(new fe({stroke:"black",font:"bold 12pt sans-serif"}).bind("text","",d.toString).theme("stroke","text").theme("font","bold"),new ie(ie.Auto,{name:"GROUPPPANEL"}).add(new le({fill:"rgba(128,128,128,0.2)",stroke:"black",strokeWidth:1}).theme("fill","group").theme("stroke","outline").theme("strokeWidth","group"),new ze({padding:5}).theme("padding","group")))),this.$l=new L,this.$l.add("",(new De).add(new le({isPanelMain:!0,stroke:"black"}).theme("stroke","link"),new le({toArrow:"Standard",fill:"black",stroke:null,strokeWidth:0}).theme("toArrow").theme("fill","link"))),this.$l.add("Comment",(new De).add(new le({isPanelMain:!0,stroke:"brown"}).theme("stroke","comment"))),this.jm=new Pe(ie.Auto).add(new le({fill:null,stroke:"dodgerblue",strokeWidth:3}).theme("stroke","selection").theme("strokeWidth","selection"),new ze({margin:1.5}).theme("margin","selection","numbers",null,(t=>t?new F(t/2):1.5))),this.ib=this.jm,this.eb=new Pe(ie.Link).add(new le({isPanelMain:!0,fill:null,stroke:"dodgerblue",strokeWidth:3}).theme("stroke","selection").theme("strokeWidth","selection"))}setRTL(t){let e=void 0===t?this.div:t;null===e&&(e=c.document.body);const i=d.sn("div");i.dir="rtl",i.style.cssText="font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll;",i.textContent="A",e.appendChild(i);let n="reverse";i.scrollLeft>0?n="default":(i.scrollLeft=1,0===i.scrollLeft&&(n="negative")),e.removeChild(i),this.wx=n}setScrollWidth(t){let e=void 0===t?this.div:t;null===e&&(e=c.document.body);let i=0;if(Dt.isUsingDOM()){let t=Dt.hS,n=Dt.lS;null===t&&(Dt.hS=d.sn("p"),t=Dt.hS,t.style.width="100%",t.style.height="200px",t.style.boxSizing="content-box",Dt.lS=d.sn("div"),n=Dt.lS,n.style.position="absolute",n.style.visibility="hidden",n.style.width="200px",n.style.height="150px",n.style.boxSizing="content-box",n.appendChild(t)),n.style.overflow="hidden",e.appendChild(n);const s=t.offsetWidth;n.style.overflow="scroll";let o=t.offsetWidth;s===o&&(o=n.clientWidth),e.removeChild(n),i=s-o,0===i&&!d.hr&&(i=11)}this.gi=i,this.BM=!0}li(t){t in Nt?this.autoScale=t:d.ar(this,t)}toString(t){void 0===t&&(t=0);let e="";this.div&&this.div.id&&(e=this.div.id);let i='Diagram "'+e+'"';if(t<=0)return i;const n=this.Gt.iterator;for(;n.next();){i+="\n  "+n.value.toString(t-1)}return i}static oL(t){Dt.hb=t}static ym(){return Dt.hb}static fromDiv(t){let e=t;return"string"==typeof t&&(e=c.document.getElementById(t)),e instanceof HTMLDivElement&&Dt.se.has(e)?Dt.se.get(e):null}get div(){return this.Tt}set div(t){if(this.Tt!==t){const e=this.Tt;if(null!==e){if(Dt.se.delete(e),e.goDiagram=void 0,e.go=void 0,e.innerHTML="",null!==this.dt){const t=this.dt.Ft;this.Ni(t,"pointermove",this.ea,!1),this.Ni(t,"pointerdown",this.th,!1),this.Ni(t,"pointerup",this.sa,!1),this.Ni(t,"pointerout",this.na,!1),this.Ni(t,"pointercancel",this.oa,!1),this.dt.dispose()}this.Oc&&(this.Oc.disconnect(),this.Oc=null);const t=this.toolManager;null!==t&&(t.mouseDownTools.each((t=>t.cancelWaitAfter())),t.mouseMoveTools.each((t=>t.cancelWaitAfter())),t.mouseUpTools.each((t=>t.cancelWaitAfter()))),t.cancelWaitAfter(),this.currentTool.doCancel(),this.dt=null,this.Ni(c,"resize",this.lb,!1),this.Ni(c,"wheel",this.ia,!0),Dt.ym()===this&&Dt.oL(null)}else null===this.th&&(this.$n=!1);if(this.Tt=null,null!==t){const e=Dt.se.get(t);e&&(e.div=null),this.uS(t),this.yu(),this.themeManager&&this.themeManager.UF()}else this.themeManager&&this.themeManager.BF()}}setupRouters(){this.Vc.push(new zi)}uS(t){const e=this;if(!Dt.isUsingDOM())return;null==t&&d.o("Diagram setup requires an argument DIV."),null!==e.Tt&&d.o("Diagram has already completed setup."),"string"==typeof t?e.Tt=c.document.getElementById(t):t instanceof HTMLDivElement?e.Tt=t:d.o("No DIV or DIV id supplied: "+t),null===e.Tt&&d.o("Invalid DIV id; could not get element with id: "+t);const i=Dt.se.get(e.Tt);if(i&&i!==this&&d.o("Invalid div id; div already has a Diagram associated with it."),!e.Oc&&c.ResizeObserver){const t=c.ResizeObserver,i=d.Sk((()=>e.requestUpdate()),250,!1);e.Oc=new t((()=>i())),e.Oc.observe(e.Tt)}"static"===c.getComputedStyle(e.Tt,null).position&&(e.Tt.style.position="relative");let n=5;const s="rgba(2"+n+"5, 255, 255, 0)";n--,e.Tt.style["-webkit-tap-highlight-color"]=s,e.Tt.innerHTML="",Dt.se.set(e.Tt,e),e.Tt.goDiagram=e,e.Tt.go=c.go;const o=new qt(e);void 0!==o.style&&(o.style.position="absolute",o.style.top="0px",o.style.left="0px","rtl"===c.getComputedStyle(e.Tt,null).getPropertyValue("direction")&&(e.Xu=!0),o.style.zIndex="2",o.style.userSelect="none",o.style.MozUserSelect="none",o.style.touchAction="none",o.style.letterSpacing="normal !important",o.style.wordSpacing="normal !important",o.style.lang="unknown"),e.dt=o,e.ni=o.ci;const r=e.ni;e.Ui=e.computePixelRatio(),e.viewSize.isReal()||(e.kt=e.Tt.clientWidth||1,e.Pt=e.Tt.clientHeight||1),e.uL(e.kt,e.Pt);const a=e;e.Tt.insertBefore(o.Ft,e.Tt.firstChild);const l=new qt(null);if(l.width=1,l.height=1,e.LF=l,e.AF=l.ci,Dt.isUsingDOM()){const t=d.sn("div"),i=d.sn("div");t.style.position="absolute",t.style.overflow="auto",t.style.width=e.kt+"px",t.style.height=e.Pt+"px",t.style.zIndex="1",i.style.position="absolute",i.style.width="1px",i.style.height="1px",e.Tt.appendChild(t),t.appendChild(i),t.onscroll=Dt.zF,t.addEventListener("pointerdown",Dt.XF),t.k=e,t.KF=!0,t.YF=!0,e.nb=t,e.ob=i}e.yu=d.Sk((()=>{e.Nl=null,e.C()}),300,!1),e.lb=d.Sk((()=>{e.SM()}),250,!1),e.Gh=t=>(t.preventDefault(),!1),e.ia=t=>{if(!a.isEnabled)return;const e=a.Uc(t,!0);e.bubbles=!0;let i=0,n=0;e.delta=0,void 0!==t.deltaX?(0!==t.deltaX&&(i=t.deltaX>0?1:-1),0!==t.deltaY&&(n=t.deltaY>0?1:-1),e.delta=Math.abs(t.deltaX)>Math.abs(t.deltaY)?-i:-n):void 0!==t.wheelDeltaX?(0!==t.wheelDeltaX&&(i=t.wheelDeltaX>0?-1:1),0!==t.wheelDeltaY&&(n=t.wheelDeltaY>0?-1:1),e.delta=Math.abs(t.wheelDeltaX)>Math.abs(t.wheelDeltaY)?-i:-n):void 0!==t.wheelDelta&&0!==t.wheelDelta&&(e.delta=t.wheelDelta>0?1:-1),a.doMouseWheel(),a.ra(e,t)},e.sL=t=>{if(!a.isEnabled)return;e.Ic=!1,a.Uc(t,!0);const i=a.currentTool;i.cancelWaitAfter(),i.standardMouseOver()},e.th=t=>{if(!a.isEnabled)return;e.Ic=!0;const i=a.sb;void 0===i[t.pointerId]&&(i[t.pointerId]=t);const n=a.ta;let s=!1;if(null===n[0]||n[0].pointerId!==t.pointerId&&n[0].pointerType===t.pointerType)if(null!==n[1]&&n[1].pointerId===t.pointerId)n[1]=t,s=!0;else if(null===n[0])n[0]=t;else{if(null!==n[1])return void t.preventDefault();n[1]=t,s=!0}else n[0]=t;const o="touch"===t.pointerType||"pen"===t.pointerType;o&&(a.Ew=!1,a.Qm=!0);const r=a.GF(t,t,s),l=a.rS,h=o?25:10;t.timeStamp-a.oS<a.eL&&!(Math.abs(l.x-t.screenX)>h||Math.abs(l.y-t.screenY)>h)?a.Zm++:a.Zm=1,r.clickCount=a.Zm,a.oS=t.timeStamp,a.rS.setTo(t.screenX,t.screenY),a.doMouseDown(),1!==t.button?a.ra(r,t):t.preventDefault()},e.ea=t=>{if(!a.isEnabled)return;e.Ic=!0;const i=a.ta;if(null===i[0]||i[0].pointerId!==t.pointerId&&i[0].pointerType===t.pointerType){if(null!==i[1]&&i[1].pointerId===t.pointerId)return void(i[1]=t);if(null!==i[0])return;i[0]=t}else i[0]=t;if(i[0].pointerId!==t.pointerId)return;const n=a.HF(t,t,null!==i[1]);a.doMouseMove(),a.ra(n,t)},e.sa=t=>{if(!a.isEnabled)return;e.Ic=!0;const i="touch"===t.pointerType||"pen"===t.pointerType,n=a.sb;if(i&&a.Ew)return delete n[t.pointerId],void t.preventDefault();const s=a.ta;if(null===s[0]||s[0].pointerId!==t.pointerId&&s[0].pointerType===t.pointerType)return null!==s[1]&&s[1].pointerId===t.pointerId?void(s[1]=null):void 0;s[0]=null;const o=a.dS(t,!1,!0,!1,!0,!1);let r=c.document.elementFromPoint(t.clientX,t.clientY)||null;null!==r&&void 0!==r.shadowRoot&&null!==r.shadowRoot&&(r=r.shadowRoot.elementFromPoint(t.clientX,t.clientY)),null!==r&&r.k instanceof Dt&&r.k!==a&&r.k.o0(t,o),null===r&&(r=t.target),a.o0(t,o),o.clickCount=a.Zm,o.targetDiagram=a.gS(t,r),o.targetObject=null,a.doMouseUp(),a.ra(o,t),i&&(a.Qm=!1)},e.na=t=>{if(!a.isEnabled)return;e.Ic=!1;const i=a.sb;i[t.pointerId]&&delete i[t.pointerId];const n=a.ta;if(null!==n[0]&&n[0].pointerId===t.pointerId&&(n[0]=null),null!==n[1]&&n[1].pointerId===t.pointerId&&(n[1]=null),"touch"===t.pointerType||"pen"===t.pointerType)return;const s=a.currentTool;s.cancelWaitAfter(),s.standardMouseOver()},e.oa=t=>{const e=a.ta;null!==e[0]&&e[0].pointerId===t.pointerId?(e[0]=null,a.Qm=!1):null!==e[1]&&e[1].pointerId===t.pointerId&&(e[1]=null)};const h=r;if(e.rb=h.U[d.Ts("7eba17a4ca3b1a8346")][d.Ts("78a118b7")](h.U,Dt.Ku,n,n),r.clearContextCache(!0),e.jF(),"svg"===this.Rc){const t=this.Zl.get("svg");this.Tt.appendChild(t.Ft),this.ni=t.ci}}addEventListener(t,e,i,n){t.addEventListener(e,i,{capture:n,passive:!1})}Bt(t,e,i,n){t.addEventListener(e,i,{capture:n,passive:!1})}removeEventListener(t,e,i,n){t.removeEventListener(e,i,{capture:n})}Ni(t,e,i,n){t.removeEventListener(e,i,{capture:n})}jF(){const t=this;let e=this.dt.Ft;e instanceof HTMLCanvasElement||(e=t.div),this.Bt(e,"pointerdown",t.th,!1),this.Bt(e,"pointermove",t.ea,!1),this.Bt(e,"pointerup",t.sa,!1),this.Bt(e,"pointerout",t.na,!1),this.Bt(e,"pointercancel",t.oa,!1),this.Bt(e,"pointerenter",t.qF,!1),this.Bt(e,"pointerleave",t.WF,!1),this.Bt(e,"wheel",t.ia,!1),this.Bt(e,"keydown",t.JF,!1),this.Bt(e,"keyup",t.$F,!1),this.Bt(e,"blur",t.ZF,!1),this.Bt(e,"focus",t.QF,!1),this.Bt(e,"selectstart",(t=>(t.preventDefault(),!1)),!1),this.Bt(e,"contextmenu",(t=>(t.preventDefault(),!1)),!1),this.Bt(c,"resize",t.lb,!1)}Vw(){this._m>30&&(this.Nl=1)}yP(t){null!==this.Nl&&(this.Nl=null,t&&this.yu(),this._m=0,this.aS=[0,0,0,0,0],this.t0=0)}computePixelRatio(){return null!==this.Nl?this.Nl:c.devicePixelRatio||1}get avgSpf(){return this._m}doMouseDown(){this.currentTool.doMouseDown()}doMouseMove(){this.currentTool.doMouseMove()}doMouseUp(){this.currentTool.doMouseUp()}doMouseWheel(){this.currentTool.doMouseWheel()}doKeyDown(){this.currentTool.doKeyDown()}doKeyUp(){this.currentTool.doKeyUp()}doFocus(){this.focus()}focus(){if(this.dt)if(this.scrollsPageOnFocus)this.dt.focus();else{const t=c.scrollX,e=c.scrollY;this.dt.focus(),c.scrollTo(t,e)}}QF(t){Dt.se.get(this).v("GainedFocus")}ZF(t){Dt.se.get(this).v("LostFocus")}SM(){if(null===this.dt)return;const t=this.Tt;if(null===t||0===t.clientWidth||0===t.clientHeight)return;this.BM||this.setScrollWidth();const e=this.Jn?this.gi:0,i=this.pn?this.gi:0,n=this.Ui;if(this.Ui=this.computePixelRatio(),this.Ui!==n&&(this.Ru=!0,this.requestUpdate()),t.clientWidth!==this.kt+e||t.clientHeight!==this.Pt+i){this.la(),this.Xe=!0;const t=this.layout;null!==t&&t.isViewportSized&&1===this.autoScale&&(this.Fc=!0,t.invalidateLayout()),this.xs||this.requestUpdate()}}lL(){let t=0,e=new Ct;e.name="Grid",e.allowSelect=!1,e.pickable=!1,e.isTemporary=!0,e.isInDocumentBounds=!1,this.qr(e,t++),e=new Ct,e.name="ViewportBackground",e.isViewportAligned=!0,e.isTemporary=!0,e.isInDocumentBounds=!1,this.qr(e,t++),e=new Ct,e.name="Background",this.qr(e,t++),e=new Ct,e.name="",this.qr(e,t++),e=new Ct,e.name="Foreground",this.qr(e,t++),e=new Ct,e.name="ViewportForeground",e.isViewportAligned=!0,e.isTemporary=!0,e.isInDocumentBounds=!1,this.qr(e,t++),e=new Ct,e.name="Adornment",e.isTemporary=!0,e.isInDocumentBounds=!1,this.qr(e,t++),e=new Ct,e.name="Tool",e.isTemporary=!0,e.isInDocumentBounds=!0,this.qr(e,t++)}dL(){const t=new ie(ie.Grid,{name:"GRID"}).add(new le("LineH",{stroke:"lightgray",strokeWidth:.5,interval:1}).theme("stroke","gridMinor"),new le("LineV",{stroke:"lightgray",strokeWidth:.5,interval:1}).theme("stroke","gridMinor"),new le("LineH",{stroke:"gray",strokeWidth:.5,interval:5}).theme("stroke","gridMajor"),new le("LineV",{stroke:"gray",strokeWidth:.5,interval:5}).theme("stroke","gridMajor"),new le("LineH",{stroke:"gray",strokeWidth:1,interval:10}).theme("stroke","gridMajor"),new le("LineV",{stroke:"gray",strokeWidth:1,interval:10}).theme("stroke","gridMajor")),e=new ke({layerName:"Grid",zOrder:0,isInDocumentBounds:!1,isAnimated:!1,pickable:!1,locationObjectName:"GRID"}).add(t);return this.add(e),this.partManager.parts.remove(e),t.visible=!1,t}static zF(){const t=Dt.se.get(this.parentElement||this);if(t){if(t.Jx)return void(t.Jx=!1);if(!t.isEnabled)return void t.gL();t.diagramScroll(this)}}static XF(t){this.k.isEnabled?(this.k.$x=t.target.scrollTop,this.k.Zx=t.target.scrollLeft):this.k.updateScroll()}diagramScroll(t){if(null===this.dt)return;const e=this.nb,i=this.ob;this.Gm=!0;let n=this.documentBounds,s=this.viewportBounds;const o=this.Ac;let r=n.x-o.left,a=n.y-o.top;const l=n.width+o.left+o.right,h=n.height+o.top+o.bottom;let u=n.right+o.right,c=n.bottom+o.bottom,d=s.x,f=s.y;const g=s.width,m=s.height;let p=s.right,y=s.bottom;const v=this.scale;let b,x=t.scrollLeft;if(this.Xu)switch(this.wx){case"negative":x=x+t.scrollWidth-t.clientWidth;break;case"reverse":x=t.scrollWidth-x-t.clientWidth}const w=x;if(g<l||m<h)return b=T.X(this.position.x,this.position.y),this.allowHorizontalScroll&&this.Zx!==w&&(b.x=w/v+r,this.Zx=w),this.allowVerticalScroll&&this.$x!==t.scrollTop&&(b.y=t.scrollTop/v+a,this.$x=t.scrollTop),this.position=b,T.s(b),this.Gm=!1,void(this.Eu=!1);if(b=T.l(),t.KF&&this.allowHorizontalScroll&&(r<d&&(this.position=b.e(w+r,this.position.y)),u>p)){const t=e.scrollWidth-this.kt;this.position=b.e(-t+w-this.kt/v+u,this.position.y)}if(t.YF&&this.allowVerticalScroll&&(a<f&&(this.position=b.e(this.position.x,t.scrollTop+a)),c>y)){const i=e.scrollHeight-this.Pt;this.position=b.e(this.position.x,-i+t.scrollTop-this.Pt/v+c)}T.s(b),this.ih(),this.Gm=!1,this.Eu=!1,n=this.documentBounds,s=this.viewportBounds,u=n.right,p=s.right,c=n.bottom,y=s.bottom,r=n.x,d=s.x,a=n.y,f=s.y,g>=l&&r>=d&&u<=p&&(i.style.width="1px"),m>=h&&a>=f&&c<=y&&(i.style.height="1px")}computeBounds(t){return void 0===t&&(t=new D),this.Li(),this.mL(t)}mL(t){if(this.fixedBounds.isReal())return t.a(this.fixedBounds),t.addMargin(this.Zt),t;let e=!0;const i=this.Gt.r,n=i.length;for(let s=0;s<n;s++){const n=i[s];if(!n.visible||!n.isInDocumentBounds)continue;const o=n.At.r,r=o.length;for(let i=0;i<r;i++){const n=o[i];if(!n.isInDocumentBounds||!n.isVisible())continue;const s=n.actualBounds;s.isReal()&&(e?(e=!1,t.a(s)):t.unionRect(s))}}return e&&t.e(0,0,0,0),t.addMargin(this.Zt),t}computePartsBounds(t,e){void 0===e&&(e=!1);let i=null;if(Array.isArray(t))for(let n=0;n<t.length;n++){const s=t[n];!e&&s instanceof De||(s.ensureBounds(),null===i?i=s.actualBounds.copy():i.unionRect(s.actualBounds))}else{const n=t.iterator;for(;n.next();){const t=n.value;!e&&t instanceof De||(t.ensureBounds(),null===i?i=t.actualBounds.copy():i.unionRect(t.actualBounds))}}return null===i?new D(NaN,NaN,0,0):i}Bs(t){if(!t&&!this.$n||this.jt||null===this.dt||!this.documentBounds.isReal())return;if(this.jt=!0,t){const t=this.initialPosition;if(t.isReal())return this.jt=!1,void(this.position=t);let e=this.initialDocumentSpot,i=this.initialViewportSpot;e.isNoSpot()&&(e=O.TopLeft),i.isNoSpot()&&(i=O.TopLeft);const n=T.l();n.setRectSpot(this.documentBounds,e);const s=this.viewportBounds,o=D.X(0,0,s.width,s.height),r=T.l();r.setRectSpot(o,i),r.e(n.x-r.x,n.y-r.y),this.jt=!1,this.position=r,D.s(o),T.s(r)}let e=this.Wl;t&&1!==this.Ar&&(e=this.Ar);const i=1!==e?this.Yu(e):this.scale,n=this.st.x,s=this.st.y,o=this.kt/i,r=this.Pt/i;let a=this.Tc;const l=this.zm;if(t&&!a.isSpot()&&(l.isSpot()||l.isDefault())){const t=this.initialDocumentSpot.isSpot()&&this.initialViewportSpot.isSpot();a=l.isDefault()&&!t?O.Center:l}this.mS(this.documentBounds,o,r,a,t);const h=this.scale;this.scale=i,this.jt=!1;const u=this.viewportBounds;u.equalsApproxTo(n,s,o,r)||this.onViewportBoundsChanged(new D(n,s,o,r),u,h,!1)}Yu(t){const e=this.$m;if(null===this.dt)return e;this.ensureBounds();const i=this.documentBounds;if(!i.isReal())return e;const n=i.width,s=i.height,o=this.kt+(this.Jn?this.gi:0),r=this.Pt+(this.pn?this.gi:0),a=o/n,l=r/s;let h;return 2===t?(h=Math.min(l,a),h>e&&(h=e),h<this.minScale&&(h=this.minScale),h>this.maxScale&&(h=this.maxScale),h):3===t?(h=0,h=l>a?(r-this.gi)/s:(o-this.gi)/n,h>e&&(h=e),h<this.minScale&&(h=this.minScale),h>this.maxScale&&(h=this.maxScale),h):this.scale}zoomToFit(){const t=this.jh;this.jh=1,this.scale=this.Yu(2),1!==t&&(this.Bs(!1),this.mS(this.documentBounds,this.kt/this.K,this.Pt/this.K,this.Tc,!1)),this.jh=t}zoomToRect(t,e){void 0===e&&(e=2);const i=t.width,n=t.height;if(0===i||0===n||isNaN(i)&&isNaN(n))return;let s=1;if(2===e||3===e)if(isNaN(i))s=this.viewportBounds.height*this.scale/n;else if(isNaN(n))s=this.viewportBounds.width*this.scale/i;else{const t=this.kt,o=this.Pt;s=3===e?o/n>t/i?(o-(this.pn?this.gi:0))/n:(t-(this.Jn?this.gi:0))/i:Math.min(o/n,t/i)}this.scale=s,this.position=new T(t.x,t.y)}get _F(){return this.jt}set _F(t){this.jt=t}alignDocument(t,e){this.ensureBounds();const i=this.documentBounds,n=this.viewportBounds;this.position=new T(i.x+(t.x*i.width+t.offsetX)-(e.x*n.width-e.offsetX),i.y+(t.y*i.height+t.offsetY)-(e.y*n.height-e.offsetY))}focusObject(t){if(t instanceof Kt){this.i0=t;const e=T.l();this.e0=this.transformDocToView(t.getDocumentPoint(O.TopLeft,e)),T.s(e)}else this.i0=null,this.e0=T.Lk}mS(t,e,i,n,s){const o=T.X(this.st.x,this.st.y);let r=o.x,a=o.y;if(null!==this.i0){let t=T.l();t=this.i0.getDocumentPoint(O.TopLeft,t),r=t.x-this.e0.x/this.scale,a=t.y-this.e0.y/this.scale,n=O.None,T.s(t)}if(s||1===this.scrollMode){n.isSpot()&&(e>t.width&&(r=t.x+(n.x*t.width+n.offsetX)-(n.x*e-n.offsetX)),i>t.height&&(a=t.y+(n.y*t.height+n.offsetY)-(n.y*i-n.offsetY)));const s=this.Ac,o=e-t.width;if(e<t.width+s.left+s.right){let i=r+e/2;i=Math.min(i,t.right+Math.max(o,s.right)-e/2),i=Math.max(i,t.left-Math.max(o,s.left)+e/2),r=i-e/2}else r>t.left?r=t.left:r<t.right-e&&(r=t.right-e);const l=i-t.height;if(i<t.height+s.top+s.bottom){let e=a+i/2;e=Math.min(e,t.bottom+Math.max(l,s.bottom)-i/2),e=Math.max(e,t.top-Math.max(l,s.top)+i/2),a=e-i/2}else a>t.top?a=t.top:a<t.bottom-i&&(a=t.bottom-i)}if(o.x=isFinite(r)?r:-this.Zt.left,o.y=isFinite(a)?a:-this.Zt.top,null!==this.positionComputation){const t=this.positionComputation(this,o);o.x=t.x,o.y=t.y}this.ms.qC(this.st,o),o.x=Math.round(o.x),o.y=Math.round(o.y),this.st.e(o.x,o.y),this.jr(),this.tR(),T.s(o)}findPartAt(t,e){if(void 0===e&&(e=!0),e){const e=this.PP(t,(t=>t.part),(t=>t.canSelect()));if(e instanceof ke)return e}else{const e=this.PP(t,(t=>t.part));if(e instanceof ke)return e}return null}findObjectAt(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.Li();const n=this.Gt.iteratorBackwards;for(;n.next();){const s=n.value;if(!s.visible)continue;const o=s.findObjectAt(t,e,i);if(null!==o)return o}return null}PP(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.Li();const n=this.Gt.iteratorBackwards;for(;n.next();){const s=n.value;if(!s.visible||s.isTemporary)continue;const o=s.findObjectAt(t,e,i);if(null!==o)return o}return null}findPartsAt(t,e,i){return void 0===e&&(e=!0),this.iR(t,(t=>t.part),e?t=>t instanceof ke&&t.canSelect():null,i)}iR(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),!(n instanceof x)&&!(n instanceof k)&&(n=new k),this.Li();const s=this.Gt.iteratorBackwards;for(;s.next();){const o=s.value;!o.visible||o.isTemporary||o.findObjectsAt(t,e,i,n)}return n}findObjectsAt(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),!(n instanceof x)&&!(n instanceof k)&&(n=new k),this.Li();const s=this.Gt.iteratorBackwards;for(;s.next();){const o=s.value;o.visible&&o.findObjectsAt(t,e,i,n)}return n}findPartsIn(t,e,i,n){return void 0===e&&(e=!1),void 0===i&&(i=!0),this.eR(t,null,(t=>t instanceof ke&&(!i||t.canSelect())),e,n)}findObjectsIn(t,e,i,n,s){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),!(s instanceof x)&&!(s instanceof k)&&(s=new k),this.Li();const o=this.Gt.iteratorBackwards;for(;o.next();){const r=o.value;r.visible&&r.findObjectsIn(t,e,i,n,s)}return s}NP(t,e,i,n,s,o){const r=new k;this.Li();const a=this.Gt.iteratorBackwards;for(;a.next();){const l=a.value;l.visible&&l.NP(t,e,i,n,r,s,o)}return r}eR(t,e,i,n,s){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),!(s instanceof x)&&!(s instanceof k)&&(s=new k),this.Li();const o=this.Gt.iteratorBackwards;for(;o.next();){const r=o.value;!r.visible||r.isTemporary||r.findObjectsIn(t,e,i,n,s)}return s}findPartsNear(t,e,i,n,s){return void 0===i&&(i=!0),void 0===n&&(n=!0),this.sR(t,e,null,(t=>t instanceof ke&&(!n||t.canSelect())),i,s)}findObjectsNear(t,e,i,n,s,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=!0),!1!==s&&!0!==s&&((s instanceof x||s instanceof k)&&(o=s),s=!0),!(o instanceof x)&&!(o instanceof k)&&(o=new k),this.Li();const r=this.Gt.iteratorBackwards;for(;r.next();){const a=r.value;a.visible&&a.findObjectsNear(t,e,i,n,s,o)}return o}sR(t,e,i,n,s,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=!0),!1!==s&&!0!==s&&((s instanceof x||s instanceof k)&&(o=s),s=!0),!(o instanceof x)&&!(o instanceof k)&&(o=new k),this.Li();const r=this.Gt.iteratorBackwards;for(;r.next();){const a=r.value;!a.visible||a.isTemporary||a.findObjectsNear(t,e,i,n,s,o)}return o}acceptEvent(t){return this.Uc(t,t instanceof MouseEvent)}Uc(t,e){const i=this.Yr;this.Yr=this.Zh,this.Zh=i,i.diagram=this,i.event=t,e?this.o0(t,i):(i.viewPoint=this.Yr.viewPoint,i.documentPoint=this.Yr.documentPoint);let n=0;const s=t;return s.ctrlKey&&(n+=1),s.altKey&&(n+=2),s.shiftKey&&(n+=4),s.metaKey&&(n+=8),i.modifiers=n,i.button=s.button,void 0!==s.buttons&&(i.buttons=s.buttons),d.hr&&0===s.button&&s.ctrlKey&&(i.button=2),i.down=!1,i.up=!1,i.clickCount=1,i.delta=0,i.handled=!1,i.bubbles=!1,i.timestamp=t.timeStamp,i.isMultiTouch=!1,i.targetDiagram=this.gS(t,t.target),i.targetObject=null,i}gS(t,e){if(null===e)return null;const i=Dt.se.get(e);if(i)return i;let n=t.path;return!n&&"function"==typeof t.composedPath&&(n=t.composedPath()),n&&n[0]&&Dt.se.has(n[0])?Dt.se.get(n[0]):null}GF(t,e,i){const n=this.dS(t,!0,!1,!1,!0,i);return this.o0(e,n),n.targetDiagram=this.gS(t,t.target),n.targetObject=null,i||n.clone(this.Jm),n}HF(t,e,i){const n=this.dS(t,!1,!1,!1,!1,i);let s=c.document.elementFromPoint(e.clientX,e.clientY)||null;null!==s&&void 0!==s.shadowRoot&&null!==s.shadowRoot&&(s=s.shadowRoot.elementFromPoint(e.clientX,e.clientY));let o=this,r=t;return s&&Dt.se.get(s)&&(r=e,o=Dt.se.get(s)),n.targetDiagram=o,this.o0(r,n),n.targetObject=null,n}dS(t,e,i,n,s,o){const r=this.Yr;this.Yr=this.Zh,this.Zh=r,r.diagram=this,r.clickCount=1,r.delta=0;let a=0;return t.ctrlKey&&(a+=1),t.altKey&&(a+=2),t.shiftKey&&(a+=4),t.metaKey&&(a+=8),r.modifiers=a,r.event=t,r.timestamp=t.timeStamp,r.button=i?this.firstInput.button:t.button,r.buttons=t.buttons,d.hr&&0===t.button&&t.ctrlKey&&(r.button=2),r.down=e,r.up=i,r.handled=n,r.bubbles=s,r.isMultiTouch=o,r}ra(t,e){return!!t.bubbles||(void 0!==e.stopPropagation&&e.stopPropagation(),!1!==e.cancelable&&e.preventDefault(),e.cancelBubble=!0,!1)}JF(t){const e=Dt.se.get(this);if(!e.isEnabled)return!1;const i=e.Uc(t,!1);return i.key=t.key,i.code=t.code,i.down=!0,e.doKeyDown(),e.ra(i,t)}$F(t){const e=Dt.se.get(this);if(!e.isEnabled)return!1;const i=e.Uc(t,!1);return i.key=t.key,i.code=t.code,i.up=!0,e.doKeyUp(),e.ra(i,t)}qF(t){const e=Dt.se.get(this);if(!e.isEnabled)return!1;const i=e.Uc(t,!0);return null!==e.mouseEnter&&e.mouseEnter(i),e.currentTool.standardMouseOver(),e.ra(i,t)}WF(t){const e=Dt.se.get(this);if(!e.isEnabled)return!1;const i=e.Uc(t,!0);return null!==e.mouseLeave&&e.mouseLeave(i),e.ra(i,t)}getMouse(t){const e=this.dt;if(null===e)return new T(0,0);const i=e.getBoundingClientRect(),n=(t.clientX-i.left)*(this.kt/i.width),s=(t.clientY-i.top)*(this.Pt/i.height);return null!==this.L?new T(n,s).Ue(this.L):new T(n,s)}o0(t,e){const i=this.dt;let n=0,s=0;if(null!==i){const e=i.getBoundingClientRect();n=(t.clientX-e.left)*(this.kt/e.width),s=(t.clientY-e.top)*(this.Pt/e.height)}if(e.viewPoint.e(n,s),null!==this.L){const t=T.X(n,s);this.L.is(t),e.documentPoint.a(t),T.s(t)}else e.documentPoint.e(n,s)}wC(t,e,i){let n;if(null===this.ta[0])return;n=this.ta[e];const s=this.dt;if(null!==s){const t=s.getBoundingClientRect();i.e((n.clientX-t.left)*(this.kt/t.width),(n.clientY-t.top)*(this.Pt/t.height))}}invalidateDocumentBounds(){this.Qh||(this.Qh=!0,this.requestUpdate(!1))}nR(){this.xs||this.Li(),this.ensureBounds()}redraw(){this.jt||this.xs||(this.C(),this.maybeUpdate())}isUpdateRequested(){return this.Sr}delayInitialization(t){void 0===t&&(t=null);const e=this.animationManager,i=e.isEnabled;e.stopAnimation(),e.isEnabled=!1,this.xr(),this.$n=!1,this.ex=new T(NaN,NaN),e.isEnabled=i,this.xs=!0;const n=this;null!==t&&d.Ih((()=>{n.xs=!1,e.Ol("Model"),t(n)}),1)}requestUpdate(t){if(void 0===t&&(t=!1),!0===this.Sr||this.jt||!1===t&&this.xs)return;this.Sr=!0;const e=this;c.requestAnimationFrame((()=>{e.Sr&&e.maybeUpdate()}))}maybeUpdate(){this.vu&&!this.Sr||(this.vu&&(this.vu=!1),this.xr())}pS(t,e){!this.Eu||this.jt||this.animationManager.defaultAnimation.isAnimating||this.gL()||(t&&this.Li(),e&&this.Bs(!1))}xr(t){if(this.xs||(this.Sr=!1,null===this.Tt&&!this.Vu.isReal()))return;this.xs=!0;const e=this.animationManager,i=this.zu;if(!e.isAnimating&&0!==i.length){const t=i.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];e.ne(!1),e.c()}i.clear()}const n=this.nS;n.count>0&&(n.each((t=>t.yS())),n.clear());let s=!1,o=!1;e.defaultAnimation.isAnimating&&(o=!0,s=this.skipsUndoManager,this.skipsUndoManager=!0),e.xi||this.SM(),t||this.pS(!1,!0),null!==this.es&&(this.es.visible&&!this.qm&&(this.Wr(),this.qm=!0),!this.es.visible&&this.qm&&(this.qm=!1));const r=!this.undoManager.isUndoingRedoing&&(this.Ml||0!==this.Vc.count&&0!==this.Tr.size),a=!this.$n||this.Gr;this.Li(!0);let l=!1;(a||r)&&(this.$n?this.wS(!this.Fc,r):(this.startTransaction("Initial Layout"),!1===e.isEnabled&&e.stopAnimation(),this.wS(!1,r)),l=a),this.Fc=!1,this.Ml=!1,this.Li(),this.Vx||this.nR(),t||this.pS(!0,!1);let h=!1;if(l){const e=D.l();e.a(this.viewportBounds),this.$n||(this.$n=!0,h=!0,this.skipsUndoManager||(this.undoManager.vw=!0),this.undoManager.Ow=!0,this.oR()),this.rR(),this.Li(!1),t||this.pS(!0,!0),D.s(e)}else if(e.bc&&e.ix){if(1!==this.Ar)this.scale=this.Yu(this.Ar);else if(1!==this.Wl)this.scale=this.Yu(this.Wl);else{const t=this.initialScale;isFinite(t)&&t>0&&(this.scale=t)}this.Bs(!0)}l&&h&&this.commitTransaction("Initial Layout"),t||this.Gi(this.ni),o&&(this.skipsUndoManager=s),this.xs=!1}get Uh(){return this.$n}oR(){if(1!==this.Ar)this.scale=this.Yu(this.Ar);else if(1!==this.Wl)this.scale=this.Yu(this.Wl);else{const t=this.initialScale;isFinite(t)&&t>0&&(this.scale=t)}this.Bs(!0);const t=this.Gt.r;this.Us(t,t.length,this,this.viewportBounds),this.v("InitialLayoutCompleted"),this.ex.a(this.st),this.Wr()}rR(){this.v("LayoutCompleted")}r0(t){this.qn.add(t)}addInvalidRoute(t){this.vo?this.Jh.add(t):this.Tr.add(t)}Li(t){if(0!==this.qn.size&&(this.xs||!this.animationManager.isTicking)){if(this.xs||(this.Ml=!0),t)return void this.pL(this.qn);for(let t=0;t<23&&0!==this.qn.size;t++){const t=new Set(this.qn);this.qn.clear(),this.yS(t,this.qn)}this.nodes.each((t=>{t instanceof Ve&&t.yL(!1)}))}}pL(t,e){for(const i of t)!i.Ne()||i instanceof Ve||(i.Jr()?(i.ut(1/0,1/0),i.zt()):e&&e.add(i));for(const i of t)if(i instanceof Ve){if(!i.isVisible())continue;this.pb(i)}}yS(t,e){this.pL(t,e);for(const i of t){if(!(i instanceof De))continue;const t=i;t.isVisible()&&(t.Jr()?(t.ut(1/0,1/0),t.zt()):e.add(t))}for(const i of t)i instanceof Pe&&i.isVisible()&&(i.Jr()?(i.ut(1/0,1/0),i.zt()):e.add(i))}l0(t){const e=t instanceof Dt,i=e?t.links:t.memberParts,n=this.qn;if(e)this.Li(!0);else{for(;i.next();){const t=i.value;n.has(t)&&(!t.Ne()||t instanceof Ve||t.Jr()&&(t.ut(1/0,1/0),t.zt()))}for(i.reset();i.next();){const t=i.value;if(n.has(t)&&t instanceof Ve){if(!t.isVisible())continue;this.pb(t)}}i.reset()}for(;i.next();){const t=i.value;t instanceof De&&n.has(t)&&t.isVisible()&&t.Jr()&&(t.ut(1/0,1/0),t.zt())}}pb(t){const e=d.rt(),i=d.rt(),n=t.memberParts;for(;n.next();){const s=n.value;s.isVisible()&&(s instanceof Ve?(s.Eo()||s.ss()||s.eh())&&this.pb(s):s instanceof De?s.fromNode===t||s.toNode===t?i.push(s):e.push(s):(s.ut(1/0,1/0),s.zt()))}let s=e.length;for(let o=0;o<s;o++){const t=e[o];t.ut(1/0,1/0),t.zt()}d.it(e),t.ut(1/0,1/0),t.zt(),s=i.length;for(let o=0;o<s;o++){const t=i[o];t.ut(1/0,1/0),t.zt()}d.it(i)}Us(t,e,i,n){if(this.vc||this.animationManager.isAnimating){for(let s=0;s<e;s++)t[s].Us(i,n);this.Li()}}Gi(t){null!==this.Tt&&(null===this.dt&&d.o("No canvas specified"),"svg"===this.Rc?this.lR(t):this.hR(t))}hR(t){const e=this.animationManager;if(e.xi||e.isAnimating&&!e.isTicking)return;const i=new Date;if(this.h0(),"0"===this.Tt.style.opacity)return;const n=t!==this.ni,s=this.Gt.r,o=s.length,r=this;if(this.Us(s,o,r,r.viewportBounds),n)t.clearContextCache(!0),this.ih();else if(!this.Xe&&!e.isAnimating)return;const a=this.L;a.Jt();const l=this.Ui,h=this.st,u=this.K;1!==u&&a.K(u),(0!==h.x||0!==h.y)&&a.Qi(-h.x,-h.y),t.setTransform(l,0,0,l,0,0),t.clearRect(0,0,this.kt,this.Pt),1!==this.Wt&&(t.globalAlpha=this.Wt),this.xS(t);for(let m=0;m<o;m++)t.setTransform(l,0,0,l,0,0),t.transform(a.m11,a.m12,a.m21,a.m22,a.dx,a.dy),t.commitTransform(),s[m].Gi(t,r);let c=!1;this.Ec?this.Ec.Ku(this)&&(c=this.rb()):c=!0,c&&(R.prototype.is=R.prototype.yw),n?(this.ni.clearContextCache(!0),this.ih()):(this.vc=!1,this.Xe=!1);const d=+new Date-+i,f=!1,g=this.aS;if(null===this.Nl){g[this.t0]=d,this.t0=(this.t0+1)%g.length;let t=0;for(let e=0;e<g.length;e++)t+=g[e];this._m=t/g.length}1!==this.Wt&&(t.globalAlpha=1)}lR(t){if(null===this.Tt)return;const e=this.animationManager;if(e.xi||e.isAnimating&&!e.isTicking)return;this.h0();const i=this.kt,n=this.Pt;t.surface.resize(i,n,i,n);const s=this.Gt.r,o=s.length,r=this;if(this.Us(s,o,r,r.viewportBounds),!this.Xe&&!e.isAnimating)return;const a=this.st,l=this.K,h=this.L;h.Jt(),1!==l&&h.K(l),(0!==a.x||0!==a.y)&&h.Qi(-a.x,-a.y),t.lastDrawnPart=null,t.setDiagramPosScale(h.m11,h.m12,h.m21,h.m22,h.dx,h.dy),1!==this.Wt&&(t.globalAlpha=this.Wt),this.xS(t);const u=this.Ui;this.dt.ci.setTransform(u,0,0,u,0,0),this.dt.ci.clearRect(0,0,this.kt,this.Pt);for(let d=0;d<o;d++)s[d].Gi(t,r);let c=!1;this.Ec?this.Ec.Ku(this)&&(c=this.rb()):c=!0,c&&(R.prototype.is=R.prototype.yw),this.vc=!1,this.Xe=!1}yb(t,e,i,n,s,o,r,a,l){if(null===this.Tt)return;null===this.dt&&d.o("No canvas specified"),void 0===o&&(o=null),void 0===r&&(r=null),void 0===a&&(a=!1),void 0===l&&(l=!1),this.h0(),this.ni.clearContextCache(!0),this.ih(),this._h=!0;const h=this.K;this.K=n;const u=this,c=this.Gt.r,f=c.length;try{const h=new D(s.x,s.y,i.width/n,i.height/n),d=h.copy();d.addMargin(e),this.Wr(d),this.Li(),this.Us(c,f,u,h),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,i.width,i.height),null!==r&&""!==r&&(t.fillStyle=r,t.fillBackground(0,0,i.width,i.height));const g=this.Ui;t.scale(g,g);const m=R.l();m.Jt(),m.Qi(e.left,e.top),m.K(n),(0!==s.x||0!==s.y)&&m.Qi(-s.x,-s.y),t.setTransform(m.m11,m.m12,m.m21,m.m22,m.dx,m.dy),t.commitTransform(),t instanceof Ht&&t.setDiagramPosScale(m.m11,m.m12,m.m21,m.m22,m.dx,m.dy),R.s(m),this.xS(t),t.globalAlpha=this.Wt;const p=this.findLayer("Grid");if(o){const e=new k,i=o.iterator;for(i.reset();i.next();){const t=i.value;t instanceof ke&&(!l&&t.layer===p||(t.Du(),e.add(t)))}for(let n=0;n<f;n++)c[n].pF(t,u,e,a);e.each((t=>t.Du()))}else for(let e=0;e<f;e++){const i=c[e];i===p?l&&i.Gi(t,u,!0):i.Gi(t,u,a)}this._h=!1,this.Ec&&this.Ec.Ku(this)&&this.rb()}finally{this.K=h,this.ni.clearContextCache(!0),this.ih(),this.Us(c,f,u,u.viewportBounds),this.Wr(),this.ni instanceof Ht&&(this.ni.diagramGroup.replaceChildren(),this.redraw())}}getRenderingHint(t){return this.Lr[t]}setRenderingHint(t,e){"minDrawingLength"===t&&(this.Vm=e),this.Lr[t]=e,this.redraw()}resetRenderingHints(){this.Lr=new g,this.Lr.drawShadows=!0,this.Lr.textGreeking=!0,this.Lr.viewportOptimizations=!d.hr,this.Lr.temporaryPixelRatio=!0,this.Lr.pictureRatioOptimization=!0,this.Lr.minDrawingLength=1,this.Vm=1}xS(t){const e=this.Lr;if(null===e)return;if(void 0!==e.imageSmoothingEnabled){const i=!!e.imageSmoothingEnabled;t.setImageSmoothingEnabled(i)}const i=e.defaultFont;null!=i&&(t.font=i)}getInputOption(t){return this.Fu[t]}setInputOption(t,e){this.Fu[t]=e}IF(){this.Fu=new g,this.Fu.extraTouchArea=10,this.Fu.extraTouchThreshold=10,this.Fu.hasGestureZoom=!0}set(t){return Object.assign(this,t),this}attach(t){return this.setProperties(t)}setProperties(t){return Dt.a0(this,t),this}static a0(t,e){const i=t instanceof ie,n=t instanceof Dt;for(const s in e){""===s&&d.o("Setting properties requires non-empty property names");let o=t,r=s;if(i||n){const e=s.indexOf(".");if(e>0){const n=s.substring(0,e);i?o=t.findObject(n):(o=t[n],null==o&&(o=t.toolManager[n])),d.wt(o)?r=s.substring(e+1):d.o("Unable to find object named: "+n+" in "+t.toString()+" when trying to set property: "+s)}}if("_"!==r[0]&&!d.fw(o,r)){if(n&&"ModelChanged"===r){t.addModelChangedListener(e[r]);continue}if(n&&"Changed"===r){t.addChangedListener(e[r]);continue}if(n&&d.fw(t.toolManager,r))o=t.toolManager;else{if(n&&t.wL(r)){t.addDiagramListener(r,e[r]);continue}if(t instanceof Ze&&"Changed"===r){t.addChangedListener(e[r]);continue}d.o('Trying to set undefined property "'+r+'" on object: '+o.toString())}}const a=e[s];o[r]=a,"_"===r[0]&&o instanceof Kt&&o.addCopyProperty(r)}}aR(){if(0!==this._l.count&&!(this.undoManager.transactionLevel>1)){for(;this._l.count>0;){const t=this._l;this._l=new L;const e=t.iterator;for(;e.next();){const t=e.key;t.invalidateOtherJumpOvers(e.value),t.oe()}}this.C()}}C(t){if(void 0===t)this.Xe=!0,this.requestUpdate();else{const e=this.viewportBounds;t.isReal()&&e.intersectsRect(t)&&(this.Xe=!0,this.requestUpdate())}this.v("InvalidateDraw")}invalidateViewport(t,e){!0!==this.Xe&&(this.Xe=!0,"svg"!==this.Rc&&!0===this.getRenderingHint("temporaryPixelRatio")?(this.Vw(),this.maybeUpdate(),this.yP(!0)):this.maybeUpdate())}la(){this.Eu=!0}ih(){this.vc=!0}h0(){!1!==this.Ru&&(this.Ru=!1,this.uL(this.kt,this.Pt))}uL(t,e){this.jr();const i=this.Ui,n=t*i,s=e*i;this.dt.resize(n,s,t,e)&&(this.Xe=!0,this.ni.clearContextCache(!0))}gL(){const t=this.dt;if(null===t||this.Vu.isReal())return!0;const e=this.kt,i=this.Pt,n=this.Tt;let s=!1,o=this.Jn?this.gi:0,r=this.pn?this.gi:0,a=n.clientWidth||e+o,l=n.clientHeight||i+r;const h=this.viewportBounds,u=h.x,c=h.y,d=h.width,f=h.height;if((a!==e+o||l!==i+r)&&(this.Jn=!1,this.pn=!1,o=0,r=0,this.kt=a,this.Pt=l,this.Ru=!0,s=!0,this.jr()),!this.$n||!this.viewportBounds.isReal())return!0;const g=this.nb,m=this.ob;if(this.Eu=!1,!s&&!this.Jn&&!this.pn&&!this.Ou&&!this.Iu)return!0;const p=this.documentBounds;let y=0,v=0,b=0,x=0;const w=h.width,k=h.height,S=this.Ac;this.contentAlignment.isSpot()?(p.width>w&&(y=S.left,v=S.right),p.height>k&&(b=S.top,x=S.bottom)):(y=S.left,v=S.right,b=S.top,x=S.bottom);const P=p.width+y+v,M=p.height+b+x,C=this.scale,N=C;let L=P>a/C,A=M>l/C;if(!s&&!this.Jn&&!this.pn&&!L&&!A)return!0;const F=p.x-y,O=h.x,R=p.right+v;let E=h.right+o;const B=p.y-b,I=h.y,V=p.bottom+x;let z=h.bottom+r,j="1px",U="1px";if(1===this.scrollMode&&(L||A)){if(L&&this.hasHorizontalScrollbar&&this.allowHorizontalScroll){let t=1;F+1<O&&(t=Math.max((O-F)*C+this.kt,t)),R>E+1&&(t=Math.max((R-E)*C+this.kt,t)),w+o+1<P&&(t=Math.max((P-w)*C+this.kt,t)),j=t.toString()+"px"}if(A&&this.hasVerticalScrollbar&&this.allowVerticalScroll){let t=1;B+1<I&&(t=Math.max((I-B)*C+this.Pt,t)),V>z+1&&(t=Math.max((V-z)*C+this.Pt,t)),k+r+1<M&&(t=Math.max((M-k)*C+this.Pt,t)),U=t.toString()+"px"}}let K="1px"!==j,G="1px"!==U;if((!K||!G)&&(K||G)){if(L=!(P<w+o),A=!(M<k+r),G&&(E-=this.gi),K&&(z-=this.gi),L&&this.hasHorizontalScrollbar&&this.allowHorizontalScroll){let t=1;F+1<O&&(t=Math.max((O-F)*C+this.kt,t)),R>E+1&&(t=Math.max((R-E)*C+this.kt,t)),w+1<P&&(t=Math.max((P-w)*C+this.kt,t)),j=t.toString()+"px"}K="1px"!==j;let t=this.Pt;if(K!==this.pn&&(t=K?this.Pt-this.gi:this.Pt+this.gi),A&&this.hasVerticalScrollbar&&this.allowVerticalScroll){let e=1;B+1<I&&(e=Math.max((I-B)*C+t,e)),V>z+1&&(e=Math.max((V-z)*C+t,e)),k+1<M&&(e=Math.max((M-k)*C+t,e)),U=e.toString()+"px"}G="1px"!==U}if(this.Gm&&K===this.pn&&G===this.Jn)return(e!==this.kt||i!==this.Pt)&&this.maybeUpdate(),!1;if(K!==this.pn&&(this.Pt="1px"===j?this.Pt+this.gi:Math.max(this.Pt-this.gi,1),s=!0),this.pn=K,m.style.width=j,G!==this.Jn&&(this.kt="1px"===U?this.kt+this.gi:Math.max(this.kt-this.gi,1),s=!0,this.Xu)){const e=T.l();G?(t.style.left=this.gi+"px",this.position=e.e(this.st.x+this.gi/this.scale,this.st.y)):(t.style.left="0px",this.position=e.e(this.st.x-this.gi/this.scale,this.st.y)),T.s(e)}s&&this.jr(),this.Jn=G,m.style.height=U,this.Jx=!0,s&&(this.Ru=!0);let X=g.scrollLeft;if(this.hasHorizontalScrollbar&&this.allowHorizontalScroll&&(w+1<P?X=(this.position.x-F)*C:F+1<O?X=g.scrollWidth-g.clientWidth:R>E+1&&(X=this.position.x*C)),this.Xu)switch(this.wx){case"negative":X=-(g.scrollWidth-X-g.clientWidth);break;case"reverse":X=g.scrollWidth-X-g.clientWidth}if(g.scrollLeft=X,this.hasVerticalScrollbar&&this.allowVerticalScroll&&(k+1<M?g.scrollTop=(this.position.y-B)*C:B+1<I?g.scrollTop=g.scrollHeight-g.clientHeight:V>z+1&&(g.scrollTop=this.position.y*C)),a=this.kt,l=this.Pt,g.style.width=a+(this.Jn?this.gi:0)+"px",g.style.height=l+(this.pn?this.gi:0)+"px",e!==a||i!==l||this.animationManager.xi){const t=D.X(u,c,d,f);return this.onViewportBoundsChanged(t,this.viewportBounds,N,s),D.s(t),!1}return!0}add(t){const e=t.diagram;if(e===this)return;null!==e&&d.o("Cannot add part "+t.toString()+" to "+this.toString()+". It is already a part of "+e.toString());let i=this.findLayer(t.layerName);if(null===i&&(i=this.findLayer("")),null===i&&d.o('Cannot add a Part when unable find a Layer named "'+t.layerName+'" and there is no default Layer'),t.layer===i)return;const n=i.Wh(99999999,t,t.diagram===this);n>=0&&this.raiseChangedEvent(3,"parts",i,null,t,null,n),i.isTemporary||this.invalidateDocumentBounds(),t.invalidateLayout(1);const s=t.layerChanged;null!==s&&s(t,null,i)}Wh(t){this.partManager.Wh(t);const e=this;t.$r((t=>e.xL(t))),t.data||t.Vo(),t.hasPlaceholder()&&t.c(),null!==t.data&&t.$r((t=>e.partManager.bS(t,null))),(!0===t.ss()||!0===t.eh())&&this.r0(t),t.bL(!0,this),t.kL()?(t.actualBounds.isReal()&&this.C(t.qh(t.actualBounds)),this.invalidateDocumentBounds()):t.isVisible()&&t.actualBounds.isReal()&&this.C(t.qh(t.actualBounds)),this.requestUpdate()}ie(t){t.clearAdornments(),this.partManager.ie(t);const e=this;null!==t.data&&t.$r((t=>e.partManager.kS(t,e))),this.qn.delete(t),t instanceof De&&this.Tr.delete(t),t.kL()?(t.actualBounds.isReal()&&this.C(t.qh(t.actualBounds)),this.invalidateDocumentBounds()):t.isVisible()&&t.actualBounds.isReal()&&this.C(t.qh(t.actualBounds)),this.requestUpdate()}remove(t){this.PS(t,!0)}PS(t,e){const i=t.layer;if(null===i||i.diagram!==this)return;t.isSelected=!1,t.isHighlighted=!1,t.invalidateLayout(2),e&&t.Bc();const n=i.ie(-1,t,!1);n>=0&&this.raiseChangedEvent(4,"parts",i,t,null,n,null);const s=t.layerChanged;null!==s&&s(t,i,null)}removeParts(t,e){if(void 0===e&&(e=!1),Array.isArray(t)){const i=t.length;for(let n=0;n<i;n++){const i=t[n];e&&!i.canDelete()||this.remove(i)}}else{const i=new k;i.addAll(t);const n=i.iterator;for(;n.next();){const t=n.value;e&&!t.canDelete()||this.remove(t)}}}copyParts(t,e,i){return void 0===i&&(i=!1),this.partManager.copyParts(t,e,i)}moveParts(t,e,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=this.c0()),null===this.toolManager)return;const s=new L;if(null!==t)if(Array.isArray(t))for(let o=0;o<t.length;o++)this.Zr(s,t[o],i,n);else{const e=t.iterator;for(;e.next();)this.Zr(s,e.value,i,n)}else{let t=this.parts;for(;t.next();){const e=t.value;this.Zr(s,e,i,n)}for(t=this.nodes;t.next();){const e=t.value;this.Zr(s,e,i,n)}for(t=this.links;t.next();){const e=t.value;this.Zr(s,e,i,n)}}this.bP(s,e,n,i)}Zr(t,e,i,n,s){if(!t.contains(e)&&(void 0===s&&(s=!1),!i||s||e.canMove()||e.canCopy()))if(void 0===n&&(n=this.c0()),e instanceof Ce){if(t.add(e,this.Vs(n,e,e.location)),e instanceof Ve&&(e.hasPlaceholder()||n.dragsMembers)){const s=e.memberParts;for(;s.next();){const e=s.value;this.Zr(t,e,i,n,n.groupsAlwaysMove)}}const s=e.linksConnected;for(;s.next();){const e=s.value;if(t.contains(e))continue;const o=e.fromNode,r=e.toNode;null!==o&&t.contains(o)&&null!==r&&t.contains(r)&&this.Zr(t,e,i,n)}if(n.dragsTree){const s=e.findTreeChildrenNodes();for(;s.next();){const e=s.value;this.Zr(t,e,i,n)}}}else if(e instanceof De){t.add(e,this.Vs(n,e));const s=e.labelNodes;for(;s.next();){const e=s.value;this.Zr(t,e,i,n)}}else e instanceof Pe||t.add(e,this.Vs(n,e,e.location))}bP(t,e,i,n){if(null===t||0===t.count)return;const s=T.l(),o=T.l();o.a(e),isNaN(o.x)&&(o.x=0),isNaN(o.y)&&(o.y=0);const r=this.ab;r||this.Uw(t);const a=d.rt(),l=d.rt(),h=t.iterator;let u=T.l();for(;h.next();){const e=h.key,r=h.value;if(e.Ne()){const l=this.PL(e,t);if(null!==l)a.push(new Rt(e,r,l));else if(!n||e.canMove()){const t=r.point;s.a(t),this.computeMove(e,s.add(o),i,u),e.location=u,void 0===r.shifted&&(r.shifted=new T),r.shifted.a(u.subtract(t))}}else h.key instanceof De&&l.push(new C(h.key,h.value))}T.s(u);const c=a.length;for(let d=0;d<c;d++){const t=a[d],e=t.ML.point;s.a(e),void 0===t.wb.shifted&&(t.wb.shifted=new T),t.me.location=s.add(t.wb.shifted)}const f=T.l(),g=T.l(),m=l.length;for(let d=0;d<m;d++){const e=l[d],n=e.key;if(n instanceof De)if(n.dn){n.Nr=null;const r=n.fromNode,a=n.toNode;if(null!==this.draggedLink&&i.dragsLink){const s=e.value.point;if(null===n.dragComputation){t.add(n,this.Vs(i,n,o));const e=o.x-s.x,r=o.y-s.y;n.wr(e,r)}else{const e=T.X(0,0),r=n.getPoint(0);r&&r.isReal()&&e.a(r),u=T.l().a(e).add(o);let a=u;i.isGridSnapEnabled&&(i.isGridSnapRealtime||this.lastInput.up)&&(a=T.l(),this.lM(n,u,a,i)),u.a(n.dragComputation(n,u,a)).subtract(e),t.add(n,this.Vs(i,n,u));const l=u.x-s.x,h=u.y-s.y;n.wr(l,h),T.s(e),T.s(u),a!==u&&T.s(a)}}else{if(null!==r){f.a(r.location);const e=t.getValue(r);null!==e&&f.subtract(e.point)}if(null!==a){g.a(a.location);const e=t.getValue(a);null!==e&&g.subtract(e.point)}if(null!==r&&null!==a)if(f.equalsApprox(g)){const o=e.value.point,r=s;r.a(f),r.subtract(o),t.add(n,this.Vs(i,n,f)),n.wr(r.x,r.y)}else n.dn=!1,n.invalidateRoute();else{const s=e.value.point;let l;l=null!==r?f:null!==a?g:o,t.add(n,this.Vs(i,n,l));const h=l.x-s.x,u=l.y-s.y;n.wr(h,u)}}}else if(null===n.fromNode||null===n.toNode){const s=e.value.point;t.add(n,this.Vs(i,n,o));const r=o.x-s.x,a=o.y-s.y;n.wr(r,a)}}T.s(s),T.s(o),T.s(f),T.s(g),d.it(a),d.it(l),r||(this.Li(),this.km(t))}computeMove(t,e,i,n){if(void 0===n&&(n=new T),n.a(e),null===t)return n;let s=e;const o=i.isGridSnapEnabled;o&&(i.isGridSnapRealtime||this.lastInput.up)&&(s=T.l(),this.lM(t,e,s,i));const r=null!==t.dragComputation?t.dragComputation(t,e,s):s,a=t.minLocation;let l=a.x;isNaN(l)&&(l=o?Math.round(1e3*t.location.x)/1e3:t.location.x);let h=a.y;isNaN(h)&&(h=o?Math.round(1e3*t.location.y)/1e3:t.location.y);const u=t.maxLocation;let c=u.x;isNaN(c)&&(c=o?Math.round(1e3*t.location.x)/1e3:t.location.x);let d=u.y;return isNaN(d)&&(d=o?Math.round(1e3*t.location.y)/1e3:t.location.y),n.e(Math.max(l,Math.min(r.x,c)),Math.max(h,Math.min(r.y,d))),s!==e&&T.s(s),n}c0(){const t=this.toolManager.findTool("Dragging");return t instanceof Q?t.dragOptions:this.fb}lM(t,e,i,n){if(void 0===n&&(n=this.c0()),i.a(e),null===t)return i;const s=this.grid,o=n.gridSnapCellSize;let r=o.width,a=o.height;const l=n.gridSnapOrigin;let h=l.x,u=l.y;const c=n.gridSnapCellSpot;if(null!==s){const t=s.gridCellSize;isNaN(r)&&(r=t.width),isNaN(a)&&(a=t.height);const e=s.gridOrigin;isNaN(h)&&(h=e.x),isNaN(u)&&(u=e.y)}const d=T.X(0,0);return d.setSpot(0,0,r,a,c),E.Vg(e.x,e.y,h+d.x,u+d.y,r,a,i),T.s(d),i}Uw(t){if(null===t)return;this.ab=!0;const e=t.iterator;for(;e.next();){const t=e.key;t instanceof De&&(t.dn=!0)}}km(t){if(null===t)return;const e=t.iterator;for(;e.next();){const t=e.key;t instanceof De&&(t.dn=!1,t.SL()&&t.invalidateRoute())}this.ab=!1}get draggedLink(){return this.cb}set draggedLink(t){this.cb!==t&&(this.cb=t,null!==t&&(this.ub=t.fromPort,this.db=t.toPort))}get MP(){return this.ub}set MP(t){this.ub=t}get SP(){return this.db}set SP(t){this.db=t}PL(t,e){const i=t.containingGroup;if(null!==i){let t=this.PL(i,e);if(null!==t||(t=e.getValue(i),null!==t))return t}return null}Vs(t,e,i){if(void 0===i)return new Ot(T.Mo);let n=t.isGridSnapEnabled;return!t.groupsSnapMembers&&null!==e.containingGroup&&(n=!1),new Ot(n?new T(Math.round(1e3*i.x)/1e3,Math.round(1e3*i.y)/1e3):i.copy())}MS(t,e){if(null!==t.diagram&&t.diagram!==this&&d.o("Cannot share a Layer with another Diagram: "+t+" of "+t.diagram),null===e?null!==t.diagram&&d.o("Cannot add an existing Layer to this Diagram again: "+t):(e.diagram!==this&&d.o("Existing Layer must be in this Diagram: "+e+" not in "+e.diagram),t===e&&d.o("Cannot move a Layer before or after itself: "+t)),t.diagram===this)return;const i=t.name,n=this.Gt,s=n.count;for(let o=0;o<s;o++)n.elt(o).name===i&&d.o("Cannot add Layer with the name '"+i+"'; a Layer with the same name is already present in this Diagram.")}addLayer(t){this.MS(t,null),t.Fo(this);const e=this.Gt;let i=e.count-1;if(!t.isTemporary)for(;i>=0&&e.elt(i).isTemporary;)i--;return e.insertAt(i+1,t),null!==this.Si&&this.raiseChangedEvent(3,"layers",this,null,t,null,i+1),this.C(),this.invalidateDocumentBounds(),this}addLayerBefore(t,e){this.MS(t,e),t.Fo(this);const i=this.Gt,n=i.indexOf(t);n>=0&&(i.remove(t),null!==this.Si&&this.raiseChangedEvent(4,"layers",this,t,null,n,null));const s=i.count;let o;for(o=0;o<s;o++)if(i.elt(o)===e){i.insertAt(o,t);break}return null!==this.Si&&this.raiseChangedEvent(3,"layers",this,null,t,null,o),this.C(),n<0&&this.invalidateDocumentBounds(),this}addLayerAfter(t,e){this.MS(t,e),t.Fo(this);const i=this.Gt,n=i.indexOf(t);n>=0&&(i.remove(t),null!==this.Si&&this.raiseChangedEvent(4,"layers",this,t,null,n,null));const s=i.count;let o;for(o=0;o<s;o++)if(i.elt(o)===e){i.insertAt(o+1,t);break}return null!==this.Si&&this.raiseChangedEvent(3,"layers",this,null,t,null,o+1),this.C(),n<0&&this.invalidateDocumentBounds(),this}qr(t,e){t.Fo(this),this.Gt.insertAt(e,t)}NL(t){this.Gt.removeAt(t)}removeLayer(t){if(t.diagram!==this&&d.o("Cannot remove a Layer from another Diagram: "+t+" of "+t.diagram),""===t.name)return;const e=this.Gt,i=e.indexOf(t);if(e.remove(t)){const e=t.At.copy().iterator;for(;e.next();){const i=e.value,n=i.layerName;n!==t.name?i.layerName=n:i.layerName=""}null!==this.Si&&this.raiseChangedEvent(4,"layers",this,t,null,i,null),this.C(),this.invalidateDocumentBounds()}}findLayer(t){const e=this.layers;for(;e.next();){const i=e.value;if(i.name===t)return i}return null}findRouter(t){for(const e of this.Vc)if(e.name===t)return e;return null}addModelChangedListener(t){return d.i(t,"function",Dt,"addModelChangedListener:listener"),null===this.Wn&&(this.Wn=new x),this.Wn.add(t),this.model.addChangedListener(t),this}removeModelChangedListener(t){d.i(t,"function",Dt,"removeModelChangedListener:listener"),null!==this.Wn&&(this.Wn.remove(t),0===this.Wn.count&&(this.Wn=null)),this.model.removeChangedListener(t)}addChangedListener(t){return d.i(t,"function",Dt,"addChangedListener:listener"),null===this.Dr&&(this.Dr=new x),this.Dr.add(t),this}removeChangedListener(t){d.i(t,"function",Dt,"removeChangedListener:listener"),null!==this.Dr&&(this.Dr.remove(t),0===this.Dr.count&&(this.Dr=null))}Iw(t){if(!this.skipsUndoManager&&!this.model.skipsUndoManager&&this.model.undoManager.handleChanged(t),1!==t.change&&(this.isModified=!0),null!==this.Dr){const e=this.Dr,i=e.length;for(let n=0;n<i;n++)e.elt(n)(t)}}raiseChangedEvent(t,e,i,n,s,o,r){void 0===o&&(o=null),void 0===r&&(r=null);const a=new _;a.diagram=this,a.change=t,a.propertyName=e,a.object=i,a.oldValue=n,a.oldParam=o,a.newValue=s,a.newParam=r,this.Iw(a)}raiseChanged(t,e,i,n,s){this.raiseChangedEvent(2,t,this,e,i,n,s)}t(t,e,i,n,s){this.raiseChangedEvent(2,t,this,e,i,n,s)}get animationManager(){return this.ms}get undoManager(){return this.Si.undoManager}get skipsUndoManager(){return this.Oo}set skipsUndoManager(t){d.i(t,"boolean",Dt,"skipsUndoManager"),this.Oo=t,this.Si.skipsUndoManager=t}get delaysLayout(){return this.Ux}set delaysLayout(t){this.Ux=t}xC(t,e){if(null===t||t.diagram!==this)return;const i=this.ge;try{this.ge=!0;const i=t.change;if(2===i){const i=t.object,n=t.propertyName,s=t.getValue(e);if(Ze.ht(i,n,s),i instanceof Kt){const t=i.part;null!==t&&t.invalidateAdornments()}this.isModified=!0}else if(3===i){const i=t.object,n=t.newParam,s=t.newValue;if(i instanceof ie)if("number"==typeof n&&s instanceof Kt){e?i.ie(n):i.insertAt(n,s);const t=i.part;null!==t&&t.invalidateAdornments()}else"number"==typeof n&&s instanceof ae&&(s.isRow?i.CL(n,e?void 0:s):i.LL(n,e?void 0:s));else if(i instanceof Ct){const o=!0===t.oldParam;"number"==typeof n&&s instanceof ke&&(e?(s.isSelected=!1,s.isHighlighted=!1,s.invalidateAdornments(),i.ie(o?n:-1,s,o)):i.Wh(n,s,o))}else i instanceof Dt?"number"==typeof n&&s instanceof Ct&&(e?this.NL(n):this.qr(s,n)):d.o("unknown ChangeType.Insert object: "+t.toString());this.isModified=!0}else if(4===i){const i=t.object,n=t.oldParam,s=t.oldValue;if(i instanceof ie)"number"==typeof n&&s instanceof Kt?e?i.insertAt(n,s):i.ie(n):"number"==typeof n&&s instanceof ae&&(s.isRow?i.CL(n,e?s:void 0):i.LL(n,e?s:void 0));else if(i instanceof Ct){const o=!0===t.newParam;"number"==typeof n&&s instanceof ke&&(e?i.At.indexOf(s)<0&&i.Wh(n,s,o):(s.isSelected=!1,s.isHighlighted=!1,s.invalidateAdornments(),i.ie(o?n:-1,s,o)))}else i instanceof Dt?"number"==typeof n&&s instanceof Ct&&(e?this.qr(s,n):this.NL(n)):d.o("unknown ChangeType.Remove object: "+t.toString());this.isModified=!0}else 1===i||d.o("unknown ChangedEvent: "+t.toString())}finally{this.ge=i}}startTransaction(t){return this.undoManager.startTransaction(t)}commitTransaction(t){return this.undoManager.commitTransaction(t)}rollbackTransaction(){return this.undoManager.rollbackTransaction()}commit(t,e){let i=e;void 0===i&&(i="");const n=this.skipsUndoManager;null===i&&(this.skipsUndoManager=!0,i=""),this.undoManager.startTransaction(i);let s=!1;try{t(this),s=!0}finally{s?this.undoManager.commitTransaction(i):this.undoManager.rollbackTransaction(),this.skipsUndoManager=n}}updateAllTargetBindings(t){this.partManager.updateAllTargetBindings(t)}updateAllThemeBindings(){if(this.partManager.updateAllThemeBindings(),null!==this.es){const t=this.es.part;null!==t&&t.Vo()}}setDivBackground(t){this.div&&(this.div.style.backgroundColor=t)}updateAllRelationshipsFromData(){this.partManager.updateAllRelationshipsFromData()}AL(t,e){const i=this.animationManager;if(this.jt||this.xs)return this.K=e,this.jr(),this.C(),this.la(),void i.WC(t,this.K);if(null===this.dt)return this.K=e,void this.jr();this.jt=!0;const n=this.viewportBounds.copy(),s=this.kt,o=this.Pt;let r=this.zoomPoint.x,a=this.zoomPoint.y;const l=this.contentAlignment;isNaN(r)&&(l.isSide()?l.includesSide(O.LeftSide)?r=0:l.includesSide(O.RightSide)&&(r=s-1):r=l.isSpot()?l.x*(s-1):s/2),isNaN(a)&&(l.isSide()?l.includesSide(O.TopSide)?a=0:l.includesSide(O.BottomSide)&&(a=o-1):a=l.isSpot()?l.y*(o-1):o/2),null!==this.scaleComputation&&!this.animationManager.defaultAnimation.isAnimating&&(e=this.scaleComputation(this,e)),e<this.minScale&&(e=this.minScale),e>this.maxScale&&(e=this.maxScale);const h=T.X(this.st.x+r/t-r/e,this.st.y+a/t-a/e);this.position=h,T.s(h),this.K=e,this.jr(),this.jt=!1,this.onViewportBoundsChanged(n,this.viewportBounds,t,!1),this.Bs(!1),i.WC(t,this.K),this.C()}tR(){const t=this.Gt.r;for(let e=0;e<t.length;e++)t[e].tL()}onViewportBoundsChanged(t,e,i,n){if(t.equals(e))return;void 0===n&&(n=!1),n||this.la(),this.ih();const s=this.layout;null!==s&&s.isViewportSized&&1===this.autoScale&&(t.width!==e.width||t.height!==e.height)&&s.invalidateLayout();const o=this.currentTool;!0===this.Ic&&o instanceof Z&&!this.animationManager.isTicking&&(this.lastInput.documentPoint=this.transformViewToDoc(this.lastInput.viewPoint),o.standardMouseActivity(this)),this.jt||this.invalidateViewport(t,e),this.Wr(),this.Vi.scale=i,this.Vi.position.x=t.x,this.Vi.position.y=t.y,this.Vi.bounds.a(t),this.Vi.canvasSize.width=Math.round(t.width*i),this.Vi.canvasSize.height=Math.round(t.height*i),this.Vi.newCanvasSize.width=this.kt,this.Vi.newCanvasSize.height=this.Pt,this.Vi.isScroll=n,this.v("ViewportBoundsChanged",this.Vi,t),this.isVirtualized&&this.links.each((t=>{t.isAvoiding&&t.actualBounds.intersectsRect(e)&&t.invalidateRoute()}))}Wr(t){const e=this.es;if(null===e||!e.visible||null===e.layer)return;const i=void 0!==t?t:this._x;if(!i.isReal())return;const n=i.width,s=i.height;if(e.scale=1,e.angle=0,e.layer.isViewportAligned)e.width=n*this.scale,e.height=s*this.scale,e.part.alignment=O.TopLeft;else{null===e.bi&&(e.bi=new se);const t=e.bi.zc;if(!t.isReal())return;e.width=n+2*t.width,e.height=s+2*t.height;const o=T.l();E.Vg(i.x,i.y,0,0,t.width,t.height,o),o.offset(-t.width,-t.height),e.part.location=o,T.s(o)}}clearSelection(t){void 0===t&&(t=!1);const e=this.selection;if(0===e.count)return;t||this.v("ChangingSelection",e);const i=e.toArray(),n=i.length;for(let s=0;s<n;s++){i[s].isSelected=!1}e.lt(),e.clear(),e.g(),t||this.v("ChangedSelection",e)}select(t){null!==t&&t.diagram===this&&(!t.isSelected||this.selection.count>1)&&(this.v("ChangingSelection",this.selection),this.clearSelection(!0),t.isSelected=!0,this.v("ChangedSelection",this.selection))}selectCollection(t){if(this.v("ChangingSelection",this.selection),this.clearSelection(!0),Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++){const e=t[i];e instanceof ke||d.o("Diagram.selectCollection given something that is not a Part: "+e),e.isSelected=!0}}else{const e=t.iterator;for(;e.next();){const t=e.value;t instanceof ke||d.o("Diagram.selectCollection given something that is not a Part: "+t),t.isSelected=!0}}this.v("ChangedSelection",this.selection)}clearHighlighteds(){const t=this.highlighteds;if(t.count>0){const e=t.toArray(),i=e.length;for(let t=0;t<i;t++){e[t].isHighlighted=!1}t.lt(),t.clear(),t.g()}}highlight(t){null!==t&&t.diagram===this&&(!t.isHighlighted||this.highlighteds.count>1)&&(this.clearHighlighteds(),t.isHighlighted=!0)}highlightCollection(t){const e=(new k).addAll(t),i=this.highlighteds.copy().removeAll(e).iterator;for(;i.next();){i.value.isHighlighted=!1}const n=e.iterator;for(;n.next();){const t=n.value;t instanceof ke||d.o("Diagram.highlightCollection given something that is not a Part: "+t),t.isHighlighted=!0}}scroll(t,e,i){void 0===i&&(i=1);const n="up"===e||"down"===e;let s=0;const o=T.l();if("pixel"===t)s=i;else if("line"===t)s=i*(n?this.scrollVerticalLineChange:this.scrollHorizontalLineChange);else if("page"===t){let t=n?this.viewportBounds.height:this.viewportBounds.width;if(t*=this.scale,0!==t){s=i*Math.max(t-(n?this.scrollVerticalLineChange:this.scrollHorizontalLineChange),0)}}else{if("document"===t){const t=this.documentBounds,i=this.viewportBounds;return"up"===e?this.position=o.e(i.x,t.y):"left"===e?this.position=o.e(t.x,i.y):"down"===e?this.position=o.e(i.x,t.bottom-i.height):"right"===e&&(this.position=o.e(t.right-i.width,i.y)),void T.s(o)}d.o("scrolling unit must be 'pixel', 'line', 'page', or 'document', not: "+t)}s/=this.scale;const r=this.position;"up"===e?this.position=o.e(r.x,r.y-s):"down"===e?this.position=o.e(r.x,r.y+s):"left"===e?this.position=o.e(r.x-s,r.y):"right"===e?this.position=o.e(r.x+s,r.y):d.o("scrolling direction must be 'up', 'down', 'left', or 'right', not: "+e),T.s(o)}scrollToRect(t){const e=this.viewportBounds;if(e.containsRect(t))return;const i=t.center;i.x-=e.width/2,i.y-=e.height/2,this.position=i}centerRect(t){const e=this.viewportBounds,i=t.center;i.x-=e.width/2,i.y-=e.height/2,this.position=i}transformDocToView(t){const e=this.L;e.Jt(),1!==this.K&&e.K(this.K);const i=this.st;return(0!==i.x||0!==i.y)&&isFinite(i.x)&&isFinite(i.y)&&e.Qi(-i.x,-i.y),t.copy().L(e)}transformViewToDoc(t){const e=this.L;e.Jt(),1!==this.K&&e.K(this.K);const i=this.st;return(0!==i.x||0!==i.y)&&isFinite(i.x)&&isFinite(i.y)&&e.Qi(-i.x,-i.y),t.copy().Ue(e)}MF(t){const e=this.L;e.Jt(),1!==this.K&&e.K(this.K);const i=this.st;return(0!==i.x||0!==i.y)&&isFinite(i.x)&&isFinite(i.y)&&e.Qi(-i.x,-i.y),t.Ue(this.L)}get opacity(){return this.Wt}set opacity(t){const e=this.Wt;e!==t&&(d.i(t,"number",Dt,"opacity"),(t<0||t>1)&&d.tt(t,"0 <= value <= 1",Dt,"opacity"),this.Wt=t,this.t("opacity",e,t),this.C())}get validCycle(){return this.Rx}set validCycle(t){const e=this.Rx;e!==t&&(this.Rx=t,this.t("validCycle",e,t))}get layers(){return this.Gt.iterator}get isModelReadOnly(){const t=this.Si;return null!==t&&t.isReadOnly}set isModelReadOnly(t){const e=this.Si;null!==e&&(e.isReadOnly=t)}get isReadOnly(){return this.Io}set isReadOnly(t){const e=this.Io;e!==t&&(d.i(t,"boolean",Dt,"isReadOnly"),this.Io=t,this.t("isReadOnly",e,t))}get isEnabled(){return this.Oi}set isEnabled(t){const e=this.Oi;e!==t&&(d.i(t,"boolean",Dt,"isEnabled"),this.Oi=t,this.t("isEnabled",e,t))}get allowClipboard(){return this.Bx}set allowClipboard(t){const e=this.Bx;e!==t&&(d.i(t,"boolean",Dt,"allowClipboard"),this.Bx=t,this.t("allowClipboard",e,t))}get allowCopy(){return this.Il}set allowCopy(t){const e=this.Il;e!==t&&(d.i(t,"boolean",Dt,"allowCopy"),this.Il=t,this.t("allowCopy",e,t))}get allowDelete(){return this.El}set allowDelete(t){const e=this.El;e!==t&&(d.i(t,"boolean",Dt,"allowDelete"),this.El=t,this.t("allowDelete",e,t))}get allowDragOut(){return this.zx}set allowDragOut(t){const e=this.zx;e!==t&&(d.i(t,"boolean",Dt,"allowDragOut"),this.zx=t,this.t("allowDragOut",e,t))}get allowDrop(){return this.Xx}set allowDrop(t){const e=this.Xx;e!==t&&(d.i(t,"boolean",Dt,"allowDrop"),this.Xx=t,this.t("allowDrop",e,t))}get allowTextEdit(){return this.Vl}set allowTextEdit(t){const e=this.Vl;e!==t&&(d.i(t,"boolean",Dt,"allowTextEdit"),this.Vl=t,this.t("allowTextEdit",e,t))}get allowGroup(){return this.Ul}set allowGroup(t){const e=this.Ul;e!==t&&(d.i(t,"boolean",Dt,"allowGroup"),this.Ul=t,this.t("allowGroup",e,t))}get allowUngroup(){return this.Bl}set allowUngroup(t){const e=this.Bl;e!==t&&(d.i(t,"boolean",Dt,"allowUngroup"),this.Bl=t,this.t("allowUngroup",e,t))}get allowInsert(){return this.Kx}set allowInsert(t){const e=this.Kx;e!==t&&(d.i(t,"boolean",Dt,"allowInsert"),this.Kx=t,this.t("allowInsert",e,t))}get allowLink(){return this.zl}set allowLink(t){const e=this.zl;e!==t&&(d.i(t,"boolean",Dt,"allowLink"),this.zl=t,this.t("allowLink",e,t))}get allowRelink(){return this.Xl}set allowRelink(t){const e=this.Xl;e!==t&&(d.i(t,"boolean",Dt,"allowRelink"),this.Xl=t,this.t("allowRelink",e,t))}get allowMove(){return this.Kl}set allowMove(t){const e=this.Kl;e!==t&&(d.i(t,"boolean",Dt,"allowMove"),this.Kl=t,this.t("allowMove",e,t))}get allowReshape(){return this.Yl}set allowReshape(t){const e=this.Yl;e!==t&&(d.i(t,"boolean",Dt,"allowReshape"),this.Yl=t,this.t("allowReshape",e,t))}get allowResize(){return this.Gl}set allowResize(t){const e=this.Gl;e!==t&&(d.i(t,"boolean",Dt,"allowResize"),this.Gl=t,this.t("allowResize",e,t))}get allowRotate(){return this.Hl}set allowRotate(t){const e=this.Hl;e!==t&&(d.i(t,"boolean",Dt,"allowRotate"),this.Hl=t,this.t("allowRotate",e,t))}get allowSelect(){return this.jl}set allowSelect(t){const e=this.jl;e!==t&&(d.i(t,"boolean",Dt,"allowSelect"),this.jl=t,this.t("allowSelect",e,t))}get allowUndo(){return this.Yx}set allowUndo(t){const e=this.Yx;e!==t&&(d.i(t,"boolean",Dt,"allowUndo"),this.Yx=t,this.t("allowUndo",e,t))}get allowZoom(){return this.Gx}set allowZoom(t){const e=this.Gx;e!==t&&(d.i(t,"boolean",Dt,"allowZoom"),this.Gx=t,this.t("allowZoom",e,t))}get hasVerticalScrollbar(){return this.Iu}set hasVerticalScrollbar(t){const e=this.Iu;e!==t&&(d.i(t,"boolean",Dt,"hasVerticalScrollbar"),this.Iu=t,this.la(),this.C(),this.t("hasVerticalScrollbar",e,t),this.Bs(!1))}get hasHorizontalScrollbar(){return this.Ou}set hasHorizontalScrollbar(t){const e=this.Ou;e!==t&&(d.i(t,"boolean",Dt,"hasHorizontalScrollbar"),this.Ou=t,this.la(),this.C(),this.t("hasHorizontalScrollbar",e,t),this.Bs(!1))}get allowHorizontalScroll(){return this.Hx}set allowHorizontalScroll(t){const e=this.Hx;e!==t&&(d.i(t,"boolean",Dt,"allowHorizontalScroll"),this.Hx=t,this.t("allowHorizontalScroll",e,t),this.Bs(!1))}get allowVerticalScroll(){return this.jx}set allowVerticalScroll(t){const e=this.jx;e!==t&&(d.i(t,"boolean",Dt,"allowVerticalScroll"),this.jx=t,this.t("allowVerticalScroll",e,t),this.Bs(!1))}get scrollHorizontalLineChange(){return this.qx}set scrollHorizontalLineChange(t){const e=this.qx;e!==t&&(d.i(t,"number",Dt,"scrollHorizontalLineChange"),t<0&&d.tt(t,">= 0",Dt,"scrollHorizontalLineChange"),this.qx=t,this.t("scrollHorizontalLineChange",e,t))}get scrollVerticalLineChange(){return this.Wx}set scrollVerticalLineChange(t){const e=this.Wx;e!==t&&(d.i(t,"number",Dt,"scrollVerticalLineChange"),t<0&&d.tt(t,">= 0",Dt,"scrollVerticalLineChange"),this.Wx=t,this.t("scrollVerticalLineChange",e,t))}get lastInput(){return this.Zh}set lastInput(t){this.Zh=t}get previousInput(){return this.Yr}set previousInput(t){this.Yr=t}get firstInput(){return this.Jm}set firstInput(t){this.Jm=t}get currentCursor(){return this.vx}set currentCursor(t){if(""===t&&(t=this.Ym),this.vx!==t){d.i(t,"string",Dt,"currentCursor");const e=this.dt,i=this.Tt;if(null===e||null===i)return;this.vx=t;const n=e.style.cursor;e.style.cursor=t,i.style.cursor=t,e.style.cursor===n&&(e.style.cursor="-webkit-"+t,i.style.cursor="-webkit-"+t,e.style.cursor===n&&(e.style.cursor="-moz-"+t,i.style.cursor="-moz-"+t,e.style.cursor===n&&(e.style.cursor=t,i.style.cursor=t)))}}get defaultCursor(){return this.Ym}set defaultCursor(t){""===t&&(t="auto");const e=this.Ym;e!==t&&(d.i(t,"string",Dt,"defaultCursor"),this.Ym=t,this.t("defaultCursor",e,t))}get click(){return this.Fr}set click(t){const e=this.Fr;e!==t&&(null!==t&&d.i(t,"function",Dt,"click"),this.Fr=t,this.t("click",e,t))}get doubleClick(){return this.Rr}set doubleClick(t){const e=this.Rr;e!==t&&(null!==t&&d.i(t,"function",Dt,"doubleClick"),this.Rr=t,this.t("doubleClick",e,t))}get contextClick(){return this.vr}set contextClick(t){const e=this.vr;e!==t&&(null!==t&&d.i(t,"function",Dt,"contextClick"),this.vr=t,this.t("contextClick",e,t))}get mouseOver(){return this.Or}set mouseOver(t){const e=this.Or;e!==t&&(null!==t&&d.i(t,"function",Dt,"mouseOver"),this.Or=t,this.t("mouseOver",e,t))}get mouseHover(){return this.Ir}set mouseHover(t){const e=this.Ir;e!==t&&(null!==t&&d.i(t,"function",Dt,"mouseHover"),this.Ir=t,this.t("mouseHover",e,t))}get mouseHold(){return this.Er}set mouseHold(t){const e=this.Er;e!==t&&(null!==t&&d.i(t,"function",Dt,"mouseHold"),this.Er=t,this.t("mouseHold",e,t))}get mouseDragOver(){return this.Ox}set mouseDragOver(t){const e=this.Ox;e!==t&&(null!==t&&d.i(t,"function",Dt,"mouseDragOver"),this.Ox=t,this.t("mouseDragOver",e,t))}get mouseDrop(){return this.Vr}set mouseDrop(t){const e=this.Vr;e!==t&&(this.Vr=t,this.t("mouseDrop",e,t))}get handlesDragDropForTopLevelParts(){return this.Ix}set handlesDragDropForTopLevelParts(t){const e=this.Ix;e!==t&&(d.i(t,"boolean",Dt,"handlesDragDropForTopLevelParts"),this.Ix=t,this.t("handlesDragDropForTopLevelParts",e,t))}get mouseEnter(){return this.Ur}set mouseEnter(t){const e=this.Ur;e!==t&&(null!==t&&d.i(t,"function",Dt,"mouseEnter"),this.Ur=t,this.t("mouseEnter",e,t))}get mouseLeave(){return this.Br}set mouseLeave(t){const e=this.Br;e!==t&&(null!==t&&d.i(t,"function",Dt,"mouseLeave"),this.Br=t,this.t("mouseLeave",e,t))}get toolTip(){return this.zr}set toolTip(t){const e=this.zr;e!==t&&(this.zr=t,this.t("toolTip",e,t))}get contextMenu(){return this.Xr}set contextMenu(t){const e=this.Xr;e!==t&&(this.Xr=t,this.t("contextMenu",e,t))}get commandHandler(){return this.jM}set commandHandler(t){this.jM!==t&&(this.jM=t,t.Fo(this))}get toolManager(){return this.YM}set toolManager(t){this.YM!==t&&(this.YM=t,t.diagram=this)}get defaultTool(){return this.GM}set defaultTool(t){const e=this.GM;e!==t&&(this.GM=t,t.diagram=this,this.currentTool===e&&(this.currentTool=t))}get currentTool(){return this.HM}set currentTool(t){const e=this.HM;e&&(e.isActive&&e.doDeactivate(),e.cancelWaitAfter(),e.doStop()),null===t&&(t=this.defaultTool),null!==t&&(this.HM=t,t.diagram=this,t.doStart())}get selection(){return this._M}get maxSelectionCount(){return this.Qx}set maxSelectionCount(t){const e=this.Qx;if(e!==t)if(d.i(t,"number",Dt,"maxSelectionCount"),t>=0&&!isNaN(t)){if(this.Qx=t,this.t("maxSelectionCount",e,t),!this.undoManager.isUndoingRedoing){const e=this.selection.count-t;if(e>0){this.v("ChangingSelection",this.selection);const t=this.selection.toArray();for(let i=0;i<e;i++)t[i].isSelected=!1;this.v("ChangedSelection",this.selection)}}}else d.tt(t,">= 0",Dt,"maxSelectionCount")}get nodeSelectionAdornmentTemplate(){return this.jm}set nodeSelectionAdornmentTemplate(t){const e=this.jm;e!==t&&(this.jm=t,this.t("nodeSelectionAdornmentTemplate",e,t))}get groupSelectionAdornmentTemplate(){return this.ib}set groupSelectionAdornmentTemplate(t){const e=this.ib;e!==t&&(this.ib=t,this.t("groupSelectionAdornmentTemplate",e,t))}get linkSelectionAdornmentTemplate(){return this.eb}set linkSelectionAdornmentTemplate(t){const e=this.eb;e!==t&&(this.eb=t,this.t("linkSelectionAdornmentTemplate",e,t))}get highlighteds(){return this.tS}get isModified(){const t=this.undoManager;return t.isEnabled?null!==t.currentTransaction||this.Uu&&this.Is!==t.historyIndex:this.Uu}set isModified(t){if(this.Uu!==t){d.i(t,"boolean",Dt,"isModified"),this.Uu=t;const e=this.undoManager;!t&&e.isEnabled&&(this.Is=e.historyIndex),t||this.TL()}}TL(){const t=this.isModified;this.ZM!==t&&(this.ZM=t,this.v("Modified"))}get model(){return this.Si}set model(t){const e=this.Si;if(e!==t){this.currentTool.doCancel(),e&&e.undoManager!==t.undoManager&&e.undoManager.isInTransaction&&d.o("Do not replace a Diagram.model while a transaction is in progress."),this.animationManager.stopAnimation(!0);const i=this.cL(!0);this.$n=!1,this.vu=!0,this.Is=-2,this.Sr=!1;const n=this.jt;this.jt=!0,this.animationManager.Ol("Model"),e&&(null!==this.Wn&&this.Wn.each((t=>e.removeChangedListener(t))),e.removeChangedListener(this.$M)),this.Si=t,this.partManager=this.cR(this.Si.type),this.initializePartManager(this.partManager);for(let t=0;t<i.length;t++)this.add(i[t]);t.addChangedListener(this.JM),this.partManager.SS(),t.removeChangedListener(this.JM),t.addChangedListener(this.$M),null!==this.Wn&&this.Wn.each((e=>t.addChangedListener(e))),this.jt=n,this.invalidateDocumentBounds(),this.jt||this.C(),e&&t.undoManager.copyProperties(e.undoManager)}}get themeManager(){return this.gb}set themeManager(t){const e=this.gb;e!==t&&(null!==e&&e.removeDiagram(this),this.gb=t,null!==t&&t.addDiagram(this))}initializePartManager(t){}static fS(t,e){Dt.nL.add(t,e)}static get licenseKey(){return Dt.NS.last()}static set licenseKey(t){Dt.NS.add(t.replace(/\s/g,""))}static get version(){return Dt.fR}cR(t){const e=Dt.nL.get(t);return null!==e?new e:new qe}get G(){return this.WM}set G(t){this.WM=t}get mx(){return this.iL}uR(t){if(t.model!==this.model)return;const e=t.change,i=t.propertyName;if(1!==e||"S"!==i[0]){if(this.G){this.G=!1;try{if(""===t.modelChange&&1===e){("FinishedUndo"===i||"FinishedRedo"===i)&&(this.v("ChangedSelection",this.selection),this.Li());const e=this.animationManager;"RolledBackTransaction"===i&&e.stopAnimation(),this.aR(),this.Fc=!0,this.maybeUpdate(),(0===this.undoManager.transactionLevel||1===this.undoManager.transactionLevel)&&e.MM(),"CommittedTransaction"===i&&this.undoManager.isJustDiscarded&&(this.Is=Math.min(this.Is,this.undoManager.historyIndex-1)),("CommittedTransaction"===i||"RolledBackTransaction"===i)&&this.undoManager.Ow&&setTimeout((()=>{this.isModified=!1}),1);const n=t.isTransactionFinished;if(n&&(this.TL(),this.mx.clear(),this.animationManager.lF()),!this.Ex&&n&&this.lastInput.targetDiagram){this.Ex=!0;const t=this;d.Ih((()=>{t.currentTool.standardMouseOver(),t.Ex=!1}),10)}}}finally{this.G=!0}}}else if("StartingFirstTransaction"===i){const t=this,e=this.toolManager;e.mouseDownTools.each((e=>e.diagram=t)),e.mouseMoveTools.each((e=>e.diagram=t)),e.mouseUpTools.each((e=>e.diagram=t)),this.routers.each((e=>e.diagram=t)),!this.xs&&!this.$n&&(this.Fc=!0,this.vu&&(this.Sr=!0))}else if("StartingUndo"===i||"StartingRedo"===i){const t=this.animationManager;this.skipsUndoManager||(t.defaultAnimation.isAnimating&&t.stopAnimation(),t.getBundleAnimation().isAnimating&&t.getBundleAnimation().stop()),this.v("ChangingSelection",this.selection)}else if("StartedTransaction"===i){const t=this.animationManager;t.defaultAnimation.isAnimating&&!this.skipsUndoManager&&t.stopAnimation()}}get ge(){return this.qM}set ge(t){this.qM=t}get bm(){return this.Vx}set bm(t){this.Vx=t}xL(t){const e=t.T.r;for(const i of e)i instanceof ye&&this.CS(i)}CS(t){const e=t.element;if(null===e||!(e instanceof HTMLImageElement)||(e.ns instanceof k&&e.ns.add(this),t.dR(),!e.f0))return;const i=e.getAttribute("src")||"",n=this.Ql.getValue(i);if(null===n){ye.DL(t,e);const n=[];n.push(t),this.Ql.add(i,n)}else{for(let e=0;e<n.length;e++)if(n[e]===t)return;n.push(t)}}gR(t){const e=t.T.r,i=e.length;for(let n=0;n<i;n++)this.LS(e[n])}LS(t){if(!(t instanceof ye))return;const e=t.element;if(null===e||!(e instanceof HTMLImageElement)||!e.f0)return;const i=e.getAttribute("src")||"",n=this.Ql.getValue(i);if(null!==n)for(let s=0;s<n.length;s++)if(n[s]===t)return n.splice(s,1),void(0===n.length&&(this.Ql.remove(i),ye.mR(e),e.ns instanceof k&&e.ns.remove(this),ye.clearCache(i)))}fL(){ye.clearCache(),this.Ql.clear()}rebuildParts(){this.partManager.rebuildParts()}Sc(t,e){this.ms.Sc(t,e)}Mc(t,e){this.ms.Mc(t,e)}findPartForKey(t){return this.partManager.findPartForKey(t)}findNodeForKey(t){return this.partManager.findNodeForKey(t)}findLinkForKey(t){return this.partManager.findLinkForKey(t)}findPartForData(t){return this.partManager.findPartForData(t)}findNodeForData(t){return this.partManager.findNodeForData(t)}findLinkForData(t){return this.partManager.findLinkForData(t)}findNodesByExample(){return this.partManager.findNodesByExample(...arguments)}findLinksByExample(){return this.partManager.findLinksByExample(...arguments)}get nodeTemplate(){return this.Kr.getValue("")}set nodeTemplate(t){const e=this.Kr.getValue("");e!==t&&(this.Kr.add("",t),this.t("nodeTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get nodeTemplateMap(){return this.Kr}set nodeTemplateMap(t){const e=this.Kr;e!==t&&(this.Kr=t,this.t("nodeTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get groupTemplate(){return this.$h.getValue("")}set groupTemplate(t){const e=this.$h.getValue("");e!==t&&(this.$h.add("",t),this.t("groupTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get groupTemplateMap(){return this.$h}set groupTemplateMap(t){const e=this.$h;e!==t&&(this.$h=t,this.t("groupTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get linkTemplate(){return this.$l.getValue("")}set linkTemplate(t){const e=this.$l.getValue("");e!==t&&(this.$l.add("",t),this.t("linkTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get linkTemplateMap(){return this.$l}set linkTemplateMap(t){const e=this.$l;e!==t&&(this.$l=t,this.t("linkTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get isMouseCaptured(){return this.QM}set isMouseCaptured(t){const e=this.dt;if(null===e)return;const i=e.Ft;i instanceof SVGElement||(t?(this.lastInput.bubbles=!1,this.Ni(i,"pointermove",this.ea,!1),this.Ni(i,"pointerdown",this.th,!1),this.Ni(i,"pointerup",this.sa,!1),this.Ni(i,"pointerout",this.na,!1),this.Ni(i,"pointercancel",this.oa,!1),this.Bt(c,"pointermove",this.ea,!0),this.Bt(c,"pointerdown",this.th,!0),this.Bt(c,"pointerup",this.sa,!0),this.Bt(c,"pointerout",this.na,!0),this.Bt(c,"pointercancel",this.oa,!0),this.Ni(i,"wheel",this.ia,!1),this.Bt(c,"wheel",this.ia,!0),this.Bt(c,"selectstart",this.Gh,!1)):(this.Ni(c,"pointermove",this.ea,!0),this.Ni(c,"pointerdown",this.th,!0),this.Ni(c,"pointerup",this.sa,!0),this.Ni(c,"pointerout",this.na,!0),this.Ni(c,"pointercancel",this.oa,!0),this.Bt(i,"pointermove",this.ea,!1),this.Bt(i,"pointerdown",this.th,!1),this.Bt(i,"pointerup",this.sa,!1),this.Bt(i,"pointerout",this.na,!1),this.Bt(i,"pointercancel",this.oa,!1),this.Ni(c,"wheel",this.ia,!0),this.Ni(c,"selectstart",this.Gh,!1),this.Bt(i,"wheel",this.ia,!1)),this.QM=t)}get position(){return this.st}set position(t){if(this.st.equals(t))return;const e=T.l().a(this.st),i=this.viewportBounds.copy();if(this.st.a(t),this.animationManager.qC(e,this.st),this.jt||null===this.dt&&!this.Vu.isReal())this.jr();else{this.jt=!0;const t=this.scale,e=this.kt/t,i=this.Pt/t;this.mS(this.Hm,e,i,this.Tc,!1),this.jt=!1}if(!this.jt){const t=this.viewportBounds;this.onViewportBoundsChanged(i,t,this.K,!1)}T.s(e)}get initialPosition(){return this.xx}set initialPosition(t){this.xx.equals(t)||(this.xx=t.N())}get initialScale(){return this.bx}set initialScale(t){this.bx!==t&&(d.i(t,"number",Dt,"initialScale"),this.bx=t)}get grid(){return null===this.es&&(this.es=this.dL()),this.es}set grid(t){let e=this.es;if(e!==t){null===e&&(this.es=this.dL(),e=this.es),t.type!==ie.Grid&&d.o("Diagram.grid must be a Panel of type Panel.Grid");const i=e.panel;null!==i&&i.remove(e),this.es=t,t.name="GRID",null!==i&&i.add(t),this.Wr(),this.C(),this.t("grid",e,t)}}get viewportBounds(){return this._x}jr(){const t=this._x,e=this.st,i=this.K;t.e(e.x,e.y,Math.max(this.kt,0)/i,Math.max(this.Pt,0)/i),this.ih()}get viewSize(){return this.Vu}set viewSize(t){const e=this.viewSize;if(!e.equals(t)){t=t.N(),this.Vu=t;let i=0,n=0;t.isReal()?(i=t.width,n=t.height):null!==this.Tt&&(i=this.Tt.clientWidth||1,n=this.Tt.clientHeight||1),this.kt=i,this.Pt=n,this.jr(),this.invalidateDocumentBounds(),this.t("viewSize",e,t),this.C()}}get fixedBounds(){return this.Sx}set fixedBounds(t){const e=this.Sx;e.equals(t)||((t.width===-1/0||t.height===1/0||t.height===-1/0)&&d.o("fixedBounds width/height must not be Infinity"),t=t.N(),this.Sx=t,this.invalidateDocumentBounds(),this.t("fixedBounds",e,t))}get scrollMargin(){return this.Ac}set scrollMargin(t){"number"==typeof t&&(t=new F(t));const e=this.Ac;e.equals(t)||(t=t.N(),this.Ac=t,this.t("scrollMargin",e,t),this.yu())}get scrollMode(){return this.jh}set scrollMode(t){const e=this.jh;e!==t&&(this.jh=t,1===t&&this.Bs(!1),this.t("scrollMode",e,t),this.la(),this.C())}get scrollsPageOnFocus(){return this.Nx}set scrollsPageOnFocus(t){const e=this.Nx;e!==t&&(d.i(t,"boolean",Dt,"scrollsPageOnFocus"),this.Nx=t,this.t("scrollsPageOnFocus",e,t))}get positionComputation(){return this.Cx}set positionComputation(t){const e=this.Cx;e!==t&&(null!==t&&d.i(t,"function",Dt,"positionComputation"),this.Cx=t,this.Bs(!1),this.t("positionComputation",e,t))}get scaleComputation(){return this.Lx}set scaleComputation(t){const e=this.Lx;e!==t&&(null!==t&&d.i(t,"function",Dt,"scaleComputation"),this.Lx=t,this.AL(this.scale,this.scale),this.t("scaleComputation",e,t))}get documentBounds(){return this.Hm}FL(t){this.Qh=!1;let e=this.Hm;e.equals(t)||(e=e.copy(),this.Hm.a(t),this.Bs(!1),this.v("DocumentBoundsChanged",void 0,e),this.la(),this.C())}ensureBounds(){if(this.Qh){const t=D.l();this.FL(this.computeBounds(t)),D.s(t)}}get isVirtualized(){return this.tb}set isVirtualized(t){const e=this.tb;e!==t&&(d.i(t,"boolean",Dt,"isVirtualized"),this.tb=t,this.t("isVirtualized",e,t))}get scale(){return this.K}set scale(t){const e=this.K;e!==t&&this.AL(e,t)}get defaultScale(){return this.$m}set defaultScale(t){this.$m=t}get autoScale(){return this.Wl}set autoScale(t){const e=this.Wl;e!==t&&(this.Wl=t,this.t("autoScale",e,t),1!==t&&this.Bs(!1))}get initialAutoScale(){return this.Ar}set initialAutoScale(t){const e=this.Ar;e!==t&&(this.Ar=t,this.t("initialAutoScale",e,t))}get initialViewportSpot(){return this.Tx}set initialViewportSpot(t){const e=this.Tx;e!==t&&(t.isSpot()||d.o("initialViewportSpot must be a specific Spot: "+t),this.Tx=t,this.t("initialViewportSpot",e,t))}get initialDocumentSpot(){return this.Ax}set initialDocumentSpot(t){const e=this.Ax;e!==t&&(t.isSpot()||d.o("initialViewportSpot must be a specific Spot: "+t),this.Ax=t,this.t("initialDocumentSpot",e,t))}get minScale(){return this.kx}set minScale(t){const e=this.kx;e!==t&&(t>0?(this.kx=t,this.t("minScale",e,t),t>this.scale&&(this.scale=t)):d.tt(t,"> 0",Dt,"minScale"))}get maxScale(){return this.Px}set maxScale(t){const e=this.Px;e!==t&&(t>0?(this.Px=t,this.t("maxScale",e,t),t<this.scale&&(this.scale=t)):d.tt(t,"> 0",Dt,"maxScale"))}get zoomPoint(){return this.Mx}set zoomPoint(t){this.Mx.equals(t)||(t=t.N(),this.Mx=t)}get contentAlignment(){return this.Tc}set contentAlignment(t){const e=this.Tc;e.equals(t)||(t=t.N(),this.Tc=t,this.t("contentAlignment",e,t),this.Bs(!1))}get initialContentAlignment(){return this.zm}set initialContentAlignment(t){const e=this.zm;e.equals(t)||(t=t.N(),this.zm=t,this.t("initialContentAlignment",e,t))}get padding(){return this.Zt}set padding(t){"number"==typeof t&&(t=new F(t));const e=this.Zt;e.equals(t)||(t=t.N(),this.Zt=t,this.invalidateDocumentBounds(),this.t("padding",e,t))}get partManager(){return this.sS}set partManager(t){const e=this.sS;e!==t&&(null!==t.diagram&&d.o("Cannot share PartManagers between Diagrams: "+t.toString()),e&&e.Fo(null),this.sS=t,t.Fo(this))}get nodes(){return this.partManager.nodes.iterator}get links(){return this.partManager.links.iterator}get parts(){return this.partManager.parts.iterator}findTopLevelNodesAndLinks(){const t=new k,e=this.nodes;for(;e.next();){const i=e.value;i.isTopLevel&&t.add(i)}const i=this.links;for(;i.next();){const e=i.value;e.isTopLevel&&t.add(e)}return t.iterator}findTopLevelGroups(){return this.Hr.iterator}get routers(){return this.Vc}doLinkRouting(t){this.vo=!0;const e=this.Vc.r;for(let i=0;i<e.length;i++)e[i].canRoute(t)&&e[i].routeLinks(this.Tr,t);this.vo=!1}get layout(){return this.ee}set layout(t){const e=this.ee;e!==t&&(this.ee=t,t.diagram=this,t.group=null,this.Gr=!0,this.t("layout",e,t),this.requestUpdate())}layoutDiagram(t){this.Li(),t&&this.xb(!0),this.xs?this.wS(!1,this.Ml||0!==this.Vc.count&&0!==this.qn.size):(this.Fc=!0,this.xr())}xb(t){const e=this.Hr.iterator;for(;e.next();)this.RL(e.value,t);this.layout&&(t?this.layout.isValidLayout=!1:this.layout.invalidateLayout())}RL(t,e){if(null===t)return;const i=t.ha.iterator;for(;i.next();){const t=i.value;this.RL(t,e)}null!==t.layout&&(e?t.layout.isValidLayout=!1:t.layout.invalidateLayout())}wS(t,e){if(this.Ux)return;const i=this.G;this.G=!0;const n="Layout",s=this.undoManager.transactionLevel,o=this.layout,r=this.animationManager;try{0===s&&(this.undoManager.Pl=!0,this.startTransaction(n)),s<=1&&!r.defaultAnimation.isAnimating&&!r.xi&&(t||r.Ol(n)),this.Gr=!1;let i=this.Hr.iterator;for(;i.next();)this.vL(i.value,t,s,e);let a=!1;if(o.isValidLayout||(!t||o.isRealtime||null===o.isRealtime||0===s?(o.doLayout(this),this.l0(this),a=!0,o.isValidLayout=!0):this.Gr=!0),a||this.l0(this),this.doLinkRouting(this),this.Tr.clear(),0!==this.Jh.size){for(let t=0;t<23&&0!==this.Jh.size;t++){for(i=this.Hr.iterator;i.next();)this.OL(i.value);const t=this.Tr;this.Tr=this.Jh,this.Jh=t,this.l0(this),this.doLinkRouting(this)}this.Tr.clear(),this.Jh.clear()}}finally{const t=this.undoManager.Pl;0===s&&(this.commitTransaction(n),this.undoManager.Pl=!1),t&&(0===s||1===s)&&r.MM(),this.Gr&&(this.Gr=!o.isValidLayout),this.G=i}}vL(t,e,i,n){const s=t.ha.iterator;for(;s.next();)this.vL(s.value,e,i,n);const o=t.layout;null===o||o.isValidLayout?n&&this.doLinkRouting(t):!e||o.isRealtime||0===i?(t.Qr=!t.location.isReal(),o.doLayout(t),t.invalidateLayout(32),this.pb(t),this.l0(t),this.doLinkRouting(t),o.isValidLayout=!0):(this.doLinkRouting(t),this.Gr=!0)}OL(t){const e=t.ha.iterator;for(;e.next();)this.OL(e.value);this.l0(t),this.doLinkRouting(t)}get isTreePathToChildren(){return this.Dx}set isTreePathToChildren(t){const e=this.Dx;if(e!==t&&(d.i(t,"boolean",Dt,"isTreePathToChildren"),this.Dx=t,this.t("isTreePathToChildren",e,t),!this.undoManager.isUndoingRedoing)){const t=this.nodes;for(;t.next();)t.value.u0()}}findTreeRoots(){const t=new x,e=this.nodes;for(;e.next();){const i=e.value;i.isTopLevel&&null===i.findTreeParentLink()&&t.add(i)}return t.iterator}get treeCollapsePolicy(){return this.Fx}set treeCollapsePolicy(t){const e=this.Fx;e!==t&&(1!==t&&2!==t&&3!==t&&d.o("Unknown Diagram.treeCollapsePolicy: "+t),this.Fx=t,this.t("treeCollapsePolicy",e,t))}get isCollapsingExpanding(){return this.KM}set isCollapsingExpanding(t){this.KM=t}EF(){const t=new L,e=new L;function i(i){const n=i.toLowerCase(),s=new x;t.add(i,s),t.add(n,s),e.add(i,i),e.add(n,i)}i("InitialAnimationStarting"),i("AnimationStarting"),i("AnimationFinished"),i("BackgroundSingleClicked"),i("BackgroundDoubleClicked"),i("BackgroundContextClicked"),i("ClipboardChanged"),i("ClipboardPasted"),i("DocumentBoundsChanged"),i("ExternalObjectsDropped"),i("GainedFocus"),i("InitialLayoutCompleted"),i("LayoutCompleted"),i("LinkDrawn"),i("LinkRelinked"),i("LinkReshaped"),i("LostFocus"),i("Modified"),i("ObjectSingleClicked"),i("ObjectDoubleClicked"),i("ObjectContextClicked"),i("PartCreated"),i("PartResized"),i("PartRotated"),i("SelectionMoved"),i("SelectionCopied"),i("SelectionDeleting"),i("SelectionDeleted"),i("SelectionGrouped"),i("SelectionUngrouped"),i("ChangingSelection"),i("ChangedSelection"),i("SubGraphCollapsed"),i("SubGraphExpanded"),i("TextEdited"),i("ThemeChanged"),i("TreeCollapsed"),i("TreeExpanded"),i("ViewportBoundsChanged"),i("InvalidateDraw"),this.zM=t,this.XM=e}wL(t){const e=this.XM.getValue(t);return null!==e?e:this.XM.getValue(t.toLowerCase())}AS(t){let e=this.zM.getValue(t);if(null!==e)return e;const i=t.toLowerCase();if(e=this.zM.getValue(i),null!==e)return e;d.o("Unknown DiagramEvent name: "+t)}addDiagramListener(t,e){d.i(t,"string",Dt,"addDiagramListener:name"),d.i(e,"function",Dt,"addDiagramListener:listener");const i=this.AS(t);return null!==i&&i.add(e),this}removeDiagramListener(t,e){d.i(t,"string",Dt,"removeDiagramListener:name"),d.i(e,"function",Dt,"addDiagramListener:listener");const i=this.AS(t);null!==i&&i.remove(e)}raiseDiagramEvent(t,e,i){this.v(t,e,i)}v(t,e,i){const n=this.AS(t),s=new X;s.diagram=this;const o=this.wL(t);null!==o&&(s.name=o),void 0!==e&&(s.subject=e),void 0!==i&&(s.parameter=i);const r=n.length;if(1===r)n.elt(0)(s);else if(0!==r){const t=n.toArray();for(let e=0;e<r;e++){(0,t[e])(s)}}}isUnoccupied(t,e){return this.getPositions(!1,null,e||null).isUnoccupied(t.x,t.y,t.width,t.height)}computeOccupiedArea(t){return this.isVirtualized?this.viewportBounds.copy():this.Qh?this.mL(t):t.a(this.documentBounds)}getPositions(t,e,i){let n=this.Jl;null===n&&(this.Jl=n=new Oe(this.avoidanceCellSize));let s=e;if(n.Uo||n.aa!==s||n.TS!==i){if(n.DS=Math.max(n.Xc+1,Math.floor(this.avoidanceLimit/this.avoidanceCellSize.width)),n.FS=Math.max(n.Xc+1,Math.floor(this.avoidanceLimit/this.avoidanceCellSize.height)),null!==s&&(s=this.IL(s)),null===s){const t=D.l();this.computeOccupiedArea(t),t.inflate(100,100),n.bb(t);const e=this.nodes;for(;e.next();){const n=e.value,s=n.layer;null===s||!s.visible||s.isTemporary||this.RS(n,i,t)}D.s(t)}else{if(s.memberParts.count>0){const t=this.computePartsBounds(s.memberParts,!1);t.inflate(20,20),n.bb(t)}const t=D.l(),e=s.memberParts;for(;e.next();){const n=e.value;n instanceof Ce&&this.RS(n,i,t)}D.s(t)}n.aa=s,n.TS=i,n.Uo=!1}else t&&n.EL();return n}get avoidanceCellSize(){return this.iS}set avoidanceCellSize(t){this.Jl=null,this.iS=new A(Math.max(1,t.width),Math.max(1,t.height))}get avoidanceLimit(){return this.eS}set avoidanceLimit(t){this.eS=Math.max(1,t)}IL(t){return t.canAvoid()?t:null!==t.containingGroup?this.IL(t.containingGroup):null}RS(t,e,i){if(t===e||!t.isVisible())return;const n=t.canAvoid();if(n){const e=t.getAvoidableRect(i);this.Jl.pR(e.x,e.y,e.width,e.height)}if(t instanceof Ve&&(!n||t.avoidableMembers)){const n=t.memberParts;for(;n.next();){const t=n.value;t instanceof Ce&&this.RS(t,e,i)}}}vS(t){null!==this.Jl&&!this.Jl.Uo&&(void 0===t||t.canAvoid())&&(this.Jl.Uo=!0)}get autoScrollInterval(){return this.Xm}set autoScrollInterval(t){const e=this.Xm;e!==t&&(this.Xm=t,this.t("autoScrollInterval",e,t))}get autoScrollRegion(){return this.Km}set autoScrollRegion(t){"number"==typeof t&&(t=new F(t));const e=this.Km;e.equals(t)||(t=t.N(),this.Km=t,this.invalidateDocumentBounds(),this.t("autoScrollRegion",e,t))}doAutoScroll(t){this.Wm.a(t),this.computeAutoScrollPosition(this.Wm).equalsApprox(this.position)?this.stopAutoScroll():this.VL()}VL(){if(-1!==this.Dc)return;const t=this.Xm,e=this;this.Dc=d.Ih((()=>{if(-1===e.Dc||(e.stopAutoScroll(),null===e.lastInput.event))return;const t=e.computeAutoScrollPosition(e.Wm);if(t.equalsApprox(e.position))return;e.position=t,e.lastInput.documentPoint=e.transformViewToDoc(e.Wm),e.doMouseMove(),e.Qh=!0;const i=D.l();e.computeBounds(i),i.unionRect(e.documentBounds),e.FL(i),D.s(i),e.Xe=!0,e.maybeUpdate(),e.VL()}),t)}stopAutoScroll(){-1!==this.Dc&&(d.Eg(this.Dc),this.Dc=-1)}computeAutoScrollPosition(t){let e=this.position;const i=this.Km;if(i.top<=0&&i.left<=0&&i.right<=0&&i.bottom<=0)return e;const n=this.viewportBounds,s=this.scale,o=D.X(0,0,n.width*s,n.height*s),r=T.X(0,0);if(t.x>=o.x&&t.x<o.x+i.left&&this.allowHorizontalScroll){let e=Math.max(this.scrollHorizontalLineChange,1);e|=0,r.x-=e,t.x<o.x+i.left/2&&(r.x-=e),t.x<o.x+i.left/4&&(r.x-=4*e)}else if(t.x<=o.x+o.width&&t.x>o.x+o.width-i.right&&this.allowHorizontalScroll){let e=Math.max(this.scrollHorizontalLineChange,1);e|=0,r.x+=e,t.x>o.x+o.width-i.right/2&&(r.x+=e),t.x>o.x+o.width-i.right/4&&(r.x+=4*e)}if(t.y>=o.y&&t.y<o.y+i.top&&this.allowVerticalScroll){let e=Math.max(this.scrollVerticalLineChange,1);e|=0,r.y-=e,t.y<o.y+i.top/2&&(r.y-=e),t.y<o.y+i.top/4&&(r.y-=4*e)}else if(t.y<=o.y+o.height&&t.y>o.y+o.height-i.bottom&&this.allowVerticalScroll){let e=Math.max(this.scrollVerticalLineChange,1);e|=0,r.y+=e,t.y>o.y+o.height-i.bottom/2&&(r.y+=e),t.y>o.y+o.height-i.bottom/4&&(r.y+=4*e)}return r.equalsApprox(T.Mo)||(e=new T(e.x+r.x/s,e.y+r.y/s)),D.s(o),T.s(r),e}makeSvg(t){this.Zl.contains("SVG")||this.addRenderer("SVG",new _t(this,c.document));const e=new _t(this,c.document,!0);void 0===t&&(t={});const i=this;return this.BL((function(t,n){const s=i.UL(t,"SVG",e),o=null!==s?s.svg:null;return"function"==typeof n?(n(o),null):o}),t)}makeSVG(t){return this.makeSvg(t)}addRenderer(t,e){this.Zl.add(t,e)}removeRenderer(t){this.Zl.remove(t)}cacheGroupExternalLinks(t){this.cS=t,t||this.nodes.each((t=>{t instanceof Ve&&(t.d0=null)}))}BL(t,e){const i=e.callback;let n=!0;const s=this.Ql.iterator;for(;s.next();)if(!s.value[0].yn){n=!1;break}if("function"!=typeof i||n)return t(e,i,this);const o=this;function r(){const h=+new Date;for(n=!0,s.reset();s.next();)if(!s.value[0].yn){n=!1;break}n||h-l>a?t(e,i,o):c.requestAnimationFrame(r)}const a=e.callbackTimeout||300,l=+new Date;return c.requestAnimationFrame((()=>r())),null}makeImage(t){return Dt.isUsingDOM()?(void 0===t&&(t={}),t.returnType="Image",this.makeImageData(t)):null}makeImageData(t){return void 0===t&&(t={}),this.BL(this.yR,t)}yR(t,e,i){const n=i.UL(t,"canvas",null);if(null===n)return null;const s=n.U.canvas;let o=null;if(null!==s){let i=t.returnType;switch(i=void 0===i?"string":i.toLowerCase(),i){case Dt.img+"data":o=n.getImageData(0,0,s.width,s.height);break;case Dt.img:const i=(t.document||document).createElement("img");i.src=s.toDataURL(t.type,t.details),o=i;break;case"blob":{const i=s;return"function"!=typeof e&&(o="",d.o('Error: Diagram.makeImageData called with "returnType: toBlob", but no required "callback" function property defined.')),"function"==typeof i.toBlob?(i.toBlob(e,t.type,t.details),"toBlob"):(e(null),null)}default:o=s.toDataURL(t.type,t.details)}}return"function"==typeof e?(e(o),null):o}UL(t,e,i){if(this.animationManager.stopAnimation(),this.maybeUpdate(),null===this.dt)return null;"object"!=typeof t&&d.o("properties argument must be an Object.");let n=!1,s=t.size||null,o=t.scale||null;void 0!==t.scale&&isNaN(t.scale)&&(o="NaN");let r=t.maxSize;void 0===t.maxSize&&(n=!0,r="SVG"===e?new A(1/0,1/0):new A(2e3,2e3));const a=t.position||null;let l=t.parts||null;Array.isArray(l)&&(l=new x(l));let h=void 0===t.padding?1:t.padding;const u=t.background||null;let c=t.omitTemporary;void 0===c&&(c=!0);const f=t.document||document,g=t.elementFinished||null;let m=t.showTemporary;void 0===m&&(m=!c);let p=t.showGrid;void 0===p&&(p=m),null!==s&&isNaN(s.width)&&isNaN(s.height)&&(s=null),"number"==typeof h?h=new F(h):h instanceof F||d.o("MakeImage padding must be a Margin or a number."),h.left=Math.max(h.left,0),h.right=Math.max(h.right,0),h.top=Math.max(h.top,0),h.bottom=Math.max(h.bottom,0),this.ni.clearContextCache(!0);const y=new qt(null,f,void 0,!0),v=y.ci;if(!(s||o||l||a))return y.width=this.kt+Math.ceil(h.left+h.right),y.height=this.Pt+Math.ceil(h.top+h.bottom),"SVG"===e?null===i?null:(i.resize(y.width,y.height,y.width,y.height),i.ca=f,i.Gu=g,this.yb(i.ci,h,new A(y.width,y.height),this.K,this.st,l,u,m,p),i.ci):(this.Bu=!1,this.yb(v,h,new A(y.width,y.height),this.K,this.st,l,u,m,p),this.Bu=!0,y.ci);const b=this.$m,w=this.documentBounds.copy();if(w.subtractMargin(this.Zt),m){const t=this.Gt.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];if(!e.visible||!e.isTemporary)continue;const n=e.At.r,s=n.length;for(let t=0;t<s;t++){const e=n[t];if(!e.isInDocumentBounds||!e.isVisible())continue;const i=e.actualBounds;i.isReal()&&w.unionRect(i)}}}let k=new T(w.x,w.y);if(null!==l){const t=new D(0,0,0,0);let e=!0;const i=l.iterator;for(i.reset();i.next();){const n=i.value;if(!(n instanceof ke))continue;const s=n.layer;if(null!==s&&!s.visible||null!==s&&!m&&s.isTemporary||!n.isVisible())continue;const o=n.actualBounds;o.isReal()&&(e?(e=!1,t.a(o)):t.unionRect(o))}w.width=t.width,w.height=t.height,k.x=t.x,k.y=t.y}null!==a&&a.isReal()&&(k=a,o||(o=b));let S=0,P=0;null!==h&&(S=h.left+h.right,P=h.top+h.bottom);let M=0,C=0;null!==s&&(M=s.width,C=s.height,isFinite(M)&&(M=Math.max(0,M-S)),isFinite(C)&&(C=Math.max(0,C-P)));let N=0,L=0;if(null!==s&&null!==o?("NaN"===o&&(o=b),s.isReal()?(N=M,L=C):isNaN(C)?(N=M,L=w.height*o):(N=w.width*o,L=C)):null!==s?s.isReal()?(o=Math.min(M/w.width,C/w.height),N=M,L=C):isNaN(C)?(o=M/w.width,N=M,L=w.height*o):(o=C/w.height,N=w.width*o,L=C):null!==o?"NaN"===o&&r.isReal()?(o=Math.min((r.width-S)/w.width,(r.height-P)/w.height),o>b?(o=b,N=w.width,L=w.height):(N=r.width,L=r.height)):(N=w.width*o,L=w.height*o):(o=b,N=w.width,L=w.height),null!==h?(N+=S,L+=P):h=new F(0),null!==r){let t=r.width,i=r.height;"SVG"!==e&&n&&Dt.wR,isNaN(t)&&(t=2e3),isNaN(i)&&(i=2e3),isFinite(t)&&(N=Math.min(N,t)),isFinite(i)&&(L=Math.min(L,i))}return y.width=Math.ceil(N),y.height=Math.ceil(L),"SVG"===e?null===i?null:(i.resize(y.width,y.height,y.width,y.height),i.ca=f,i.Gu=g,this.yb(i.ci,h,new A(Math.ceil(N),Math.ceil(L)),o,k,l,u,m,p),i.ci):(this.Bu=!1,this.yb(v,h,new A(Math.ceil(N),Math.ceil(L)),o,k,l,u,m,p),this.Bu=!0,y.ci)}}a=Dt,y(Dt,"hb",null),y(Dt,"nL",new L),y(Dt,"lS",void 0),y(Dt,"hS",null),y(Dt,"hL",void 0!==c.document),y(Dt,"se",new WeakMap),y(Dt,"s0",null),y(Dt,"mb",""),y(Dt,"None",1),y(Dt,"Uniform",2),y(Dt,"UniformToFill",3),y(Dt,"CycleAll",1),y(Dt,"CycleNotDirected",2),y(Dt,"CycleNotDirectedFast",3),y(Dt,"CycleNotUndirected",4),y(Dt,"CycleDestinationTree",5),y(Dt,"CycleSourceTree",6),y(Dt,"DocumentScroll",1),y(Dt,"InfiniteScroll",2),y(Dt,"TreeParentCollapsed",1),y(Dt,"AllParentsCollapsed",2),y(Dt,"AnyParentsCollapsed",3),y(Dt,"NS",new x),y(Dt,"fR","3.0.2"),y(Dt,"img","image"),y(Dt,"wR",!1),y(Dt,"Ku",null),y(Dt,"zL","5da73c80a36555d4038e4972187c3cae51fd22"),y(Dt,"uw",!1),y(Dt,"Ik",(()=>{if(void 0===a.zL[5]&&(R.prototype.is=R.prototype.yw),!a.isUsingDOM())return;const t=c.document.createElement("canvas"),e=t.getContext("2d"),i=d.Ts("7ca11abfd022028846");e[i]=d.Ts("398c3597c01238");const n="7ca11abfd7330390",s=[a.zL,d.uw+"4ae6247590da4bb21c324ba3a84e385776",R.Ik+"fb236cdfda5de14c134ba1a95a2d4c7cc6f93c1387",E.za];for(let o=1;o<5;o++)e[d.Ts(n)](d.Ts(s[o-1]),10,15*o+0);e[i]=d.Ts("39f046ebb36e4b");for(let o=1;o<5;o++)e[d.Ts(n)](d.Ts(s[o-1]),10,15*o+0);(4!==s.length||"5"!==s[0][0]||"7"!==s[3][0])&&(R.prototype.is=R.prototype.yw),a.Ku=t}));class Ft{constructor(t){if(y(this,"XL",void 0),y(this,"KL",void 0),y(this,"OS",void 0),y(this,"Ae",void 0),this.XL=null,this.KL="63ad05bbe23a1786468a4c741b6d2",this.OS="@onz",this.KL===this._tk)return this.OS=!0,void(this.Ae=this.OS);this.Ae=null}xR(t,e){let i="f";const n=c[d.Ts("76a715b2f73f148a")][d.Ts("72ba13b5")]||"",s=d.Ts;if(this.Ae=!0,!Dt.isUsingDOM())return;let o=Dt[s("76a115b6ed251eaf4692")];if(!o){const t=n[s("76ad18b4f73e")];for(let o=n[s("73a612b6fb191d")](s("35e7"))+2;o<t;o++)i+=n[o];const e=i[s("73a612b6fb191d")](s("7da71ca0ad381e90"));return void(this.Ae=!(e>=0&&e<i[s("73a612b6fb191d")](s("35"))))}const r=Dt.NS.iterator;for(;r.next();){o=r.value;const t=s(o).split(s("39e9"));if(t.length<6)return;const a=s(t[1]).split(".");if("7da71ca0"!==t[4])return;const l=s(d[s("6cae19")]).split(".");if(!(a[0]>l[0]||a[0]===l[0]&&a[1]>=l[1]))continue;const h="73a612b6fb191d",u=c[s("74a900bae4370f8b51")][s("6fbb13a1c2311e8a57")].toLowerCase(),f=u[s(h)](s("3aad1ab6e022098b4dc4")),g=s(t[2]);if(f>-1){const t=u[s(h)](g.toLowerCase()+"/");if(this.Ae=!(t>-1&&t<f),!this.Ae)return}const m=n[s("76ad18b4f73e")];for(let e=n[s(h)](s("35e7"))+2;e<m;e++)i+=n[e];let p=i[s(h)](g);if(p<0&&g!==s("7da71ca0ad381e90")&&(p=i[s(h)](s("76a715b2ef3e149757"))),p<0&&(p=i[s(h)](s("76a715b2ef3e149757"))),p<0&&(p=i[s(h)](s("2bfa41fdb3784bca12"))),p<0&&(p=n[s(h)](s("7baa19a6f76c1988428554"))),this.Ae=!(p>=0&&p<i[s(h)](s("35"))||-1===i[s(h)](s("35"))),!this.Ae||n[s(h)](s("7fb002b6ed25128b4da25b2e"))&&(this.Ae=!(n[s(h)](g)>-1),!this.Ae))return;const y=c[d.Ts("76a715b2f73f148a")][d.Ts("69ad17a1e03e")],v=y[s(h)](s("7fb002b6ed25128b4da25b2e"));if(v>-1&&(this.Ae=!(y[s(h)](g)>v),!this.Ae))return;const b=g;if("#"!==b[0])continue;const x=c.document.createElement("div");let w=t[0].replace(/[A-Za-z]/g,"");for(;w.length<4;)w+="9";const k=w;w=w.substring(w.length-4);let S="";const P=["Header","Background","Display","Feedback"];if(S+=["gsh","gsf"][parseInt(w.substring(0,1),10)%2],S+=P[parseInt(w.substring(0,1),10)%4],x[s("79a417a0f0181a8946")]=S,c.document[s("78a712aa")]){c.document[s("78a712aa")][s("7bb806b6ed32388c4a875b")](x);const t=c.getComputedStyle(x).getPropertyValue(s("78a704b7e62456904c9b12701b6532a8")),e=c.getComputedStyle(x).getPropertyValue(s("75b817b0ea2202"));if(c.document[s("78a712aa")][s("68ad1bbcf533388c4a875b")](x),!t)continue;const i=c[s("77a902b0eb1b1e804a8a")];if(e==="0."+parseInt(k,10)%100||-1!==t.indexOf(parseInt(b[1]+b[2],16))&&-1!==t.indexOf(parseInt(b[3]+b[4],16)))return void(this.Ae=!1);if(i&&i(s("32ae19a1e0331fc94084537c067a67fa59f1386b89d006")).matches){S="."+S;for(let t=0;t<document.styleSheets.length;t++){const e=document.styleSheets[t].rules||document.styleSheets[t].cssRules;for(const t in e)if(S===e[t].selectorText)return void(this.Ae=!1)}}}else this.Ae=null,e&&(this.Ae=!1)}}Ku(t){return t.ni.setTransform(t.Ui,0,0,t.Ui,0,0),t.ni.commitTransform(),null===this.Ae&&this.xR(t,!0),0<this.Ae&&this!==this.XL}}class Ot{constructor(t){y(this,"IS",void 0),y(this,"ES",void 0),this.IS=void 0===t?new T:t,this.ES=new T}get point(){return this.IS}set point(t){this.IS=t}get shifted(){return this.ES}set shifted(t){this.ES=t}}class Rt{constructor(t,e,i){y(this,"me",void 0),y(this,"ML",void 0),y(this,"wb",void 0),this.me=t,this.ML=e,this.wb=i}}class Et{constructor(t){y(this,"isGridSnapEnabled",void 0),y(this,"isGridSnapRealtime",void 0),y(this,"gridSnapCellSize",void 0),y(this,"gridSnapCellSpot",void 0),y(this,"gridSnapOrigin",void 0),y(this,"dragsLink",void 0),y(this,"dragsTree",void 0),y(this,"groupsSnapMembers",void 0),y(this,"groupsAlwaysMove",void 0),y(this,"dragsMembers",void 0),this.Jt(),t&&Object.assign(this,t)}Jt(){this.isGridSnapEnabled=!1,this.isGridSnapRealtime=!0,this.gridSnapCellSize=new A(NaN,NaN).g(),this.gridSnapCellSpot=O.TopLeft,this.gridSnapOrigin=new T(NaN,NaN).g(),this.dragsLink=!1,this.dragsTree=!1,this.groupsSnapMembers=!1,this.groupsAlwaysMove=!0,this.dragsMembers=!0}}class Bt extends Dt{constructor(t,e){return"string"==typeof t||c.Element&&t instanceof Element?(super(t),y(this,"kb",void 0),y(this,"Pb",void 0),y(this,"Mb",void 0),y(this,"Sb",void 0),y(this,"g0",void 0),y(this,"Kc",void 0),y(this,"Fl",void 0),y(this,"VS",void 0),y(this,"US",void 0),y(this,"Nb",void 0),y(this,"BS",void 0)):(super(),y(this,"kb",void 0),y(this,"Pb",void 0),y(this,"Mb",void 0),y(this,"Sb",void 0),y(this,"g0",void 0),y(this,"Kc",void 0),y(this,"Fl",void 0),y(this,"VS",void 0),y(this,"US",void 0),y(this,"Nb",void 0),y(this,"BS",void 0),e=t),this.animationManager.isEnabled=!1,this.jt=!0,this.kb=null,this.Ou=!1,this.Iu=!1,this.Pb=!0,this.Mb=!0,this.Sb=0,this.g0=!1,this.Kc=null,this.setRenderingHint("drawShadows",!1),this.Fl=new ke({selectable:!0,selectionAdorned:!1,selectionObjectName:"BOXSHAPE",locationObjectName:"BOXSHAPE",resizeObjectName:"BOXSHAPE",cursor:"move"}).add(new le({name:"BOXSHAPE",fill:"transparent",stroke:"magenta",strokeWidth:2}).theme("stroke","overviewBox")).hi(),this.allowCopy=!1,this.allowDelete=!1,this.allowSelect=!0,this.autoScrollRegion=new F(0,0,0,0),this.st.e(0,0),this.toolManager.$t("Dragging",new It,this.toolManager.mouseMoveTools),this.click=()=>{const t=this.observed;if(null===t)return;const e=t.viewportBounds,i=this.lastInput.documentPoint;t.position=new T(i.x-e.width/2,i.y-e.height/2)},this.VS=t=>{this.invalidateDocumentBounds(),this.m0()},this.US=t=>{null!==this.observed&&(this.invalidateDocumentBounds(),this.C())},this.Nb=t=>{this.updateDelay<1?this.C():this.g0||(this.g0=!0,setTimeout((()=>this.redraw()),this.updateDelay))},this.BS=t=>{null!==this.observed&&this.m0()},this.autoScale=2,this.jt=!1,e&&Object.assign(this,e),this}setupRouters(){}computePixelRatio(){return 1}redraw(){this.g0&&this.updateDelay>=1&&(this.g0=!1,this.bR()),super.redraw()}Gi(){if(null===this.Tt&&d.o("No div specified"),null===this.dt&&d.o("No canvas specified"),this.dt instanceof _t||(this.box.UM(),!this.Xe))return;const t=this.observed;if(null===t||t.animationManager.defaultAnimation.isAnimating||!t.Uh)return;this.h0();const e=this.dt,i=this.ni;if(i.clearContextCache(!0),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,e.width,e.height),this.updateDelay<1)this.GL();else if(null!==this.Kc){i.drawImage(this.Kc.Ft,0,0);const t=this.L;t.Jt(),1!==this.scale&&t.K(this.scale),(0!==this.position.x||0!==this.position.y)&&t.Qi(-this.position.x,-this.position.y),i.scale(this.Ui,this.Ui),i.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),i.commitTransform()}const n=this.Gt.r,s=n.length;for(let o=0;o<s;o++)n[o].Gi(i,this);this.vc=!1,this.Xe=!1}bR(){const t=this.dt,e=this.ni;if(null!==t&&null!==e){if(this.h0(),null===this.Kc){const e=new qt(null);e.width=t.width,e.height=t.height,this.Kc=e}try{this.dt=this.Kc,this.ni=this.dt.ci,this.ni.clearContextCache(!0),this.ni.setTransform(1,0,0,1,0,0),this.ni.clearRect(0,0,this.dt.width,this.dt.height),this.GL()}finally{this.dt=t,this.ni=e}}}GL(){const t=this.observed;if(null===t)return;const e=this.drawsTemporaryLayers,i=this.drawsGrid&&e,n=t.grid;if(i&&null!==n&&n.visible&&!isNaN(n.width)&&!isNaN(n.height)){const e=D.l().a(this.viewportBounds).unionRect(t.viewportBounds);t.Wr(e),D.s(e),t.Li()}const s=this.L;s.Jt(),1!==this.scale&&s.K(this.scale),(0!==this.position.x||0!==this.position.y)&&s.Qi(-this.position.x,-this.position.y);const o=this.ni;o.scale(this.Ui,this.Ui),o.transform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),o.commitTransform();const r=this.viewportBounds,a=t.Gt.r,l=a.length;for(let h=0;h<l;h++)a[h].yF(o,r,this,e,i)}get observed(){return this.kb}set observed(t){const e=this.kb;if(t instanceof Bt&&d.o("Overview.observed Diagram may not be an Overview itself: "+t),e!==t){if(this.kR(e),this.kb=t,this.PR(t),this.invalidateDocumentBounds(),null===t){this.Kc=null;const t=this.dt,e=this.ni;t&&e&&(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height))}else this.Nb(null),this.m0(),this.C();this.t("observed",e,t)}}get box(){return this.Fl}set box(t){const e=this.Fl;e!==t&&(t.hi(),this.Fl=t,this.remove(e),this.add(this.Fl),this.m0(),this.t("box",e,t))}get drawsTemporaryLayers(){return this.Pb}set drawsTemporaryLayers(t){this.Pb!==t&&(this.Pb=t,this.redraw())}get drawsGrid(){return this.Mb}set drawsGrid(t){this.Mb!==t&&(this.Mb=t,this.redraw())}get updateDelay(){return this.Sb}set updateDelay(t){t<0&&(t=0),this.Sb!==t&&(this.Sb=t)}PR(t){null!==t&&(t.addDiagramListener("ViewportBoundsChanged",this.VS),t.addDiagramListener("DocumentBoundsChanged",this.US),t.addDiagramListener("InvalidateDraw",this.Nb),t.addDiagramListener("AnimationFinished",this.BS),this.add(this.box))}kR(t){null!==t&&(this.remove(this.box),t.removeDiagramListener("ViewportBoundsChanged",this.VS),t.removeDiagramListener("DocumentBoundsChanged",this.US),t.removeDiagramListener("InvalidateDraw",this.Nb),t.removeDiagramListener("AnimationFinished",this.BS))}m0(){const t=this.box;if(null===t)return;const e=this.observed;if(null===e)return;this.Xe=!0;const i=e.viewportBounds,n=t.selectionObject,s=A.l();s.e(i.width,i.height),n.desiredSize=s,A.s(s);const o=2/this.scale;n instanceof le&&(n.strokeWidth=o),t.location=new T(i.x-o/2,i.y-o/2),t.isSelected=!0}computeBounds(){const t=this.observed;if(null===t)return D.Dk;const e=t.documentBounds.copy();return e.unionRect(t.viewportBounds),e}invalidateViewport(t,e){!0!==this.Xe&&(this.Xe=!0,this.requestUpdate())}onViewportBoundsChanged(t,e,i,n){this.jt||(this.ih(),this.C(),this.la(),this.invalidateDocumentBounds(),this.m0(),this.Vi.scale=i,this.Vi.position.x=t.x,this.Vi.position.y=t.y,this.Vi.bounds.a(t),this.Vi.isScroll=n,this.v("ViewportBoundsChanged",this.Vi,t))}}class It extends Q{constructor(){super(),y(this,"sh",void 0),this.sh=null}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(null===t||!t.allowMove||!t.allowSelect)return!1;const e=t.observed;if(null===e)return!1;const i=t.lastInput;if(!i.left||t.currentTool!==this&&(!this.isBeyondDragSize()||i.isTouchEvent&&i.timestamp-t.firstInput.timestamp<this.delay))return!1;if(null===this.findDraggablePart()){const i=e.viewportBounds;this.sh=new T(i.width/2,i.height/2);const n=t.firstInput.documentPoint;e.position=new T(n.x-this.sh.x,n.y-this.sh.y)}return!0}doActivate(){this.sh=null,super.doActivate()}doUpdateCursor(t){const e=this.diagram,i=e.box;null!==i&&i.cursor&&(e.currentCursor=i.cursor)}moveParts(t,e,i){void 0===i&&(i=!1);const n=this.diagram,s=n.observed;if(null===s)return;const o=n.box;if(null===o)return;if(null===this.sh){const t=n.firstInput.documentPoint,e=o.location;this.sh=new T(t.x-e.x,t.y-e.y)}const r=n.lastInput.documentPoint;s.position=new T(r.x-this.sh.x,r.y-this.sh.y)}}class Vt{constructor(t){y(this,"k",void 0),y(this,"zS",void 0),y(this,"XS",void 0),y(this,"KS",void 0),y(this,"YS",void 0),y(this,"GS",void 0),y(this,"HS",void 0),y(this,"jS",void 0),y(this,"qS",void 0),y(this,"nh",void 0),y(this,"WS",void 0),y(this,"Cb",void 0),y(this,"JS",void 0),y(this,"Lb",void 0),y(this,"Ab",void 0),y(this,"$S",void 0),y(this,"Bo",void 0),y(this,"ZS",void 0),k.Yi(this),this.k=Dt.ym(),this.zS=!0,this.XS=!0,this.KS=!0,this.YS=!1,this.GS=!1,this.HS=!1,this.jS=!1,this.qS=null,this.nh=null,this.WS=1.05,this.Cb=NaN,this.JS=null,this.Lb=NaN,this.Ab=D.Dk,this.$S=!1,this.Bo=null,this.ZS=200,t&&Object.assign(this,t)}toString(){return"CommandHandler"}get diagram(){return this.k}Fo(t){this.k=t}doKeyDown(){const t=this.diagram,e=t.lastInput,i=d.hr?e.meta:e.control,n=e.shift,s=e.alt,o=e.code;!i||"KeyC"!==o&&"Insert"!==o?i&&"KeyX"===o||n&&"Delete"===o?this.canCutSelection()&&this.cutSelection():i&&"KeyV"===o||n&&"Insert"===o?this.canPasteSelection()&&this.pasteSelection():i&&"KeyY"===o||s&&n&&"Backspace"===o?this.canRedo()&&this.redo():i&&"KeyZ"===o||s&&"Backspace"===o?this.canUndo()&&this.undo():"Delete"===o||"Backspace"===o?this.canDeleteSelection()&&this.deleteSelection():i&&"KeyA"===o?this.canSelectAll()&&this.selectAll():"Escape"===o?this.canStopCommand()&&this.stopCommand():"ArrowUp"===o?t.allowVerticalScroll&&(i?t.scroll("pixel","up"):t.scroll("line","up")):"ArrowDown"===o?t.allowVerticalScroll&&(i?t.scroll("pixel","down"):t.scroll("line","down")):"ArrowLeft"===o?t.allowHorizontalScroll&&(i?t.scroll("pixel","left"):t.scroll("line","left")):"ArrowRight"===o?t.allowHorizontalScroll&&(i?t.scroll("pixel","right"):t.scroll("line","right")):"PageUp"===o?n&&t.allowHorizontalScroll?t.scroll("page","left"):t.allowVerticalScroll&&t.scroll("page","up"):"PageDown"===o?n&&t.allowHorizontalScroll?t.scroll("page","right"):t.allowVerticalScroll&&t.scroll("page","down"):"Home"===o?i&&t.allowVerticalScroll?t.scroll("document","up"):!i&&t.allowHorizontalScroll&&t.scroll("document","left"):"End"===o?i&&t.allowVerticalScroll?t.scroll("document","down"):!i&&t.allowHorizontalScroll&&t.scroll("document","right"):"Space"===o?this.canScrollToPart()&&this.scrollToPart():"Minus"===o||"NumpadSubtract"===o?this.canDecreaseZoom()&&this.decreaseZoom():"Equal"===o||"NumpadAdd"===o?this.canIncreaseZoom()&&this.increaseZoom():i&&"Digit0"===o?this.canResetZoom()&&this.resetZoom():n&&"KeyZ"===o?this.canZoomToFit()&&this.zoomToFit():i&&!n&&"KeyG"===o?this.canGroupSelection()&&this.groupSelection():i&&n&&"KeyG"===o?this.canUngroupSelection()&&this.ungroupSelection():"F2"===o?this.canEditTextBlock()&&this.editTextBlock():"ContextMenu"===o?this.canShowContextMenu()&&this.showContextMenu():e.bubbles=!0:this.canCopySelection()&&this.copySelection()}doKeyUp(){this.diagram.lastInput.bubbles=!0}stopCommand(){const t=this.diagram,e=t.currentTool;e instanceof Z&&t.allowSelect&&t.clearSelection(),null!==e&&e.doCancel()}canStopCommand(){return!0}selectAll(){const t=this.diagram;t.C();try{t.currentCursor="wait",t.v("ChangingSelection",t.selection);const e=t.parts;for(;e.next();){const t=e.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}const i=t.nodes;for(;i.next();){const t=i.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}const n=t.links;for(;n.next();){const t=n.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}}finally{t.v("ChangedSelection",t.selection),t.currentCursor=""}}canSelectAll(){return this.diagram.allowSelect}deleteSelection(){const t=this.diagram;try{t.currentCursor="wait",t.v("ChangingSelection",t.selection),t.startTransaction("Delete"),t.v("SelectionDeleting",t.selection);const e=new k,i=t.selection.iterator;for(;i.next();){const t=i.value;ke.oh(e,t,!0,this.deletesTree?1/0:0,!!this.deletesConnectedLinks&&null,(t=>t.canDelete()))}t.removeParts(e,!0),t.v("SelectionDeleted",e)}finally{t.commitTransaction("Delete"),t.v("ChangedSelection",t.selection),t.currentCursor=""}}canDeleteSelection(){const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowDelete||0===t.selection.count)}copySelection(){const t=this.diagram;try{const e=new k,i=t.selection.iterator;for(;i.next();){const t=i.value;ke.oh(e,t,!0,this.copiesTree?1/0:0,this.copiesConnectedLinks,(t=>t.canCopy()))}this.copyToClipboard(e)}finally{}}canCopySelection(){const t=this.diagram;return!(!t.allowCopy||!t.allowClipboard||0===t.selection.count)}cutSelection(){this.copySelection(),this.deleteSelection()}canCutSelection(){const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowCopy||!t.allowDelete||!t.allowClipboard||0===t.selection.count)}copyToClipboard(t){const e=this.diagram;let i=null;if(null===t)Dt.aL();else{const n=e.model;let s=!1,o=!1,r=null;try{n.Hu()&&(s=n.copiesParentKeyOfNodeData,n.copiesParentKeyOfNodeData=this.copiesParentKey),(n.uc()||n.ju())&&(o=n.copiesGroupKeyOfNodeData,n.copiesGroupKeyOfNodeData=this.copiesGroupKey),r=e.copyParts(t,null,!0)}finally{n.Hu()&&(n.copiesParentKeyOfNodeData=s),(n.uc()||n.ju())&&(n.copiesGroupKeyOfNodeData=o),i=new x,i.addAll(r.iteratorValues),Dt.s0=i,Dt.mb=e.model.dataFormat}}e.v("ClipboardChanged",i)}pasteFromClipboard(){const t=new k,e=Dt.s0;if(null===e)return t;const i=this.diagram;if(Dt.mb!==i.model.dataFormat)return t;const n=i.model;let s=!1,o=!1,r=null;try{n.Hu()&&(s=n.copiesParentKeyOfNodeData,n.copiesParentKeyOfNodeData=this.copiesParentKey),(n.uc()||n.ju())&&(o=n.copiesGroupKeyOfNodeData,n.copiesGroupKeyOfNodeData=this.copiesGroupKey),r=i.copyParts(e,i,!1)}finally{n.Hu()&&(n.copiesParentKeyOfNodeData=s),(n.uc()||n.ju())&&(n.copiesGroupKeyOfNodeData=o);const e=r.iterator;for(;e.next();){const i=e.value,n=e.key;i.location.isReal()||(n.location.isReal()?i.location=n.location:!i.position.isReal()&&n.position.isReal()&&(i.position=n.position)),t.add(i)}}return t}pasteSelection(t){void 0===t&&(t=null);const e=this.diagram;try{e.currentCursor="wait",e.v("ChangingSelection",e.selection),e.startTransaction("Paste");const i=this.pasteFromClipboard();i.count>0&&e.clearSelection(!0);const n=i.iterator;for(;n.next();){n.value.isSelected=!0}if(null!==t){const i=e.computePartsBounds(e.selection);if(i.isReal()){const n=this.computeEffectiveCollection(e.selection,e.fb);e.bP(n,new T(t.x-i.centerX,t.y-i.centerY),e.fb,!1)}}e.v("ClipboardPasted",i)}finally{e.commitTransaction("Paste"),e.v("ChangedSelection",e.selection),e.currentCursor=""}}canPasteSelection(t){const e=this.diagram;return!(e.isReadOnly||e.isModelReadOnly||!e.allowInsert||!e.allowClipboard||null===Dt.s0||0===Dt.s0.count||Dt.mb!==e.model.dataFormat)}undo(){this.diagram.undoManager.undo()}canUndo(){const t=this.diagram;return!t.isReadOnly&&!t.isModelReadOnly&&(t.allowUndo&&t.undoManager.canUndo())}redo(){this.diagram.undoManager.redo()}canRedo(){const t=this.diagram;return!t.isReadOnly&&!t.isModelReadOnly&&(t.allowUndo&&t.undoManager.canRedo())}decreaseZoom(t){void 0===t&&(t=1/this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return;const i=e.scale*t;i<e.minScale||i>e.maxScale||(e.scale=i)}canDecreaseZoom(t){void 0===t&&(t=1/this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return!1;const i=e.scale*t;return!(i<e.minScale||i>e.maxScale)&&e.allowZoom}increaseZoom(t){void 0===t&&(t=this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return;const i=e.scale*t;i<e.minScale||i>e.maxScale||(e.scale=i)}canIncreaseZoom(t){void 0===t&&(t=this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return!1;const i=e.scale*t;return!(i<e.minScale||i>e.maxScale)&&e.allowZoom}resetZoom(t){void 0===t&&(t=this.defaultScale);const e=this.diagram;t<e.minScale||t>e.maxScale||(e.scale=t)}canResetZoom(t){void 0===t&&(t=this.defaultScale);const e=this.diagram;return!(t<e.minScale||t>e.maxScale)&&e.allowZoom}zoomToFit(){const t=this.diagram,e=t.animationManager;e.stopAnimation(),t.redraw();const i=t.position,n=t.scale;e.Ol("Zoom To Fit"),this.isZoomToFitRestoreEnabled&&n===this.Lb&&!isNaN(this.Cb)&&t.documentBounds.equals(this.Ab)?(t.scale=this.Cb,t.position=this.JS,this.Lb=NaN,this.Ab=D.Dk):(this.Cb=n,this.JS=i.copy(),t.zoomToFit(),this.Lb=t.scale,this.Ab=t.documentBounds.copy()),e.MM()}canZoomToFit(){return this.diagram.allowZoom}scrollToPart(t){void 0===t&&(t=null);const e=this.diagram;if(e.ensureBounds(),null===t){try{null!==this.Bo&&(this.Bo.next()?t=this.Bo.value:this.Bo=null)}catch{this.Bo=null}null===t&&(e.highlighteds.count>0?this.Bo=e.highlighteds.iterator:e.selection.count>0&&(this.Bo=e.selection.iterator),null!==this.Bo&&this.Bo.next()&&(t=this.Bo.value))}if(null!==t){const i=e.animationManager;i.Ol("Scroll To Part");const n=this.scrollToPartPause;if(n>0){const s=this.Yc(t,[t]);if(1===s.length)e.startTransaction(),e.centerRect(t.actualBounds),e.commitTransaction("Scroll To Part");else{const t=()=>{e.startTransaction();let t=s.pop();for(;s.length>0&&t instanceof Ce&&t.isTreeExpanded&&(!(t instanceof Ve)||t.isSubGraphExpanded);)t=s.pop();s.length>0?(t instanceof ke&&e.scrollToRect(t.actualBounds),t instanceof Ce&&!t.isTreeExpanded&&(t.isTreeExpanded=!0),t instanceof Ve&&!t.isSubGraphExpanded&&(t.isSubGraphExpanded=!0)):(t instanceof ke&&e.centerRect(t.actualBounds),e.removeDiagramListener("LayoutCompleted",o)),e.commitTransaction("Scroll To Part")},o=()=>{d.Ih(t,(i.isEnabled?i.duration:0)+n)};e.addDiagramListener("LayoutCompleted",o),t()}}else{const n=e.position.copy();e.centerRect(t.actualBounds),n.equalsApprox(e.position)&&i.stopAnimation()}}}Yc(t,e){if(t.isVisible())return e;if(t instanceof Pe)this.Yc(t.adornedPart,e);else if(t instanceof De){const i=t.fromNode;null!==i&&this.Yc(i,e);const n=t.toNode;null!==n&&this.Yc(n,e)}else{if(t instanceof Ce){const i=t.labeledLink;null!==i&&this.Yc(i,e);const n=t.findTreeParentNode();null!==n&&(!n.isTreeExpanded&&!n.wasTreeExpanded&&e.push(n),this.Yc(n,e))}const i=t.containingGroup;null!==i&&(!i.isSubGraphExpanded&&!i.wasSubGraphExpanded&&e.push(i),this.Yc(i,e))}return e}canScrollToPart(t){if(void 0===t&&(t=null),null!==t&&!(t instanceof ke))return!1;const e=this.diagram;return(0!==e.selection.count||0!==e.highlighteds.count)&&(e.allowHorizontalScroll&&e.allowVerticalScroll)}collapseTree(t){void 0===t&&(t=null);const e=this.diagram,i="Collapse Tree";try{e.startTransaction(i),e.animationManager.Ol(i);const n=new x;if(null!==t&&t.isTreeExpanded)t.collapseTree(),n.add(t);else if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ce&&e.isTreeExpanded&&(e.collapseTree(),n.add(e))}}e.v("TreeCollapsed",n)}finally{e.commitTransaction(i)}}canCollapseTree(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t){if(!(t instanceof Ce)||!t.isTreeExpanded)return!1;if(t.findTreeChildrenLinks().count>0)return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ce){if(!e.isTreeExpanded)continue;if(e.findTreeChildrenLinks().count>0)return!0}}}return!1}expandTree(t){void 0===t&&(t=null);const e=this.diagram,i="Expand Tree";try{e.startTransaction(i),e.animationManager.Ol(i);const n=new x;if(null===t||t.isTreeExpanded){if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ce&&(e.isTreeExpanded||(e.expandTree(),n.add(e)))}}}else t.expandTree(),n.add(t);e.v("TreeExpanded",n)}finally{e.commitTransaction(i)}}canExpandTree(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t){if(!(t instanceof Ce)||t.isTreeExpanded)return!1;if(t.findTreeChildrenLinks().count>0)return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ce){if(e.isTreeExpanded)continue;if(e.findTreeChildrenLinks().count>0)return!0}}}return!1}groupSelection(){const t=this.diagram,e=t.model;if(!e.Gc())return;const i=this.archetypeGroupData;if(null===i)return;let n=null;try{t.currentCursor="wait",t.v("ChangingSelection",t.selection),t.startTransaction("Group");const s=new x,o=t.selection.iterator;for(;o.next();){const t=o.value;t.Ne()&&t.canGroup()&&s.add(t)}const r=new x,a=s.iterator;for(;a.next();){const t=a.value;let e=!1;const i=s.iterator;for(;i.next();){const n=i.value;if(t.isMemberOf(n)){e=!0;break}}e||r.add(t)}if(r.count>0){let s=r.first().containingGroup;if(null!==s)for(;null!==s;){let t=!1;const e=r.iterator;for(;e.next();)if(!e.value.isMemberOf(s)){t=!0;break}if(!t)break;s=s.containingGroup}if(i instanceof Ve)i.hi(),n=i.copy(),null!==n&&t.add(n);else if(e.isGroupForData(i)){const s=e.copyNodeData(i);d.wt(s)&&(e.addNodeData(s),n=t.findNodeForData(s))}if(null!==n){null!==s&&this.isValidMember(s,n)&&(n.containingGroup=s);const e=r.iterator;for(;e.next();){const t=e.value;this.isValidMember(n,t)&&(t.containingGroup=n)}t.clearSelection(!0),n.isSelected=!0}}t.v("SelectionGrouped",n)}finally{t.commitTransaction("Group"),t.v("ChangedSelection",t.selection),t.currentCursor=""}}canGroupSelection(){const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.allowGroup||!t.model.Gc()||null===this.archetypeGroupData)return!1;const e=t.selection.iterator;for(;e.next();){const t=e.value;if(t.Ne()&&t.canGroup())return!0}return!1}QS(t){const e=d.rt();if(Array.isArray(t))t.forEach((t=>{t instanceof De||t instanceof ke&&e.push(t)}));else{const i=t.iterator;for(;i.next();){const t=i.value;t instanceof De||t instanceof ke&&e.push(t)}}const i=new k,n=e.length;for(let s=0;s<n;s++){const t=e[s];let o=!0;for(let i=0;i<n;i++)if(t.isMemberOf(e[i])){o=!1;break}o&&i.add(t)}return d.it(e),i}isValidMember(t,e){if(null===e||t===e||e instanceof De)return!1;let i;return(null===t||!(t===e||t.isMemberOf(e)||(i=t.memberValidation,null!==i&&!i(t,e))||null===t.data&&null!==e.data||null!==t.data&&null===e.data))&&(i=this.memberValidation,null===i||i(t,e))}ungroupSelection(t){void 0===t&&(t=null);const e=this.diagram,i=e.model;if(i.Gc())try{e.currentCursor="wait",e.v("ChangingSelection",e.selection),e.startTransaction("Ungroup");const n=new x;if(null!==t)n.add(t);else{const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ve&&e.canUngroup()&&n.add(e)}}const s=new x;if(n.count>0){e.clearSelection(!0);const t=n.iterator;for(;t.next();){const n=t.value;n.expandSubGraph();const o=n.containingGroup,r=null!==o&&null!==o.data?i.getKeyForNodeData(o.data):void 0;s.addAll(n.memberParts);const a=s.iterator;for(;a.next();){const t=a.value;if(t.isSelected=!0,t instanceof De)continue;const e=t.data;null!==e?i.setGroupForData(e,r):t.containingGroup=o}e.remove(n)}}e.v("SelectionUngrouped",n,s)}finally{e.commitTransaction("Ungroup"),e.v("ChangedSelection",e.selection),e.currentCursor=""}}canUngroupSelection(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly||e.isModelReadOnly||!e.allowDelete||!e.allowUngroup||!e.model.Gc())return!1;if(null!==t){if(!(t instanceof Ve))return!1;if(t.canUngroup())return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ve&&e.canUngroup())return!0}}return!1}addTopLevelParts(t,e){let i=!0;const n=this.QS(t).iterator;for(;n.next();){const t=n.value;null!==t.containingGroup&&(!e||this.isValidMember(null,t)?t.containingGroup=null:i=!1)}return i}collapseSubGraph(t){void 0===t&&(t=null);const e=this.diagram,i="Collapse SubGraph";try{e.startTransaction(i),e.animationManager.Ol(i);const n=new x;if(null!==t&&t.isSubGraphExpanded)t.collapseSubGraph(),n.add(t);else if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ve&&e.isSubGraphExpanded&&(e.collapseSubGraph(),n.add(e))}}e.v("SubGraphCollapsed",n)}finally{e.commitTransaction(i)}}canCollapseSubGraph(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t)return!(!(t instanceof Ve)||!t.isSubGraphExpanded);{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ve&&e.isSubGraphExpanded)return!0}}return!1}expandSubGraph(t){void 0===t&&(t=null);const e=this.diagram,i="Expand SubGraph",n=new x;try{if(e.startTransaction(i),e.animationManager.Ol(i),null===t||t.isSubGraphExpanded){if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ve&&(e.isSubGraphExpanded||(e.expandSubGraph(),n.add(e)))}}}else t.expandSubGraph(),n.add(t);e.v("SubGraphExpanded",n)}finally{for(const t of n)this.HL(e,t);t&&this.HL(e,t),e.commitTransaction(i)}}HL(t,e){for(const i of e.memberParts)i instanceof Ce&&t.Mc(i,e)}canExpandSubGraph(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t)return!(!(t instanceof Ve)||t.isSubGraphExpanded);{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ve&&!e.isSubGraphExpanded)return!0}}return!1}editTextBlock(t){void 0===t&&(t=null);const e=this.diagram,i=e.toolManager.findTool("TextEditing");if(null!==i){if(null===t){let i=null;const n=e.selection.iterator;for(;n.next();){const t=n.value;if(t.canEdit()){i=t;break}}if(null===i)return;t=i.findInVisualTree((t=>t instanceof fe&&t.editable))}null!==t&&(e.currentTool=null,i.textBlock=t,e.currentTool=i)}}canEditTextBlock(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly||e.isModelReadOnly||!e.allowTextEdit||null===e.toolManager.findTool("TextEditing"))return!1;if(null!==t){if(!(t instanceof fe))return!1;const e=t.part;if(null!==e&&e.canEdit())return!0}else{const i=e.selection.iterator;for(;i.next();){const e=i.value;if(e.canEdit()&&null!==(t=e.findInVisualTree((t=>t instanceof fe&&t.editable))))return!0}}return!1}showContextMenu(t){const e=this.diagram,i=e.toolManager.findTool("ContextMenu");if(null===i)return;void 0===t&&(t=e.selection.count>0?e.selection.first():e);const n=i.findObjectWithContextMenu(t);if(null!==n){const t=e.lastInput;let s=null;if(n instanceof Kt)s=n.getDocumentPoint(O.Center);else if(!e.viewportBounds.containsPoint(t.documentPoint)){const t=e.viewportBounds;s=new T(t.x+t.width/2,t.y+t.height/2)}null!==s&&(t.viewPoint=e.transformDocToView(s),t.documentPoint=s,t.left=!1,t.right=!0,t.up=!0),e.currentTool=i,i.openMenu(!1,n)}}canShowContextMenu(t){const e=this.diagram,i=e.toolManager.findTool("ContextMenu");return!(null===i||(void 0===t&&(t=e.selection.count>0?e.selection.first():e),null===i.findObjectWithContextMenu(t)))}get copiesClipboardData(){return this.zS}set copiesClipboardData(t){d.i(t,"boolean",Vt,"copiesClipboardData"),this.zS=t}get copiesConnectedLinks(){return this.XS}set copiesConnectedLinks(t){d.i(t,"boolean",Vt,"copiesConnectedLinks"),this.XS=t}get deletesConnectedLinks(){return this.KS}set deletesConnectedLinks(t){d.i(t,"boolean",Vt,"deletesConnectedLinks"),this.KS=t}get copiesTree(){return this.YS}set copiesTree(t){d.i(t,"boolean",Vt,"copiesTree"),this.YS=t}get deletesTree(){return this.GS}set deletesTree(t){d.i(t,"boolean",Vt,"deletesTree"),this.GS=t}get copiesParentKey(){return this.HS}set copiesParentKey(t){d.i(t,"boolean",Vt,"copiesParentKey"),this.HS=t}get copiesGroupKey(){return this.jS}set copiesGroupKey(t){d.i(t,"boolean",Vt,"copiesGroupKey"),this.jS=t}get archetypeGroupData(){return this.qS}set archetypeGroupData(t){null!==t&&d.i(t,"object",Vt,"archetypeGroupData");this.diagram;this.qS=t}get memberValidation(){return this.nh}set memberValidation(t){null!==t&&d.i(t,"function",Vt,"memberValidation"),this.nh=t}get defaultScale(){return this.diagram.defaultScale}set defaultScale(t){this.diagram.defaultScale=t}get zoomFactor(){return this.WS}set zoomFactor(t){t>1||d.o("zoomFactor must be larger than 1.0, not: "+t),this.WS=t}get isZoomToFitRestoreEnabled(){return this.$S}set isZoomToFitRestoreEnabled(t){d.i(t,"boolean",Vt,"isZoomToFitRestoreEnabled"),this.$S=t}get scrollToPartPause(){return this.ZS}set scrollToPartPause(t){this.ZS=t}computeEffectiveCollection(t,e){const i=this.diagram,n=i.toolManager.findTool("Dragging"),s=i.currentTool===n;void 0===e&&(e=i.c0());const o=new L;if(null===t)return o;let r=t.iterator;for(;r.next();){const t=r.value;i.Zr(o,t,s,e)}if(null!==i.draggedLink&&e.dragsLink)return o;for(r=t.iterator;r.next();){const t=r.value;if(t instanceof De){const e=t.fromNode;if(null===e||o.contains(e)){const e=t.toNode;null!==e&&!o.contains(e)&&o.remove(t)}else o.remove(t)}}return o}}var zt=(t=>(t[t.None=0]="None",t[t.Default=1]="Default",t[t.Vertical=4]="Vertical",t[t.Horizontal=5]="Horizontal",t[t.Fill=2]="Fill",t))(zt||{}),jt=(t=>(t[t.None=0]="None",t[t.Along=21]="Along",t[t.Plus90=22]="Plus90",t[t.Minus90=23]="Minus90",t[t.Opposite=24]="Opposite",t[t.Upright=25]="Upright",t[t.Plus90Upright=26]="Plus90Upright",t[t.Minus90Upright=27]="Minus90Upright",t[t.Upright45=28]="Upright45",t))(jt||{}),Ut=(t=>(t[t.None=0]="None",t[t.Vertical=1]="Vertical",t[t.Horizontal=2]="Horizontal",t[t.Both=3]="Both",t))(Ut||{});class Kt{constructor(){y(this,"n",void 0),y(this,"qu",void 0),y(this,"Wu",void 0),y(this,"zo",void 0),y(this,"f",void 0),y(this,"rh",void 0),y(this,"W",void 0),y(this,"st",void 0),y(this,"re",void 0),y(this,"Wt",void 0),y(this,"Ju",void 0),y(this,"zs",void 0),y(this,"Ct",void 0),y(this,"Ke",void 0),y(this,"_r",void 0),y(this,"lh",void 0),y(this,"ki",void 0),y(this,"Hc",void 0),y(this,"K",void 0),y(this,"Xt",void 0),y(this,"tl",void 0),y(this,"Ai",void 0),y(this,"Bi",void 0),y(this,"$u",void 0),y(this,"oi",void 0),y(this,"jc",void 0),y(this,"Vt",void 0),y(this,"si",void 0),y(this,"il",void 0),y(this,"_S",void 0),y(this,"Zu",void 0),k.Yi(this),this.n=30723,this.Wt=1,this.Ju="",this.zs=null,this.Ct=null,this.st=new T(NaN,NaN).g(),this.Ke=A.gw,this._r=new R,this.lh=new R,this.ki=null,this.Hc=1,this.K=1,this.Xt=0,this.tl=F.Ug,this.re=new D(NaN,NaN,NaN,NaN).g(),this.Ai=new D(NaN,NaN,NaN,NaN).g(),this.Bi=new D(0,0,NaN,NaN).g(),this.$u=null,this.qu=null,this.W=null,this.oi=O.Default,this.jc=O.Default,this.Wu=0,this.zo=0,this.Vt=null,this.f=null,this.rh=null,this.si=null,this._S=null,this.il=null,this.Zu=null}cloneProtected(t){t.n=-32769&this.n|6144,t.Wt=this.Wt,t.Ju=this.Ju,t.Ct=this.Ct,t.st.a(this.st),t.Ke=this.Ke.N(),null!==this.ki?t.ki=this.ki.copy():t.ki=null,t.K=this.K,t.Xt=this.Xt,t.tl=this.tl.N(),t.re.a(this.re),t.Ai.a(this.Ai),t.Bi.a(this.Bi),t.qu=this.qu,null!==this.W&&(t.W=this.W.copy()),t.oi=this.oi.N(),t.jc=this.jc.N(),t.Wu=this.Wu,t.zo=this.zo,null!==this.Vt&&(t.Vt=this.Vt.copy()),null!==this.f&&(this.f.mi?t.f=this.f:t.f=this.f.copy()),null!==this.rh&&(t.rh=this.rh.slice()),null!==this.si&&(t.si=this.si.copy())}addCopyProperty(t){let e=this.rh;if(Array.isArray(e)){for(let i=0;i<e.length;i++)if(e[i]===t)return}else e=[],this.rh=e;e.push(t)}Xo(t){t.$u=null,t.il=null,t.c()}clone(){const t=new this.constructor;if(this.cloneProtected(t),null!==this.rh)for(let e=0;e<this.rh.length;e++){const i=this.rh[e];t[i]=this[i]}return t}copy(){return this.clone()}Pm(){const t=this.Ti;if(null!==t){this.Ti=null;for(const e of t)e.Qu()&&(e.isToData?this.themeData(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter):e.isToObject?this.themeObject(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter,e.sourceName):e.isToModel?this.themeModel(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter):this.theme(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter))}return this}li(t){t in jt?this.segmentOrientation=t:t in zt?this.stretch=t:d.ar(this,t)}toString(){return d.nn(this.constructor)+"#"+k.fs(this)}hh(){null!==this.f&&(this.f.mi=!0)}Ht(){null===this.f?this.f=new Gt:this.f.mi&&(this.f=this.f.copy())}Ye(){if(null===this.W){const t=new Be;t.fa=O.None,t.ua=O.None,t.da=10,t.ga=10,t.ma=0,t.pa=0,this.W=t}}raiseChangedEvent(t,e,i,n,s,o,r){const a=this.part;if(null!==a){a.qc(t,e,i,n,s,o,r),i===this&&2===t&&this.Wc()&&this.ya(a,e);const l=this.diagram;if(null!==this.bs&&null!==l&&l.Uh&&!l.undoManager.isUndoingRedoing&&!l.animationManager.wu){const t=this.bs.get(e);if(null!==t&&l.animationManager.isEnabled&&!l.animationManager.isTicking){null===this.Zu&&(this.Zu=new L);let i=0===l.undoManager.transactionLevel;if(2===t.startCondition?i=!0:3===t.startCondition&&(i=!1),i){const i=new kt;t.gF(i);const o=this.Zu.get(t);null!==o&&o.stop(),this.Zu.add(t,i),i.cx=this,i.DM=t,i.add(this,e,n,s),i.start()}else l.animationManager.getBundleAnimation().add(this,e,n,s)}}if(this instanceof ie&&i===a&&a.t2()&&null!==a.data){const t=this.T.r,i=t.length;for(let n=0;n<i;n++){const i=t[n];i instanceof ie&&i.$r((t=>{null!==t.data&&t.t2()&&t.updateTargetBindings(e)}))}}}}cF(t){this.Zu.remove(t)}Vo(){if(null!==this.diagram&&null===this.findBindingPanel()&&null!==this.Ti){const t=this.Ti.iterator;for(;t.next();){const e=t.value;if(!e.isToTheme)continue;let i=null;const n=e.sourceName;e.isToObject&&(i=this.jL(n));let s=this;const o=e.targetId;-1!==o&&(s=this.p0(o),null===s)||("/"===n?i=s.part:"."===n?i=s:".."===n&&(i=s.panel),e.updateTarget(s,i))}}}ya(t,e){const i=this.findBindingPanel();if(null!==i){const n=this.Ti.iterator;for(;n.next();){const s=n.value;let o=null;if(s.isToObject){if(o=s.qL(i,this),null===o)continue;s.updateSource(this,o,e,null)}else if(s.isToModel){const n=t.diagram;null!==n&&!n.ge&&s.updateSource(this,n.model.modelData,e,i)}else if(!s.isToTheme){const n=i.data;if(null===n)continue;const o=t.diagram;null!==o&&!o.ge&&s.updateSource(this,n,e,i)}if(o===this){const t=s.targetId,n=i.p0(t);null!==n&&s.updateTarget(n,o,e)}}}}p0(t){return this.Zn===t?this:null}jL(t){let e;return e=""===t||"/"===t||"."===t||".."===t?this:this.part.findObject(t),e}get Zn(){return null!==this.f?this.f.Zn:-1}set Zn(t){this.Zn!==t&&(null===this.f&&(this.f=new Gt),this.f.Zn=t)}get Ti(){return null!==this.f?this.f.Ti:null}set Ti(t){this.Ti!==t&&(null===this.f&&(this.f=new Gt),this.f.Ti=t)}get Qn(){return null!==this.f?this.f.Qn:null}set Qn(t){this.Qn!==t&&(null===this.f&&(this.f=new Gt),this.f.Qn=t)}raiseChanged(t,e,i){this.raiseChangedEvent(2,t,this,e,i)}t(t,e,i){this.raiseChangedEvent(2,t,this,e,i)}_n(t,e,i,n){const s=this.re;if(s.e(t,e,i,n),1!==this.K||0!==this.Xt){null===this.ki&&(this.ki=new R);const o=this.ki;o.Jt(),this.y0(o,t,e,i,n),o.ww(s)}}WL(t,e,i){return!1!==this.pickable&&(i.tc(this.L),e?this.intersectsRect(t,i):this.containedInRect(t,i))}JL(t,e,i){if(!1===this.pickable)return!1;const n=this.naturalBounds,s=t.distanceSquaredPoint(e);return i?T.distanceLineSegmentSquared(t.x,t.y,0,0,0,n.height)<=s||T.distanceLineSegmentSquared(t.x,t.y,0,n.height,n.width,n.height)<=s||T.distanceLineSegmentSquared(t.x,t.y,n.width,n.height,n.width,0)<=s||T.distanceLineSegmentSquared(t.x,t.y,n.width,0,0,0)<=s:t.distanceSquared(0,0)<=s&&t.distanceSquared(0,n.height)<=s&&t.distanceSquared(n.width,0)<=s&&t.distanceSquared(n.width,n.height)<=s}wn(){return!0}containsPoint(t){const e=T.l();e.a(t),this.L.xt(e);const i=this.actualBounds;if(!i.isReal())return T.s(e),!1;const n=this.diagram;if(null!==n&&n.Qm){const t=n.getInputOption("extraTouchThreshold"),s=n.getInputOption("extraTouchArea"),o=s/2,r=this.naturalBounds,a=this.getDocumentScale()*n.scale,l=1/a;if(r.width*a<t&&r.height*a<t){const t=D.contains(i.x-o*l,i.y-o*l,i.width+s*l,i.height+s*l,e.x,e.y);return T.s(e),t}}let s=!1;return(this instanceof Pe||this instanceof le?D.contains(i.x-5,i.y-5,i.width+10,i.height+10,e.x,e.y):i.containsPoint(e))&&(s=!(this.si&&!this.si.containsPoint(e))&&(!(null===this.Ct||!this.Bi.containsPoint(t))||this.ah(t))),T.s(e),s}ah(t){const e=this.naturalBounds;return D.contains(0,0,e.width,e.height,t.x,t.y)}containsRect(t){if(0===this.angle)return this.actualBounds.containsRect(t);const e=this.naturalBounds,i=D.X(0,0,e.width,e.height),n=this.L;let s=!1;const o=T.X(t.x,t.y);return i.containsPoint(n.is(o))&&(o.e(t.x,t.bottom),i.containsPoint(n.is(o))&&(o.e(t.right,t.bottom),i.containsPoint(n.is(o))&&(o.e(t.right,t.y),i.containsPoint(n.is(o))&&(s=!0)))),T.s(o),D.s(i),s}containedInRect(t,e){if(void 0===e)return t.containsRect(this.actualBounds);const i=this.naturalBounds,n=e;let s=!1;const o=T.X(0,0);return t.containsPoint(n.xt(o))&&(o.e(0,i.height),t.containsPoint(n.xt(o))&&(o.e(i.width,i.height),t.containsPoint(n.xt(o))&&(o.e(i.width,0),t.containsPoint(n.xt(o))&&(s=!0)))),T.s(o),s}intersectsRect(t,e){if(void 0===e&&(e=this.L,0===this.angle))return t.intersectsRect(this.actualBounds);const i=this.naturalBounds,n=e,s=T.X(0,0),o=T.X(0,i.height),r=T.X(i.width,i.height),a=T.X(i.width,0);let l=!1;if(t.containsPoint(n.xt(s))||t.containsPoint(n.xt(o))||t.containsPoint(n.xt(r))||t.containsPoint(n.xt(a)))l=!0;else{const e=D.X(0,0,i.width,i.height),h=T.X(t.x,t.y);e.containsPoint(n.is(h))?l=!0:(h.e(t.x,t.bottom),e.containsPoint(n.is(h))?l=!0:(h.e(t.right,t.bottom),e.containsPoint(n.is(h))?l=!0:(h.e(t.right,t.y),e.containsPoint(n.is(h))&&(l=!0)))),T.s(h),D.s(e),l||(E.kw(t,s,o)||E.kw(t,o,r)||E.kw(t,r,a)||E.kw(t,a,s))&&(l=!0)}return T.s(s),T.s(o),T.s(r),T.s(a),l}getDocumentPoint(t,e){if(void 0===e&&(e=new T),t instanceof O){const i=t,n=this.naturalBounds;return e.e(i.x*n.width+i.offsetX,i.y*n.height+i.offsetY),this.ws.xt(e),e}return e.set(t),this.ws.xt(e),e}getDocumentBounds(t){void 0===t&&(t=new D);const e=this.naturalBounds,i=this.ws,n=T.X(0,0).L(i);return t.e(n.x,n.y,0,0),n.e(e.width,0).L(i),t.unionNoCheck(n.x,n.y,0,0),n.e(e.width,e.height).L(i),t.unionNoCheck(n.x,n.y,0,0),n.e(0,e.height).L(i),t.unionNoCheck(n.x,n.y,0,0),T.s(n),t}getDocumentAngle(){return this.ws.ND()}getDocumentScale(){if(!1===this.w0())return this.Hc;const t=this.K;return null!==this.panel?t*this.panel.getDocumentScale():t}getLocalPoint(t,e){return void 0===e&&(e=new T),e.a(t),this.ws.is(e),e}getNearestIntersectionPoint(t,e,i){return this.Jc(t.x,t.y,e.x,e.y,i)}Jc(t,e,i,n,s){const o=this.L,r=1/(o.m11*o.m22-o.m12*o.m21),a=o.m22*r,l=-o.m12*r,h=-o.m21*r,u=o.m11*r,c=r*(o.m21*o.dy-o.m22*o.dx),d=r*(o.m12*o.dx-o.m11*o.dy),f=t*a+e*h+c,g=t*l+e*u+d,m=i*a+n*h+c,p=i*l+n*u+d;s.e(0,0);const y=this.naturalBounds,v=E.xl(0,0,y.width,y.height,f,g,m,p,s);return s.L(o),v}ut(t,e,i,n){if(!1===this.Eo())return;const s=this.tl,o=s.right+s.left,r=s.top+s.bottom;t=Math.max(t-o,0),e=Math.max(e-r,0),i=i||0,n=n||0,i=Math.max(i-o,0),n=Math.max(n-r,0);const a=this.angle;let l=0;const h=this.desiredSize,u=this.Tb();90===a||270===a?(t=isFinite(h.height)?h.height+u:t,e=isFinite(h.width)?h.width+u:e):(t=isFinite(h.width)?h.width+u:t,e=isFinite(h.height)?h.height+u:e);let c=i||0,f=n||0;const g=this instanceof ie;switch(this.Xs(!0)){case 0:c=0,f=0,g&&(t=1/0,e=1/0);break;case 2:isFinite(t)&&t>i&&(c=t),isFinite(e)&&e>n&&(f=e);break;case 5:isFinite(t)&&t>i&&(c=t),f=0,g&&(e=1/0);break;case 4:isFinite(e)&&e>n&&(f=e),c=0,g&&(t=1/0)}const m=this.maxSize,p=this.minSize;c>m.width&&p.width<m.width&&(c=m.width),f>m.height&&p.height<m.height&&(f=m.height),i=Math.max(c,p.width),n=Math.max(f,p.height),m.width<i&&(i=Math.min(p.width,i)),m.height<n&&(n=Math.min(p.height,n)),t=Math.min(m.width,t),e=Math.min(m.height,e),t=Math.max(i,t),e=Math.max(n,e),(90===a||270===a)&&(l=t,t=e,e=l,l=i,i=n,n=l),this.re.lt(),this._u(t,e,i,n),this.re.g(),this.re.isReal()||d.o("Non-real measuredBounds has been set. Object "+this+", measuredBounds: "+this.re.toString()),this.ne(!1)}_u(t,e,i,n){}Ks(){return!1}zt(t,e,i,n,s){this.td();const o=D.l();o.a(this.Ai),this.Ai.lt(),!1===this.ss()?this.Ai.e(t,e,i,n):this.ch(t,e,i,n),this.Ai.g(),this.si=void 0===s?null:s;let r=!1;if(void 0!==s)r=!0;else{let i=this.panel;if(null!==i&&i.el()&&(i=i.panel),null!==i){const n=i.Bi,s=this.measuredBounds,o=e+s.height,a=t+s.width;if(r=!(0<=t+.05&&a<=n.width+.05&&0<=e+.05&&o<=n.height+.05),this instanceof fe){const t=this.naturalBounds;(this.x0>t.height||this.pi>t.width)&&(r=!0)}}}r?this.n|=256:this.n&=-257,this.Ai.isReal()||d.o("Non-real actualBounds has been set. Object "+this+", actualBounds: "+this.Ai.toString()),this.ed(o,this.Ai),this.to(!1),D.s(o)}ch(t,e,i,n){}commonArrange(t,e,i,n){if(this.Ai.e(t,e,i,n),this.desiredSize.isReal())return;const s=this.re,o=this.tl,r=o.right+o.left,a=o.top+o.bottom,l=s.width+r,h=s.height+a;i+=r,n+=a;let u=this.Xs(!0);switch(l===i&&h===n&&(u=0),u){case 0:(l>i||h>n)&&(this.ne(!0),this.ut(l>i?i:l,h>n?n:h,0,0));break;case 2:this.ne(!0),this.ut(i,n,0,0);break;case 5:this.ne(!0),this.ut(i,h,0,0);break;case 4:this.ne(!0),this.ut(l,n,0,0)}}ed(t,e){const i=this.part;null!==i&&null!==i.diagram&&((i.selectionObject===this||i.resizeObject===this||i.rotateObject===this)&&i.i2(!0),this.C(),!t.equalsApproxClose(e)&&(i.fh(),this.b0(i)))}b0(t){null!==this.portId&&(t.i2(!0),t instanceof Ce&&t.$L(this))}get shadowVisible(){return null!==this.f?this.f.k0:null}set shadowVisible(t){const e=this.shadowVisible;e!==t&&(this.Ht(),this.f.k0=t,this.os(!0),this.C(),this.t("shadowVisible",e,t))}MR(t,e){const i=this.naturalBounds,n=this.lh,s=n.m11,o=n.m21,r=n.dx,a=n.m12,l=n.m22,h=n.dy;let u=0,c=0,d=u,f=c;u=d*s+f*o+r,c=d*a+f*l+h;let g=u,m=c,p=0,y=0;d=i.width+e,f=0,u=d*s+f*o+r,c=d*a+f*l+h;let v=Math.min(g,u),b=Math.min(m,c);p=Math.max(g+p,u)-v,y=Math.max(m+y,c)-b,g=v,m=b,d=i.width+e,f=i.height+e,u=d*s+f*o+r,c=d*a+f*l+h,v=Math.min(g,u),b=Math.min(m,c),p=Math.max(g+p,u)-v,y=Math.max(m+y,c)-b,g=v,m=b,d=0,f=i.height+e,u=d*s+f*o+r,c=d*a+f*l+h,v=Math.min(g,u),b=Math.min(m,c),p=Math.max(g+p,u)-v,y=Math.max(m+y,c)-b,g=v,m=b;const x=t.viewportBounds,w=x.x,k=x.y,S=x.width,P=x.height;return g>S+w||w>p+g||m>P+k||k>y+m}Gi(t,e){if(this.SR(t,e)||!this.visible)return;const i=this.opacity;if(0===i)return;let n=1;1!==i&&(n=t.globalAlpha,t.globalAlpha=n*i);let s="";""!==this.filter&&(s=t.filter,t.filter=this.filter);const o=this.L,r=this.panel;!0===this.w0()&&this.Db();const a=this.part;let l=!1,h=0;if(a&&e.getRenderingHint("drawShadows")&&(l=a.isShadowed,l)){const t=a.shadowOffset;h=Math.max(t.y,t.x)*e.scale*e.Ui}const u=this instanceof ie&&this.el(),c=this.Ai;if(u&&(this.ZL(l,t,!1,r),this.NR(t,e),this.QL(l,t,!1,r),this._L(l,t,!1)),u||!u&&(0===c.width||0===c.height||isNaN(c.x)||isNaN(c.y)))return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));const d=this.Ks();if(!e._h&&d&&this.MR(e,h))return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));let f=0!==(256&this.n);if(t.clipInsteadOfFill&&(f=!1),this instanceof fe&&(t.font=this.font),f){const e=r.wn()?r.naturalBounds:r.actualBounds;let o=Math.max(c.x,e.x),a=Math.max(c.y,e.y),l=Math.min(c.right,e.right)-o,h=Math.min(c.bottom,e.bottom)-a;const u=this.si;if(null!==u&&(o=u.x,a=u.y,l=u.width,h=u.height),o>c.width+c.x||c.x>e.width+e.x)return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));t.save(),t.beginPath(),t.rect(o,a,l,h),t.clip()}if(d){if(!a.isVisible())return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));if(l){const i=a.shadowOffset;t.shadowsSet(i.x*e.scale*this.scale*e.Ui,i.y*e.scale*this.scale*e.Ui,a.shadowBlur),t.shadowsOn(),t.shadowColor=a.shadowColor}}const g=this.naturalBounds;if(t.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.ZL(l,t,d,r),null!==this.Ct&&(t.commitTransform(),this.Fb(t,g,c)),this.QL(l,t,d,r),this.uh(t,e),this._L(l,t,d),f&&(t.restore(),t.clearContextCache(this instanceof ie)),!o.Ok()){const e=1/(o.m11*o.m22-o.m12*o.m21);t.transform(o.m22*e,-o.m12*e,-o.m21*e,o.m11*e,e*(o.m21*o.dy-o.m22*o.dx),e*(o.m12*o.dx-o.m11*o.dy))}1!==i&&(t.globalAlpha=n),""!==this.filter&&(t.filter=s)}ZL(t,e,i,n){t&&!0===this.shadowVisible?e.shadowsOn():t&&!1===this.shadowVisible&&e.shadowsOff(),t&&this.Rb(n)&&null===this.shadowVisible&&e.shadowsOff()}QL(t,e,i,n){t&&(null!==this.Ct||this.Rb(n))?(this.vb(!0),null===this.shadowVisible&&e.shadowsOff()):this.vb(!1)}_L(t,e,i){t&&!0===this.e2()&&e.shadowsOn(),i&&t&&e.shadowsOff()}CR(t,e,i){const n=this.part;let s=!1;n&&t.getRenderingHint("drawShadows")&&(s=n.isShadowed),e.clipInsteadOfFill&&(s=!1),this.Ks()&&s&&e.shadowsOn(),s&&!0===this.shadowVisible?e.shadowsOn():s&&!1===this.shadowVisible&&e.shadowsOff();const o=this.panel;if(s&&this.Rb(o)&&null===this.shadowVisible&&e.shadowsOff(),e.sl){const n=t.computePixelRatio(),s="drop-shadow(".concat(e.shadowOffsetX/n,"px ").concat(e.shadowOffsetY/n,"px ").concat(e.shadowBlur/n/2,"px ").concat(e.shadowColor,")");null!==this.background&&i.Ct.setAttributeNS(null,"filter",s)}return s&&(null!==this.Ct||this.Rb(o))?(this.vb(!0),null===this.shadowVisible&&e.shadowsOff()):this.vb(!1),s}LR(t,e,i,n){if(i.sl){const n=e.computePixelRatio(),s="drop-shadow(".concat(i.shadowOffsetX/n,"px ").concat(i.shadowOffsetY/n,"px ").concat(i.shadowBlur/n/2,"px ").concat(i.shadowColor,")");this.s2(t,s)}n&&!0===this.e2()&&i.shadowsOn(),this.Ks()&&i.shadowsOff()}Rb(t){return null!==t&&(t.el()&&(t=t.panel),t.e2()||(t.type===ie.Auto||t.type===ie.Spot)&&t.findMainElement()!==this)}s2(t,e){}Fb(t,e,i){const n=this.Tb(),s=e.x,o=e.y,r=e.width+n,a=e.height+n;this.mn(t,this.Ct,!0,!1,e,i),this.Ct instanceof Qt&&3===this.Ct.type?(t.beginPath(),t.rect(s-n/2,o-n/2,r,a),t.fillContext(this.Ct,!1,null)):t.fillRect(s-n/2,o-n/2,r,a)}tA(t,e){let i=t.AR(this);if(-1!==i)if(0===i)if(t.svg.Ct)t.svg.Ct.after(e);else if(t.type===ie.Table){const i=t.svg.getElementsByClassName("gojs-ts"),n=0!==i.length?i[0]:null;null!==n&&n.after(e)}else t.svg.prepend(e);else{for(;0!==i&&!t.elt(i-1).isVisibleObject();)i--;if(0===i)t.svg.prepend(e);else{const n=t.elt(i-1).svg;null!==n?n.after(e):t.svg.appendChild(e)}}}SR(t,e){if(!(t instanceof Ht))return!1;if(!this.visible||0===this.opacity)return null!==this.svg&&null!==this.svg.parentNode&&this.svg.remove(),!0;if(this.Ks()&&!this.isVisible())return null!==this.svg&&null!==this.svg.parentNode&&this.svg.remove(),!0;const i=this.panel,n=this.sd(t);if(this.$c(t,e,n))return this.iA(this.svg),null!==this.svg.parentElement?(this.Ks()&&(t.lastDrawnPart=this.svg),!0):(this.Ks()?(null!==t.lastDrawnPart?t.lastDrawnPart.after(this.svg):t.diagramGroup.prepend(this.svg),t.lastDrawnPart=this.svg):i&&this.tA(i,this.svg),!0);if(this.Ks()&&this.isShadowed){const i=this.shadowOffset;t.shadowsSet(i.x*e.scale*this.scale*e.Ui,i.y*e.scale*this.scale*e.Ui,this.shadowBlur),t.shadowsOn(),t.shadowColor=this.shadowColor}this instanceof fe&&(t.font=this.font),t.currentElement=null;const s=this.L,o=this instanceof ie,r=this instanceof ie&&this.el(),a=this.svg;!0===this.w0()&&this.Db();const l=this.Ai;t.setCurrentTransform(1,0,0,1,0,0),t.outerGroup=!1,n&&(t.outerGroup=!0,o&&r?(t.newGroup(1,0,0,1,0,0),this.svg=t.lastCreatedElement):o?(t.newGroup(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),this.svg=t.lastCreatedElement):t.newGroup(1,0,0,1,0,0));const h=this.naturalBounds;o||t.setCurrentTransform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),null!==this.background&&(o?(r&&t.setCurrentTransform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),this.Fb(t,h,l),r&&t.setCurrentTransform(1,0,0,1,0,0)):(t.setCurrentTransform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),this.Fb(t,h,l)),t.currentElement.Ct=t.lastCreatedElement,t.currentElement.prepend(t.lastCreatedElement));const u=this.CR(e,t,t.currentElement);this.uh(t,e),o&&t.endGroup(),t.outerGroup&&t.endGroup();const c=t.surface.Gu,d=o?this.svg:t.currentElement;if(!o&&null!==a&&d!==a&&a.parentNode===this.panel.svg){const e=this.svg.getAttribute("filter");return null!==e&&d.setAttribute("filter",e),this.svg.replaceWith(d),this.svg=d,null!==d&&this.P0(t,i,l,d),this.eA(t,a),!0}if(this.svg=d,null!==c&&null===d&&t.dummyGroup(),null===d)return!0;this.P0(t,i,l,d),this.LR(d,e,t,u);const f=this.Ks()?this.opacity*t.globalAlpha:this.opacity;if(1!==f&&d.setAttributeNS(null,"opacity",f.toString()),""!==this.filter&&d.setAttributeNS(null,"filter",this.filter),this.Ks()){if(null!==a&&d!==a&&a.parentNode===t.diagramGroup){const t=a.getAttribute("filter");null!==t&&d.setAttribute("filter",t),a.replaceWith(d)}else t.lastDrawnPart?t.lastDrawnPart.after(d):t.diagramGroup.prepend(d);t.lastDrawnPart=d}else null!==i&&this.tA(i,d);return null!==c&&c(this,d),this.iA(d),!0}iA(t){const e=this,i=t.dataset;e instanceof Kt&&(null!==e.portId&&(i.portId=e.portId),e instanceof ie&&(isNaN(e.itemIndex)||(i.itemIndex=e.itemIndex.toString()),e instanceof ke&&(i.className=d.nn(e),void 0!==e.key&&(i.key=e.key.toString()),e instanceof De&&(null!==e.fromNode&&void 0!==e.fromNode.key&&(i.fromKey=e.fromNode.key.toString()),""!==e.fromPortId&&(i.fromPortId=e.fromPortId),null!==e.toNode&&void 0!==e.toNode.key&&(i.toKey=e.toNode.key.toString()),""!==e.toPortId&&(i.toPortId=e.toPortId)))))}P0(t,e,i,n){let s=0!==(256&this.n);if(t.clipInsteadOfFill&&(s=!1),!s)return n.removeAttributeNS(null,"clip-path"),void this.eA(t,n);const o=e.wn()?e.naturalBounds:e.actualBounds;let r=Math.max(i.x,o.x),a=Math.max(i.y,o.y),l=Math.min(i.right,o.right)-r,h=Math.min(i.bottom,o.bottom)-a;const u=this.si;null!==u&&(r=u.x,a=u.y,l=u.width,h=u.height);const c=n.getAttribute("clip-path");let d=null;if(null!==c&&(d=t.svg.getElementById(c.split("#")[1].slice(0,-1))),null===d){const e="CLIP"+k.su++,i={id:e},s=t.makeElement("clipPath",i),o=t.makeElement("rect",{x:r,y:a,width:l,height:h});if(this instanceof ie){const t=this.L.copy().pw();o.setAttribute("transform","matrix(".concat(t.m11,", ").concat(t.m12,", ").concat(t.m21,", ").concat(t.m22,", ").concat(t.dx,", ").concat(t.dy,")"))}s.appendChild(o),t.svg.appendChild(s),n.setAttributeNS(null,"clip-path","url(#"+e+")")}else{const t=d.firstElementChild;t.setAttribute("x",r.toString()),t.setAttribute("y",a.toString()),t.setAttribute("width",l.toString()),t.setAttribute("height",h.toString())}}eA(t,e){const i=e.getAttribute("clip-path");if(null===i)return;const n=t.svg.getElementById(i.split("#")[1].slice(0,-1));null!==n&&n.remove()}TR(){if(null===this.svg)return;const t=this.svg.innerHTML.match(/url\(#((CLIP|GRAD).+?)\)/g),e=this.svg.ownerDocument;if(null!==t)for(const i of t){const t=e.getElementById(i.split("#")[1].slice(0,-1));null!==t&&t.remove()}this.svg.remove()}NR(t,e){const i=this.Ai,n=this.Bi,s=this.Ct;null!==s&&t.commitTransform(),null!==s&&(this.mn(t,s,!0,!1,n,i),s instanceof Qt&&3===s.type?(t.beginPath(),t.rect(i.x,i.y,i.width,i.height),t.fillContext(s,!1,null)):t.fillRect(i.x,i.y,i.width,i.height)),this.uh(t,e)}uh(t,e){}o2(){this.os(!0)}$c(t,e,i){const n=this.svg;if(this.DR()){if(this.o2(),this.os(!1),null===n)return!1;const e=this.svg.getAttribute("clip-path");if(null!==e){const i=t.svg.getElementById(e.split("#")[1].slice(0,-1));null!==i&&i.remove()}return!1}if(null===n)return!1;if(!this.visible)return n.remove(),!1;if("g"!==n.nodeName&&i||"g"===n.nodeName&&!i)return!1;const s=this.L,o=this instanceof ie,r=this instanceof ie&&this.el();if(!o||!r)if(this instanceof ye){const e=this.Ob;t.setCurrentTransform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),null!==e&&t.amendImageTransform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]),i?n.lastElementChild.setAttributeNS(null,"transform",t.getCurrentTransform()):n.setAttributeNS(null,"transform",t.getCurrentTransform())}else if(!i||this instanceof ie)n.setAttributeNS(null,"transform","matrix("+s.m11+", "+s.m12+", "+s.m21+", "+s.m22+", "+s.dx+", "+s.dy+")");else if(this instanceof le){const t=n.getElementsByTagName("path");for(let e=0;e<t.length;e++)t[e].setAttributeNS(null,"transform","matrix("+s.m11+", "+s.m12+", "+s.m21+", "+s.m22+", "+s.dx+", "+s.dy+")")}else(n.lastElementChild||n).setAttributeNS(null,"transform","matrix("+s.m11+", "+s.m12+", "+s.m21+", "+s.m22+", "+s.dx+", "+s.dy+")");const a=this.Ks()?this.opacity*t.globalAlpha:this.opacity;if(1===a?n.removeAttribute("opacity"):n.setAttributeNS(null,"opacity",a.toString()),t.setCurrentTransform(1,0,0,1,0,0),null!==this.background||void 0!==n.Ct){const e=n.Ct;if(null===this.background)t.removeOldGradient(this,n.Ct,"fill"),n.Ct.remove(),n.Ct=void 0;else{if((r||i&&!(this instanceof ie))&&t.setCurrentTransform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),this.Fb(t,this.naturalBounds,this.actualBounds),n.Ct){t.removeOldGradient(this,n.Ct,"fill");const e=n.Ct.getAttribute("filter");null!==e&&t.lastCreatedElement.setAttribute("filter",e),n.Ct.replaceWith(t.lastCreatedElement)}else n.prepend(t.lastCreatedElement);n.Ct=t.lastCreatedElement}e&&t.removeOldGradient(this,e,"fill")}return this.P0(t,this.panel,this.actualBounds,n),!0}sd(t){if(null!==this.background)return!0;let e=0!==(256&this.n);return t.clipInsteadOfFill&&(e=!1),!!e}static aE(t,e,i,n,s,o,r){let a=.001;const l=o.length;t.moveTo(e,i);let h=n-e;const u=s-i;0===h&&(h=.001);const c=u/h;let d=Math.sqrt(h*h+u*u),f=0,g=!0;a=o[f%l];let m=0!==r;for(;d>=.1;){if(m){for(a=o[f++%l],a-=r;a<0;)a+=o[f++%l],g=!g;m=!1}else a=o[f++%l];a>d&&(a=d);let n=Math.sqrt(a*a/(1+c*c));h<0&&(n=-n),e+=n,i+=c*n,g?t.lineTo(e,i):t.moveTo(e,i),d-=a,g=!g}}mn(t,e,i,n,s,o){let r,a=1,l=1;if("string"==typeof e)return void(i?t.fillStyle=e:t.strokeStyle=e);if(1===e.type)return void(i?t.fillStyle=e.color:t.strokeStyle=e.color);const h=this.Tb();a=s.width,l=s.height,n?(a=o.width,l=o.height):i||(a+=h,l+=h);const u=t instanceof Wt;if(u&&e.xn&&(4===e.type||e.Zc===a&&e.Ib===l))r=e.xn;else{let s=0,c=0,f=0,g=0,m=0,p=0,y=0,v=0;if(n?(y=o.x,v=o.y):i||(y-=h/2,v-=h/2),s=e.start.x*a+e.start.offsetX+y,c=e.start.y*l+e.start.offsetY+v,f=e.end.x*a+e.end.offsetX+y,g=e.end.y*l+e.end.offsetY+v,2===e.type)r=t.createLinearGradient(s,c,f,g);else if(3===e.type)p=isNaN(e.endRadius)?Math.max(a,l)/2:e.endRadius,isNaN(e.startRadius)?(m=0,p=Math.max(a,l)/2):m=e.startRadius,r=t.createRadialGradient(s,c,m,f,g,p);else if(4===e.type)try{r=t.createPattern(e.pattern,"repeat")}catch{r=null}else d.ke(e.type,"Brush type");if(4!==e.type){const t=e.colorStops;if(null!==t){const e=t.iterator;for(;e.next();)r.addColorStop(e.key,e.value)}}if(u&&(e.xn=r,null!==r&&(e.Zc=a,e.Ib=l),null===r&&4===e.type&&-1!==e.Zc)){e.Zc=-1;const t=this.diagram;null!==t&&-1===e.Zc&&d.Ih((()=>{t.redraw()}),600)}}i?t.fillStyle=r:t.strokeStyle=r}isContainedBy(t){return t instanceof ie&&this.FR(this,t)}FR(t,e){if(t===e||null===e)return!1;let i=t.panel;for(;null!==i;){if(i===e)return!0;i=i.panel}return!1}isVisibleObject(){if(!this.visible)return!1;const t=this.panel;return null===t||t.isVisibleObject()}isEnabledObject(){let t=this instanceof ie?this:this.panel;for(;null!==t&&t.isEnabled;)t=t.panel;return null===t}get enabledChanged(){return null!==this.f?this.f.M0:null}set enabledChanged(t){const e=this.enabledChanged;e!==t&&(null!==t&&d.i(t,"function",Kt,"enabledChanged"),this.Ht(),this.f.M0=t,this.t("enabledChanged",e,t))}Db(){if(!0===this.Eb()){const t=this._r;if(t.Jt(),!this.Ai.isReal()||!this.re.isReal())return void this.nd(!1);if(t.Qi(this.Ai.x-this.re.x,this.Ai.y-this.re.y),1!==this.scale||0!==this.angle){const e=this.naturalBounds;this.y0(t,e.x,e.y,e.width,e.height)}this.nd(!1),this.wa(!0)}if(!0===this.w0()){const t=this.panel;if(null===t)this.lh.set(this._r),this.Hc=this.scale;else if(null!==t.ws){const e=this.lh;e.Jt(),t.wn()?e.tc(t.lh):null!==t.panel&&e.tc(t.panel.lh),e.tc(this._r),this.Hc=this.scale*t.Hc}this.wa(!1)}}y0(t,e,i,n,s){if(1!==this.K&&t.K(this.K),0===this.Xt)return;const o=T.l();o.setSpot(e,i,n,s,O.Center),t.us(this.Xt,o.x,o.y),T.s(o)}c(t){if(this.Eo())return;void 0===t&&(t=!1),this.ne(!0),this.to(!0);const e=this.panel;null!==e&&!t&&e.c()}Qc(){this.Eo()||(this.ne(!0),this.to(!0))}_c(t){if(this.ss())return;const e=this.panel;!t&&null!==e&&e.c(),this.to(!0)}td(){!1===this.Eb()&&(this.nd(!0),this.wa(!0))}l2(){this.wa(!0)}C(){const t=this.part;null!==t&&t.C()}Xs(t){const e=this.stretch,i=this.panel;if(null!==i&&i.type===ie.Table)return this.S0(i.getRowDefinition(this.row),i.getColumnDefinition(this.column),t);if(null!==i&&i.type===ie.Auto&&i.findMainElement()===this)return this.Ko(2,t);if(1===e){if(null!==i){if(i.type===ie.Spot&&i.findMainElement()===this)return this.Ko(2,t);const e=i.defaultStretch;return 1===e?this.Ko(0,t):this.Ko(e,t)}return this.Ko(0,t)}return this.Ko(e,t)}S0(t,e,i){const n=this.stretch;if(1!==n)return this.Ko(n,i);let s=null,o=null;switch(t.stretch){case 1:case 5:break;case 4:case 2:o=!0}switch(e.stretch){case 1:case 4:break;case 5:case 2:s=!0}const r=this.panel.defaultStretch;return null===s&&(s=5===r||2===r),null===o&&(o=4===r||2===r),!0===s&&!0===o?this.Ko(2,i):!0===s?this.Ko(5,i):!0===o?this.Ko(4,i):this.Ko(0,i)}Ko(t,e){if(e)return t;if(0===t)return 0;const i=this.desiredSize;if(i.isReal())return 0;const n=!isNaN(i.width),s=!isNaN(i.height),o=this.angle;if(n)if(90!==o&&270!==o){if(5===t)return 0;if(2===t)return 4}else{if(4===t)return 0;if(2===t)return 5}if(s)if(90!==o&&270!==o){if(4===t)return 0;if(2===t)return 5}else{if(5===t)return 0;if(2===t)return 4}return t}get segmentOrientation(){return null!==this.Vt?this.Vt.N0:0}set segmentOrientation(t){const e=this.segmentOrientation;e!==t&&(null===this.Vt&&(this.Vt=new Ie),this.Vt.N0=t,this.c(),this.t("segmentOrientation",e,t),0===t&&(this.angle=0))}RR(){this.segmentOrientation=21}get segmentIndex(){return null!==this.Vt?this.Vt.C0:-1/0}set segmentIndex(t){t=Math.round(t);const e=this.segmentIndex;e!==t&&(null===this.Vt&&(this.Vt=new Ie),this.Vt.C0=t,this.c(),this.t("segmentIndex",e,t))}get segmentFraction(){return null!==this.Vt?this.Vt.L0:0}set segmentFraction(t){isNaN(t)||t<0?t=0:t>1&&(t=1);const e=this.segmentFraction;e!==t&&(null===this.Vt&&(this.Vt=new Ie),this.Vt.L0=t,this.c(),this.t("segmentFraction",e,t))}get segmentOffset(){return null!==this.Vt?this.Vt.A0:T.Mo}set segmentOffset(t){const e=this.segmentOffset;e.equals(t)||(t=t.N(),null===this.Vt&&(this.Vt=new Ie),this.Vt.A0=t,this.c(),this.t("segmentOffset",e,t))}get stretch(){return null!==this.f?this.f.io:1}set stretch(t){const e=this.stretch;e!==t&&(this.Ht(),this.f.io=t,this.c(),this.t("stretch",e,t))}get name(){return null!==this.f?this.f.St:""}set name(t){const e=this.name;e!==t&&(this.Ht(),this.f.St=t,null!==this.part&&this.part.T0(),this.t("name",e,t))}get opacity(){return this.Wt}set opacity(t){const e=this.Wt;if(e!==t){d.i(t,"number",Kt,"opacity"),(t<0||t>1)&&d.tt(t,"0 <= value <= 1",Kt,"opacity"),this.Wt=t,this.t("opacity",e,t);const i=this.diagram,n=this.part;null!==i&&null!==n&&i.C(n.qh(n.actualBounds))}}get filter(){return this.Ju}set filter(t){const e=this.Ju;if(e!==t){this.Ju=t,this.os(!0),this.t("filter",e,t);const i=this.diagram,n=this.part;null!==i&&null!==n&&i.C(n.qh(n.actualBounds))}}get visible(){return 0!==(1&this.n)}set visible(t){const e=0!==(1&this.n);if(e!==t){this.n=1^this.n,this.t("visible",e,t);const i=this.panel;null!==i?i.c():this.Ks()&&this.Ei(t),this.C(),this.sA()}}get pickable(){return 0!==(2&this.n)}set pickable(t){const e=0!==(2&this.n);e!==t&&(this.n=2^this.n,this.t("pickable",e,t))}get fromLinkableDuplicates(){return 0!==(4&this.n)}set fromLinkableDuplicates(t){const e=0!==(4&this.n);e!==t&&(this.n=4^this.n,this.t("fromLinkableDuplicates",e,t))}get fromLinkableSelfNode(){return 0!==(8&this.n)}set fromLinkableSelfNode(t){const e=0!==(8&this.n);e!==t&&(this.n=8^this.n,this.t("fromLinkableSelfNode",e,t))}get toLinkableDuplicates(){return 0!==(16&this.n)}set toLinkableDuplicates(t){const e=0!==(16&this.n);e!==t&&(this.n=16^this.n,this.t("toLinkableDuplicates",e,t))}get toLinkableSelfNode(){return 0!==(32&this.n)}set toLinkableSelfNode(t){const e=0!==(32&this.n);e!==t&&(this.n=32^this.n,this.t("toLinkableSelfNode",e,t))}get isPanelMain(){return 0!==(64&this.n)}set isPanelMain(t){const e=0!==(64&this.n);e!==t&&(this.n=64^this.n,this.c(),this.t("isPanelMain",e,t))}get isActionable(){return 0!==(128&this.n)}set isActionable(t){const e=0!==(128&this.n);e!==t&&(this.n=128^this.n,this.t("isActionable",e,t))}get background(){return this.Ct}set background(t){const e=this.Ct;e!==t&&(null!==t&&Qt.od(t,"GraphObject.background"),t instanceof Qt&&t.g(),this.Ct=t,this.C(),this.t("background",e,t))}e2(){return 0!==(512&this.n)}vb(t){t?this.n|=512:this.n&=-513}Wc(){return 0!==(1024&this.n)}h2(t){t?this.n|=1024:this.n&=-1025}Eb(){return 0!==(2048&this.n)}nd(t){t?this.n|=2048:this.n&=-2049}w0(){return 0!==(4096&this.n)}wa(t){t?this.n|=4096:this.n&=-4097}Eo(){return 0!==(8192&this.n)}ne(t){t?this.n|=8192:this.n&=-8193}ss(){return 0!==(16384&this.n)}to(t){t?this.n|=16384:this.n&=-16385}DR(){return 0!==(32768&this.n)}os(t){t?this.n|=32768:this.n&=-32769}get part(){if(this.Ks())return this;if(null!==this.il)return this.il;let t=this;for(t=t.panel;t;){if(t instanceof ke)return this.il=t,t;t=t.panel}return null}get svg(){return this._S}set svg(t){this._S=t}Du(){this.svg=null}get panel(){return this.zs}xa(t){this.zs=t,null!==this.svg&&this.svg.remove()}get layer(){const t=this.part;return null!==t?t.layer:null}get diagram(){const t=this.part;return null!==t?t.diagram:null}get position(){return this.st}set position(t){const e=t.x,i=t.y,n=this.st,s=n.x,o=n.y;(s===e||isNaN(s)&&isNaN(e))&&(o===i||isNaN(o)&&isNaN(i))?this.c2():(t=t.copy(),this.a2(t,s,o)&&this.t("position",new T(s,o),t))}c2(){}a2(t,e,i){return this.st=t,this._c(),!0}yc(t,e,i){this.st.x===t&&this.st.y===e||(this.st.e(t,e),this.td())}get actualBounds(){return this.Ai}get scale(){return this.K}set scale(t){const e=this.K;e!==t&&(t<=0&&d.o("GraphObject.scale for "+this+" must be greater than zero, not: "+t),this.K=t,this.c(),this.t("scale",e,t))}get angle(){return this.Xt}set angle(t){const e=this.Xt;if(e!==t){if((t%=360)<0&&(t+=360),e===t)return;this.Xt=t,this.sA(),this.c(),this.t("angle",e,t)}}get desiredSize(){return this.Ke}set desiredSize(t){const e=t.width,i=t.height,n=this.Ke,s=n.width,o=n.height;if((s!==e&&(!isNaN(s)||!isNaN(e))||o!==i&&(!isNaN(o)||!isNaN(i)))&&(t=t.N(),this.Ke=t,this.c(),this instanceof le&&this.oe(),this.t("desiredSize",n,t),this.Wc())){const t=this.part;null!==t&&(this.ya(t,"width"),this.ya(t,"height"))}}get width(){return this.Ke.width}set width(t){const e=this.Ke.width;if(e!==t&&(!isNaN(e)||!isNaN(t))){const e=this.Ke,i=new A(t,this.Ke.height).g();if(this.Ke=i,this.c(),this instanceof le&&this.oe(),this.t("desiredSize",e,i),this.Wc()){const t=this.part;null!==t&&this.ya(t,"width")}}}get height(){return this.Ke.height}set height(t){const e=this.Ke.height;if(e!==t&&(!isNaN(e)||!isNaN(t))){const e=this.Ke,i=new A(this.Ke.width,t).g();if(this.Ke=i,this.c(),this instanceof le&&this.oe(),this.t("desiredSize",e,i),this.Wc()){const t=this.part;null!==t&&this.ya(t,"height")}}}get minSize(){return null!==this.f?this.f.kr:A.ru}set minSize(t){const e=this.minSize;e.equals(t)||(t=t.copy(),isNaN(t.width)&&(t.width=0),isNaN(t.height)&&(t.height=0),t.g(),this.Ht(),this.f.kr=t,this.c(),this.t("minSize",e,t))}get maxSize(){return null!==this.f?this.f.Pr:A.QN}set maxSize(t){const e=this.maxSize;e.equals(t)||(t=t.copy(),isNaN(t.width)&&(t.width=1/0),isNaN(t.height)&&(t.height=1/0),t.g(),this.Ht(),this.f.Pr=t,this.c(),this.t("maxSize",e,t))}get measuredBounds(){return this.re}get naturalBounds(){return this.Bi}Tb(){return 0}get margin(){return this.tl}set margin(t){"number"==typeof t&&(t=new F(t));const e=this.tl;e.equals(t)||(t=t.N(),this.tl=t,this.c(),this.t("margin",e,t))}get L(){return!0===this.Eb()&&this.Db(),this._r}get ws(){return!0===this.w0()&&this.Db(),this.lh}trigger(t){return t.Se=this,null===this.bs&&(this.bs=new L),this.bs.add(t.propertyName,t),this}get bs(){return null!==this.f?this.f.bs:null}set bs(t){this.bs!==t&&(this.Ht(),this.f.bs=t)}get br(){return null!==this.f?this.f.br:0}set br(t){this.br!==t&&(this.Ht(),this.f.br=t)}get alignment(){return this.oi}set alignment(t){const e=this.oi;e.equals(t)||(t.isNoSpot()&&!t.isDefault()&&d.o("GraphObject.alignment for "+this+" must be a real Spot or Spot.Default, not: "+t),t=t.N(),this.oi=t,this._c(),this.t("alignment",e,t))}get column(){return this.zo}set column(t){t=Math.round(t);const e=this.zo;e!==t&&(t<0&&d.tt(t,">= 0",Kt,"column"),this.zo=t,this.c(),this.t("column",e,t),null!==this.svg&&this.svg.remove())}get columnSpan(){return null!==this.f?this.f.D0:1}set columnSpan(t){t=Math.round(t);const e=this.columnSpan;e!==t&&(t<1&&d.tt(t,">= 1",Kt,"columnSpan"),this.Ht(),this.f.D0=t,this.c(),this.t("columnSpan",e,t))}get row(){return this.Wu}set row(t){t=Math.round(t);const e=this.Wu;e!==t&&(t<0&&d.tt(t,">= 0",Kt,"row"),this.Wu=t,this.c(),this.t("row",e,t),null!==this.svg&&this.svg.remove())}get rowSpan(){return null!==this.f?this.f.F0:1}set rowSpan(t){t=Math.round(t);const e=this.rowSpan;e!==t&&(t<1&&d.tt(t,">= 1",Kt,"rowSpan"),this.Ht(),this.f.F0=t,this.c(),this.t("rowSpan",e,t))}get spanAllocation(){return null!==this.f?this.f.R0:null}set spanAllocation(t){const e=this.spanAllocation;e!==t&&(null!==t&&d.i(t,"function",Kt,"spanAllocation"),this.Ht(),this.f.R0=t,this.c(),this.t("spanAllocation",e,t))}get alignmentFocus(){return this.jc}set alignmentFocus(t){const e=this.jc;e.equals(t)||(t=t.N(),this.jc=t,this.c(),this.t("alignmentFocus",e,t))}get portId(){return this.qu}set portId(t){const e=this.qu;if(e!==t){const i=this.part;null!==i&&!(i instanceof Ce)&&d.o("Cannot set portID on a Link: "+t);const n=i;null!==e&&null!==n&&n.f2(this),this.qu=t,null!==t&&null!==n&&(n.bn=!0,n.nA(this)),this.t("portId",e,t)}}ba(){const t=this.part;if(t instanceof Ce&&(null!==this.portId||this===t.port)){const e=t.diagram;null!==e&&!e.undoManager.isUndoingRedoing&&t.$L(this)}}sA(){const t=this.diagram;null===t||t.undoManager.isUndoingRedoing||(this instanceof ie?this instanceof Ce?this.invalidateConnectedLinks():this.walkVisualTreeFrom(this,(t=>{t.ba()})):this.ba())}get toSpot(){return null!==this.W?this.W.ua:O.None}set toSpot(t){const e=this.toSpot;e.equals(t)||(t=t.N(),this.Ye(),this.W.ua=t,this.t("toSpot",e,t),this.ba())}get toEndSegmentLength(){return null!==this.W?this.W.ga:10}set toEndSegmentLength(t){const e=this.toEndSegmentLength;e!==t&&(t<0&&d.tt(t,">= 0",Kt,"toEndSegmentLength"),this.Ye(),this.W.ga=t,this.t("toEndSegmentLength",e,t),this.ba())}get toShortLength(){return null!==this.W?this.W.pa:0}set toShortLength(t){const e=this.toShortLength;e!==t&&(this.Ye(),this.W.pa=t,this.t("toShortLength",e,t),this.ba())}get toLinkable(){return null!==this.W?this.W.v0:null}set toLinkable(t){const e=this.toLinkable;e!==t&&(this.Ye(),this.W.v0=t,this.t("toLinkable",e,t))}get toMaxLinks(){return null!==this.W?this.W.O0:1/0}set toMaxLinks(t){const e=this.toMaxLinks;e!==t&&(t<0&&d.tt(t,">= 0",Kt,"toMaxLinks"),this.Ye(),this.W.O0=t,this.t("toMaxLinks",e,t))}get fromSpot(){return null!==this.W?this.W.fa:O.None}set fromSpot(t){const e=this.fromSpot;e.equals(t)||(t=t.N(),this.Ye(),this.W.fa=t,this.t("fromSpot",e,t),this.ba())}get fromEndSegmentLength(){return null!==this.W?this.W.da:10}set fromEndSegmentLength(t){const e=this.fromEndSegmentLength;e!==t&&(t<0&&d.tt(t,">= 0",Kt,"fromEndSegmentLength"),this.Ye(),this.W.da=t,this.t("fromEndSegmentLength",e,t),this.ba())}get fromShortLength(){return null!==this.W?this.W.ma:0}set fromShortLength(t){const e=this.fromShortLength;e!==t&&(this.Ye(),this.W.ma=t,this.t("fromShortLength",e,t),this.ba())}get fromLinkable(){return null!==this.W?this.W.I0:null}set fromLinkable(t){const e=this.fromLinkable;e!==t&&(this.Ye(),this.W.I0=t,this.t("fromLinkable",e,t))}get fromMaxLinks(){return null!==this.W?this.W.E0:1/0}set fromMaxLinks(t){const e=this.fromMaxLinks;e!==t&&(t<0&&d.tt(t,">= 0",Kt,"fromMaxLinks"),this.Ye(),this.W.E0=t,this.t("fromMaxLinks",e,t))}get cursor(){return null!==this.f?this.f.Cl:""}set cursor(t){const e=this.cursor;e!==t&&(d.i(t,"string",Kt,"cursor"),this.Ht(),this.f.Cl=t,this.t("cursor",e,t))}get click(){return null!==this.f?this.f.Fr:null}set click(t){const e=this.click;e!==t&&(null!==t&&d.i(t,"function",Kt,"click"),this.Ht(),this.f.Fr=t,this.t("click",e,t))}get doubleClick(){return null!==this.f?this.f.Rr:null}set doubleClick(t){const e=this.doubleClick;e!==t&&(null!==t&&d.i(t,"function",Kt,"doubleClick"),this.Ht(),this.f.Rr=t,this.t("doubleClick",e,t))}get contextClick(){return null!==this.f?this.f.vr:null}set contextClick(t){const e=this.contextClick;e!==t&&(null!==t&&d.i(t,"function",Kt,"contextClick"),this.Ht(),this.f.vr=t,this.t("contextClick",e,t))}get mouseEnter(){return null!==this.f?this.f.Ur:null}set mouseEnter(t){const e=this.mouseEnter;e!==t&&(null!==t&&d.i(t,"function",Kt,"mouseEnter"),this.Ht(),this.f.Ur=t,this.t("mouseEnter",e,t))}get mouseLeave(){return null!==this.f?this.f.Br:null}set mouseLeave(t){const e=this.mouseLeave;e!==t&&(null!==t&&d.i(t,"function",Kt,"mouseLeave"),this.Ht(),this.f.Br=t,this.t("mouseLeave",e,t))}get mouseOver(){return null!==this.f?this.f.Or:null}set mouseOver(t){const e=this.mouseOver;e!==t&&(null!==t&&d.i(t,"function",Kt,"mouseOver"),this.Ht(),this.f.Or=t,this.t("mouseOver",e,t))}get mouseHover(){return null!==this.f?this.f.Ir:null}set mouseHover(t){const e=this.mouseHover;e!==t&&(null!==t&&d.i(t,"function",Kt,"mouseHover"),this.Ht(),this.f.Ir=t,this.t("mouseHover",e,t))}get mouseHold(){return null!==this.f?this.f.Er:null}set mouseHold(t){const e=this.mouseHold;e!==t&&(null!==t&&d.i(t,"function",Kt,"mouseHold"),this.Ht(),this.f.Er=t,this.t("mouseHold",e,t))}get mouseDragEnter(){return null!==this.f?this.f.V0:null}set mouseDragEnter(t){const e=this.mouseDragEnter;e!==t&&(null!==t&&d.i(t,"function",Kt,"mouseDragEnter"),this.Ht(),this.f.V0=t,this.t("mouseDragEnter",e,t))}get mouseDragLeave(){return null!==this.f?this.f.U0:null}set mouseDragLeave(t){const e=this.mouseDragLeave;e!==t&&(null!==t&&d.i(t,"function",Kt,"mouseDragLeave"),this.Ht(),this.f.U0=t,this.t("mouseDragLeave",e,t))}get mouseDrop(){return null!==this.f?this.f.Vr:null}set mouseDrop(t){const e=this.mouseDrop;e!==t&&(null!==t&&d.i(t,"function",Kt,"mouseDrop"),this.Ht(),this.f.Vr=t,this.t("mouseDrop",e,t))}get actionDown(){return null!==this.f?this.f.B0:null}set actionDown(t){const e=this.actionDown;e!==t&&(null!==t&&d.i(t,"function",Kt,"actionDown"),this.Ht(),this.f.B0=t,this.t("actionDown",e,t))}get actionMove(){return null!==this.f?this.f.z0:null}set actionMove(t){const e=this.actionMove;e!==t&&(null!==t&&d.i(t,"function",Kt,"actionMove"),this.Ht(),this.f.z0=t,this.t("actionMove",e,t))}get actionUp(){return null!==this.f?this.f.X0:null}set actionUp(t){const e=this.actionUp;e!==t&&(null!==t&&d.i(t,"function",Kt,"actionUp"),this.Ht(),this.f.X0=t,this.t("actionUp",e,t))}get actionCancel(){return null!==this.f?this.f.K0:null}set actionCancel(t){const e=this.actionCancel;e!==t&&(null!==t&&d.i(t,"function",Kt,"actionCancel"),this.Ht(),this.f.K0=t,this.t("actionCancel",e,t))}get toolTip(){return null!==this.f?this.f.zr:null}set toolTip(t){const e=this.toolTip;e!==t&&(this.Ht(),this.f.zr=t,this.t("toolTip",e,t))}get contextMenu(){return null!==this.f?this.f.Xr:null}set contextMenu(t){const e=this.contextMenu;e!==t&&(this.Ht(),this.f.Xr=t,this.t("contextMenu",e,t))}findBindingPanel(){let t=this instanceof ie?this:this.panel;for(;null!==t;){if(t.u2())return t;t=t.panel}return null}bind(t,e,i,n){return this.tf(t,e,i,n),this}bindTwoWay(t,e,i,n){return this.tf(t,e,i,n).makeTwoWay(),this}bindModel(t,e,i,n){return this.tf(t,e,i,n).ofModel(),this}bindObject(t,e,i,n,s){return this.tf(t,e,i,n).ofObject(s),this}theme(t,e,i,n,s){return this.dh(t,e,i,n,s),this}themeData(t,e,i,n,s){return this.dh(t,e,i,n,s).ofData(),this}themeObject(t,e,i,n,s,o){return this.dh(t,e,i,n,s).ofObject(o),this}themeModel(t,e,i,n,s){return this.dh(t,e,i,n,s).ofModel(),this}tf(t,e,i,n){let s=null;return s="string"==typeof t?new $e(t,e,i,n):t,this.Y0(s),s}dh(t,e,i,n,s){let o=null;return o="string"==typeof t?new Je(t,e,i,n,s):t,this.Y0(o),o}Y0(t){t.Se=this;const e=this.findBindingPanel();null!==e&&e.oA()&&d.o("Cannot add a Binding to a template that has already been copied: "+t),null===this.Ti&&(this.Ti=new x),this.Ti.add(t)}set(t){return Object.assign(this,t),this}attach(t){return Kt.d2(this,t),this}apply(t){return t(this),this}setProperties(t){return Dt.a0(this,t),this}static build(t,e){const i=Kt.G0.getValue(t);if("function"==typeof i){for(var n=arguments.length,s=new Array(n>2?n-2:0),o=2;o<n;o++)s[o-2]=arguments[o];const r=i([t].concat(s));if(r instanceof Kt)return e&&r.setProperties(e),r}d.o('GraphObject.build invoked object builder "'+t+'", but it did not return an Object')}static make(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];let s=arguments,o=null,r=null;if("function"==typeof t)r=t;else if("string"==typeof t){const e=Kt.G0.getValue(t);"function"==typeof e?(s=Array.prototype.slice.call(s),o=e(s),d.wt(o)||d.o('GraphObject.make invoked object builder "'+t+'", but it did not return an Object')):r=c.go[t]}null===o&&((null==r||!r.constructor)&&d.o("GraphObject.make requires a class function or GoJS class name or name of an object builder, not: "+t),o=new r);let a=1;if(o instanceof Dt&&s.length>1){const t=o,e=s[1];("string"==typeof e||e instanceof HTMLDivElement)&&(t.uS(e),a++)}for(let l=a;l<s.length;l++){const t=s[l];void 0===t?d.o("Undefined value at argument "+l+" for object being constructed by GraphObject.make: "+o):Kt.d2(o,t)}return o}static d2(t,e){if("number"==typeof e)Kt.vR(t,e);else if("string"==typeof e)Kt.OR(t,e);else if(e instanceof Kt)t instanceof ie||d.o("A GraphObject can only be added to a Panel, not to: "+t),t.add(e);else if(e instanceof ae){let i;e.isRow&&"function"==typeof t.getRowDefinition?i=t.getRowDefinition(e.index):!e.isRow&&"function"==typeof t.getColumnDefinition&&(i=t.getColumnDefinition(e.index)),i instanceof ae?i.Vb(e):d.o("A RowColumnDefinition can only be added to an object that implements getRowDefinition/getColumnDefinition, not to: "+t)}else if(e instanceof te){t.type=e}else if(e instanceof $e)t instanceof Kt||t instanceof ae?t.bind(e):d.o("A Binding can only be applied to a GraphObject or RowColumnDefinition, not to: "+t);else if(e instanceof Mt)t instanceof Kt?t.trigger(e):d.o("An AnimationTrigger can only be applied to a GraphObject, not to: "+t);else if(e instanceof j)t instanceof z&&4===t.type?t.figures.add(e):d.o("A PathFigure can only be added to a Path Geometry, not to: "+t);else if(e instanceof K)t instanceof j?t.segments.add(e):d.o("A PathSegment can only be added to a PathFigure, not to: "+t);else if(e instanceof je)t instanceof Dt||t instanceof Ve?t.layout=e:d.o("A Layout can only be assigned to a Diagram or a Group, not to: "+t);else if(Array.isArray(e))for(let i=0;i<e.length;i++){const n=e[i];Kt.d2(t,n)}else"object"==typeof e&&null!==e?Kt.IR(t,e):d.o('Unknown initializer "'+e+'" for object being constructed by GraphObject.make: '+t)}static OR(t,e){if(t instanceof fe)t.text=e;else if(t instanceof le)t.figure=e;else if(t instanceof ye)t.source=e;else if(t instanceof ie){const i=te.Layouts.getValue(e);null!==i&&(t.type=i)}else if(t instanceof Qt){const i=d.Eh($t,e);null!==i?t.type=i:d.o("Unknown Brush type as an argument to GraphObject.make: "+e)}else if(t instanceof z){const i=d.Eh(I,e);null!==i&&(t.type=i)}else if(t instanceof K){const i=d.Eh(U,e);null!==i&&(t.type=i)}}static vR(t,e){"function"==typeof t.li?t.li(e):d.ar(t,e)}static IR(t,e){if(t instanceof Qt){const i=new g;for(const n in e){const s=parseFloat(n);isNaN(s)?i[n]=e[n]:t.addColorStop(s,e[n])}Dt.a0(t,i)}else if(t instanceof ae){if(void 0!==e.row){const i=e.row;(null==i||i===1/0||isNaN(i)||i<0)&&d.o("Must specify non-negative integer row for RowColumnDefinition "+e+", not: "+i),t.isRow=!0,t.index=i}else if(void 0!==e.column){const i=e.column;(null==i||i===1/0||isNaN(i)||i<0)&&d.o("Must specify non-negative integer column for RowColumnDefinition "+e+", not: "+i),t.isRow=!1,t.index=i}const i=new g;for(const t in e)"row"===t||"column"===t||(i[t]=e[t]);Dt.a0(t,i)}else Dt.a0(t,e)}static cE(){const t=new L;for(const e in Kt.G0){if(e===e.toLowerCase())continue;const i=Kt.G0.getValue(e);"function"==typeof i&&t.add(e,i)}return t.g(),t}static defineBuilder(t,e){d.i(t,"string",Kt,"defineBuilder:name"),d.i(e,"function",Kt,"defineBuilder:func");t.toLowerCase();Kt.G0.add(t,e)}static takeBuilderArgument(t,e,i){void 0===i&&(i=null);const n=t[1];if("function"==typeof i?i(n):"string"==typeof n)return t.splice(1,1),n;if(void 0===e)throw new Error("no "+("function"==typeof i?"satisfactory":"string")+" argument for GraphObject builder "+t[0]);return e}}l=Kt,y(Kt,"None",0),y(Kt,"Default",1),y(Kt,"Fill",2),y(Kt,"Vertical",void 0),y(Kt,"Horizontal",void 0),y(Kt,"Uniform",6),y(Kt,"UniformToFill",7),y(Kt,"FlipVertical",1),y(Kt,"FlipHorizontal",2),y(Kt,"FlipBoth",3),y(Kt,"G0",new L),l.Vertical=4,l.Horizontal=5,l.defineBuilder("Button",(t=>{const e="#f5f5f5",i="#737373",n=2.76142374915397,s=2.761423749153969,o=new ie(ie.Auto,{isActionable:!0,enabledChanged:(t,e)=>{if(t instanceof ie){const i=t.findObject("ButtonBorder");null!==i&&(e?(t._buttonFillDisabled=i.fill,i.fill=t._buttonFillNormal):(t._buttonFillNormal=i.fill,i.fill=t._buttonFillDisabled))}},cursor:"pointer"}).attach({_buttonFillNormal:e,_buttonStrokeNormal:i,_buttonFillOver:"#d4d4d4",_buttonStrokeOver:"#737373",_buttonFillDisabled:"#a3a3a3"}).add(new le("RoundedRectangle",{name:"ButtonBorder",spot1:new O(0,0,n,s),spot2:new O(1,1,-n,-s),parameter1:2,fill:e,stroke:i}));return o.mouseEnter=(t,e,i)=>{if(!e.isEnabledObject()||!(e instanceof ie))return;const n=e.findObject("ButtonBorder");n instanceof le&&(e._buttonFillNormal=n.fill,n.fill=e._buttonFillOver,e._buttonStrokeNormal=n.stroke,n.stroke=e._buttonStrokeOver)},o.mouseLeave=(t,e,i)=>{if(!e.isEnabledObject()||!(e instanceof ie))return;const n=e.findObject("ButtonBorder");n instanceof le&&(n.fill=e._buttonFillNormal,n.stroke=e._buttonStrokeNormal)},o})),l.defineBuilder("TreeExpanderButton",(t=>{const e=l.build("Button");return e.attach({_treeExpandedFigure:"MinusLine",_treeCollapsedFigure:"PlusLine",visible:!1}),e.add(new le("MinusLine",{name:"ButtonIcon",stroke:"#0a0a0a",strokeWidth:2,desiredSize:A.lu}).bindObject("figure","isTreeExpanded",((t,e)=>{const i=e.panel;return t?i._treeExpandedFigure:i._treeCollapsedFigure}))),e.bindObject("visible","isTreeLeaf",(t=>!t)),e.click=(t,e)=>{let i=e.part;if(i instanceof Pe&&(i=i.adornedPart),!(i instanceof Ce))return;const n=i.diagram;if(null===n)return;const s=n.commandHandler;if(i.isTreeExpanded){if(!s.canCollapseTree(i))return}else if(!s.canExpandTree(i))return;t.handled=!0,i.isTreeExpanded?s.collapseTree(i):s.expandTree(i)},e})),l.defineBuilder("SubGraphExpanderButton",(t=>{const e=l.build("Button");return e.attach({_subGraphExpandedFigure:"MinusLine",_subGraphCollapsedFigure:"PlusLine"}),e.add(new le("MinusLine",{name:"ButtonIcon",stroke:"#0a0a0a",strokeWidth:2,desiredSize:A.lu}).bindObject("figure","isSubGraphExpanded",((t,e)=>{const i=e.panel;return t?i._subGraphExpandedFigure:i._subGraphCollapsedFigure}))),e.click=(t,e)=>{let i=e.part;if(i instanceof Pe&&(i=i.adornedPart),!(i instanceof Ve))return;const n=i.diagram;if(null===n)return;const s=n.commandHandler;if(i.isSubGraphExpanded){if(!s.canCollapseSubGraph(i))return}else if(!s.canExpandSubGraph(i))return;t.handled=!0,i.isSubGraphExpanded?s.collapseSubGraph(i):s.expandSubGraph(i)},e})),l.defineBuilder("ToolTip",(t=>new Pe(ie.Auto,{isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new T(0,2)}).add(new le("RoundedRectangle",{name:"Border",parameter1:1,fill:"#f5f5f5",strokeWidth:0,spot1:new O(0,0,4,6),spot2:new O(1,1,-4,-4)})))),l.defineBuilder("ContextMenu",(t=>new Pe(ie.Vertical,{background:"#f5f5f5",isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new T(0,2)}).bindObject("background","",(t=>null!==t.adornedPart&&t.hasPlaceholder()?null:"#f5f5f5")))),l.defineBuilder("ContextMenuButton",(t=>{const e=l.build("Button");e.stretch=5;const i=e.findObject("ButtonBorder");return i instanceof le&&(i.figure="Rectangle",i.strokeWidth=0,i.spot1=new O(0,0,4,6),i.spot2=new O(1,1,-4,-4)),e})),l.defineBuilder("PanelExpanderButton",(t=>{const e=l.takeBuilderArgument(t,"COLLAPSIBLE"),i=l.build("Button");i.attach({_buttonExpandedFigure:"M0 0 M0 6 L4 2 8 6 M8 8",_buttonCollapsedFigure:"M0 0 M0 2 L4 6 8 2 M8 8",_buttonFillNormal:"rgba(0, 0, 0, 0)",_buttonStrokeNormal:null,_buttonFillOver:"rgba(0, 0, 0, .2)",_buttonStrokeOver:null}),i.add(new le({name:"ButtonIcon",strokeWidth:2}).bindObject("geometryString","visible",(t=>t?i._buttonExpandedFigure:i._buttonCollapsedFigure),void 0,e));const n=i.findObject("ButtonBorder");return n instanceof le&&(n.stroke=null,n.fill="rgba(0, 0, 0, 0)"),i.click=(t,i)=>{if(!(i instanceof ie))return;const n=i.diagram;if(null===n||n.isReadOnly)return;let s=i.findBindingPanel();if(null===s&&(s=i.part),null!==s){const i=s.findObject(e);null!==i&&(t.handled=!0,n.startTransaction("Collapse/Expand Panel"),i.visible=!i.visible,n.commitTransaction("Collapse/Expand Panel"))}},i})),l.defineBuilder("CheckBoxButton",(t=>{const e=l.takeBuilderArgument(t),i=l.build("Button",{desiredSize:new A(14,14)});i.attach({"ButtonBorder.spot1":new O(0,0,1,1),"ButtonBorder.spot2":new O(1,1,-1,-1)});const n=new le({name:"ButtonIcon",geometryString:"M0 0 M0 8.85 L4.9 13.75 16.2 2.45 M16.2 16.2",strokeWidth:2,stretch:2,geometryStretch:6,visible:!1});return""!==e&&n.bindTwoWay("visible",e),i.add(n),i.click=(t,i)=>{if(!(i instanceof ie))return;const n=t.diagram;if(null===n||n.isReadOnly||""!==e&&n.model.isReadOnly)return;t.handled=!0;const s=i.findObject("ButtonIcon");n.startTransaction("checkbox"),null!==s&&(s.visible=!s.visible),"function"==typeof i._doClick&&i._doClick(t,i),n.commitTransaction("checkbox")},i})),l.defineBuilder("CheckBox",(t=>{const e=l.takeBuilderArgument(t),i=l.build("CheckBoxButton",{name:"Button",isActionable:!1,margin:new F(0,1,0,0)},e),n=new ie("Horizontal",{isActionable:!0,cursor:i.cursor,margin:new F(1),mouseEnter:i.mouseEnter,mouseLeave:i.mouseLeave,click:i.click}).attach({_buttonFillNormal:i._buttonFillNormal,_buttonStrokeNormal:i._buttonStrokeNormal,_buttonFillOver:i._buttonFillOver,_buttonStrokeOver:i._buttonStrokeOver,_buttonFillDisabled:i._buttonFillDisabled,_buttonClick:i.click});return n.add(i),i.mouseEnter=null,i.mouseLeave=null,i.click=null,n}));class Gt{constructor(){y(this,"mi",void 0),y(this,"St",void 0),y(this,"Zn",void 0),y(this,"Ti",void 0),y(this,"Qn",void 0),y(this,"Ys",void 0),y(this,"Cl",void 0),y(this,"Fr",void 0),y(this,"Rr",void 0),y(this,"vr",void 0),y(this,"Ur",void 0),y(this,"Br",void 0),y(this,"Or",void 0),y(this,"Ir",void 0),y(this,"Er",void 0),y(this,"V0",void 0),y(this,"U0",void 0),y(this,"Vr",void 0),y(this,"B0",void 0),y(this,"z0",void 0),y(this,"X0",void 0),y(this,"K0",void 0),y(this,"zr",void 0),y(this,"Xr",void 0),y(this,"M0",void 0),y(this,"R0",void 0),y(this,"bs",void 0),y(this,"kr",void 0),y(this,"Pr",void 0),y(this,"io",void 0),y(this,"F0",void 0),y(this,"D0",void 0),y(this,"br",void 0),y(this,"k0",void 0),y(this,"H0",void 0),y(this,"j0",void 0),this.mi=!1,this.St="",this.Zn=-1,this.Ti=null,this.Qn=null,this.Ys=null,this.Cl="",this.Fr=null,this.Rr=null,this.vr=null,this.Ur=null,this.Br=null,this.Or=null,this.Ir=null,this.Er=null,this.V0=null,this.U0=null,this.Vr=null,this.B0=null,this.z0=null,this.X0=null,this.K0=null,this.zr=null,this.Xr=null,this.M0=null,this.R0=null,this.bs=null,this.kr=A.ru,this.Pr=A.QN,this.io=1,this.F0=1,this.D0=1,this.br=0,this.k0=null,this.H0=null,this.j0="category"}copy(){const t=new Gt;return t.St=this.St,t.Zn=this.Zn,t.Ti=this.Ti,t.Ys=this.Ys,t.Cl=this.Cl,t.Fr=this.Fr,t.Rr=this.Rr,t.vr=this.vr,t.Ur=this.Ur,t.Br=this.Br,t.Or=this.Or,t.Ir=this.Ir,t.Er=this.Er,t.V0=this.V0,t.U0=this.U0,t.Vr=this.Vr,t.B0=this.B0,t.z0=this.z0,t.X0=this.X0,t.K0=this.K0,t.zr=this.zr,t.Xr=this.Xr,t.M0=this.M0,t.R0=this.R0,t.bs=this.bs,t.kr=this.kr.N(),t.Pr=this.Pr.N(),t.io=this.io,t.F0=this.F0,t.D0=this.D0,t.br=this.br,t.k0=this.k0,t.H0=this.H0,t.j0=this.j0,t}}class Xt{constructor(){y(this,"m",void 0),this.m=[1,0,0,1,0,0]}copy(){const t=new Xt;return t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t}translate(t,e){this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e}scale(t,e){this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e}rotate(t,e,i){if(t>=360?t-=360:t<0&&(t+=360),0===t)return;this.translate(e,i);let n=0,s=0;if(90===t)n=0,s=1;else if(180===t)n=-1,s=0;else if(270===t)n=0,s=-1;else{const e=t*Math.PI/180;n=Math.cos(e),s=Math.sin(e)}const o=this.m[0]*n+this.m[2]*s,r=this.m[1]*n+this.m[3]*s,a=this.m[0]*-s+this.m[2]*n,l=this.m[1]*-s+this.m[3]*n;this.m[0]=o,this.m[1]=r,this.m[2]=a,this.m[3]=l,this.translate(-e,-i)}}class Yt{constructor(t){y(this,"type",void 0),y(this,"x1",void 0),y(this,"y1",void 0),y(this,"r1",void 0),y(this,"x2",void 0),y(this,"y2",void 0),y(this,"r2",void 0),y(this,"colors",void 0),y(this,"pattern",void 0),this.type=t,this.x1=0,this.y1=0,this.r1=0,this.x2=0,this.y2=0,this.r2=0,this.colors=[],this.pattern=null}addColorStop(t,e){this.colors.push({offset:t,color:e})}}class _t{constructor(t,e,i){y(this,"Ft",void 0),y(this,"ci",void 0),y(this,"ca",void 0),y(this,"Gu",void 0),y(this,"g2",void 0);const n=void 0===e?c.document:e;this.ca=n,this.g2="http://www.w3.org/2000/svg";const s="http://www.w3.org/2000/xmlns/";void 0!==n&&(this.Ft=this.makeElement("svg",{width:"1px",height:"1px",viewBox:"0 0 1 1"}),this.style.display="block",this.style.letterSpacing="normal",this.style.wordSpacing="normal",i||(this.style.position="absolute"),this.Ft.setAttributeNS(s,"xmlns",this.g2),this.Ft.setAttributeNS(s,"xmlns:xlink","http://www.w3.org/1999/xlink")),this.Gu=null,this.ci=new Ht(this,i)}resize(t,e,i,n){return(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.style.width=i+"px",this.style.height=n+"px",this.Ft.setAttributeNS(null,"width",i+"px"),this.Ft.setAttributeNS(null,"height",n+"px"),this.Ft.setAttributeNS(null,"viewBox","0 0 "+i+" "+n),this.ci.m2.firstElementChild.setAttributeNS(null,"width",i+"px"),this.ci.m2.firstElementChild.setAttributeNS(null,"height",n+"px"),!0)}makeElement(t,e,i){const n=this.ca.createElementNS(this.g2,t);if(d.wt(e))for(const s in e)n.setAttributeNS("href"===s?"http://www.w3.org/1999/xlink":"",s,e[s]);return void 0!==i&&(n.textContent=i),n}getBoundingClientRect(){return this.Ft.getBoundingClientRect()}focus(){this.Ft.focus()}get width(){return this.Ft.width.baseVal.value}set width(t){this.Ft.setAttribute("width",t+"px")}get height(){return this.Ft.height.baseVal.value}set height(t){this.Ft.setAttribute("height",t+"px")}dispose(){this.ca=null}get style(){return this.Ft.style}}class Ht{constructor(t,e){y(this,"ef",void 0),y(this,"sf",void 0),y(this,"kn",void 0),y(this,"Di",void 0),y(this,"Ge",void 0),y(this,"fillStyle",void 0),y(this,"font",void 0),y(this,"globalAlpha",void 0),y(this,"lineCap",void 0),y(this,"lineDashOffset",void 0),y(this,"lineJoin",void 0),y(this,"lineWidth",void 0),y(this,"miterLimit",void 0),y(this,"shadowBlur",void 0),y(this,"shadowColor",void 0),y(this,"shadowOffsetX",void 0),y(this,"shadowOffsetY",void 0),y(this,"strokeStyle",void 0),y(this,"textAlign",void 0),y(this,"imageSmoothingEnabled",void 0),y(this,"clipInsteadOfFill",void 0),y(this,"lastCreatedElement",void 0),y(this,"nf",void 0),y(this,"of",void 0),y(this,"surface",void 0),y(this,"svg",void 0),y(this,"m2",void 0),y(this,"rA",void 0),y(this,"Ub",void 0),y(this,"Yo",void 0),y(this,"gh",void 0),y(this,"ka",void 0),y(this,"currentElement",void 0),y(this,"clipPathGroup",void 0),y(this,"diagramGroup",void 0),y(this,"lastDrawnPart",void 0),y(this,"currentPath",void 0),y(this,"outerGroup",void 0),y(this,"pathAttributes",void 0),y(this,"sl",void 0),y(this,"Cr",void 0),y(this,"filter",void 0),y(this,"partClipRect",void 0),this.surface=t,this.svg=t.Ft,this.nf=[],this.of=[],this.fillStyle="#000000",this.font="10px sans-serif",this.globalAlpha=1,this.lineCap="butt",this.lineDashOffset=0,this.lineJoin="miter",this.lineWidth=1,this.miterLimit=10,this.shadowBlur=0,this.shadowColor="rgba(0, 0, 0, 0)",this.shadowOffsetX=0,this.shadowOffsetY=0,this.sl=!1,this.strokeStyle="#000000",this.textAlign="start",this.clipInsteadOfFill=!1,this.ef=0,this.sf=0,this.kn=0,this.lastCreatedElement=null,this.currentElement=null,this.Di=[],this.pathAttributes={},this.Ub=!1,this.Yo=null,this.gh=0,this.Ge=new Xt,this.clipPathGroup=this.newGroup2(),this.diagramGroup=this.newGroup2("gojs-diagram"),this.lastDrawnPart=null,this.currentPath=null;const i=k.su++,n=this.makeElement("clipPath",{id:"mainClip"+i}),s={x:0,y:0,width:t.width,height:t.height};n.appendChild(this.makeElement("rect",s)),this.m2=n,this.svg.appendChild(this.clipPathGroup),this.clipPathGroup.appendChild(this.diagramGroup),this.svg.appendChild(n),this.clipPathGroup.setAttributeNS(null,"clip-path","url(#mainClip"+i+")"),this.rA={},this.Cr=!!e,this.filter="",this.partClipRect=null}setDiagramPosScale(t,e,i,n,s,o){void 0===this.diagramGroup?this.newGroup(t,e,i,n,s,o):this.diagramGroup.setAttribute("transform","matrix("+t+", "+e+", "+i+", "+n+", "+s+", "+o+")")}resetInnerSVG(){null!==this.diagramGroup&&(this.diagramGroup.innerHTML="")}arc(t,e,i,n,s,o,r,a){const l=2*Math.PI,h=1e-6,u=l-h,c=i*Math.cos(n),d=i*Math.sin(n),f=t+c,g=e+d,m=o?0:1;let p=o?n-s:s-n;(Math.abs(r-f)>h||Math.abs(a-g)>h)&&this.Di.push(["L",f,+g]),p<0&&(p=p%l+l),p>u?(this.Di.push(["A",i,i,0,1,m,t-c,e-d]),this.Di.push(["A",i,i,0,1,m,f,g])):p>h&&this.Di.push(["A",i,i,0,+(p>=Math.PI),m,t+i*Math.cos(s),e+i*Math.sin(s)])}beginPath(){this.Di=[],this.pathAttributes={stroke:"none",fill:"none"}}endPath(t){this.ER(this.Di,this.Ge,t||0)}bezierCurveTo(t,e,i,n,s,o){this.Di.push(["C",t,e,i,n,s,o])}clearRect(t,e,i,n){}clip(){this.pathAttributes.clipPath=!0}closePath(){this.Di.push(["z"])}createLinearGradient(t,e,i,n){const s=new Yt("linear");return s.x1=t,s.y1=e,s.x2=i,s.y2=n,s}createPattern(t,e){let i="";t instanceof HTMLCanvasElement&&(i=t.toDataURL()),t instanceof HTMLImageElement&&(i=t.getAttribute("src"));const n=this.rA;if(n[i])return"url(#"+n[i]+")";const s="PATTERN"+k.su++,o={width:t.width,height:t.height,id:s,patternUnits:"userSpaceOnUse"},r={x:0,y:0,width:t.width,height:t.height,href:i},a=this.makeElement("pattern",o);return a.appendChild(this.makeElement(Dt.img,r)),this.svg.appendChild(a),n[i]=s,"url(#"+s+")"}createRadialGradient(t,e,i,n,s,o){const r=new Yt("radial");return r.x1=t,r.y1=e,r.r1=i,r.x2=n,r.y2=s,r.r2=o,r}amendImageTransform(t,e,i,n,s,o,r,a){const l=r/i,h=a/n;(0!==s||0!==o)&&this.Ge.translate(s,o),(1!==l||1!==h)&&this.Ge.scale(l,h),(0!==t||0!==e)&&this.Ge.translate(-t,-e)}drawImage(t,e,i,n,s,o,r,a,l){let h="";t instanceof HTMLCanvasElement&&(h=t.toDataURL()),t instanceof HTMLImageElement&&(h=t.getAttribute("src"));const u=t instanceof HTMLImageElement?t.naturalWidth:t.width,c=t instanceof HTMLImageElement?t.naturalHeight:t.height;void 0===n&&(o=e,r=i,a=n=u,l=s=c),n=n||0,s=s||0,o=o||0,r=r||0,a=a||0,l=l||0,this.amendImageTransform(e,i,n,s,o,r,a,l);const d={x:0,y:0,width:u||n,height:c||s,href:h};E.Y(n,a)&&E.Y(s,l)?-1===h.toLowerCase().indexOf(".svg")&&-1===h.toLowerCase().indexOf("data:image/svg")&&(d.preserveAspectRatio="xMidYMid slice"):d.preserveAspectRatio="none",(0!==e||0!==i||n!==u||s!==c)&&(n+=e,s+=i,d["clip-path"]="path('M ".concat(e,",").concat(i," L ").concat(n," ").concat(i," L ").concat(n," ").concat(s," L ").concat(e," ").concat(s," z')")),this.processCommon(Dt.img,d,this.Ge),this.rd(Dt.img,d)}fill(t,e){t&&(this.pathAttributes["fill-rule"]="evenodd"),this.setFill(this.pathAttributes)}fillContext(t,e,i){this.clipInsteadOfFill?this.clip():this.fill(e,i)}fillRect(t,e,i,n){this.addRect("fill",[t,e,i,n],this.Ge)}fillBackground(t,e,i,n){const s={x:t,y:e,width:i,height:n};this.processCommon("fill",s,this.Ge),this.setFill(s),this.svg.prepend(this.makeElement("rect",s))}fillText(t,e,i){this.addText("fill",[t,e,i],this.Ge)}lineTo(t,e){this.Di.push(["L",t,e])}moveTo(t,e){this.Di.push(["M",t,e])}quadraticCurveTo(t,e,i,n){this.Di.push(["Q",t,e,i,n])}rect(t,e,i,n){this.Di.push(["M",t,e],["L",t+i,e],["L",t+i,e+n],["L",t,e+n],["z"])}restore(){this.Ge=this.nf.pop(),this.Di=this.nf.pop();const t=this.nf.pop();this.fillStyle=t.fillStyle,this.font=t.font,this.globalAlpha=t.globalAlpha,this.lineCap=t.lineCap,this.lineDashOffset=t.lineDashOffset,this.lineJoin=t.lineJoin,this.lineWidth=t.lineWidth,this.miterLimit=t.miterLimit,this.shadowBlur=t.shadowBlur,this.shadowColor=t.shadowColor,this.shadowOffsetX=t.shadowOffsetX,this.shadowOffsetY=t.shadowOffsetY,this.strokeStyle=t.strokeStyle,this.textAlign=t.textAlign,this.partClipRect=t.partClipRect}save(){const t={fillStyle:this.fillStyle,font:this.font,globalAlpha:this.globalAlpha,lineCap:this.lineCap,lineDashOffset:this.lineDashOffset,lineJoin:this.lineJoin,lineWidth:this.lineWidth,miterLimit:this.miterLimit,shadowBlur:this.shadowBlur,shadowColor:this.shadowColor,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY,strokeStyle:this.strokeStyle,textAlign:this.textAlign,partClipRect:this.partClipRect};this.nf.push(t);const e=[];for(let i=0;i<this.Di.length;i++)e.push(this.Di[i]);this.nf.push(e),this.nf.push(this.Ge.copy())}setTransform(t,e,i,n,s,o){1===t&&0===e&&0===i&&1===n&&0===s&&0===o||this.newGroup(t,e,i,n,s,o)}setCurrentTransform(t,e,i,n,s,o){this.Ge.m=[t,e,i,n,s,o]}getCurrentTransform(){const t=this.Ge.m;return"matrix("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}scale(t,e){this.Ge.scale(t,e)}translate(t,e){this.Ge.translate(t,e)}transform(t,e,i,n,s,o){}commitTransform(){}stroke(){this.setStroke(this.pathAttributes)}strokeContext(){this.clipInsteadOfFill||this.stroke()}strokeRect(t,e,i,n){this.addRect("stroke",[t,e,i,n],this.Ge)}makeElement(t,e,i){return this.surface.makeElement(t,e,i)}rd(t,e,i){const n=this.makeElement(t,e,i);return null!==this.currentElement?this.currentElement.appendChild(n):this.currentElement=n,this.lastCreatedElement=n,n}processCommon(t,e,i){if("fill"===t?this.setFill(e):"stroke"===t&&this.setStroke(e),null!==i){const t=i.m;e.transform="matrix("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}}setFill(t){if(this.fillStyle instanceof Yt)t.fill=this.addGradient(this.fillStyle,!0);else if(/^rgba\(/.test(this.fillStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.fillStyle);t.fill="rgb("+e[1]+","+e[2]+","+e[3]+")",t["fill-opacity"]=e[4]}else t.fill=this.fillStyle}setFillOrStrokeInPlace(t,e){const i=e?"fill":"stroke";if(this.fillStyle instanceof Yt)t.setAttributeNS(null,"fill",this.addGradient(this.fillStyle,!0));else if(/^rgba\(/.test(this.fillStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.fillStyle);t.setAttributeNS(null,i,"rgb("+e[1]+","+e[2]+","+e[3]+")"),t.setAttributeNS(null,i+"-opacity",e[4])}else t.setAttributeNS(null,i,this.fillStyle)}setStroke(t){if(this.strokeStyle instanceof Yt)t.stroke=this.addGradient(this.strokeStyle,!1);else if(/^rgba\(/.test(this.strokeStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.strokeStyle);t.stroke="rgb("+e[1]+","+e[2]+","+e[3]+")",t["stroke-opacity"]=e[4]}else t.stroke=this.strokeStyle;t["stroke-width"]=this.lineWidth,t["stroke-linecap"]=this.lineCap,t["stroke-linejoin"]=this.lineJoin,t["stroke-miterlimit"]=this.miterLimit,this.Ub&&(t["stroke-dasharray"]=this.Yo.toString(),t["stroke-dashoffset"]=this.gh)}addGradient(t,e){let i="";const n=null!==this.currentPath?this.currentPath.getAttribute(e?"fill":"stroke"):null;if(null!==n&&-1!==n.indexOf("GRAD")){i=n.split("#")[1].slice(0,-1);const t=this.svg.getElementById(i);null!==t&&t.remove()}else i="GRAD"+k.su++;let s;if("linear"===t.type){const e={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,id:i,gradientUnits:"userSpaceOnUse"};s=this.makeElement("linearGradient",e)}else{if("radial"!==t.type)throw new Error("invalid gradient");{const e={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,r1:t.r1,r2:t.r2,id:i};s=this.makeElement("radialGradient",e)}}const o=t.colors,r=o.length,a=[];for(let l=0;l<r;l++){const t=o[l],e=t.color,i={offset:t.offset,"stop-color":e};if(/^rgba\(/.test(e)){const t=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(e);i["stop-color"]="rgb("+t[1]+","+t[2]+","+t[3]+")",i["stop-opacity"]=t[4]}a.push(i)}a.sort(((t,e)=>t.offset>e.offset?1:-1));for(let l=0;l<r;l++)s.appendChild(this.makeElement("stop",a[l]));return this.svg.appendChild(s),"url(#"+i+")"}addRect(t,e,i){const n={x:e[0],y:e[1],width:e[2],height:e[3]};this.processCommon(t,n,i),this.rd("rect",n)}addText(t,e,i){let n=this.textAlign;"left"===n?n="start":"right"===n?n="end":"center"===n&&(n="middle");const s={x:e[1],y:e[2],style:"font: "+this.font,"text-anchor":n};this.processCommon(t,s,i),this.rd("text",s,e[0])}ER(t,e,i){const n=this.VR(t),s=this.pathAttributes;if(s.clipPath)this.of.length>0&&this.of[this.of.length-1].setAttributeNS(null,"clip-path",'path("'+n+'")');else if(s.d=n,this.processCommon("",s,e),null!==this.currentPath){const t=this.currentPath;if("g"!==t.nodeName)for(const e in s)"transform"!==e&&t.setAttributeNS(null,e,s[e]);else{const e=t.getElementsByTagName("path");for(const t in s)"transform"!==t&&e[i].setAttributeNS(null,t,s[t])}}else this.rd("path",s)}VR(t){const e=[];for(let i=0;i<t.length;i++){const n=t[i].slice(),s=[n.shift()];if("A"===s[0])s.push(n.shift()+","+n.shift(),n.shift(),n.shift()+","+n.shift(),n.shift()+","+n.shift());else for(;n.length;)s.push(n.shift()+","+n.shift());e.push(s.join(" "))}return e.join(" ")}newGroup(t,e,i,n,s,o){const r=new Xt;r.m=[t,e,i,n,s,o];const a={};this.processCommon("g",a,r);const l=this.rd("g",a);return this.of.push(l),l}newGroup2(t){const e={};t&&(e.class=t);const i=this.rd("g",e);return this.of.push(i),i}endGroup(){return this.of.pop()}dummyGroup(){return this.newGroup2(),this.endGroup()}shadowsSet(t,e,i){this.ef=t,this.sf=e,this.kn=i}shadowsOff(){this.sl=!1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0}shadowsOn(){this.sl=!0,this.shadowOffsetX=this.ef,this.shadowOffsetY=this.sf,this.shadowBlur=this.kn}enableDash(t,e){this.Ub=!0,this.Yo=t,this.gh=e}disableDash(){this.Ub=!1}clearContextCache(t){}setImageSmoothingEnabled(t){}rotate(t){this.Ge.rotate(57.2958*t,0,0)}getImageData(t,e,i,n){return null}measureText(t){return null}removeOldGradient(t,e,i){const n=e.getAttribute(i);if(null===n)return;const s=n.split("#");if(1===s.length)return;const o=this.svg.getElementById(s[1].slice(0,-1));if(null!==o){const t=new RegExp(o.id,"g");1===this.svg.innerHTML.match(t).length&&o.remove()}}removePartFromView(t){null!==t.svg&&t.svg.parentNode===this.diagramGroup&&t.svg.remove()}}class qt{constructor(t,e,i,n){y(this,"Ft",void 0),y(this,"ci",void 0),y(this,"ca",void 0),y(this,"Gu",void 0);const s=void 0===e?c.document:e;this.ca=s,this.Gu=null;const o=s.createElement("canvas");o.tabIndex=0,this.Ft=o,this.ci=new Wt(o,i,n),Dt.se.set(o,t)}resize(t,e,i,n){return(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.style.width=i+"px",this.style.height=n+"px",!0)}toDataURL(t,e){return this.Ft.toDataURL(t,e)}getBoundingClientRect(){return this.Ft.getBoundingClientRect()}focus(){this.Ft.focus()}get width(){return this.Ft.width}set width(t){this.Ft.width=t}get height(){return this.Ft.height}set height(t){this.Ft.height=t}dispose(){Dt.se.delete(this.Ft),this.ca=null}get style(){return this.Ft.style}}class Wt{constructor(t,e,i){y(this,"U",void 0),y(this,"Bb",void 0),y(this,"zb",void 0),y(this,"Xb",void 0),y(this,"q0",void 0),y(this,"ef",void 0),y(this,"sf",void 0),y(this,"kn",void 0),y(this,"ka",void 0),y(this,"sl",void 0),y(this,"Cr",void 0),this.U=t.getContext?t.getContext("2d",e):null,null===this.U&&d.o("Browser does not support HTML Canvas Element"),this.Bb="",this.zb="",this.Xb="",this.q0=!1,this.ef=0,this.sf=0,this.kn=0,this.sl=!1,this.ka=new R,this.Cr=!!i}setImageSmoothingEnabled(t){this.U.imageSmoothingEnabled=t}get fillStyle(){return this.U.fillStyle}set fillStyle(t){this.Xb!==t&&(this.U.fillStyle=t,this.Xb=t)}get font(){return this.U.font}set font(t){this.Bb!==t&&(this.U.font=t,this.Bb=t)}get globalAlpha(){return this.U.globalAlpha}set globalAlpha(t){this.U.globalAlpha=t}get lineCap(){return this.U.lineCap}set lineCap(t){this.U.lineCap=t}get lineDashOffset(){return this.U.lineDashOffset}set lineDashOffset(t){this.U.lineDashOffset=t}get lineJoin(){return this.U.lineJoin}set lineJoin(t){this.U.lineJoin=t}get lineWidth(){return this.U.lineWidth}set lineWidth(t){this.U.lineWidth=t}get miterLimit(){return this.U.miterLimit}set miterLimit(t){this.U.miterLimit=t}get shadowBlur(){return this.U.shadowBlur}set shadowBlur(t){this.U.shadowBlur=t}get shadowColor(){return this.U.shadowColor}set shadowColor(t){this.U.shadowColor=t}get shadowOffsetX(){return this.U.shadowOffsetX}set shadowOffsetX(t){this.U.shadowOffsetX=t}get shadowOffsetY(){return this.U.shadowOffsetY}set shadowOffsetY(t){this.U.shadowOffsetY=t}get strokeStyle(){return this.U.strokeStyle}set strokeStyle(t){this.zb!==t&&(this.U.strokeStyle=t,this.zb=t)}get textAlign(){return this.U.textAlign}set textAlign(t){this.U.textAlign=t}get imageSmoothingEnabled(){return this.U.imageSmoothingEnabled}set imageSmoothingEnabled(t){this.U.imageSmoothingEnabled=t}get filter(){return this.U.filter}set filter(t){this.U.filter=""===t?"none":t}arc(t,e,i,n,s,o,r,a){this.U.arc(t,e,i,n,s,o)}beginPath(){this.U.beginPath()}endPath(){}bezierCurveTo(t,e,i,n,s,o){this.U.bezierCurveTo(t,e,i,n,s,o)}clearRect(t,e,i,n){this.commitTransform(),this.U.clearRect(t,e,i,n)}clip(t){t?this.U.clip(t):this.U.clip()}closePath(){this.U.closePath()}createLinearGradient(t,e,i,n){return this.U.createLinearGradient(t,e,i,n)}createPattern(t,e){return this.U.createPattern(t,e)}createRadialGradient(t,e,i,n,s,o){return this.U.createRadialGradient(t,e,i,n,s,o)}drawImage(t,e,i,n,s,o,r,a,l){void 0===n?this.U.drawImage(t,e,i):this.U.drawImage(t,e,i,n,s,o,r,a,l)}fill(t,e){e?this.U.fill(e,t?"evenodd":"nonzero"):this.U.fill(t?"evenodd":"nonzero")}fillRect(t,e,i,n){this.U.fillRect(t,e,i,n)}fillBackground(t,e,i,n){this.U.fillRect(t,e,i,n)}fillText(t,e,i){this.U.fillText(t,e,i)}getImageData(t,e,i,n){return this.U.getImageData(t,e,i,n)}lineTo(t,e){this.U.lineTo(t,e)}measureText(t){return this.U.measureText(t)}moveTo(t,e){this.U.moveTo(t,e)}quadraticCurveTo(t,e,i,n){this.U.quadraticCurveTo(t,e,i,n)}rect(t,e,i,n){this.U.rect(t,e,i,n)}restore(){this.U.restore()}save(){this.commitTransform(),this.U.save()}rotate(t){this.ka.us(57.2958*t,0,0)}setTransform(t,e,i,n,s,o){this.ka.setTo(t,e,i,n,s,o)}scale(t,e){this.ka.K(t,e)}translate(t,e){this.ka.Qi(t,e)}stroke(t){t?this.U.stroke(t):this.U.stroke()}transform(t,e,i,n,s,o){if(1===t&&0===e&&0===i&&1===n&&0===s&&0===o)return;const r=this.ka,a=r.m11*t+r.m21*e,l=r.m12*t+r.m22*e,h=r.m11*i+r.m21*n,u=r.m12*i+r.m22*n;r.dx=r.m11*s+r.m21*o+r.dx,r.dy=r.m12*s+r.m22*o+r.dy,r.m11=a,r.m12=l,r.m21=h,r.m22=u}commitTransform(){const t=this.ka;this.U.setTransform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy)}fillContext(t,e,i){this.radialFill(t,e,i)||this.fillOrClip(e,i)}radialFill(t,e,i){if(!(t instanceof Qt)||3!==t.type)return!1;const n=t.Zc,s=t.Ib;return s>n?(this.scale(n/s,1),this.translate((s-n)/2,0)):n>s&&(this.scale(1,s/n),this.translate(0,(n-s)/2)),this.fillOrClip(e,i),s>n?(this.translate(-(s-n)/2,0),this.scale(1/(n/s),1)):n>s&&(this.translate(0,-(n-s)/2),this.scale(1,1/(s/n))),!0}strokeContext(){this.q0||this.stroke()}fillOrClip(t,e){this.q0?this.clip(e):this.fill(t,e)}get clipInsteadOfFill(){return this.q0}set clipInsteadOfFill(t){this.q0=t}shadowsSet(t,e,i){this.ef=t,this.sf=e,this.kn=i}shadowsOff(){this.sl=!1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0}shadowsOn(){this.sl=!0,this.shadowOffsetX=this.ef,this.shadowOffsetY=this.sf,this.shadowBlur=this.kn}enableDash(t,e){const i=this.U;void 0!==i.setLineDash&&(i.setLineDash(t),i.lineDashOffset=e)}disableDash(){const t=this.U;void 0!==t.setLineDash&&(t.setLineDash(Wt.EmptyArray),t.lineDashOffset=0)}clearContextCache(t){t&&(this.Bb=""),this.zb="",this.Xb=""}removePartFromView(t){}}y(Wt,"EmptyArray",Object.freeze([]));var $t=(t=>(t[t.Solid=1]="Solid",t[t.Linear=2]="Linear",t[t.Radial=3]="Radial",t[t.Pattern=4]="Pattern",t))($t||{}),Jt=(t=>(t[t.Lab=1]="Lab",t[t.HSL=2]="HSL",t[t.Oklch=3]="Oklch",t))(Jt||{});class Zt{constructor(){y(this,"n0",void 0),y(this,"n1",void 0),y(this,"n2",void 0),y(this,"n3",void 0),this.n0=0,this.n1=0,this.n2=0,this.n3=0}}class Qt{constructor(t,e){if(y(this,"h",void 0),y(this,"_",void 0),y(this,"Pa",void 0),y(this,"ei",void 0),y(this,"ps",void 0),y(this,"W0",void 0),y(this,"J0",void 0),y(this,"Pn",void 0),y(this,"$0",void 0),y(this,"xn",void 0),y(this,"Zc",void 0),y(this,"Ib",void 0),k.Yi(this),this.h=!1,void 0===t)this._=1,this.Pa="black";else if("string"==typeof t){const e=d.Eh($t,t);null!==e?(this._=e,this.Pa="black"):(this._=1,this.Pa=t)}else this._=t,this.Pa="black";const i=this._;if(2===i?(this.ei=O.TopCenter,this.ps=O.BottomCenter):3===i?(this.ei=O.Center,this.ps=O.Center):(this.ei=O.None,this.ps=O.None),this.W0=0,this.J0=NaN,this.Pn=null,this.$0=null,this.xn=null,this.Zc=0,this.Ib=0,e){const t={};for(const i in e)isFinite(parseFloat(i))?this.addColorStop(parseFloat(i),e[i]):t[i]=e[i];Object.assign(this,t)}}copy(){const t=new Qt;return t._=this._,t.Pa=this.Pa,t.ei=this.ei.N(),t.ps=this.ps.N(),t.W0=this.W0,t.J0=this.J0,null!==this.Pn&&(t.Pn=this.Pn.copy()),t.$0=this.$0,t}g(){return this.h=!0,null!==this.Pn&&this.Pn.g(),this}lt(){return Object.isFrozen(this)&&d.o("cannot thaw constant: "+this),this.h=!1,null!==this.Pn&&this.Pn.lt(),this}li(t){t in $t?this.type=t:d.ar(this,t)}toString(){let t="Brush(";if(1===this.type)t+=this.color;else if(2===this.type?t+="Linear ":3===this.type?t+="Radial ":4===this.type?t+="Pattern ":t+="(unknown) ",t+=this.start+" "+this.end,null!==this.colorStops){const e=this.colorStops.iterator;for(;e.next();){t+=" "+e.key+":"+e.value}}return t+=")",t}addColorStop(t,e){return this.h&&d.D(this),("number"!=typeof t||!isFinite(t)||t>1||t<0)&&d.tt(t,"0 <= loc <= 1",Qt,"addColorStop:loc"),d.i(e,"string",Qt,"addColorStop:color"),null===this.Pn&&(this.Pn=new L),this.Pn.add(t,e),1===this._&&(this.type=2),this.xn=null,this}get type(){return this._}set type(t){this.h&&d.D(this,t),this._=t,this.start.isNoSpot()&&(2===t?this.start=O.TopCenter:3===t&&(this.start=O.Center)),this.end.isNoSpot()&&(2===t?this.end=O.BottomCenter:3===t&&(this.end=O.Center)),this.xn=null}get color(){return this.Pa}set color(t){this.h&&d.D(this,t),this.Pa=t,this.xn=null}get start(){return this.ei}set start(t){this.h&&d.D(this,t),this.ei=t.N(),this.xn=null}get end(){return this.ps}set end(t){this.h&&d.D(this,t),this.ps=t.N(),this.xn=null}get startRadius(){return this.W0}set startRadius(t){this.h&&d.D(this,t),t<0&&d.tt(t,">= zero",Qt,"startRadius"),this.W0=t,this.xn=null}get endRadius(){return this.J0}set endRadius(t){this.h&&d.D(this,t),t<0&&d.tt(t,">= zero",Qt,"endRadius"),this.J0=t,this.xn=null}get colorStops(){return this.Pn}set colorStops(t){this.h&&d.D(this,t),this.Pn=t,this.xn=null}get pattern(){return this.$0}set pattern(t){this.h&&d.D(this,t),this.$0=t,this.xn=null}static randomColor(t,e){void 0===t&&(t=128),void 0===e&&(e=Math.max(t,255));const i=Math.abs(e-t);let n=Math.floor(t+Math.random()*i).toString(16),s=Math.floor(t+Math.random()*i).toString(16),o=Math.floor(t+Math.random()*i).toString(16);return n.length<2&&(n="0"+n),s.length<2&&(s="0"+s),o.length<2&&(o="0"+o),"#"+n+s+o}static isValidColor(t){return!c.CSS||c.CSS.supports("color",t)}static lighten(t){return Qt.lightenBy(t)}lightenBy(t,e){this.h&&d.D(this);const i=void 0===t||"number"!=typeof t?.2:t,n=void 0===e?3:e;if(1===this.type)Qt.Ro(this.color),this.color=Qt.ld(i,n);else if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops.iterator;for(;t.next();)Qt.Ro(t.value),this.addColorStop(t.key,Qt.ld(i,n))}return this}static lightenBy(t,e,i){const n=void 0===e||"number"!=typeof e?.2:e,s=void 0===i?3:i;return Qt.Ro(t),Qt.ld(n,s)}static darken(t){return Qt.darkenBy(t)}darkenBy(t,e){this.h&&d.D(this);const i=void 0===t||"number"!=typeof t?.2:t,n=void 0===e?3:e;if(1===this.type)Qt.Ro(this.color),this.color=Qt.ld(-i,n);else if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops.iterator;for(;t.next();)Qt.Ro(t.value),this.addColorStop(t.key,Qt.ld(-i,n))}return this}static darkenBy(t,e,i){const n=void 0===e||"number"!=typeof e?.2:e,s=void 0===i?3:i;return Qt.Ro(t),Qt.ld(-n,s)}static mix(t,e,i){Qt.Ro(t);const n=Qt.H.n0,s=Qt.H.n1,o=Qt.H.n2,r=Qt.H.n3;Qt.Ro(e),void 0===i&&(i=.5);const a=Math.round((Qt.H.n0-n)*i+n),l=Math.round((Qt.H.n1-s)*i+s),h=Math.round((Qt.H.n2-o)*i+o),u=Math.round((Qt.H.n3-r)*i+r);return"rgba(".concat(a,", ").concat(l,", ").concat(h,", ").concat(u,")")}isDark(){if(1===this.type)return Qt.isDark(this.color);if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops;if(3===this.type)return Qt.isDark(t.first().value);if(null!==t.get(.5))return Qt.isDark(t.get(.5));if(2===t.count){const e=t.toArray();return Qt.isDark(Qt.mix(e[0].value,e[1].value))}const e=t.iterator;let i=-1,n=-1,s=1,o=1;for(;e.next();){const t=e.key,r=Math.abs(.5-e.key);s>o&&r<s?(i=t,s=r):o>=s&&r<o&&(n=t,o=r)}if(i>n){let t=i;i=n,n=t,t=s,s=o,o=t}const r=n-i;return Qt.isDark(Qt.mix(t.get(i),t.get(n),1-o/r))}return!1}static isDark(t){return!!t&&(t instanceof Qt?t.isDark():(Qt.Ro(t),(299*Qt.H.n0+587*Qt.H.n1+114*Qt.H.n2)/1e3<128))}static ld(t,e){switch(e){case 1:return Qt.UR(),Qt.eo.n0=Math.min(100,Math.max(0,Qt.eo.n0+100*t)),Qt.BR(),"rgba("+Qt.H.n0+", "+Qt.H.n1+", "+Qt.H.n2+", "+Qt.H.n3+")";case 2:return Qt.OM(),Qt.Ii.n2=Math.min(100,Math.max(0,Qt.Ii.n2+100*t)),"hsla("+Qt.Ii.n0+", "+Qt.Ii.n1+"%, "+Qt.Ii.n2+"%, "+Qt.Ii.n3+")";case 3:return Qt.zR(),Qt.so.n0=Math.min(100,Math.max(0,Qt.so.n0+100*t)),Qt.XR(),"rgba("+Qt.H.n0+", "+Qt.H.n1+", "+Qt.H.n2+", "+Qt.H.n3+")";default:d.o("Unknown color space: "+e)}}static Ro(t){const e=Qt.nl;if(null===e)return;e.clearRect(0,0,1,1),e.fillStyle="#000000";const i=e.fillStyle;if(e.fillStyle=t,e.fillStyle!==i){e.fillRect(0,0,1,1);const t=e.getImageData(0,0,1,1).data;Qt.H.n0=t[0],Qt.H.n1=t[1],Qt.H.n2=t[2],Qt.H.n3=t[3]/255}else{e.fillStyle="#FFFFFF";e.fillStyle;e.fillStyle=t,e.fillStyle,Qt.H.n0=0,Qt.H.n1=0,Qt.H.n2=0,Qt.H.n3=1}}static OM(){const t=Qt.H.n0/255,e=Qt.H.n1/255,i=Qt.H.n2/255,n=Math.max(t,e,i),s=Math.min(t,e,i),o=n-s;let r,a;const l=(n+s)/2;if(0===o)r=a=0;else{switch(n){case t:r=(e-i)/o%6;break;case e:r=(i-t)/o+2;break;case i:r=(t-e)/o+4}r*=60,r<0&&(r+=360),a=o/(1-Math.abs(2*l-1))}Qt.Ii.n0=Math.round(r),Qt.Ii.n1=Math.round(100*a),Qt.Ii.n2=Math.round(100*l),Qt.Ii.n3=Qt.H.n3}static fE(){const t=Qt.Ii.n0,e=Qt.Ii.n1/100,i=Qt.Ii.n2/100;let n,s,o;const r=(1-Math.abs(2*i-1))*e,a=t/60,l=r*(1-Math.abs(a%2-1));a>=0&&a<1?(n=r,s=l,o=0):a>=1&&a<2?(n=l,s=r,o=0):a>=2&&a<3?(n=0,s=r,o=l):a>=3&&a<4?(n=0,s=l,o=r):a>=4&&a<5?(n=l,s=0,o=r):a>=5&&a<6&&(n=r,s=0,o=l);const h=i-.5*r;n+=h,s+=h,o+=h,Qt.H.n0=Math.round(255*n),Qt.H.n1=Math.round(255*s),Qt.H.n2=Math.round(255*o),Qt.H.n3=Qt.Ii.n3}static UR(){Qt.lA(),Qt.KR()}static BR(){Qt.YR(),Qt.hA()}static p2(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}static w2(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055}static lA(){const t=Qt.p2(Qt.H.n0),e=Qt.p2(Qt.H.n1),i=Qt.p2(Qt.H.n2);Qt.Rt.n0=.4124564*t+.3575761*e+.1804375*i,Qt.Rt.n1=.2126729*t+.7151522*e+.072175*i,Qt.Rt.n2=.0193339*t+.119192*e+.9503041*i,Qt.Rt.n3=Qt.H.n3}static hA(){const t=3.2404542*Qt.Rt.n0+-1.5371385*Qt.Rt.n1+-.4985314*Qt.Rt.n2,e=-.969266*Qt.Rt.n0+1.8760108*Qt.Rt.n1+.041556*Qt.Rt.n2,i=.0556434*Qt.Rt.n0+-.2040259*Qt.Rt.n1+1.0572252*Qt.Rt.n2;Qt.H.n0=255*Qt.w2(t),Qt.H.n1=255*Qt.w2(e),Qt.H.n2=255*Qt.w2(i),Qt.H.n3=Qt.Rt.n3,Qt.H.n0=Math.round(Qt.H.n0),Qt.H.n0>255?Qt.H.n0=255:Qt.H.n0<0&&(Qt.H.n0=0),Qt.H.n1=Math.round(Qt.H.n1),Qt.H.n1>255?Qt.H.n1=255:Qt.H.n1<0&&(Qt.H.n1=0),Qt.H.n2=Math.round(Qt.H.n2),Qt.H.n2>255?Qt.H.n2=255:Qt.H.n2<0&&(Qt.H.n2=0)}static k2(t){return t>Qt.b2?Math.pow(t,1/3):(Qt.Kb*t+16)/116}static KR(){const t=Qt.k2(100*Qt.Rt.n0/Qt.hd[0]),e=Qt.k2(100*Qt.Rt.n1/Qt.hd[1]),i=Qt.k2(100*Qt.Rt.n2/Qt.hd[2]);Qt.eo.n0=116*e-16,Qt.eo.n1=500*(t-e),Qt.eo.n2=200*(e-i),Qt.eo.n3=Qt.Rt.n3}static aA(t){const e=t*t*t;return e>Qt.b2?e:(116*t-16)/Qt.Kb}static YR(){const t=(Qt.eo.n0+16)/116,e=Qt.eo.n1/500+t,i=t-Qt.eo.n2/200;Qt.Rt.n0=Qt.hd[0]/100*Qt.aA(e),Qt.Rt.n1=Qt.hd[1]/100*(Qt.eo.n0>Qt.Kb*Qt.b2?Math.pow(t,3):Qt.eo.n0/Qt.Kb),Qt.Rt.n2=Qt.hd[2]/100*Qt.aA(i),Qt.Rt.n3=Qt.eo.n3}static GR(){let t=.8190224*Qt.Rt.n0+.3619062*Qt.Rt.n1+-.1288737*Qt.Rt.n2,e=.03298366*Qt.Rt.n0+.9292868*Qt.Rt.n1+.03614466*Qt.Rt.n2,i=.04817719*Qt.Rt.n0+.2642395*Qt.Rt.n1+.6335478*Qt.Rt.n2;t=Math.cbrt(t),e=Math.cbrt(e),i=Math.cbrt(i),Qt.fi.n0=.2104542*t+.7936177*e+-.004072046*i,Qt.fi.n1=1.977998*t+-2.428592*e+.4505937*i,Qt.fi.n2=.02590403*t+.7827717*e+-.8086757*i,Qt.fi.n3=Qt.Rt.n3,Qt.fi.n0*=100}static HR(){Qt.fi.n0/=100;let t=.9999999*Qt.fi.n0+.3963377*Qt.fi.n1+.2158037*Qt.fi.n2,e=1.000000009*Qt.fi.n0+-.1055613*Qt.fi.n1+-.06385417*Qt.fi.n2,i=1.00000005*Qt.fi.n0+-.08948418*Qt.fi.n1+-1.291485*Qt.fi.n2;t=t**3,e=e**3,i=i**3,Qt.Rt.n0=1.2268798*t+-.5578149*e+.281391*i,Qt.Rt.n1=-.04057576*t+1.112286*e+-.07171106*i,Qt.Rt.n2=-.07637294*t+-.4214933*e+1.586924*i,Qt.Rt.n3=Qt.fi.n3}static jR(){const t=180*Math.atan2(Qt.fi.n2,Qt.fi.n1)/Math.PI;Qt.so.n0=Qt.fi.n0,Qt.so.n1=Math.sqrt(Qt.fi.n1**2+Qt.fi.n2**2),Qt.so.n2=t>=0?t:t+360,Qt.so.n3=Qt.fi.n3}static qR(){Qt.fi.n0=Qt.so.n0,Qt.fi.n1=Qt.so.n1*Math.cos(Qt.so.n2*Math.PI/180),Qt.fi.n2=Qt.so.n1*Math.sin(Qt.so.n2*Math.PI/180),Qt.fi.n3=Qt.so.n3}static zR(){Qt.lA(),Qt.GR(),Qt.jR()}static XR(){Qt.qR(),Qt.HR(),Qt.hA()}static od(t,e){"string"==typeof t||t instanceof Qt||d.o("Value for "+e+" must be a color string or a Brush, not "+t)}}y(Qt,"b2",216/24389),y(Qt,"Kb",24389/27),y(Qt,"hd",[95.047,100,108.883]),y(Qt,"Solid",1),y(Qt,"Linear",2),y(Qt,"Radial",3),y(Qt,"Pattern",4),y(Qt,"Lab",1),y(Qt,"HSL",2),y(Qt,"nl",Dt.isUsingDOM()?new qt(null,void 0,{willReadFrequently:!0}).ci:null),y(Qt,"H",new Zt),y(Qt,"Ii",new Zt),y(Qt,"Rt",new Zt),y(Qt,"eo",new Zt),y(Qt,"fi",new Zt),y(Qt,"so",new Zt);class te{static definePanelLayout(t,e){e.name=t,te.Layouts.add(t,e)}get name(){return this.St}set name(t){this.St=t}constructor(){y(this,"St","Base")}get classType(){return ie}measure(t,e,i,n,s,o,r){}measureElement(t,e,i,n,s){t.ut(e,i,n,s)}arrange(t,e,i){}arrangeElement(t,e,i,n,s,o){t.zt(e,i,n,s,o)}remeasureObject(t){t.Qc()}Gi(t,e,i){}}y(te,"Layouts",new L);te.definePanelLayout("Position",new class extends te{constructor(){super()}measure(t,e,i,n,s,o,r){const a=n.length,l=t.Go();for(let h=0;h<a;h++){const t=n[h];if(!t.visible&&t!==l)continue;const a=t.margin,u=a.right+a.left,c=a.top+a.bottom;t.ut(e,i,o,r);const d=t.measuredBounds,f=Math.max(d.width+u,0),g=Math.max(d.height+c,0);let m=t.position.x,p=t.position.y;if(isFinite(m)||(m=0),isFinite(p)||(p=0),t instanceof le&&t.isGeometryPositioned){const e=t.strokeWidth/2;m-=e,p-=e}s.unionNoCheck(m,p,f,g)}}arrange(t,e,i){const n=e.length,s=t.padding,o=i.x-s.left,r=i.y-s.top;for(let a=0;a<n;a++){const t=e[a],i=t.measuredBounds,n=t.margin,s=t.position.x,l=t.position.y;let h=isNaN(s)?-o:s-o,u=isNaN(l)?-r:l-r;if(t instanceof le&&t.isGeometryPositioned){const e=t.strokeWidth/2;h-=e,u-=e}t.visible&&t.zt(h+n.left,u+n.top,i.width,i.height)}}});te.definePanelLayout("Horizontal",new class extends te{constructor(){super()}measure(t,e,i,n,s,o,r){const a=n.length,l=d.rt(),h=t.Go();for(let c=0;c<a;c++){const t=n[c];if(!t.visible&&t!==h)continue;const e=t.Xs(!1);if(0!==e&&5!==e){l.push(t);continue}t.ut(1/0,i,0,r);const o=t.margin,a=t.measuredBounds,u=Math.max(a.width+o.right+o.left,0),d=Math.max(a.height+o.top+o.bottom,0);s.width+=u,s.height=Math.max(s.height,d)}const u=l.length;t.desiredSize.height?i=Math.min(t.desiredSize.height,t.maxSize.height):0!==s.height&&(i=Math.min(s.height,t.maxSize.height));for(let c=0;c<u;c++){const t=l[c];if(!t.visible&&t!==h)continue;const e=t.margin,n=e.right+e.left,o=e.top+e.bottom;t.ut(1/0,i,0,r);const a=t.measuredBounds,u=Math.max(a.width+n,0),d=Math.max(a.height+o,0);s.width+=u,s.height=Math.max(s.height,d)}d.it(l)}arrange(t,e,i){const n=e.length,s=t.padding,o=s.top,r=t.isOpposite;let a=r?i.width:s.left;for(let l=0;l<n;l++){const n=o,h=e[l];if(!h.visible)continue;const u=h.measuredBounds,c=h.margin,d=c.top+c.bottom,f=o+s.bottom;let g=u.height;const m=h.Xs(!1);(isNaN(h.desiredSize.height)&&2===m||4===m)&&(g=Math.max(i.height-d-f,0));const p=g+d+f;let y=h.alignment;y.isDefault()&&(y=t.defaultAlignment),y.isSpot()||(y=O.Center),r&&(a-=u.width+c.left+c.right),h.zt(a+y.offsetX+c.left,n+y.offsetY+c.top+(i.height*y.y-p*y.y),u.width,g),r||(a+=u.width+c.left+c.right)}}});te.definePanelLayout("Vertical",new class extends te{constructor(){super()}measure(t,e,i,n,s,o,r){const a=n.length,l=d.rt(),h=t.Go();for(let c=0;c<a;c++){const t=n[c];if(!t.visible&&t!==h)continue;const i=t.Xs(!1);if(0!==i&&4!==i){l.push(t);continue}const r=t.margin,a=r.right+r.left,u=r.top+r.bottom;t.ut(e,1/0,o,0);const d=t.measuredBounds,f=Math.max(d.width+a,0),g=Math.max(d.height+u,0);s.So(Math.max(s.width,f),s.height+g)}const u=l.length;if(0!==u){t.desiredSize.width?e=Math.min(t.desiredSize.width,t.maxSize.width):0!==s.width&&(e=Math.min(s.width,t.maxSize.width));for(let t=0;t<u;t++){const i=l[t];if(!i.visible&&i!==h)continue;const n=i.margin,r=n.right+n.left,a=n.top+n.bottom;i.ut(e,1/0,o,0);const u=i.measuredBounds,c=Math.max(u.width+r,0),d=Math.max(u.height+a,0);s.width=Math.max(s.width,c),s.height+=d}d.it(l)}}arrange(t,e,i){const n=e.length,s=t.padding,o=s.left,r=t.isOpposite;let a=r?i.height:s.top;for(let l=0;l<n;l++){const n=o,h=e[l];if(!h.visible)continue;const u=h.measuredBounds,c=h.margin,d=c.left+c.right,f=o+s.right;let g=u.width;const m=h.Xs(!1);(isNaN(h.desiredSize.width)&&2===m||5===m)&&(g=Math.max(i.width-d-f,0));const p=g+d+f;let y=h.alignment;y.isDefault()&&(y=t.defaultAlignment),y.isSpot()||(y=O.Center),r&&(a-=u.height+c.bottom+c.top),h.zt(n+y.offsetX+c.left+(i.width*y.x-p*y.x),a+y.offsetY+c.top,g,u.height),r||(a+=u.height+c.bottom+c.top)}}});te.definePanelLayout("Spot",new class extends te{constructor(){super()}measure(t,e,i,n,s,o,r){const a=n.length;if(0===a)return;const l=t.findMainElement();let h=l.margin,u=0,c=0;const d=h.right+h.left,f=h.top+h.bottom;l.ut(e,i,o,r);let g=l.measuredBounds,m=g.width,p=g.height,y=Math.max(m+d,0),v=Math.max(p+f,0);const b=t.isClipping,x=D.X(-h.left,-h.top,y,v);let w=D.X(0,0,m,p);this.P2(l,w,!0),m=w.width,p=w.height;let k=!0;const S=t.Go();let P;for(let M=0;M<a;M++){const o=n[M];let r=e,a=i;if(o===l||!o.visible&&o!==S)continue;h=o.margin;let d=h.left,f=h.top;switch(u=h.right+h.left,c=h.top+h.bottom,P=o.Xs(!1),P){case 2:r=m,a=p,u=0,c=0,d=0,f=0;break;case 5:r=m,u=0,d=0;break;case 4:a=p,c=0,f=0}o.ut(r,a,0,0),g=o.measuredBounds,y=Math.max(g.width+u,0),v=Math.max(g.height+c,0);let b=o.alignment;b.isDefault()&&(b=t.defaultAlignment),b.isSpot()||(b=O.Center);let x=o.alignmentFocus;x.isDefault()&&(x=O.Center);let C=null;o instanceof ie&&""!==o.no&&(C=o.findObject(o.no),C===o&&(C=null));let N=w.x-d,L=w.y-f;if(null!==C){o.zt(0,0,g.width,g.height);const t=C.actualBounds,e=T.X(t.x+(x.x*t.width-x.offsetX),t.y+(x.y*t.height-x.offsetY));for(C=C.panel;C!==o;)C.L.xt(e),C=C.panel;N+=b.x*m+b.offsetX-e.x,L+=b.y*p+b.offsetY-e.y,T.s(e)}else N+=b.x*m+b.offsetX-(x.x*g.width+x.offsetX),L+=b.y*p+b.offsetY-(x.y*g.height+x.offsetY);k?(k=!1,s.e(N,L,y,v)):s.unionNoCheck(N,L,y,v)}switch(k?s.a(x):b?s.intersect(w.x,w.y,w.width,w.height):s.unionNoCheck(x.x,x.y,x.width,x.height),D.s(x),D.s(w),P=l.stretch,1===P&&(P=l.Xs(!1)),P){case 0:return;case 2:if(!isFinite(e)&&!isFinite(i))return;break;case 5:if(!isFinite(e))return;break;case 4:if(!isFinite(i))return}g=l.measuredBounds,m=g.width,p=g.height,y=Math.max(m+d,0),v=Math.max(p+f,0),h=l.margin,w=D.X(-h.left,-h.top,y,v),this.P2(l,w,!0),m=w.width,p=w.height;for(let M=0;M<a;M++){const e=n[M];if(e===l||!e.visible&&e!==S)continue;h=e.margin,u=h.right+h.left,c=h.top+h.bottom,g=e.measuredBounds,y=Math.max(g.width+u,0),v=Math.max(g.height+c,0);let i=e.alignment;i.isDefault()&&(i=t.defaultAlignment),i.isSpot()||(i=O.Center);let o=e.alignmentFocus;o.isDefault()&&(o=O.Center),k?(k=!1,s.e(i.x*m+i.offsetX-(o.x*g.width+o.offsetX)-h.left,i.y*p+i.offsetY-(o.y*g.height+o.offsetY)-h.top,y,v)):s.unionNoCheck(i.x*m+i.offsetX-(o.x*g.width+o.offsetX)-h.left,i.y*p+i.offsetY-(o.y*g.height+o.offsetY)-h.top,y,v)}k?s.a(x):b?s.intersect(w.x,w.y,w.width,w.height):s.unionNoCheck(x.x,x.y,x.width,x.height),D.s(w)}arrange(t,e,i){const n=e.length;if(0===n)return;const s=t.findMainElement(),o=s.measuredBounds,r=o.width,a=o.height,l=t.padding,h=l.left,u=l.top;let c=h-i.x,d=u-i.y;s.zt(c,d,r,a);const f=D.X(0,0,r,a);this.P2(s,f,!1);for(let g=0;g<n;g++){const n=e[g];if(n===s)continue;const o=n.measuredBounds,r=o.width,a=o.height;let l=n.alignment;l.isDefault()&&(l=t.defaultAlignment),l.isSpot()||(l=O.Center);let m=n.alignmentFocus;m.isDefault()&&(m=O.Center);let p=null;if(n instanceof ie&&""!==n.no&&(p=n.findObject(n.no),p===n&&(p=null)),null!==p){const t=p.actualBounds,e=T.X(t.x+(m.x*t.width-m.offsetX),t.y+(m.y*t.height-m.offsetY));for(p=p.panel;p!==n;)p.L.xt(e),p=p.panel;c=l.x*f.width+l.offsetX-e.x,d=l.y*f.height+l.offsetY-e.y,T.s(e)}else c=l.x*f.width+l.offsetX-(m.x*r+m.offsetX),d=l.y*f.height+l.offsetY-(m.y*a+m.offsetY);c+=f.x-i.x,d+=f.y-i.y,n.visible&&n.zt(h+c,u+d,r,a)}D.s(f)}P2(t,e,i){let n=null;if(t instanceof ie&&""!==t.no&&(n=t.findObject(t.no),n===t&&(n=null)),null!==n)for(i&&t.zt(0,0,e.width,e.height),e.a(n.actualBounds),n=n.panel;n!==t;)n.L.ww(e),n=n.panel}});te.definePanelLayout("Auto",new class extends te{constructor(){super()}measure(t,e,i,n,s,o,r){const a=n.length;if(0===a)return;const l=t.findMainElement();let h=l.margin,u=e,c=i;const d=h.right+h.left,f=h.top+h.bottom;l.ut(e,i,o,r);let g=l.measuredBounds,m=0,p=null;l instanceof le&&(p=l,m=p.strokeWidth*p.scale);let y=Math.max(g.width+d,0),v=Math.max(g.height+f,0),b=t.M2(l);const x=b.x*y+b.offsetX,w=b.y*v+b.offsetY;let k=t.S2(l);const S=k.x*y+k.offsetX,P=k.y*v+k.offsetY;isFinite(e)&&(u=Math.max(Math.abs(x-S)-m,0)),isFinite(i)&&(c=Math.max(Math.abs(w-P)-m,0));let M=0,C=0;o>0&&(M=Math.max(Math.abs(b.x*o+b.offsetX-(k.x*o+k.offsetX))-m,0)),r>0&&(C=Math.max(Math.abs(b.y*r+b.offsetY-(k.y*r+k.offsetY))-m,0));const N=A.l();N.e(0,0);const L=t.Go();for(let A=0;A<a;A++){const t=n[A];if(t===l||!t.visible&&t!==L)continue;h=t.margin;const e=h.right+h.left,i=h.top+h.bottom;t.ut(u,c,M,C),g=t.measuredBounds,y=Math.max(g.width+e,0),v=Math.max(g.height+i,0),N.e(Math.max(y,N.width),Math.max(v,N.height))}if(1===a)return g=l.measuredBounds,s.width=y,s.height=v,void A.s(N);b=t.M2(l),k=t.S2(l);let T=0,D=0;k.x!==b.x&&k.y!==b.y&&(T=N.width/Math.abs(k.x-b.x),D=N.height/Math.abs(k.y-b.y)),A.s(N),m=0,null!==p&&(m=p.strokeWidth*p.scale,6===p._P()&&(T=D=Math.max(T,D))),T+=Math.abs(b.offsetX)+Math.abs(k.offsetX)+m,D+=Math.abs(b.offsetY)+Math.abs(k.offsetY)+m;let F=l.stretch;switch(1===F&&(F=l.Xs(!1)),F){case 0:o=0,r=0;break;case 2:isFinite(e)&&(T=e),isFinite(i)&&(D=i);break;case 5:isFinite(e)&&(T=e),r=0;break;case 4:o=0,isFinite(i)&&(D=i)}l.Qc(),l.ut(T,D,o,r),s.width=l.measuredBounds.width+d,s.height=l.measuredBounds.height+f}arrange(t,e,i){const n=e.length;if(0===n)return;const s=t.findMainElement(),o=s.measuredBounds,r=D.l();r.e(0,0,1,1);let a=s.margin;const l=a.left,h=a.top,u=t.padding,c=u.left,d=u.top;let f=l,g=h,m=o.width,p=o.height;s.zt(c+f,d+g,m,p);const y=t.M2(s),v=t.S2(s),b=0+y.x*o.width+y.offsetX,x=0+y.y*o.height+y.offsetY,w=0+v.x*o.width+v.offsetX,k=0+v.y*o.height+v.offsetY;r.x=b,r.y=x,r.unionNoCheck(w,k,0,0),r.x+=l+c,r.y+=h+d;for(let S=0;S<n;S++){const i=e[S];if(i===s)continue;const n=i.measuredBounds;a=i.margin;const o=Math.max(n.width+a.right+a.left,0),l=Math.max(n.height+a.top+a.bottom,0);let h=i.alignment;h.isDefault()&&(h=t.defaultAlignment),h.isSpot()||(h=O.Center),f=r.width*h.x+h.offsetX-o*h.x+a.left+r.x,g=r.height*h.y+h.offsetY-l*h.y+a.top+r.y,m=r.width,p=r.height,i.visible&&(D.contains(r.x,r.y,r.width,r.height,f,g,n.width,n.height)?i.zt(f,g,n.width,n.height):i.zt(f,g,n.width,n.height,new D(r.x,r.y,r.width,r.height)))}D.s(r)}});te.definePanelLayout("Table",new class extends te{constructor(){super(),this.name="Table"}measure(t,e,i,n,s,o,r){let a=n.length;const l=d.rt(),h=d.rt();for(let d=0;d<a;d++){const t=n[d],e=t instanceof ie?t:null;if(null!==e&&e.el()&&t.visible){h.push(e);const i=e.T.r,n=i.length;for(let s=0;s<n;s++){const n=i[s];e.type===ie.TableRow?n.row=t.row:e.type===ie.TableColumn&&(n.column=t.column),l.push(n)}}else l.push(t)}a=l.length,0===a&&(t.getRowDefinition(0),t.getColumnDefinition(0));const u=[];for(let d=0;d<a;d++){const t=l[d];t.visible&&(t.ne(!0),t.to(!0),u[t.row]||(u[t.row]=[]),u[t.row][t.column]||(u[t.row][t.column]=[]),u[t.row][t.column].push(t))}d.it(l);const c=d.rt(),f=d.rt(),g=d.rt(),m={count:0},p={count:0};let y=e,v=i;const b=t.He,x=t.je;let w=null;a=b.length;for(let d=0;d<a;d++)w=b[d],void 0!==w&&(w.actual=0);a=x.length;for(let d=0;d<a;d++)w=x[d],void 0!==w&&(w.actual=0);let k=u.length,S=0;for(let d=0;d<k;d++)u[d]&&(S=Math.max(S,u[d].length));const P=Math.min(t.topIndex,k-1),M=Math.min(t.leftIndex,S-1);let C,N=0;k=u.length;const L=t.Go();for(let d=0;d<k;d++){if(!u[d])continue;S=u[d].length;const e=t.getRowDefinition(d);e.actual=0,e.Hi=0;for(let i=0;i<S;i++){if(!u[d][i])continue;const n=t.getColumnDefinition(i);void 0===c[i]&&(n.actual=0,n.Hi=0,c[i]=!0);const s=u[d][i],o=s.length;for(let r=0;r<o;r++){const o=s[r];if(!o.visible&&o!==L)continue;const a=o.rowSpan>1,l=o.columnSpan>1;(a||l)&&!(d<P)&&!(i<M)&&f.push(o);const h=o.margin,u=h.right+h.left,c=h.top+h.bottom;C=o.S0(e,n,!1);const b=o.desiredSize,x=!isNaN(b.width),k=!isNaN(b.height);if(0!==C&&!(x&&k)&&!(d<P)&&!(i<M)&&(!l&&void 0===m[i]&&(2===C||5===C)&&(m[i]=-1,m.count++),!a&&void 0===p[d]&&(2===C||4===C)&&(p[d]=-1,p.count++),!a&&!l&&g.push(o)),o.ut(1/0,1/0,0,0),d<P||i<M)continue;const S=o.measuredBounds,T=Math.max(S.width+u,0),A=Math.max(S.height+c,0);if(1===o.rowSpan&&(0===C||5===C)){w=t.getRowDefinition(d);const e=w.computeEffectiveSpacing(),i=0===w.ot;N=Math.max(A-w.actual,0),N+(i?e:0)>v&&(N=Math.max(v-e,0)),w.Hi=w.Hi+N,w.actual=w.ot+N,v=Math.max(v-(N+(i?e:0)),0)}if(1===o.columnSpan&&(0===C||4===C)){w=t.getColumnDefinition(i);const e=w.computeEffectiveSpacing(),n=0===w.ot;N=Math.max(T-w.actual,0),N+(n?e:0)>y&&(N=Math.max(y-e,0)),w.Hi=w.Hi+N,w.actual=w.ot+N,y=Math.max(y-(N+(n?e:0)),0)}(a||l)&&o.Qc()}}}d.it(c);let T=0,D=0;a=t.columnCount;for(let d=0;d<a;d++){const t=x[d];void 0!==t&&(T+=isNaN(t.pe)?t.Hi:t.pe,0!==t.Hi&&(T+=t.computeEffectiveSpacing()))}a=t.rowCount;for(let d=0;d<a;d++){const t=b[d];void 0!==t&&(D+=isNaN(t.pe)?t.Hi:t.pe,0!==t.Hi&&(D+=t.computeEffectiveSpacing()))}y=Math.max(e-T,0),v=Math.max(i-D,0);let F=v,O=y;a=g.length;for(let d=0;d<a;d++){const e=g[d],i=t.getRowDefinition(e.row),n=t.getColumnDefinition(e.column),s=e.measuredBounds,o=e.margin,r=o.right+o.left,a=o.top+o.bottom;0===n.Hi&&void 0!==m[e.column]?m[e.column]=Math.max(s.width+r,m[e.column]):m[e.column]=null,0===i.Hi&&void 0!==p[e.row]?p[e.row]=Math.max(s.height+a,p[e.row]):p[e.row]=null}let R,E=0,B=0;for(R in p)"count"!==R&&(E+=p[R]);for(R in m)"count"!==R&&(B+=m[R]);const I=A.l();for(let d=0;d<a;d++){const e=g[d];if(!e.visible&&e!==L)continue;const i=t.getRowDefinition(e.row),n=t.getColumnDefinition(e.column);let s=0;isFinite(n.width)?s=n.width:(s=isFinite(y)&&null!==m[e.column]?0===B?n.actual+y:m[e.column]/B*O:null!==m[e.column]?y:n.actual||y,s=Math.max(0,s-n.computeEffectiveSpacing()));let o=0;switch(isFinite(i.height)?o=i.height:(o=isFinite(v)&&null!==p[e.row]?0===E?i.actual+v:p[e.row]/E*F:null!==p[e.row]?v:i.actual||v,o=Math.max(0,o-i.computeEffectiveSpacing())),I.e(Math.max(n.minimum,Math.min(s,n.maximum)),Math.max(i.minimum,Math.min(o,i.maximum))),C=e.S0(i,n,!1),C){case 5:I.height=Math.max(I.height,i.actual+v);break;case 4:I.width=Math.max(I.width,n.actual+y)}const r=e.margin,a=r.right+r.left,l=r.top+r.bottom;e.Qc();let h=n.minimum,u=i.minimum;const c=e.measuredBounds;0===c.width&&null!==m[e.column]&&(h=Math.max(h,m[e.column])),0===c.height&&null!==p[e.row]&&(u=Math.max(h,p[e.row])),e.ut(I.width,I.height,h,u);const f=e.measuredBounds;let b=Math.max(f.width+a,0),x=Math.max(f.height+l,0);isFinite(y)&&(b=Math.min(b,I.width)),isFinite(v)&&(x=Math.min(x,I.height));let w=0;w=i.actual,i.actual=Math.max(i.actual,x),i.Hi=Math.max(i.Hi,x),N=i.actual-w,v=Math.max(v-N,0),null===p[e.row]&&(F=Math.max(F-N,0)),w=n.actual,n.actual=Math.max(n.actual,b),n.Hi=Math.max(n.Hi,b),N=n.actual-w,y=Math.max(y-N,0),null===m[e.column]&&(O=Math.max(O-N,0))}d.it(g);const V=A.l(),z=d.rt(),j=d.rt();if(a=f.length,0!==a)for(let d=0;d<k;d++){if(!u[d])continue;S=u[d].length;const e=t.getRowDefinition(d);z[d]=e.actual;for(let i=0;i<S;i++){if(!u[d][i])continue;const e=t.getColumnDefinition(i);j[i]=e.actual}}for(let d=0;d<a;d++){const n=f[d];if(!n.visible&&n!==L)continue;const s=t.getRowDefinition(n.row),o=t.getColumnDefinition(n.column);switch(I.e(Math.max(o.minimum,Math.min(e,o.maximum)),Math.max(s.minimum,Math.min(i,s.maximum))),C=n.S0(s,o,!1),C){case 2:0!==j[o.index]&&(I.width=Math.min(I.width,j[o.index])),0!==z[s.index]&&(I.height=Math.min(I.height,z[s.index]));break;case 5:0!==j[o.index]&&(I.width=Math.min(I.width,j[o.index]));break;case 4:0!==z[s.index]&&(I.height=Math.min(I.height,z[s.index]))}isFinite(o.width)&&(I.width=o.width),isFinite(s.height)&&(I.height=s.height),V.e(0,0);let r=o.minimum,a=s.minimum;for(let e=1;e<n.rowSpan&&!(n.row+e>=t.rowCount);e++)w=t.getRowDefinition(n.row+e),N=0,N=2===C||4===C?Math.max(w.minimum,0===z[n.row+e]?w.maximum:Math.min(z[n.row+e],w.maximum)):Math.max(w.minimum,isNaN(w.pe)?w.maximum:Math.min(w.pe,w.maximum)),V.height+=N,a+=w.minimum;for(let e=1;e<n.columnSpan&&!(n.column+e>=t.columnCount);e++)w=t.getColumnDefinition(n.column+e),N=0,N=2===C||5===C?Math.max(w.minimum,0===j[n.column+e]?w.maximum:Math.min(j[n.column+e],w.maximum)):Math.max(w.minimum,isNaN(w.pe)?w.maximum:Math.min(w.pe,w.maximum)),V.width+=N,r+=w.minimum;I.width+=V.width,I.height+=V.height;const l=n.margin,h=l.right+l.left,u=l.top+l.bottom;n.ut(I.width,I.height,r,a);const c=n.measuredBounds,g=Math.max(c.width+h,0),m=Math.max(c.height+u,0);let p=0;for(let e=0;e<n.rowSpan&&!(n.row+e>=t.rowCount);e++)w=t.getRowDefinition(n.row+e),p+=w.total||0;if(p<m){let e=m-p;const i=m-p;if(null!==n.spanAllocation){const s=n.spanAllocation;for(let o=0;o<n.rowSpan&&!(e<=0||n.row+o>=t.rowCount);o++){w=t.getRowDefinition(n.row+o);const r=w.ot||0,a=s(n,w,i);w.actual=Math.min(w.maximum,r+a),w.ot!==r&&(e-=w.ot-r)}}for(;e>0;){const i=w.ot||0;if(isNaN(w.height)&&w.maximum>i&&(w.actual=Math.min(w.maximum,i+e),w.ot!==i&&(e-=w.ot-i)),0===w.index)break;w=t.getRowDefinition(w.index-1)}}let y=0;for(let e=0;e<n.columnSpan&&!(n.column+e>=t.columnCount);e++)w=t.getColumnDefinition(n.column+e),y+=w.total||0;if(y<g){let e=g-y;const i=g-y;if(null!==n.spanAllocation){const s=n.spanAllocation;for(let o=0;o<n.columnSpan&&!(e<=0||n.column+o>=t.columnCount);o++){w=t.getColumnDefinition(n.column+o);const r=w.ot||0,a=s(n,w,i);w.actual=Math.min(w.maximum,r+a),w.ot!==r&&(e-=w.ot-r)}}for(;e>0;){const i=w.ot||0;if(isNaN(w.width)&&w.maximum>i&&(w.actual=Math.min(w.maximum,i+e),w.ot!==i&&(e-=w.ot-i)),0===w.index)break;w=t.getColumnDefinition(w.index-1)}}}d.it(f),A.s(V),A.s(I),void 0!==z&&d.it(z),void 0!==j&&d.it(j);let U=0,K=0;const G=t.desiredSize,X=t.maxSize;C=t.Xs(!0),T=0,D=0;let Y=0,_=0;a=t.columnCount;for(let d=0;d<a;d++)if(void 0!==x[d]){if(w=t.getColumnDefinition(d),isFinite(w.width)){Y+=w.width,Y+=w.computeEffectiveSpacing();continue}if(2===w.Yb()){Y+=w.ot,Y+=w.computeEffectiveSpacing();continue}0!==w.ot&&(T+=w.ot,T+=w.computeEffectiveSpacing())}U=isFinite(G.width)?Math.min(G.width,X.width):0!==C&&isFinite(e)?e:T,U=Math.max(U,isFinite(e)?Math.min(o,e):o),U=Math.max(U-Y,0);const H=0===T?1:Math.max(U/T,1);for(let d=0;d<a;d++)void 0!==x[d]&&(w=t.getColumnDefinition(d),!isFinite(w.width)&&2!==w.Yb()&&(w.actual=w.ot*H),w.position=s.width,0!==w.ot&&(s.width+=w.ot,s.width+=w.computeEffectiveSpacing()));a=t.rowCount;for(let d=0;d<a;d++)if(void 0!==b[d]){if(w=t.getRowDefinition(d),isFinite(w.height)){_+=w.height,_+=w.computeEffectiveSpacing();continue}if(2===w.Yb()){_+=w.ot,_+=w.computeEffectiveSpacing();continue}0!==w.ot&&(D+=w.ot,D+=w.computeEffectiveSpacing())}K=isFinite(G.height)?Math.min(G.height,X.height):0!==C&&isFinite(i)?i:D,K=Math.max(K,isFinite(i)?Math.min(r,i):r),K=Math.max(K-_,0);const q=0===D?1:Math.max(K/D,1);for(let d=0;d<a;d++)void 0!==b[d]&&(w=t.getRowDefinition(d),!isFinite(w.height)&&2!==w.Yb()&&(w.actual=w.ot*q),w.position=s.height,0!==w.ot&&(s.height+=w.ot,s.height+=w.computeEffectiveSpacing()));a=h.length;for(let d=0;d<a;d++){const e=h[d];let i=0,n=0;e.type===ie.TableRow?(i=s.width,w=t.getRowDefinition(e.row),n=w.actual):(w=t.getColumnDefinition(e.column),i=w.actual,n=s.height),e.measuredBounds.e(0,0,i,n),e.ne(!1)}d.it(h),t.mh=u}arrange(t,e,i){const n=e.length,s=t.padding,o=s.left,r=s.top,a=t.mh;if(null===a)return;let l=0,h=0;const u=a.length;let c=0;for(let P=0;P<u;P++)a[P]&&(c=Math.max(c,a[P].length));const d=t.He,f=t.je;let g=0,m=0,p=Math.min(t.topIndex,u-1);if(d.length>0){for(;p!==u&&(void 0===d[p]||0===d[p].ot);)p++;p=Math.max(Math.min(p,u-1),0),g=-d[p].position}let y=Math.min(t.leftIndex,c-1);if(f.length>0){for(;y!==c&&(void 0===f[y]||0===f[y].ot);)y++;y=Math.max(Math.min(y,c-1),0),m=-f[y].position}let v=0,b=0;for(;v!==u&&void 0===d[v];)v++;for(;b!==u&&void 0===f[b];)b++;const x=t.part;let w=t.getRowDefinition(v),k=t.getColumnDefinition(b);for(let P=0;P<e.length;P++){const i=e[P];if(!(i instanceof ie&&i.visible&&i.el()))continue;i.type===ie.TableRow?(w=t.getRowDefinition(i.row),k=t.getColumnDefinition(b)):(w=t.getRowDefinition(v),k=t.getColumnDefinition(i.column)),h=w.position+g+r,0!==w.ot&&(h+=w.computeEffectiveSpacingTop(Math.max(v,p))),l=k.position+m+o,0!==k.ot&&(l+=k.computeEffectiveSpacingTop(Math.max(b,y)));const n=i.measuredBounds;i.td(),i.actualBounds.lt();const s=i.actualBounds,a=D.X(s.x,s.y,s.width,s.height);(s.x=i.type===ie.TableRow?o:l,s.y=i.type===ie.TableColumn?r:h,s.width=n.width,s.height=n.height,i.actualBounds.g(),i.to(!1),a.equalsApproxClose(s))?D.s(a):(null!==x&&(x.fh(),i.b0(x)),D.s(a))}const S=A.l();for(let P=0;P<u;P++){if(!a[P])continue;c=a[P].length;const e=t.getRowDefinition(P);h=e.position+g+r,0!==e.ot&&(h+=e.computeEffectiveSpacingTop(Math.max(v,p)));for(let n=0;n<c;n++){if(!a[P][n])continue;const s=t.getColumnDefinition(n);l=s.position+m+o,0!==s.ot&&(l+=s.computeEffectiveSpacingTop(Math.max(b,y)));const r=a[P][n],u=r.length;for(let o=0;o<u;o++){const a=r[o],u=a.measuredBounds;S.e(0,0);for(let e=1;e<a.rowSpan&&!(P+e>=t.rowCount);e++){const i=t.getRowDefinition(P+e);0!==i.ot&&(S.height+=i.total)}for(let e=1;e<a.columnSpan&&!(n+e>=t.columnCount);e++){const i=t.getColumnDefinition(n+e);0!==i.ot&&(S.width+=i.total)}const c=s.ot+S.width,d=e.ot+S.height;let f=l,g=h;const m=c,p=d,y=l,v=h;let b=c,x=d;l+c>i.width&&(b=Math.max(i.width-l,0)),h+d>i.height&&(x=Math.max(i.height-h,0));let w=a.alignment,k=0,M=0,C=0,N=0;if(w.isDefault()){w=t.defaultAlignment,w.isSpot()||(w=O.Center),k=w.x,M=w.y,C=w.offsetX,N=w.offsetY;const i=s.alignment,n=e.alignment;i.isSpot()&&(k=i.x,C=i.offsetX),n.isSpot()&&(M=n.y,N=n.offsetY)}else k=w.x,M=w.y,C=w.offsetX,N=w.offsetY;(isNaN(k)||isNaN(M))&&(k=.5,M=.5,C=0,N=0);let L=u.width,T=u.height;const A=a.margin,F=A.left+A.right,R=A.top+A.bottom,E=a.S0(e,s,!1);isNaN(a.desiredSize.width)&&(2===E||5===E)&&(L=Math.max(c-F,0)),isNaN(a.desiredSize.height)&&(2===E||4===E)&&(T=Math.max(d-R,0));const B=a.maxSize,I=a.minSize;L=Math.min(B.width,L),T=Math.min(B.height,T),L=Math.max(I.width,L),T=Math.max(I.height,T);const V=T+R;f+=m*k-(L+F)*k+C+A.left,g+=p*M-V*M+N+A.top,a.visible&&(D.contains(y,v,b,x,f,g,u.width,u.height)?a.zt(f,g,L,T):a.zt(f,g,L,T,new D(y,v,b,x)))}}}A.s(S);for(let P=0;P<n;P++){const t=e[P],i=t instanceof ie?t:null;if(null!==i&&i.el()){const e=t.actualBounds;t.naturalBounds.lt(),t.naturalBounds.e(0,0,e.width,e.height),t.naturalBounds.g()}}}});te.definePanelLayout("TableRow",new class extends te{constructor(){super()}measure(t,e,i,n,s,o,r){}arrange(t,e,i){}});te.definePanelLayout("TableColumn",new class extends te{constructor(){super()}measure(t,e,i,n,s,o,r){}arrange(t,e,i){}});te.definePanelLayout("Viewbox",new class extends te{constructor(){super()}measure(t,e,i,n,s,o,r){n.length>1&&d.o("Viewbox Panel cannot contain more than one GraphObject.");const a=n[0];a.K=1,a.Qc(),a.ut(1/0,1/0,o,r);let l=a.measuredBounds;const h=a.margin,u=h.right+h.left,c=h.top+h.bottom;if(isFinite(e)||isFinite(i)){const n=a.scale,s=l.width,h=l.height,d=Math.max(e-u,0),f=Math.max(i-c,0);let g=1;6===t.viewboxStretch?(0!==s&&0!==h&&(g=Math.min(d/s,f/h)),0===g&&(g=1e-4),a.K*=g):(0!==s&&0!==h&&(g=Math.max(d/s,f/h)),0===g&&(g=1e-4),a.K*=g),n!==a.scale&&(a.ne(!0),a.ut(1/0,1/0,o,r))}l=a.measuredBounds,s.width=isFinite(e)?e:Math.max(l.width+u,0),s.height=isFinite(i)?i:Math.max(l.height+c,0)}arrange(t,e,i){const n=e[0],s=n.measuredBounds,o=n.margin,r=o.right+o.left,a=o.top+o.bottom,l=Math.max(s.width+r,0),h=Math.max(s.height+a,0);let u=n.alignment;u.isDefault()&&(u=t.defaultAlignment),u.isSpot()||(u=O.Center),n.zt(i.width*u.x-l*u.x+u.offsetX,i.height*u.y-h*u.y+u.offsetY,s.width,s.height)}});te.definePanelLayout("Grid",new class extends te{constructor(){super()}measure(t,e,i,n,s,o,r){null===t.bi&&(t.bi=new se),this.WR(t),this.JR(t)}arrange(t,e,i){}Gi(t,e,i){const n=t.naturalBounds,s=n.width,o=n.height;e.save(),e.beginPath(),e.rect(0,0,s,o),e.clip(),e.endPath(),this.$R(t,e,i),e.restore(),e.clearContextCache(!1)}$R(t,e,i){let n=t.getDocumentScale()*i.scale;n<=0&&(n=1);const s=t.gridCellSize,o=s.width,r=s.height,a=t.naturalBounds,l=t.actualBounds,h=a.width,u=a.height,c=Math.ceil(h/o),d=Math.ceil(u/r),f=t.gridOrigin,g=f.x,m=f.y,p=t.bi.Z0,y=t.T.r,v=y.length;for(let b=0;b<v;b++){const i=y[b];if(!i.visible)continue;const s=i.interval||1,f=Math.abs(s);if(o*f*n<2)continue;let v=i.segmentIndex;(!isFinite(v)||isNaN(v))&&(v=0),v<0&&(v=f-Math.min(-v,f)),v=Math.round(v%f);const x=i.opacity;let w=1;if(1!==x){if(0===x)continue;w=e.globalAlpha,e.globalAlpha=w*x}const k=p[b];let S=!1;const P=i.strokeDashArray;if(null!==P&&(S=!0,e.enableDash(P,i.strokeDashOffset)),null!==i.stroke&&i.strokeWidth>0&&("LineV"===i.figure||"LineH"===i.figure)){if(e.lineWidth=i.strokeWidth,t.mn(e,i.stroke,!1,!1,a,l),e.beginPath(),"LineV"===i.figure){const t=Math.floor((g-o)/o);for(let i=t;i<=t+c;i++){const t=i*o+g;0<=t&&t<=h&&this.Gb(i,s,v,k)&&(e.moveTo(t,0),e.lineTo(t,u))}}else if("LineH"===i.figure){const t=Math.floor((m-r)/r);for(let i=t;i<=t+d;i++){const t=i*r+m;0<=t&&t<=u&&this.Gb(i,s,v,k)&&(e.moveTo(0,t),e.lineTo(h,t))}}e.stroke(),e.endPath()}else if(null!==i.fill)if(t.mn(e,i.fill,!0,!1,a,l),"BarV"===i.figure){let t=i.width;isNaN(t)&&(t=o);const n=Math.floor((g-o)/o);for(let i=n;i<=n+c;i++){const n=i*o+g;0<=n+t&&n<=h&&this.Gb(i,s,v,k)&&e.fillRect(n,0,t,u)}}else if("BarH"===i.figure){let t=i.height;isNaN(t)&&(t=r);const n=Math.floor((m-r)/r);for(let i=n;i<=n+d;i++){const n=i*r+m;0<=n+t&&n<=u&&this.Gb(i,s,v,k)&&e.fillRect(0,n,h,t)}}S&&e.disableDash(),1!==x&&(e.globalAlpha=w)}}Gb(t,e,i,n){if(e<0)return t%e===i;if(t%e!==i)return!1;const s=n.length;for(let o=0;o<s;o++){if(t%n[o]===i)return!1}return!0}JR(t){const e=[],i=t.T.r,n=i.length;for(let s=0;s<n;s++){const t=i[s],o=[];if(e.push(o),!t.visible)continue;const r=t.interval;if(r<0)continue;const a=t.figure,l=this.N2(a);for(let e=0;e<n;e++){if(e===s)continue;const t=i[e];if(!t.visible)continue;const n=t.figure;if(this.N2(n)!==l)continue;const a=t.interval;a>r&&o.push(a)}}t.bi.Z0=e}N2(t){return"LineV"===t||"BarV"===t}WR(t){let e=1,i=1;const n=t.T.r,s=n.length;for(let a=0;a<s;a++){const t=n[a],s=Math.abs(t.interval);s<2||(this.N2(t.figure)?i=i*s/E.cC(i,s):e=e*s/E.cC(e,s))}const o=t.gridCellSize,r=t.bi;r.zc.isReal()?r.zc.e(i*o.width,e*o.height):r.zc=new A(i*o.width,e*o.height)}});te.definePanelLayout("Link",new class extends te{constructor(){super()}measure(t,e,i,n,s,o,r){const a=n.length;if(!(t instanceof Pe||t instanceof De))return;let l=null,h=null;if(t instanceof De&&(l=t),t instanceof Pe&&(h=t,l=h.adornedPart,null===t.rf&&(t.rf=[])),!(l instanceof De))return;const u=l;if(0===a)return t.naturalBounds.So(0,0),void t.measuredBounds.e(0,0,0,0);const c=t instanceof Pe?null:l.path,f=l.routeBounds,g=t.Ho;g.e(0,0,f.width,f.height);const m=u.points,p=l.pointsCount;null!==h?h.ad(!1):null!==l&&l.ad(!1);const y=f.width,v=f.height,b=t.rf;if(b.length=0,null!==c){this.measureLinkPath(t,y,v,c);const e=c.measuredBounds;g.unionRect(e),b.push(e)}const x=R.l(),w=T.l(),k=T.l();for(let S=0;S<a;S++){const e=n[S];if(e===c)continue;let i=e.measuredBounds;if(e.isPanelMain&&e instanceof le){this.measureLinkPath(t,y,v,e),i=e.measuredBounds,g.unionRect(i),b.push(i);continue}if(p<2){e.ut(1/0,1/0,0,0),i=e.measuredBounds,g.unionRect(i),b.push(i);continue}const s=e.segmentIndex,o=e.segmentFraction;let r=e.alignmentFocus;r.isNoSpot()&&(r=O.Center);const a=e.segmentOrientation,l=e.segmentOffset;let h=0,P=0,M=0,C=0;if(isNaN(s)){const t=u.ft,i=d.rt();t.getPointAndAngleAlongPath(o,i);const n=T.X(i[0],i[1]);C=i[2],0!==a&&(M=u.computeAngle(e,a,C),e.Xt=M,e.ne(!0),e.to(!0)),h=n.x,P=n.y,T.s(n),d.it(i)}else if(s<-p||s>=p){const t=T.l();u.cA(t),C=u.midAngle,0!==a&&(M=u.computeAngle(e,a,C),e.Xt=M,e.ne(!0),e.to(!0)),h=t.x-f.x,P=t.y-f.y,T.s(t)}else{let t,i,n=0;if(s>=0?(t=m.elt(s),i=s<p-1?m.elt(s+1):t):(n=p+s,t=m.elt(n),i=n>0?m.elt(n-1):t),C=0,t.equalsApprox(i)){let e,o;s>=0?(e=s>0?m.elt(s-1):t,o=s<p-2?m.elt(s+2):i):(e=n<p-1?m.elt(n+1):t,o=n>1?m.elt(n-2):i);const r=e.distanceSquaredPoint(t),a=i.distanceSquaredPoint(o);C=r>a+10?s>=0?e.directionPoint(t):t.directionPoint(e):a>r+10?s>=0?i.directionPoint(o):o.directionPoint(i):s>=0?e.directionPoint(o):o.directionPoint(e)}else C=s>=0?t.directionPoint(i):i.directionPoint(t);0!==a&&(M=u.computeAngle(e,a,C),e.Xt=M,e.ne(!0),e.to(!0)),h=t.x+(i.x-t.x)*o-f.x,P=t.y+(i.y-t.y)*o-f.y}e.ut(1/0,1/0,0,0),i=e.measuredBounds;const N=e.naturalBounds;let L=0;e instanceof le&&(L=e.strokeWidth);const A=N.width+L,F=N.height+L;x.Jt(),x.Qi(-i.x,-i.y),x.K(e.scale,e.scale),x.us(0===a?e.angle:C,A/2,F/2),(22===a||26===a)&&x.us(90,A/2,F/2),(23===a||27===a)&&x.us(-90,A/2,F/2),28===a&&(C>45&&C<135||C>225&&C<315)&&x.us(-C,A/2,F/2);const R=new D(0,0,A,F);w.setRectSpot(R,r),x.xt(w);const E=-w.x+L/2*e.scale,B=-w.y+L/2*e.scale;k.a(l);const I=isNaN(l.x),V=isNaN(l.y);if(I||V){const t=A/2+3,e=F/2+3,i=C>=45&&C<=135,n=C>=225&&C<=315;0===a&&(i||n)?(k.x=V?t:l.y,k.y=I?e:l.x,i?s>=0||isNaN(s)&&o<.5||I&&(k.y=-e):n&&((s>=0||isNaN(s)&&o<.5)&&I&&(k.y=-e),V&&(k.x=-t))):(I&&(s>=0||isNaN(s)&&o<.5?k.x=t:k.x=-t),V&&(k.y=-e),k.rotate(C))}else k.rotate(C);h+=k.x,P+=k.y,R.e(h+E,P+B,i.width,i.height),b.push(R),g.unionRect(R)}if(null!==l){const t=l.labelNodes;for(;t.next();)t.value.ut(1/0,1/0)}t.Ho=g,t.position.e(f.x+g.x,f.y+g.y),s.So(g.width||0,g.height||0),R.s(x),T.s(w),T.s(k)}arrange(t,e,i){const n=e.length;if(!(t instanceof Pe||t instanceof De))return;let s=t,o=null;t instanceof Pe&&(o=t,s=o.adornedPart);const r=t,a=t instanceof Pe?null:s.path,l=t.rf;if(0!==l.length){let t=0;if(null!==a&&t<l.length){const e=l[t];t++,a.zt(e.x-r.Ho.x,e.y-r.Ho.y,e.width,e.height)}for(let i=0;i<n;i++){const n=e[i];if(n!==a&&t<l.length){const e=l[t];t++,n.zt(e.x-r.Ho.x,e.y-r.Ho.y,e.width,e.height)}}}const h=s.points,u=h.count;if(u>=2&&r instanceof De){const t=r.labelNodes;for(;t.next();){const e=t.value;r.ZR(e,u,h)}}null!==o?o.ad(!1):s.ad(!1);const c=t.fA(T.l());t.location.e(t.position.x+c.x,t.position.y+c.y),T.s(c)}measureLinkPath(t,e,i,n){if(!1===n.Eo())return;let s=n.strokeWidth;if(0===s&&t instanceof Pe&&t.type===ie.Link&&t.adornedObject instanceof le&&(s=t.adornedObject.strokeWidth),s*=n.K,t instanceof De&&null!==t.ft){const e=t.geometry.bounds;n._n(e.x-s/2,e.y-s/2,e.width+s,e.height+s)}else if(t instanceof Pe&&null!==t.adornedPart.ft){const e=t.adornedPart.ft.bounds;n._n(e.x-s/2,e.y-s/2,e.width+s,e.height+s)}else n._n(-s/2,-s/2,e+s,i+s);n.QR(),n.ne(!1)}});te.definePanelLayout("Graduated",new class extends te{constructor(){super()}measure(t,e,i,n,s,o,r){const a=t.findMainElement();t.qe=[];const l=a.margin,h=l.right+l.left,u=l.top+l.bottom;a.ut(e,i,o,r);const c=a.measuredBounds,d=c.width,f=c.height,g=Math.max(d+h,0),m=Math.max(f+u,0),p=new D(-l.left,-l.top,g,m);t.qe.push(p),s.a(p),this.determineGraduatedMarks(t,a);const y=t.ks;if(null===y)return;const v=n.length;for(let b=0;b<v;b++){const e=n[b],i=y[b];!e.visible||e===a||0===i.length||(e instanceof le?this.measureGraduatedTicks(t,e,i,s):e instanceof fe&&this.measureGraduatedLabels(t,e,i,s),e.ne(!1))}}arrange(t,e,i){if(null===t.qe)return;const n=t.findMainElement(),s=t.ks;if(null===s)return;const o=t.qe;let r=0,a=o[r];r++,null!==n&&n.zt(a.x-i.x,a.y-i.y,a.width,a.height);const l=e.length;for(let h=0;h<l;h++){const t=e[h],l=s[h];!t.visible||t===n||0===l.length||(a=o[r],r++,t.zt(a.x-i.x,a.y-i.y,a.width,a.height))}t.qe=null}measureGraduatedTicks(t,e,i,n){let s=e.alignmentFocus;s.isNoSpot()&&(s=O.TopCenter);const o=e.angle;e.Xt=0,e.ut(1/0,1/0,0,0),e.Xt=o;const r=e.measuredBounds,a=r.width,l=r.height,h=D.X(0,0,a,l),u=T.l();u.setRectSpot(h,s),D.s(h);const c=-u.x,d=-u.y,f=new D,g=i.length;for(let m=0;m<g;m++){const t=i[m],n=t.pt.x,s=t.pt.y,o=t.angle;for(let i=0;i<4;i++){switch(i){case 0:u.e(c,d);break;case 1:u.e(c+a,d);break;case 2:u.e(c,d+l);break;case 3:u.e(c+a,d+l)}u.rotate(o+e.angle),u.offset(n,s),0===m&&0===i?f.e(u.x,u.y,0,0):f.unionPoint(u),u.offset(-n,-s),u.rotate(-o-e.angle)}}T.s(u),null!==t.qe&&t.qe.push(f),n.unionNoCheck(f.x,f.y,f.width,f.height)}measureGraduatedLabels(t,e,i,n){null===t.Ce&&(t.Ce=new fe);const s=t.Ce;this.uA(e,s);let o=e.alignmentFocus;o.isNoSpot()&&(o=O.TopCenter);const r=e.segmentOrientation,a=e.segmentOffset,l=new D;let h=0,u=0,c=0,d=0,f=0;const g=i.length;for(let m=0;m<g;m++){const t=i[m];h=t.pt.x,u=t.pt.y,c=t.angle,d=e.angle,f=e.angle,0!==r&&(f=21===r||25===r?c+e.angle:c,d=De.computeAngle(r,f)),s.Xt=d,s.text=t.text||"",s.ut(1/0,1/0,0,0);const n=s.measuredBounds,g=s.naturalBounds,p=g.width,y=g.height,v=R.l();v.Jt(),v.Qi(-n.x,-n.y),v.K(s.scale,s.scale),v.us(f,p/2,y/2),(22===r||26===r)&&v.us(90,p/2,y/2),(23===r||27===r)&&v.us(-90,p/2,y/2),28===r&&(c>45&&c<135||c>225&&c<315)&&v.us(-c,p/2,y/2);const b=D.X(0,0,p,y),x=T.l();x.setRectSpot(b,o),v.xt(x);const w=-x.x,k=-x.y,S=T.l();S.a(a),isNaN(S.x)&&(S.x=p/2+3),isNaN(S.y)&&(S.y=-(y/2+3)),S.rotate(c),h+=S.x+w,u+=S.y+k;const P=new D(h,u,n.width,n.height),M=new D(n.x,n.y,n.width,n.height),C=new D(g.x,g.y,g.width,g.height);t.labelAngle=d,t.lineCount=s.lineCount,t.lines=s.getMetrics(),t.actualBounds=P,t.measuredBounds=M,t.naturalBounds=C,0===m?l.a(P):l.unionRect(P),T.s(S),T.s(x),D.s(b),R.s(v)}null!==t.qe&&t.qe.push(l),n.unionNoCheck(l.x,l.y,l.width,l.height)}determineGraduatedMarks(t,e){const i=e.geometry,n=e.strokeWidth,s=i.flattenedSegments,o=i.flattenedLengths,r=i.flattenedTotalLength,a=s.length;let l=0,h=0;const u=d.rt();for(let d=0;d<a;d++){const t=s[d],e=[];l=0,h=0;const i=t.length;for(let n=0;n<i;n+=2){const i=t[n],s=t[n+1];if(0===n){l=i,h=s;continue}let o=180*Math.atan2(s-h,i-l)/Math.PI;o<0&&(o+=360),e.push(o),l=i,h=s}u.push(e)}const c=this._R(t),f=t.T.r,g=f.length;let m,p=0,y=0,v=r;t.ks=[];for(let d=0;d<g;d++){const a=f[d];if(m=[],!a.visible||a===e){t.ks.push(m);continue}const l=Math.abs(a.interval),h=t.graduatedTickUnit;if(h*l*r/t.graduatedRange<2&&null===a.graduatedSkip){t.ks.push(m);continue}let g=o[0][0],b=0,x=0;y=r*a.graduatedStart-1e-4,v=r*a.graduatedEnd+1e-4;const w=h*l;let k=t.graduatedTickBase;if(k<t.graduatedMin){let e=(t.graduatedMin-k)/w;e=e%1===0?e:Math.floor(e+1),k+=e*w}else if(k>t.graduatedMin+w){k-=Math.floor((k-t.graduatedMin)/w)*w}const S=c[d],P=k,M=1e-6*t.graduatedMax;for(let c=1;k<=t.graduatedMax+M;c++){if(this.tv(t,k-t.graduatedTickBase,S)&&(k>t.graduatedMax&&(k=t.graduatedMax),(null===a.graduatedSkip||a instanceof fe&&!a.graduatedSkip(k,a)||a instanceof le&&!a.graduatedSkip(k,a))&&(p=(k-t.graduatedMin)*r/t.graduatedRange,p>r&&(p=r),y<=p&&p<=v))){let t=u[b][x],r=o[b][x];for(;b<o.length;){for(;p>g&&x<o[b].length-1;)x++,t=u[b][x],r=o[b][x],g+=r;if(p<=g)break;b++,x=0,t=u[b][x],r=o[b][x],g+=r}const l=s[b],h=l[2*x],c=l[2*x+1],d=l[2*x+2],f=l[2*x+3],y=(p-(g-r))/r,v=new T(h+(d-h)*y+n/2-i.bounds.x,c+(f-c)*y+n/2-i.bounds.y);if(v.scale(e.scale,e.scale),t=this.iv(t,y,l,u[b],x),a instanceof fe){let e="";null!==a.graduatedFunction?(e=a.graduatedFunction(k,a),e=null!=e?e.toString():""):e=(+k.toFixed(2)).toString(),""!==e&&m.push({pt:v,angle:t,text:e})}else m.push({pt:v,angle:t})}k=P+c*w}t.ks.push(m)}d.it(u)}iv(t,e,i,n,s){if(e<.5005&&e>.4995)return t;let o=t;if(e<.5?s>0?o=n[s-1]:E.Y(i[0],i[i.length-2])&&E.Y(i[1],i[i.length-1])&&(o=n[n.length-1]):e>.5&&(s+1<n.length?o=n[s+1]:E.Y(i[0],i[i.length-2])&&E.Y(i[1],i[i.length-1])&&(o=n[0])),t!==o){let i=Math.abs(t-o);if(i>180&&(t<o?t+=360:o+=360,i=Math.abs(t-o)),e<5e-4||e>.9995)return(t+o)/2%360;if(i<10){const i=1-Math.abs(.5-e);return(t*i+o*(1-i))%360}}return t}_R(t){if(null===t.rs){const e=[],i=t.T.r,n=i.length;for(let t=0;t<n;t++){const s=i[t],o=[];if(e.push(o),!s.visible)continue;const r=s.interval;if(!(r<0))for(let e=0;e<n;e++){if(e===t)continue;const n=i[e];if(!n.visible||s.constructor!==n.constructor)continue;const a=n.interval;a>r&&o.push(a)}}t.rs=e}return t.rs}tv(t,e,i){const n=i.length;for(let s=0;s<n;s++){const n=e%(i[s]*t.graduatedTickUnit),o=1e-6*t.graduatedTickUnit;if(n<o&&n>-o)return!1}return!0}Gi(t,e,i){const n=i._h;i._h=!0;const s=t.naturalBounds,o=s.width,r=s.height,a=e instanceof Ht;e.save(),e.beginPath(),e.rect(-1,-1,o+1,r+1),e.clip(),e.endPath();const l=t.findMainElement();l.Gi(e,i);let h=t.getDocumentScale()*i.scale;h<=0&&(h=1);const u=l.actualBounds,c=t.T.r,d=t.ks,f=c.length;for(let g=0;g<f;g++){const n=c[g],s=d[g],o=s.length;if(n.visible&&n!==l&&0!==s.length)if(n instanceof le){if(t.graduatedTickUnit*n.interval*l.geometry.flattenedTotalLength/t.graduatedRange*h<2&&null===n.graduatedSkip)continue;const r=n.measuredBounds,c=n.strokeWidth*n.scale;let d=n.alignmentFocus;d.isNoSpot()&&(d=O.TopCenter);for(let l=0;l<o;l++){const o=s[l].pt,h=s[l].angle;this.ev(n,o,u,h,r,c,d),n.Gi(e,i),a&&(t.svg.appendChild(n.svg),n.svg=null),n._r.Jt()}}else if(n instanceof fe){null===t.Ce&&(t.Ce=new fe);const r=t.Ce;this.uA(n,r);for(let l=0;l<o;l++){const o=s[l];if(o.actualBounds&&o.measuredBounds&&o.naturalBounds){r.sv(o);const s=o.actualBounds;r.zt(s.x,s.y,s.width,s.height),this.nv(r,u,s,o.measuredBounds,o.naturalBounds),r.il=n.part,r.zs=n.panel,r.Gi(e,i),r.zs=null,r.il=null,a&&(t.svg.appendChild(r.svg),r.svg=null)}}}}i._h=n,e.restore(),e.clearContextCache(!0)}ev(t,e,i,n,s,o,r){const a=t._r;a.Jt(),a.Qi(e.x+i.x,e.y+i.y),a.us(n+t.angle,0,0),a.Qi(-s.width*r.x+r.offsetX+o/2,-s.height*r.y+r.offsetY+o/2),a.K(t.scale,t.scale),t.nd(!1),t.lh.set(t._r),t.Hc=t.scale,t.wa(!1)}nv(t,e,i,n,s){const o=t._r;o.Jt(),o.Qi(i.x+e.x,i.y+e.y),o.Qi(-n.x,-n.y),t.y0(o,s.x,s.y,s.width,s.height),t.nd(!1),t.lh.set(t._r),t.Hc=t.scale,t.wa(!1)}uA(t,e){e.ov(t)}});var ee=(t=>(t[t.Uniform=6]="Uniform",t[t.UniformToFill=7]="UniformToFill",t))(ee||{});class ie extends Kt{constructor(t,e){if(super(),y(this,"_",void 0),y(this,"T",void 0),y(this,"Zt",void 0),y(this,"cd",void 0),y(this,"Yn",void 0),y(this,"ol",void 0),y(this,"no",void 0),y(this,"Ho",void 0),y(this,"C2",void 0),y(this,"O",void 0),y(this,"fd",void 0),y(this,"at",void 0),y(this,"bi",void 0),y(this,"Qt",void 0),y(this,"ud",void 0),y(this,"ph",void 0),y(this,"Gs",void 0),this._=null,void 0===t)this._=ie.Position;else if("string"==typeof t){const e=te.Layouts.getValue(t);null!==e&&(this._=e)}else t instanceof te?this._=t:t&&(this._=ie.Position,e=t);null===this._&&d.o("Panel type not specified or PanelLayout not loaded: "+t),this.n|=4194304|(this._===ie.Grid?1048576:0),this.T=new x,this.Zt=F.Ug,this.cd=O.Default,this.Yn=1,this.ol=null,this.no="",this.Ho=new D(NaN,NaN,NaN,NaN),this.C2=null,this.O=null,this.fd=6,this.bi=null,this.at=null,this.Qt=null,this.ud=NaN,this.ph=null,this.Gs=null,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t._=this._,t.Zt=this.Zt.N(),t.cd=this.cd.N(),t.Yn=this.Yn,t.no=this.no,t.Ho.a(this.Ho),null!==this.O&&(t.O=this.O.copy(t)),t.fd=this.fd,null!==this.at&&(t.at=this.at.copy()),null!==this.bi&&(t.bi=this.bi.copy()),t.Qt=this.Qt,t.ud=this.ud,t.ph=this.ph}Xo(t){super.Xo(t),t.T=this.T;const e=t.T.r,i=e.length;for(let n=0;n<i;n++){e[n].zs=t}t.ol=null}copy(){const t=super.copy();if(null!==t){const e=this.T.r,i=e.length;for(let n=0;n<i;n++){const i=e[n].copy();t.rv(i)}return t}return null}toString(){return"Panel("+this.type.name+")#"+k.fs(this)}get type(){return this._}set type(t){const e=this._;e!==t&&(this._=t,this.lf=this._===ie.Grid,this.c(),this.t("type",e,t))}get elements(){return this.T.iterator}get naturalBounds(){return this.Bi}get padding(){return this.Zt}set padding(t){"number"==typeof t?(t<0&&d.tt(t,">= 0",ie,"padding"),t=new F(t)):(t.left<0&&d.tt(t.left,">= 0",ie,"padding:value.left"),t.right<0&&d.tt(t.right,">= 0",ie,"padding:value.right"),t.top<0&&d.tt(t.top,">= 0",ie,"padding:value.top"),t.bottom<0&&d.tt(t.bottom,">= 0",ie,"padding:value.bottom"));const e=this.Zt;e.equals(t)||(t=t.N(),this.Zt=t,this.c(),this.t("padding",e,t))}get defaultAlignment(){return this.cd}set defaultAlignment(t){const e=this.cd;e.equals(t)||(t=t.N(),this.cd=t,this.c(),this.t("defaultAlignment",e,t))}get defaultStretch(){return this.Yn}set defaultStretch(t){const e=this.Yn;e!==t&&(this.Yn=t,this.c(),this.t("defaultStretch",e,t))}get defaultSeparatorPadding(){return null!==this.O?this.O.Q0:F.Ug}set defaultSeparatorPadding(t){"number"==typeof t&&(t=new F(t));const e=this.defaultSeparatorPadding;e.equals(t)||(t=t.N(),null===this.O&&(this.O=new oe),this.O.Q0=t,this.c(),this.t("defaultSeparatorPadding",e,t))}get defaultRowSeparatorStroke(){return null!==this.O?this.O._0:null}set defaultRowSeparatorStroke(t){const e=this.defaultRowSeparatorStroke;e!==t&&(null===t||"string"==typeof t||t instanceof Qt)&&(t instanceof Qt&&t.g(),null===this.O&&(this.O=new oe),this.O._0=t,this.C(),this.t("defaultRowSeparatorStroke",e,t))}get defaultRowSeparatorStrokeWidth(){return null!==this.O?this.O.tp:1}set defaultRowSeparatorStrokeWidth(t){const e=this.defaultRowSeparatorStrokeWidth;e!==t&&isFinite(t)&&t>=0&&(null===this.O&&(this.O=new oe),this.O.tp=t,this.c(),this.t("defaultRowSeparatorStrokeWidth",e,t))}get defaultRowSeparatorDashArray(){return null!==this.O?this.O.ip:null}set defaultRowSeparatorDashArray(t){const e=this.defaultRowSeparatorDashArray;if(e!==t){if(null!==t&&!Array.isArray(t)&&d.ke(t,"Array",ie,"defaultRowSeparatorDashArray:value"),null!==t){const i=t.length;let n=0;for(let e=0;e<i;e++){const i=t[e];("number"!=typeof i||!(i>=0)||!isFinite(i))&&d.o("defaultRowSeparatorDashArray value "+i+" at index "+e+" must be a positive number or zero."),n+=i}if(0===n){if(null===e)return;t=null}}null===this.O&&(this.O=new oe),this.O.ip=t,this.C(),this.t("defaultRowSeparatorDashArray",e,t)}}get defaultColumnSeparatorStroke(){return null!==this.O?this.O.ep:null}set defaultColumnSeparatorStroke(t){const e=this.defaultColumnSeparatorStroke;e!==t&&(null===t||"string"==typeof t||t instanceof Qt)&&(t instanceof Qt&&t.g(),null===this.O&&(this.O=new oe),this.O.ep=t,this.C(),this.t("defaultColumnSeparatorStroke",e,t))}get defaultColumnSeparatorStrokeWidth(){return null!==this.O?this.O.sp:1}set defaultColumnSeparatorStrokeWidth(t){const e=this.defaultColumnSeparatorStrokeWidth;e!==t&&isFinite(t)&&t>=0&&(null===this.O&&(this.O=new oe),this.O.sp=t,this.c(),this.t("defaultColumnSeparatorStrokeWidth",e,t))}get defaultColumnSeparatorDashArray(){return null!==this.O?this.O.np:null}set defaultColumnSeparatorDashArray(t){const e=this.defaultColumnSeparatorDashArray;if(e!==t){if(null!==t&&!Array.isArray(t)&&d.ke(t,"Array",ie,"defaultColumnSeparatorDashArray:value"),null!==t){const i=t.length;let n=0;for(let e=0;e<i;e++){const i=t[e];("number"!=typeof i||!(i>=0)||!isFinite(i))&&d.o("defaultColumnSeparatorDashArray value "+i+" at index "+e+" must be a positive number or zero."),n+=i}if(0===n){if(null===e)return;t=null}}null===this.O&&(this.O=new oe),this.O.np=t,this.C(),this.t("defaultColumnSeparatorDashArray",e,t)}}get mh(){return null!==this.O?this.O.mh:null}set mh(t){null===this.O&&(this.O=new oe),this.O.mh=t}get viewboxStretch(){return this.fd}set viewboxStretch(t){const e=this.fd;e!==t&&(this.fd=t,this.c(),this.t("viewboxStretch",e,t))}get gridCellSize(){return null!==this.bi?this.bi.dd:A.ZN}set gridCellSize(t){null===this.bi&&(this.bi=new se);const e=this.bi.dd;if(!e.equals(t)){(!t.isReal()||0===t.width||0===t.height)&&d.o("Invalid Panel.gridCellSize: "+t),this.bi.dd=t.N();const i=this.diagram;null!==i&&this===i.grid&&i.Wr(),this.C(),this.t("gridCellSize",e,t)}}get gridOrigin(){return null!==this.bi?this.bi.gd:T.Mo}set gridOrigin(t){null===this.bi&&(this.bi=new se);const e=this.bi.gd;if(!e.equals(t)){t.isReal()||d.o("Invalid Panel.gridOrigin: "+t),this.bi.gd=t.N();const i=this.diagram;null!==i&&this===i.grid&&i.Wr(),this.C(),this.t("gridOrigin",e,t)}}get graduatedMin(){return null!==this.at?this.at.op:0}set graduatedMin(t){const e=this.graduatedMin;if(e!==t&&(null===this.at&&(this.at=new ne),this.at.op=t,this.c(),this.t("graduatedMin",e,t),this.Wc())){const t=this.part;null!==t&&this.ya(t,"graduatedRange")}}get graduatedMax(){return null!==this.at?this.at.rp:100}set graduatedMax(t){const e=this.graduatedMax;if(e!==t&&(null===this.at&&(this.at=new ne),this.at.rp=t,this.c(),this.t("graduatedMax",e,t),this.Wc())){const t=this.part;null!==t&&this.ya(t,"graduatedRange")}}get graduatedRange(){return this.graduatedMax-this.graduatedMin}get graduatedTickUnit(){return null!==this.at?this.at.lp:10}set graduatedTickUnit(t){const e=this.graduatedTickUnit;e!==t&&t>0&&(null===this.at&&(this.at=new ne),this.at.lp=t,this.c(),this.t("graduatedTickUnit",e,t))}get graduatedTickBase(){return null!==this.at?this.at.hp:0}set graduatedTickBase(t){const e=this.graduatedTickBase;e!==t&&(null===this.at&&(this.at=new ne),this.at.hp=t,this.c(),this.t("graduatedTickBase",e,t))}get ks(){return null!==this.at?this.at.ks:null}set ks(t){null!==this.at?this.at.ks=t:null!==t&&(this.at=new ne,this.at.ks=t)}get qe(){return null!==this.at?this.at.qe:null}set qe(t){null!==this.at?this.at.qe=t:null!==t&&(this.at=new ne,this.at.qe=t)}get rs(){return null!==this.at?this.at.rs:null}set rs(t){null!==this.at?this.at.rs=t:null!==t&&(this.at=new ne,this.at.rs=t)}get Ce(){return null!==this.at?this.at.Ce:null}set Ce(t){null!==this.at?this.at.Ce=t:null!==t&&(this.at=new ne,this.at.Ce=t)}b0(t){super.b0(t);const e=this.T.r,i=e.length;for(let n=0;n<i;n++)e[n].b0(t)}uh(t,e){if(this._===ie.Grid)return t.commitTransform(),void this._.Gi(this,t,e);if(this._===ie.Graduated)return t.commitTransform(),void this._.Gi(this,t,e);if(this._===ie.Table)if(t.commitTransform(),t instanceof Ht){const i=t.currentElement;t.currentElement=t.newGroup2("gojs-ts"),this.L2(t,e),t.endGroup(),t.currentElement=i}else this.L2(t,e);const i=this.isClipping&&this._===ie.Spot;i&&t.save();const n=this.findMainElement(),s=this.T.r,o=s.length;for(let r=0;r<o;r++){const o=s[r];i&&o===n&&(t.clipInsteadOfFill=!0),o.Gi(t,e),i&&o===n&&(t.clipInsteadOfFill=!1)}i&&(t.restore(),t.clearContextCache(!0))}L2(t,e){t.lineCap="butt";const i=this.rowCount>0?this.He:null,n=this.columnCount>0?this.je:null;null!==i&&this.Hb(t,e,!0,i,!0),null!==n&&this.Hb(t,e,!1,n,!0),null!==i&&this.dA(t,!0,i),null!==n&&this.dA(t,!1,n),null!==i&&this.Hb(t,e,!0,i,!1),null!==n&&this.Hb(t,e,!1,n,!1)}dA(t,e,i){const n=i.length,s=this.actualBounds,o=this.naturalBounds;let r=!0;for(let a=0;a<n;a++){const n=i[a];if(void 0===n||0===n.actual)continue;if(r){r=!1;continue}if(e){if(n.position>o.height)continue}else if(n.position>o.width)continue;let l=n.separatorStrokeWidth;isNaN(l)&&(l=e?this.defaultRowSeparatorStrokeWidth:this.defaultColumnSeparatorStrokeWidth);let h=n.separatorStroke;if(null===h&&(h=e?this.defaultRowSeparatorStroke:this.defaultColumnSeparatorStroke),0===l||null===h)continue;this.mn(t,h,!1,!1,o,s);let u=!1,c=n.separatorDashArray;null===c&&(c=e?this.defaultRowSeparatorDashArray:this.defaultColumnSeparatorDashArray),null!==c&&(u=!0,t.enableDash(c,0)),t.beginPath();const d=n.position+l;e?d>o.height&&(l-=d-o.height):d>o.width&&(l-=d-o.width);let f=n.position+l/2;t.lineWidth=l;const g=this.Zt;if(e){f+=g.top;const e=g.left,i=o.width-g.right;t.moveTo(e,f),t.lineTo(i,f)}else{f+=g.left;const e=g.top,i=o.height-g.bottom;t.moveTo(f,e),t.lineTo(f,i)}t.stroke(),t.endPath(),u&&t.disableDash()}}Hb(t,e,i,n,s){const o=n.length,r=this.actualBounds,a=this.naturalBounds,l=this.gA(!0),h=this.gA(!1);for(let u=0;u<o;u++){const e=n[u];if(void 0===e||null===e.background||e.coversSeparators===s||0===e.actual)continue;const o=i?r.height:r.width;if(e.position>o)continue;let c=e.computeEffectiveSpacing(),d=e.separatorStrokeWidth;isNaN(d)&&(d=i?this.defaultRowSeparatorStrokeWidth:this.defaultColumnSeparatorStrokeWidth);let f=e.separatorStroke;null===f&&(f=i?this.defaultRowSeparatorStroke:this.defaultColumnSeparatorStroke),(null===f||e.index===(i?l:h))&&(d=0),c-=d;const g=e.position+d;let m=c+e.actual;if(g+m>o&&(m=o-g),m<=0)continue;const p=this.Zt;this.mn(t,e.background,!0,!1,a,r),i?t.fillRect(p.left,g+p.top,r.width-(p.left+p.right),m):t.fillRect(g+p.left,p.top,m,r.height-(p.top+p.bottom))}}gA(t){const e=t?this.rowCount:this.columnCount;for(let i=0;i<e;i++){const e=t?this.He[i]:this.je[i];if(void 0!==e)return e.index}return 0}o2(){const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].o2();this.os(!0)}$c(t,e,i){if(!super.$c(t,e,i))return!1;if(this.type===ie.Table){const i=this.svg.getElementsByClassName("gojs-ts"),n=0!==i.length?i[0]:null;null!==n&&(n.innerHTML=""),t.currentElement=n,this.L2(t,e),t.currentElement=null}else{if(this._===ie.Grid)return this.svg.innerHTML="",this.svg.remove(),!1;if(this._===ie.Graduated)return this.svg.innerHTML="",this.svg.remove(),!1}const n=this.T.r,s=n.length;for(let o=0;o<s;o++)n[o].Gi(t,e);return!0}sd(t){return!0}P0(t,e,i,n){if(!this.isClipping){if(this.Ks()&&null!==t.partClipRect){const e=t.partClipRect,s=this.T.r;let o=0,r=0;for(let t=0;t<s.length;t++){if(!s[t].isVisibleObject())continue;const e=s[t].actualBounds;o=0===t?e.x:Math.min(e.x,o),r=0===t?e.y:Math.min(e.y,r)}return void n.setAttributeNS(null,"clip-path","path('M ".concat(e.x-i.x-o,",").concat(e.y-i.y-r," l ").concat(e.width," 0 l 0 ").concat(e.height," l -").concat(e.width," 0 z')"))}super.P0(t,e,i,n)}}Jc(t,e,i,n,s){const o=this.wn(),r=this.L,a=1/(r.m11*r.m22-r.m12*r.m21);let l=r.m22*a,h=-r.m12*a,u=-r.m21*a,c=r.m11*a,d=a*(r.m21*r.dy-r.m22*r.dx),f=a*(r.m12*r.dx-r.m11*r.dy);if(null!==this.background){const o=t*l+e*u+d,a=t*h+e*c+f,g=i*l+n*u+d,m=i*h+n*c+f;s.e(0,0);const p=this.naturalBounds,y=E.xl(0,0,p.width,p.height,o,a,g,m,s);return s.L(r),y}{o||(l=1,h=0,u=0,c=1,d=0,f=0);const a=t*l+e*u+d,g=t*h+e*c+f,m=i*l+n*u+d,p=i*h+n*c+f;s.e(m,p);let y=(m-a)*(m-a)+(p-g)*(p-g),v=!1;const b=this.T.r,x=b.length,w=T.l();let k=null,S=1/0,P=null;const M=this.isClipping&&this._===ie.Spot;M&&(P=T.l(),k=this.findMainElement(),v=k.Jc(a,g,m,p,P),v&&(S=(a-P.x)*(a-P.x)+(g-P.y)*(g-P.y)));for(let t=0;t<x;t++){const e=b[t];if(!e.visible||e===k||!e.Jc(a,g,m,p,w))continue;v=!0;const i=(a-w.x)*(a-w.x)+(g-w.y)*(g-w.y);i<y&&(y=i,s.set(w))}return M&&(S>y&&s.set(P),T.s(P)),T.s(w),o&&s.L(r),v}}Du(){const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].Du();super.Du()}c(t){if(this.Eo())return;super.c(t);let e=null;(this._===ie.Auto||this._===ie.Link)&&(e=this.findMainElement());const i=this.T.r,n=i.length;for(let s=0;s<n;s++){const t=i[s];if((t===e||t.isPanelMain)&&t.c(!0),t.desiredSize.isReal())continue;const n=t.Xs(!1);!(t instanceof ze)&&!(t instanceof ie)&&!(t instanceof fe)&&0===n||t.c(!0)}}Qc(){if(this.Eo())return;this.ne(!0),this.to(!0);const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].Qc()}td(){if(!1===this.Eb()){this.nd(!0),this.wa(!0);const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].l2()}}l2(){this.wa(!0);const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].l2()}_u(t,e,i,n){const s=this.Ho;s.e(0,0,0,0);const o=this.desiredSize,r=this.minSize;void 0===i&&(i=r.width,n=r.height),i=Math.max(i,r.width),n=Math.max(n,r.height);const a=this.maxSize;isNaN(o.width)||(t=Math.min(o.width,a.width)),isNaN(o.height)||(e=Math.min(o.height,a.height)),t=Math.max(i,t),e=Math.max(n,e);const l=this.Zt;t=Math.max(t-l.left-l.right,0),e=Math.max(e-l.top-l.bottom,0);const h=this.T.r;this._.measure(this,t,e,h,s,i,n);let u=s.width+l.left+l.right,c=s.height+l.top+l.bottom;isFinite(o.width)&&(u=o.width),isFinite(o.height)&&(c=o.height),u=Math.min(a.width,u),c=Math.min(a.height,c),u=Math.max(r.width,u),c=Math.max(r.height,c),u=Math.max(i,u),c=Math.max(n,c),s.So(u,c),this.naturalBounds.So(u,c),this._n(0,0,u,c)}findMainElement(){if(null===this.ol){const t=this.T.r,e=t.length;if(0===e)return null;for(let i=0;i<e;i++){const e=t[i];if(!0===e.isPanelMain)return this.ol=e,e}this.ol=t[0]}return this.ol}Go(){return null!==this.part?this.part.locationObject:null}get panelLayoutState(){return this.C2}set panelLayoutState(t){this.C2=t}ch(t,e,i,n){const s=this.T.r;if(this.actualBounds.e(t,e,i,n),!this.desiredSize.isReal()){let t=this.Xs(!0);const e=this.measuredBounds,s=e.width,o=e.height,r=this.tl,a=r.left+r.right,l=r.top+r.bottom;switch(s===i&&o===n&&(t=0),t){case 0:(s>i||o>n)&&(this.c(),this.ut(s>i?i:s,o>n?n:o,0,0));break;case 2:this.c(!0),this.ut(i+a,n+l,0,0);break;case 5:this.c(!0),this.ut(i+a,o+l,0,0);break;case 4:this.c(!0),this.ut(s+a,n+l,0,0)}}this._.arrange(this,s,this.Ho)}ah(t){const e=this.naturalBounds,i=this.Go();if(D.contains(0,0,e.width,e.height,t.x,t.y)){const e=this.T.r,n=e.length,s=T.X(0,0);for(let o=n;o--;){const n=e[o];if((n.visible||n===i)&&(s.set(t).Ue(n.L),n.containsPoint(s)))return T.s(s),!0}return T.s(s),null!==this.Ct}return!1}p0(t){if(this.Zn===t)return this;const e=this.T.r,i=e.length;for(let n=0;n<i;n++){const i=e[n].p0(t);if(null!==i)return i}return null}walkVisualTreeFrom(t,e){if(e(this,t),t instanceof ie){const i=t.T.r,n=i.length;for(let t=0;t<n;t++)this.walkVisualTreeFrom(i[t],e)}}$r(t){this.mA(this,t)}mA(t,e){e(t);const i=t.T.r,n=i.length;for(let s=0;s<n;s++){const t=i[s];t instanceof ie&&this.mA(t,e)}}lv(t){this.pA(this,t)}pA(t,e){if(e(t),t instanceof ie){const i=t.T.r,n=i.length;for(let t=0;t<n;t++)this.pA(i[t],e)}}findInVisualTree(t){return this.yA(this,t)}yA(t,e){if(e(t))return t;if(t instanceof ie){const i=t.T.r,n=i.length;for(let t=0;t<n;t++){const n=this.yA(i[t],e);if(null!==n)return n}}return null}findObject(t){if(this.name===t)return this;const e=this.T.r;let i=e.length;this.hv()&&(i=this.ap());for(let n=0;n<i;n++){const i=e[n];if(i instanceof ie){const e=i.findObject(t);if(null!==e)return e}if(i.name===t)return i}return null}wA(){const t=this.T.r,e=t.length;let i=0;for(let n=0;n<e;n++){const e=t[n];e instanceof ie?i=Math.max(i,e.wA()):e instanceof le&&(i=Math.max(i,e.av()))}return i}wn(){return!(this.type===ie.TableRow||this.type===ie.TableColumn)}el(){return this.type===ie.TableRow||this.type===ie.TableColumn}$C(t,e,i){if(!1===this.pickable||(void 0===e&&(e=null),void 0===i&&(i=null),this.ss()))return null;const n=this.naturalBounds,s=1/this.getDocumentScale(),o=this.wn(),r=o?t:T.X(t.x,t.y).Ue(this.L),a=this.diagram;let l=10,h=5;if(null!==a&&(l=a.getInputOption("extraTouchArea"),h=l/2),D.contains(-h*s,-h*s,n.width+l*s,n.height+l*s,r.x,r.y)){if(!this.lf){const n=this.T.r,s=n.length,a=T.l(),l=this.isClipping&&this._===ie.Spot,h=l?this.findMainElement():null;if(l&&(h.wn()?a.set(t).Ue(h.L):a.set(t),!h.containsPoint(a)))return T.s(a),o||T.s(r),null;const u=this.Go();for(let c=s;c--;){const s=n[c];if(!s.visible&&s!==u||(s.wn()?a.set(t).Ue(s.L):a.set(t),l&&s===h))continue;let d=null;if(s instanceof ie?d=s.$C(a,e,i):!0===s.pickable&&s.containsPoint(a)&&(d=s),null!==d&&(null!==e&&(d=e(d)),null!==d&&(null===i||i(d))))return T.s(a),o||T.s(r),d}T.s(a)}if(null===this.background)return o||T.s(r),null;const s=D.contains(0,0,n.width,n.height,r.x,r.y)?this:null;return o||T.s(r),s}return o||T.s(r),null}ZC(t,e,i,n){if(!1===this.pickable)return!1;void 0===e&&(e=null),void 0===i&&(i=null);const s=this.naturalBounds,o=this.wn(),r=o?t:T.X(t.x,t.y).Ue(this.L),a=this.el(),l=D.contains(0,0,s.width,s.height,r.x,r.y);if(a||l){if(!this.lf){const s=this.T.r,o=s.length,r=T.l(),a=this.Go();for(let l=o;l--;){const o=s[l];if(!o.visible&&o!==a)continue;o.wn()?r.set(t).Ue(o.L):r.set(t);let h=o;const u=o instanceof ie?o:null;if(null!==u?u.ZC(r,e,i,n):h.containsPoint(r)){if(!1===h.pickable)continue;null!==e&&(h=e(h)),null!==h&&(null===i||i(h))&&n.add(h)}}T.s(r)}return o||T.s(r),l&&null!==this.background}return o||T.s(r),!1}Im(t,e,i,n,s,o){if(!1===this.pickable)return!1;void 0===e&&(e=null),void 0===i&&(i=null);let r=o;if(void 0===o&&(r=R.l(),r.Jt()),r.tc(this.L),this.containedInRect(t,r))return this.A2(e,i,s),void 0===o&&R.s(r),!0;if(this.intersectsRect(t,r)){if(!this.lf){const o=this.Go(),a=this.T.r;for(let l=a.length;l--;){const h=a[l];if(!h.visible&&h!==o)continue;const u=h.actualBounds,c=this.naturalBounds;if(u.x>c.width||u.y>c.height||u.x+u.width<0||u.y+u.height<0)continue;let d=h;const f=h instanceof ie?h:null,g=R.l();g.set(r),(null!==f?f.Im(t,e,i,n,s,g):d.WL(t,n,g))&&(null!==e&&(d=e(d)),null!==d&&(null===i||i(d))&&s.add(d)),R.s(g)}}return void 0===o&&R.s(r),n}return void 0===o&&R.s(r),!1}A2(t,e,i){const n=this.T.r;for(let s=n.length;s--;){const o=n[s];if(!o.visible)continue;const r=o.actualBounds,a=this.naturalBounds;if(r.x>a.width||r.y>a.height||r.x+r.width<0||r.y+r.height<0)continue;o instanceof ie&&o.A2(t,e,i);let l=o;null!==t&&(l=t(l)),null!==l&&(null===e||e(l))&&i.add(l)}}QC(t,e,i,n,s,o){if(!1===this.pickable)return!1;void 0===i&&(i=null),void 0===n&&(n=null);const r=this.naturalBounds,a=this.wn(),l=a?t:T.X(t.x,t.y).Ue(this.L),h=a?e:T.X(e.x,e.y).Ue(this.L),u=l.distanceSquaredPoint(h),c=l.x>0&&l.x<r.width&&l.y>0&&l.y<r.height||T.distanceLineSegmentSquared(l.x,l.y,0,0,0,r.height)<=u||T.distanceLineSegmentSquared(l.x,l.y,0,r.height,r.width,r.height)<=u||T.distanceLineSegmentSquared(l.x,l.y,r.width,r.height,r.width,0)<=u||T.distanceLineSegmentSquared(l.x,l.y,r.width,0,0,0)<=u,d=l.distanceSquared(0,0)<=u&&l.distanceSquared(0,r.height)<=u&&l.distanceSquared(r.width,0)<=u&&l.distanceSquared(r.width,r.height)<=u;if(a||(T.s(l),T.s(h)),c){if(!this.lf){const r=T.l(),l=T.l(),h=this.Go(),u=this.T.r;for(let c=u.length;c--;){const d=u[c];if(!d.visible&&d!==h)continue;const f=d.actualBounds,g=this.naturalBounds;if(a&&(f.x>g.width||f.y>g.height||f.x+f.width<0||f.y+f.height<0))continue;if(d.wn()){const i=d.L;r.set(t).Ue(i),l.set(e).Ue(i)}else r.set(t),l.set(e);let m=d;const p=d instanceof ie?d:null;(null!==p?p.QC(r,l,i,n,s,o):m.JL(r,l,s))&&(null!==i&&(m=i(m)),null!==m&&(null===n||n(m))&&o.add(m))}T.s(r),T.s(l)}return s?c:d}return!1}M2(t){let e=null;if(t instanceof le){e=t.spot1,e===O.Default&&(e=null);const i=t.geometry;null!==i&&null===e&&(e=i.spot1)}return null===e&&(e=O.TopLeft),e}S2(t){let e=null;if(t instanceof le){e=t.spot2,e===O.Default&&(e=null);const i=t.geometry;null!==i&&null===e&&(e=i.spot2)}return null===e&&(e=O.BottomRight),e}add(){for(let t=0;t<arguments.length;t++)this.insertAt(this.T.count,t<0||arguments.length<=t?void 0:arguments[t]);return this}elt(t){return this.T.elt(t)}insertAt(t,e){e instanceof ke&&d.o("Cannot add a Part to a Panel: "+e+"; use a Panel instead"),(this===e||this.isContainedBy(e))&&(this===e&&d.o("Cannot make a Panel contain itself: "+this.toString()),d.o("Cannot make a Panel indirectly contain itself: "+this.toString()+" already contains "+e.toString()));const i=e.panel;if(null!==i&&i!==this&&d.o("Cannot add a GraphObject that already belongs to another Panel to this Panel: "+e.toString()+", already contained by "+i.toString()+", cannot be shared by this Panel: "+this.toString()),this._===ie.Grid&&!(e instanceof le)&&d.o("Can only add Shapes to a Grid Panel, not: "+e),this._===ie.Graduated&&!(e instanceof le||e instanceof fe)&&d.o("Can only add Shapes or TextBlocks to a Graduated Panel, not: "+e),e.xa(this),e.il=null,null!==this.itemArray){const t=e.data;null!==t&&"object"==typeof t&&(null===this.Gs&&(this.Gs=new L),this.Gs.add(t,e))}const n=this.T;let s=-1;if(i===this){let o=-1;const r=this.T.r,a=r.length;for(let t=0;t<a;t++)if(r[t]===e){o=t;break}if(-1!==o){if(o===t||o+1>=n.count&&t>=n.count)return;n.removeAt(o),s=o}else d.o("element "+e.toString()+" has panel "+i.toString()+" but is not contained by it.")}(t<0||t>n.count)&&(t=n.count),n.insertAt(t,e),(0===t||e.isPanelMain)&&(this.ol=null),this.Eo()||this.c(),e.c(!1),(null!==e.portId||e instanceof ie&&!0===e.bn)&&(this.bn=!0),this.rs=null,this.isEnabledObject()||this.jb(e,!1);const o=this.part;if(null!==o){o.T0(),o.hf(),this.bn&&o instanceof Ce&&(o.bn=!0),o.bn&&o instanceof Ce&&(o.le=null);const i=this.diagram;if(null!==i&&i.undoManager.isUndoingRedoing)return;-1!==s&&o.raiseChangedEvent(4,"elements",this,e,null,s,null),o.raiseChangedEvent(3,"elements",this,null,e,null,t)}}get bn(){return 0!==(8388608&this.n)}set bn(t){0!==(8388608&this.n)!==t&&(this.n=8388608^this.n)}t2(){return 0!==(16777216&this.n)}T2(t){t?this.n|=16777216:this.n&=-16777217}rv(t){t.xa(this),t.il=null;const e=this.T,i=e.count;e.insertAt(i,t);const n=this.part;if(null!==n){n.T0(),null!==t.portId&&n instanceof Ce&&(n.bn=!0);const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;n.raiseChangedEvent(3,"elements",this,null,t,null,i)}}AR(t){const e=this.T.r,i=e.length;let n=-1;for(let s=0;s<i;s++)if(e[s]===t){n=s;break}return n}remove(t){const e=this.T.r,i=e.length;let n=-1;for(let s=0;s<i;s++)if(e[s]===t){n=s;break}-1!==n&&this.ie(n,!0)}removeAt(t){t>=0&&this.ie(t,!0)}ie(t,e){const i=this.T,n=i.elt(t);if(n.il=null,n.xa(null),null!==this.Gs){const t=n.data;"object"==typeof t&&this.Gs.remove(t)}i.removeAt(t),this.ne(!1),this.c(),this.ol===n&&(this.ol=null),this.rs=null;const s=this.part;if(null!==s){s.T0(),s.hf(),s.invalidateAdornments(),s instanceof Ce&&(n instanceof ie?n.walkVisualTreeFrom(n,((t,i)=>s.f2(i,e))):s.f2(n,e));const i=this.diagram;if(null!==i&&i.undoManager.isUndoingRedoing)return;s.raiseChangedEvent(4,"elements",this,n,null,t,null)}}get He(){return null===this.O&&(this.O=new oe),this.O.He}get rowCount(){return null===this.O?0:this.He.length}getRowDefinition(t){t<0&&d.tt(t,">= 0",ie,"getRowDefinition:idx"),t=Math.round(t);const e=this.He;if(void 0===e[t]){const i=new ae;i.xa(this),i.isRow=!0,i.index=t,e[t]=i,this.raiseChangedEvent(3,"rowdefs",this,null,i,null,t)}return e[t]}removeRowDefinition(t){if(t<0&&d.tt(t,">= 0",ie,"removeRowDefinition:idx"),0===this.rowCount)return;t=Math.round(t);const e=this.He,i=e[t];if(i){e[t]=void 0;let n=e.length-1;for(;n>=0&&void 0===e[n--];)e.length--;this.raiseChangedEvent(4,"rowdefs",this,i,null,t,null),this.c()}}CL(t,e){const i=this.He;if(!(t<0)){if(i[t]=e instanceof ae?e:void 0,!e){let t=i.length-1;for(;t>=0&&void 0===i[t--];)i.length--}this.c()}}get je(){return null===this.O&&(this.O=new oe),this.O.je}get columnCount(){return null===this.O?0:this.je.length}getColumnDefinition(t){t<0&&d.tt(t,">= 0",ie,"getColumnDefinition:idx"),t=Math.round(t);const e=this.je;if(void 0===e[t]){const i=new ae;i.xa(this),i.isRow=!1,i.index=t,e[t]=i,this.raiseChangedEvent(3,"coldefs",this,null,i,null,t)}return e[t]}removeColumnDefinition(t){if(t<0&&d.tt(t,">= 0",ie,"removeColumnDefinition:idx"),0===this.columnCount)return;t=Math.round(t);const e=this.je,i=e[t];if(i){e[t]=void 0;let n=e.length-1;for(;n>=0&&void 0===e[n--];)e.length--;this.raiseChangedEvent(4,"coldefs",this,i,null,t,null),this.c()}}LL(t,e){const i=this.je;if(!(t<0)){if(i[t]=e instanceof ae?e:void 0,!e){let t=i.length-1;for(;t>=0&&void 0===i[t--];)i.length--}this.c()}}addRowColumnDefinition(t){let e=null;return t.isRow?e=this.getRowDefinition(t.index):t.isRow||(e=this.getColumnDefinition(t.index)),e&&e.Vb(t),this}addRowDefinition(t,e){const i=this.getRowDefinition(t);return i&&i.Vb(new ae(e)),this}addColumnDefinition(t,e){const i=this.getColumnDefinition(t);return i&&i.Vb(new ae(e)),this}get rowSizing(){return null!==this.O?this.O.cp:3}set rowSizing(t){const e=this.rowSizing;e!==t&&(null===this.O&&(this.O=new oe),this.O.cp=t,this.c(),this.t("rowSizing",e,t))}get columnSizing(){return null!==this.O?this.O.fp:3}set columnSizing(t){const e=this.columnSizing;e!==t&&(null===this.O&&(this.O=new oe),this.O.fp=t,this.c(),this.t("columnSizing",e,t))}get topIndex(){return null!==this.O?this.O.dp:0}set topIndex(t){const e=this.topIndex;e!==t&&((!isFinite(t)||t<0)&&d.o("Panel.topIndex must be greater than zero and a real number, not: "+t),null===this.O&&(this.O=new oe),this.O.dp=t,this.c(),this.t("topIndex",e,t))}get leftIndex(){return null!==this.O?this.O.gp:0}set leftIndex(t){const e=this.leftIndex;e!==t&&((!isFinite(t)||t<0)&&d.o("Panel.leftIndex must be greater than zero and a real number, not: "+t),null===this.O&&(this.O=new oe),this.O.gp=t,this.c(),this.t("leftIndex",e,t))}findRowForLocalY(t){if(t<0||this.type!==ie.Table||0===this.rowCount)return-1;let e=0;const i=this.He,n=i.length;let s=this.topIndex;for(;s<n;s++){const n=i[s];if(void 0!==n&&(e+=n.total,t<e))return s}return s}findColumnForLocalX(t){if(t<0||this.type!==ie.Table||0===this.columnCount)return-1;let e=0;const i=this.je,n=i.length;let s=this.leftIndex;for(;s<n;s++){const n=i[s];if(void 0!==n&&(e+=n.total,t<e))return s}return s}graduatedPointForValue(t,e){if(void 0===e&&(e=new T(NaN,NaN)),this.type!==ie.Graduated)return e.e(NaN,NaN),e;t=Math.min(Math.max(t,this.graduatedMin),this.graduatedMax);const i=this.findMainElement();return i.geometry.getPointAlongPath((t-this.graduatedMin)/this.graduatedRange,e),i.L.xt(e)}graduatedValueForPoint(t){if(this.type!==ie.Graduated)return NaN;const e=this.findMainElement();return e.L.is(t),e.geometry.getFractionForPoint(t)*this.graduatedRange+this.graduatedMin}get data(){return this.Qt}set data(t){const e=this.Qt;if(e!==t){const i=this instanceof ke&&!(this instanceof Pe);i&&d.i(t,"object",ie,"data"),this.hi(),this.Qt=t;const n=this.diagram;if(null!==n)if(i)n.partManager.cv(this,e,t);else{const i=this.panel;null!==i&&null!==i.Gs&&(null!==e&&i.Gs.remove(e),null!==t&&i.Gs.add(t,this))}if(this.t("data",e,t),null!==n&&n.undoManager.isUndoingRedoing)return;null!==t&&this.updateTargetBindings()}}get itemIndex(){return this.ud}set itemIndex(t){const e=this.ud;e!==t&&(this.ud=t,this.t("itemIndex",e,t))}get Ys(){return null!==this.f?this.f.Ys:null}set Ys(t){this.Ti!==t&&(null===this.f&&(this.f=new Gt),this.f.Ys=t)}u2(){return null!==this.Ys}oA(){const t=this.Ys;return null!==t&&t.h}hi(){let t=this.Ys;if(null===t)null!==this.data&&d.o("Template cannot have .data be non-null: "+this),this.Ys=t=new x;else if(t.h)return this;const e=new x;this.T2(!1),this.walkVisualTreeFrom(this,((i,n)=>{n.hh();const s=n.Ti;if(null!==s){n.h2(!1);const o=s.iterator;for(;o.next();){const s=o.value;2===s.mode&&n.h2(!0);const r=s.sourceName;if(s.isToObject){"/"===r&&i.T2(!0);const t=s.qL(i,n);null!==t&&(e.add(t),null===t.Qn&&(t.Qn=new x),t.Qn.add(s))}t.add(s)}}if(n instanceof ie&&n.type===ie.Table){if(n.rowCount>0){const e=n.He,i=e.length;for(let n=0;n<i;n++){const i=e[n];if(void 0!==i&&null!==i.Hs){const e=i.Hs.iterator;for(;e.next();){const n=e.value;n.Se=i,n.md=2,n.af=i.index,t.add(n)}}}}if(n.columnCount>0){const e=n.je,i=e.length;for(let n=0;n<i;n++){const i=e[n];if(void 0!==i&&null!==i.Hs){const e=i.Hs.iterator;for(;e.next();){const n=e.value;n.Se=i,n.md=1,n.af=i.index,t.add(n)}}}}}}));const i=e.iterator;for(;i.next();){const t=i.value;if(null!==t.Qn){t.h2(!0);const e=t.Qn.iterator;for(;e.next();){const i=e.value;null===t.Ti&&(t.Ti=new x),t.Ti.add(i)}}t.Qn=null}let n=t.iterator;for(;n.next();){const t=n.value;let e=t.Se;if(null!==e){t.Se=null;const i=t.targetProperty,n=i.indexOf(".");if(n>0&&e instanceof ie){const s=i.substring(0,n),o=i.substring(n+1),r=e.findObject(s);null!==r?(e=r,t.targetProperty=o):(d.ri('Warning: unable to find GraphObject named "'+s+'" for Binding: '+t.toString()),e=null)}if(e instanceof ae){const i=k.fs(e.panel);t.targetId=void 0===i?-1:i,e.panel.Zn=t.targetId}else if(e instanceof Kt){const i=k.fs(e);t.targetId=void 0===i?-1:i,e.Zn=t.targetId}else d.o("Unknown type of binding target: "+e);t.check(e)}}return t.g(),this instanceof ke&&this.Ne()&&this.ensureBounds(),this}copyTemplate(t){void 0===t&&(t=!1);const e=this.copy();return e.lv((t=>{t instanceof ie&&(t.Ys=null,t.Qt=null);const e=t.Ti;null!==e&&(t.Ti=null,e.each((e=>t.bind(e.copy()))));const i=t.bs;null!==i&&(t.bs=null,i.each((e=>t.trigger(e.value.copy()))))})),t&&e.hi(),e}updateTargetBindings(t){const e=this.Ys;if(null===e)return;void 0===t&&(t="");const i=e.iterator;for(;i.next();){const e=i.value,n=this.xA(e,t);if(null===n)continue;const{data:s,elt:o}=n;e.isToTheme&&null===this.diagram||void 0!==o&&e.updateTarget(o,s)}}Vo(){if(null!==this.diagram)if(this.u2()){const t=this.Ys.iterator;for(;t.next();){const e=t.value;if(!e.isToTheme)continue;const i=this.xA(e);if(null===i)continue;const{data:n,elt:s}=i;void 0!==s&&e.updateTarget(s,n)}}else{const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].Vo()}}xA(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=t.sourceProperty;if(""!==e&&""!==i&&i!==e)return null;const n=t.targetProperty;if(null===t.converter&&""===n)return null;let s=this.data;const o=t.sourceName;if(t.isToObject){if(s=this.jL(o),null===s)return null}else if(t.isToModel){const t=this.diagram;if(null===t)return null;s=t.model.modelData}let r=this;const a=t.targetId;if(-1!==a){if(r=this.p0(a),null===r)return null}else null!==t.Se&&(r=t.Se);"/"===o?s=r.part:"."===o?s=r:".."===o&&(s=r.panel);const l=t.md;if(0!==l){if(!(r instanceof ie))return null;1===l?r=r.getColumnDefinition(t.af):2===l&&(r=r.getRowDefinition(t.af))}return{data:s,elt:r}}get itemArray(){return this.ph}set itemArray(t){const e=this.ph;if(e!==t||null!==t&&this.fv(t)){const i=this.diagram;if(e!==t&&(null!==i&&null!==e&&i.partManager.kS(this,i),this.ph=t,null!==i&&null!==t&&i.partManager.bS(this,i)),this.t("itemArray",e,t),null!==i&&i.undoManager.isUndoingRedoing)return;this.bA(e,t)}}findItemPanelForData(t){return null==t||null===this.Gs?null:(d.i(t,"object",ie,"findItemPanelForData"),this.Gs.getValue(t))}fv(t){const e=this.T.r,i=e.length,n=t.length;let s=0,o=null;for(;s<i&&(o=e[s],!(o instanceof ie)||null===o.data);)s++,o=e[s];if(i-s!==n)return!0;if(null===o)return n>0;let r=0;for(;s<i&&r<n;){if(o=e[s],!(o instanceof ie)||o.data!==t[r])return!0;s++,r++}return!1}ap(){if(this.type===ie.Spot||this.type===ie.Auto)return Math.min(this.T.length,1);if(this.type===ie.Link){const t=this.T,e=t.length;let i=0;for(;i<e;i++){const e=t.elt(i);if(!(e instanceof le)||!e.isPanelMain)return i}return i}if(this.type===ie.Table&&this.T.length>0){const t=this.T.elt(0);if(t.isPanelMain&&t instanceof ie&&t.el())return 1}return 0}rebuildItemElements(){const t=this.ap();for(;this.T.length>t;)this.ie(this.T.length-1,!1);this.bA(null,this.itemArray)}bA(t,e){const i=this.ap(),n=e;if(null!==n&&0!==n.length)if(this.T.length<=i){const t=n.length;for(let e=0;e<t;e++)this.qb(n[e],e,!0)}else{let t=i;for(let i=0;i<n.length;i++,t++){const e=n[i],s=t<this.T.length?this.T.elt(t):null;if(s instanceof ie){if(s.data!==e){const n=this.D2(s.data,i),o=this.D2(e,i);let r=o!==n;if(!r){const t=this.F2(s.data,i,n);r=this.F2(e,i,o)!==t}r?(this.ie(t,!1),this.qb(e,i,!1)):s.data=e}}else this.qb(e,i,!1)}for(;t<this.T.length;)this.ie(t,!1);this.ol=null,this.R2(i,0),this.Eo()||this.c(),this.rs=null,this.isEnabledObject()||this.jb(this,!1);const e=this.part;null!==e&&(e.T0(),e.hf(),this.bn&&e instanceof Ce&&(e.bn=!0),e.bn&&e instanceof Ce&&(e.le=null))}else for(;this.T.length>i;)this.ie(this.T.length-1,!1)}qb(t,e,i){if(null==t||e<0)return null;const n=this.D2(t,e),s=this.F2(t,e,n);if(null!==s){s.hi();const n=s.copy();if(n.t2()){const t=this.findBindingPanel();null!==t&&t.T2(!0)}"object"==typeof t&&(null===this.Gs&&(this.Gs=new L),this.Gs.add(t,n));const o=e+this.ap();return this.insertAt(o,n),i&&(n.Qt=t,this.R2(o,e),n.Qt=null),n.data=t,n}return null}uv(t){if(t<0)return;const e=t+this.ap();this.ie(e,!0),this.R2(e,t)}R2(t,e){const i=this.T;let n=t,s=e;for(;n<i.length;){const t=i.elt(n);t instanceof ie&&t.dv(n,s),n++,s++}}dv(t,e){this.type===ie.TableRow?this.row=t:this.type===ie.TableColumn&&(this.column=t),this.itemIndex=e}hv(){return null!==this.ph||null!==this.itemTemplateMap}get itemTemplate(){return null===this.itemTemplateMap?null:this.itemTemplateMap.getValue("")}set itemTemplate(t){if(null===this.itemTemplateMap){if(null===t)return;this.itemTemplateMap=new L}const e=this.itemTemplateMap.getValue("");if(e!==t){(t instanceof ke||t.isPanelMain)&&d.o("Panel.itemTemplate must not be a Part or be Panel.isPanelMain: "+t),this.itemTemplateMap.add("",t),this.t("itemTemplate",e,t);const i=this.diagram;if(null!==i&&i.undoManager.isUndoingRedoing)return;this.rebuildItemElements()}}get itemTemplateMap(){return null!==this.f?this.f.H0:null}set itemTemplateMap(t){const e=this.itemTemplateMap;if(e!==t){const i=t.iterator;for(;i.next();){i.value}this.Ht(),this.f.H0=t,this.t("itemTemplateMap",e,t);const n=this.diagram;if(null!==n&&n.undoManager.isUndoingRedoing)return;this.rebuildItemElements()}}get itemCategoryProperty(){return null!==this.f?this.f.j0:"category"}set itemCategoryProperty(t){const e=this.itemCategoryProperty;e!==t&&("string"!=typeof t&&"function"!=typeof t&&d.ke(t,"string or function",ie,"itemCategoryProperty"),this.Ht(),this.f.j0=t,this.t("itemCategoryProperty",e,t))}D2(t,e){if(null===t)return"";const i=this.itemCategoryProperty;let n="";if("function"==typeof i)n=i(t);else{if("string"!=typeof i||"object"!=typeof t)return"";if(""===i)return"";n=Ze.vt(t,i)}return void 0===n?"":"string"==typeof n?n:void d.o("Panel.getCategoryForItemData found a non-string category for "+t+": "+n)}F2(t,e,i){const n=this.itemTemplateMap;let s=null;return null!==n&&(s=n.getValue(i)),null===s&&(null!==n&&(s=n.getValue("")),null===s&&(ie.kA||(ie.kA=!0,d.ri('No item template Panel found for category "'+i+'" on '+this),d.ri("  Using default item template."),ie.PA=(new ie).add((new fe).bind("text","",d.toString).theme("stroke","text"))),s=ie.PA)),s}get lf(){return 0!==(1048576&this.n)}set lf(t){const e=0!==(1048576&this.n);e!==t&&(d.i(t,"boolean",ie,"isAtomic"),this.n=1048576^this.n,this.t("isAtomic",e,t))}get isClipping(){return 0!==(2097152&this.n)}set isClipping(t){const e=0!==(2097152&this.n);e!==t&&(this.n=2097152^this.n,this instanceof Ve&&(this.si=null),this.c(),this.t("isClipping",e,t))}get isOpposite(){return 0!==(33554432&this.n)}set isOpposite(t){const e=0!==(33554432&this.n);e!==t&&(d.i(t,"boolean",ie,"isOpposite"),this.n=33554432^this.n,this.c(),this.t("isOpposite",e,t))}get isEnabled(){return 0!==(4194304&this.n)}set isEnabled(t){const e=0!==(4194304&this.n);if(e!==t){d.i(t,"boolean",ie,"isEnabled");const i=null===this.panel||this.panel.isEnabledObject();this.n=4194304^this.n,this.t("isEnabled",e,t);const n=this.diagram;if(null!==n&&n.undoManager.isUndoingRedoing)return;i&&this.jb(this,t)}}jb(t,e){const i=t.enabledChanged;if(null!==i&&i(t,e),t instanceof ie){const i=t.T.r,n=i.length;for(let t=0;t<n;t++){const n=i[t];e&&n instanceof ie&&!n.isEnabled||this.jb(n,e)}}}get alignmentFocusName(){return this.no}set alignmentFocusName(t){const e=this.no;e!==t&&(this.no=t,this.c(),this.t("alignmentFocusName",e,t))}static definePanelLayout(t,e){te.definePanelLayout(t,e)}}y(ie,"uE",!1),y(ie,"kA",!1),y(ie,"PA",null),y(ie,"Position",te.Layouts.getValue("Position")),y(ie,"Horizontal",te.Layouts.getValue("Horizontal")),y(ie,"Vertical",te.Layouts.getValue("Vertical")),y(ie,"Spot",te.Layouts.getValue("Spot")),y(ie,"Auto",te.Layouts.getValue("Auto")),y(ie,"Table",te.Layouts.getValue("Table")),y(ie,"Viewbox",te.Layouts.getValue("Viewbox")),y(ie,"TableRow",te.Layouts.getValue("TableRow")),y(ie,"TableColumn",te.Layouts.getValue("TableColumn")),y(ie,"Link",te.Layouts.getValue("Link")),y(ie,"Grid",te.Layouts.getValue("Grid")),y(ie,"Graduated",te.Layouts.getValue("Graduated")),ie.definePanelLayout=ie.definePanelLayout;class ne{constructor(){y(this,"op",void 0),y(this,"rp",void 0),y(this,"lp",void 0),y(this,"hp",void 0),y(this,"ks",void 0),y(this,"qe",void 0),y(this,"rs",void 0),y(this,"Ce",void 0),this.op=0,this.rp=100,this.lp=10,this.hp=0,this.ks=null,this.qe=null,this.rs=null,this.Ce=null}copy(){const t=new ne;return t.op=this.op,t.rp=this.rp,t.lp=this.lp,t.hp=this.hp,t.ks=this.ks,t.qe=this.qe,t.rs=this.rs,t.Ce=this.Ce,t}}class se{constructor(){y(this,"dd",void 0),y(this,"gd",void 0),y(this,"zc",void 0),y(this,"Z0",void 0),this.dd=A.ZN,this.gd=T.Mo,this.zc=A.gw,this.Z0=[]}copy(){const t=new se;return t.dd=this.dd.copy(),t.gd=this.gd.copy(),t.zc=this.zc.copy(),t.Z0=this.Z0,t}}class oe{constructor(){y(this,"He",void 0),y(this,"je",void 0),y(this,"cp",void 0),y(this,"fp",void 0),y(this,"dp",void 0),y(this,"gp",void 0),y(this,"Q0",void 0),y(this,"tp",void 0),y(this,"_0",void 0),y(this,"ip",void 0),y(this,"sp",void 0),y(this,"ep",void 0),y(this,"np",void 0),y(this,"mh",void 0),this.He=[],this.je=[],this.cp=3,this.fp=3,this.dp=0,this.gp=0,this.Q0=F.Ug,this.tp=1,this._0=null,this.ip=null,this.sp=1,this.ep=null,this.np=null,this.mh=null}copy(t){const e=new oe,i=this.He,n=i.length,s=e.He;for(let l=0;l<n;l++){if(void 0===i[l])continue;const e=i[l].copy();e.xa(t),s[l]=e}const o=this.je,r=o.length,a=e.je;for(let l=0;l<r;l++){if(void 0===o[l])continue;const e=o[l].copy();e.xa(t),a[l]=e}return e.cp=this.cp,e.fp=this.fp,e.dp=this.dp,e.gp=this.gp,e.Q0=this.Q0.N(),e.tp=this.tp,e._0=this._0,e.ip=this.ip,e.sp=this.sp,e.ep=this.ep,e.np=this.np,e.mh=this.mh,e}}var re=(t=>(t[t.Default=1]="Default",t[t.None=2]="None",t[t.ProportionalExtra=3]="ProportionalExtra",t))(re||{});class ae{constructor(t){y(this,"zs",void 0),y(this,"mp",void 0),y(this,"Dt",void 0),y(this,"Ma",void 0),y(this,"Sa",void 0),y(this,"oi",void 0),y(this,"st",void 0),y(this,"pd",void 0),y(this,"io",void 0),y(this,"jo",void 0),y(this,"yd",void 0),y(this,"wd",void 0),y(this,"Na",void 0),y(this,"Ct",void 0),y(this,"xd",void 0),y(this,"Hs",void 0),y(this,"ot",void 0),y(this,"Hi",void 0),y(this,"pe",void 0),k.Yi(this),this.zs=null,this.mp=!0,this.Dt=0,this.pe=NaN,this.Ma=0,this.Sa=1/0,this.oi=O.Default,this.ot=0,this.Hi=0,this.st=0,this.Hs=null,this.pd=1,this.io=1,this.jo=null,this.yd=null,this.wd=NaN,this.Na=null,this.Ct=null,this.xd=!1,t&&(Object.assign(this,t),void 0!==t.column?(this.isRow=!1,this.index=t.column):void 0!==t.row&&(this.isRow=!0,this.index=t.row))}copy(){const t=new ae;return t.mp=this.mp,t.Dt=this.Dt,t.pe=this.pe,t.Ma=this.Ma,t.Sa=this.Sa,t.oi=this.oi,t.ot=this.ot,t.Hi=this.Hi,t.st=this.st,t.io=this.io,t.pd=this.pd,null===this.jo?t.jo=null:t.jo=this.jo.N(),t.yd=this.yd,t.wd=this.wd,t.Na=null,null!==this.Na&&(t.separatorDashArray=this.separatorDashArray.slice()),t.Ct=this.Ct,t.xd=this.xd,t.Hs=this.Hs,t}Vb(t){t.isRow?this.height=t.height:this.width=t.width,this.minimum=t.minimum,this.maximum=t.maximum,this.alignment=t.alignment,this.stretch=t.stretch,this.sizing=t.sizing,this.jo=null===t.separatorPadding?null:t.separatorPadding.N(),this.separatorStroke=t.separatorStroke,this.separatorStrokeWidth=t.separatorStrokeWidth,this.Na=null,t.separatorDashArray&&(this.Na=t.separatorDashArray.slice()),this.background=t.background,this.coversSeparators=t.coversSeparators,this.Hs=t.Hs}li(t){t in re?this.sizing=t:d.ar(this,t)}toString(){return"RowColumnDefinition "+(this.isRow?"(Row ":"(Column ")+this.index+") #"+k.fs(this)}xa(t){this.zs=t}computeEffectiveSpacingTop(t){let e=0;const i=this.zs;if(this.index!==t){let t=this.separatorStroke;null===t&&null!==i&&(t=this.isRow?i.defaultRowSeparatorStroke:i.defaultColumnSeparatorStroke),null!==t&&(e=this.separatorStrokeWidth,isNaN(e)&&(e=null!==i?this.isRow?i.defaultRowSeparatorStrokeWidth:i.defaultColumnSeparatorStrokeWidth:0))}let n=this.jo;if(null===n){if(null===i)return e;n=i.defaultSeparatorPadding}return e+(this.isRow?n.top:n.left)}computeEffectiveSpacing(){let t=0;const e=this.zs;let i=0;const n=this.isRow;if(null!==e&&e.type===ie.Table){const t=n?e.He.length:e.je.length;for(let s=0;s<t;s++){const t=n?e.He[s]:e.je[s];if(void 0!==t&&0!==t.ot){i=t.index;break}}}if(this.index!==i){let i=this.separatorStroke;null===i&&null!==e&&(i=n?e.defaultRowSeparatorStroke:e.defaultColumnSeparatorStroke),null!==i&&(t=this.separatorStrokeWidth,isNaN(t)&&(t=null!==e?n?e.defaultRowSeparatorStrokeWidth:e.defaultColumnSeparatorStrokeWidth:0))}let s=this.jo;if(null===s){if(null===e)return t;s=e.defaultSeparatorPadding}return t+(this.isRow?s.top+s.bottom:s.left+s.right)}t(t,e,i,n,s){const o=this.zs;if(null!==o&&(o.raiseChangedEvent(2,t,this,e,i,n,s),null!==this.Hs)){const e=o.diagram;if(null!==e&&!e.ge){const e=o.findBindingPanel();if(null!==e){const i=e.data;if(null!==i){const n=this.Hs.iterator;for(;n.next();)n.value.updateSource(this,i,t,e)}}}}}get panel(){return this.zs}get isRow(){return this.mp}set isRow(t){this.mp=t}get index(){return this.Dt}set index(t){this.Dt=t}get height(){return this.pe}set height(t){const e=this.pe;e!==t&&(t<0&&d.tt(t,">= 0",ae,"height"),this.pe=t,this.actual=this.ot,null!==this.panel&&this.panel.c(),this.t("height",e,t))}get width(){return this.pe}set width(t){const e=this.pe;e!==t&&(t<0&&d.tt(t,">= 0",ae,"width"),this.pe=t,this.actual=this.ot,null!==this.panel&&this.panel.c(),this.t("width",e,t))}get minimum(){return this.Ma}set minimum(t){const e=this.Ma;e!==t&&((t<0||!isFinite(t))&&d.tt(t,">= 0",ae,"minimum"),this.Ma=t,this.actual=this.ot,null!==this.panel&&this.panel.c(),this.t("minimum",e,t))}get maximum(){return this.Sa}set maximum(t){const e=this.Sa;e!==t&&(t<0&&d.tt(t,">= 0",ae,"maximum"),this.Sa=t,this.actual=this.ot,null!==this.panel&&this.panel.c(),this.t("maximum",e,t))}get alignment(){return this.oi}set alignment(t){const e=this.oi;e.equals(t)||(this.oi=t.N(),null!==this.panel&&this.panel.c(),this.t("alignment",e,t))}get stretch(){return this.io}set stretch(t){const e=this.io;e!==t&&(this.io=t,null!==this.panel&&this.panel.c(),this.t("stretch",e,t))}get separatorPadding(){return this.jo}set separatorPadding(t){"number"==typeof t&&(t=new F(t));const e=this.jo;(null===t||null===e||!e.equals(t))&&(null!==t&&(t=t.N()),this.jo=t,null!==this.panel&&this.panel.c(),this.t("separatorPadding",e,t))}get separatorStroke(){return this.yd}set separatorStroke(t){const e=this.yd;e!==t&&(null!==t&&Qt.od(t,"RowColumnDefinition.separatorStroke"),t instanceof Qt&&t.g(),this.yd=t,null!==this.panel&&this.panel.c(),this.t("separatorStroke",e,t))}get separatorStrokeWidth(){return this.wd}set separatorStrokeWidth(t){const e=this.wd;e!==t&&(this.wd=t,null!==this.panel&&this.panel.c(),this.t("separatorStrokeWidth",e,t))}get separatorDashArray(){return this.Na}set separatorDashArray(t){const e=this.Na;if(e!==t){if(null!==t&&!Array.isArray(t)&&d.ke(t,"Array",ae,"separatorDashArray:value"),null!==t){const i=t.length;let n=0;for(let e=0;e<i;e++){const i=t[e];("number"!=typeof i||!(i>=0)||!isFinite(i))&&d.o("separatorDashArray value "+i+" at index "+e+" must be a positive number or zero."),n+=i}if(0===n){if(null===e)return;t=null}}this.Na=t,null!==this.panel&&this.panel.C(),this.t("separatorDashArray",e,t)}}get background(){return this.Ct}set background(t){const e=this.Ct;e!==t&&(null!==t&&Qt.od(t,"RowColumnDefinition.background"),t instanceof Qt&&t.g(),this.Ct=t,null!==this.panel&&this.panel.C(),this.t("background",e,t))}get coversSeparators(){return this.xd}set coversSeparators(t){const e=this.xd;e!==t&&(d.i(t,"boolean",ae,"coversSeparators"),this.xd=t,null!==this.panel&&this.panel.C(),this.t("coversSeparators",e,t))}get sizing(){return this.pd}set sizing(t){const e=this.pd;e!==t&&(this.pd=t,null!==this.panel&&this.panel.c(),this.t("sizing",e,t))}Yb(){if(1===this.sizing){const t=this.zs;return this.isRow?t.rowSizing:t.columnSizing}return this.sizing}get actual(){return this.ot}set actual(t){isNaN(this.pe)?this.ot=Math.max(Math.min(this.Sa,t),this.Ma):this.ot=Math.max(Math.min(this.Sa,this.pe),this.Ma)}get measured(){return this.Hi}set measured(t){this.Hi=t}get total(){return this.ot+this.computeEffectiveSpacing()}get position(){return this.st}set position(t){this.st=t}bind(t,e,i,n){return this.tf(t,e,i,n),this}bindTwoWay(t,e,i,n){const s=this.tf(t,e,i,n);return void 0===n&&s.makeTwoWay(),this}theme(t,e,i,n,s){return this.dh(t,e,i,n,s),this}themeData(t,e,i,n,s){return this.dh(t,e,i,n,s).ofData(),this}themeObject(t,e,i,n,s,o){return this.dh(t,e,i,n,s).ofObject(o),this}themeModel(t,e,i,n,s){return this.dh(t,e,i,n,s).ofModel(),this}tf(t,e,i,n){let s=null;return s="string"==typeof t?new $e(t,e,i,n):t,this.Y0(s),s}dh(t,e,i,n,s){let o=null;return o="string"==typeof t?new Je(t,e,i,n,s):t,this.Y0(o),o}Y0(t){t.Se=this;const e=this.panel;if(null!==e){const i=e.findBindingPanel();null!==i&&i.oA()&&d.o("Cannot add a Binding to a RowColumnDefinition that is already frozen: "+t+" on "+e)}null===this.Hs&&(this.Hs=new x),this.Hs.add(t)}}y(ae,"Default",1),y(ae,"None",2),y(ae,"ProportionalExtra",3);class le extends Kt{constructor(t,e){super(),y(this,"ft",void 0),y(this,"Ps",void 0),y(this,"bd",void 0),y(this,"Ca",void 0),y(this,"ji",void 0),y(this,"qo",void 0),y(this,"Yo",void 0),y(this,"Lt",void 0),y(this,"kd",void 0),y(this,"Pd",void 0),y(this,"$",void 0),this.ft=null,this.Ps=null,this.bd="None",this.Ca="black",this.ji="black",this.qo=1,this.Yo=null,this.Lt=null,this.kd=NaN,this.Pd=NaN,this.$=null,"string"==typeof t?this.figure=t:t&&Object.assign(this,t),e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.ft=this.ft,t.Ps=this.Ps,t.bd=this.bd,t.Ca=this.Ca,t.ji=this.ji,t.qo=this.qo,null!==this.Yo&&(t.Yo=this.Yo.slice()),null!==this.Lt&&(this.Lt.mi?t.Lt=this.Lt:t.Lt=this.Lt.copy()),t.kd=this.kd,t.Pd=this.Pd,null!==this.$&&(t.$=this.$.copy())}La(){null===this.Lt?this.Lt=new he:this.Lt.mi&&(this.Lt=this.Lt.copy())}hh(){super.hh(),null!==this.Lt&&(this.Lt.mi=!0)}li(t){t in V?this.geometryStretch=t:super.li(t)}toString(){return"Shape("+("None"!==this.figure?this.figure:"None"!==this.toArrow?this.toArrow:this.fromArrow)+")#"+k.fs(this)}gv(t,e){const i=this.pathPattern;i.ut(1/0,1/0);const n=i.measuredBounds;i.zt(0,0,n.width,n.height);const s=this.geometry;t.save(),t.beginPath();const o=d.rt();if(1===s.type)o.push(s.startX),o.push(s.startY),o.push(s.endX),o.push(s.endY),this.Md(t,e,o,i);else if(4===s.type){const n=s.figures.iterator;for(;n.next();){const s=n.value;o.length=0,o.push(s.startX),o.push(s.startY);let r=s.startX,a=s.startY,l=r,h=a;const u=s.segments.r,c=u.length;for(let n=0;n<c;n++){const c=u[n];switch(c.type){case 1:this.Md(t,e,o,i),o.length=0,o.push(c.endX),o.push(c.endY),r=c.endX,a=c.endY,l=r,h=a;break;case 2:o.push(c.endX),o.push(c.endY),r=c.endX,a=c.endY;break;case 3:E.Bn(r,a,c.point1X,c.point1Y,c.point2X,c.point2Y,c.endX,c.endY,.5,o),r=c.endX,a=c.endY;break;case 4:E.Bg(r,a,c.point1X,c.point1Y,c.endX,c.endY,.5,o),r=c.endX,a=c.endY;break;case 5:{const t=c.Co(s),e=t.length;if(0===e){o.push(c.centerX),o.push(c.centerY),r=c.centerX,a=c.centerY;break}for(let i=0;i<e;i++){const e=t[i];E.Bn(r,a,e[2],e[3],e[4],e[5],e[6],e[7],.5,o),r=e[6],a=e[7]}break}case 6:{const t=c.Vh(s,r,a),e=t.length;if(0===e){o.push(c.endX),o.push(c.endY),r=c.endX,a=c.endY;break}for(let i=0;i<e;i++){const e=t[i];E.Bn(r,a,e[2],e[3],e[4],e[5],e[6],e[7],.5,o),r=e[6],a=e[7]}break}default:d.o("Segment not of valid type: "+c.type)}c.isClosed&&(o.push(l),o.push(h),this.Md(t,e,o,i))}this.Md(t,e,o,i)}}else if(2===s.type)o.push(s.startX),o.push(s.startY),o.push(s.endX),o.push(s.startY),o.push(s.endX),o.push(s.endY),o.push(s.startX),o.push(s.endY),o.push(s.startX),o.push(s.startY),this.Md(t,e,o,i);else if(3===s.type){const n=new j;n.startX=s.endX,n.startY=(s.startY+s.endY)/2;const r=new K(5);r.startAngle=0,r.sweepAngle=360,r.centerX=(s.startX+s.endX)/2,r.centerY=(s.startY+s.endY)/2,r.radiusX=Math.abs(s.startX-s.endX)/2,r.radiusY=Math.abs(s.startY-s.endY)/2,n.add(r);const a=r.Co(n),l=a.length;if(0===l)o.push(r.centerX),o.push(r.centerY);else{let t=n.startX,e=n.startY;for(let i=0;i<l;i++){const n=a[i];E.Bn(t,e,n[2],n[3],n[4],n[5],n[6],n[7],.5,o),t=n[6],e=n[7]}}this.Md(t,e,o,i)}d.it(o),t.restore(),t.clearContextCache(!1)}mv(t){let e=t.measuredBounds.width;return t instanceof le&&(e-=t.strokeWidth),e<1&&(e=1),e}Md(t,e,i,n){const s=i.length;if(s<4)return;const o=n.measuredBounds,r=Math.max(1,o.width),a=o.height;let l=i[0],h=i[1],u=0,c=0,f=0,g=0,m=0,p=0,y=0,v=0;const b=d.rt();for(let d=2;d<s;d+=2)u=i[d],c=i[d+1],f=u-l,g=c-h,0===f&&(f=.001),m=g/f,p=Math.atan2(g,f),y=Math.sqrt(f*f+g*g),b.push([f,p,m,y]),v+=y,l=u,h=c;l=i[0],h=i[1];const x=this.mv(n);let w=x;const k=r/2;let S=0!==k,P=0,M=b[P];f=M[0],p=M[1],m=M[2],y=M[3];let C=0;for(;v>=.1;){if(0===C&&(S?(w=x,w-=k,v-=k,S=!1):w=x,0===w&&(w=1)),w>v)return w=v,void d.it(b);w>y?(C=w-y,w=y):C=0;let i=Math.sqrt(w*w/(1+m*m));if(f<0&&(i=-i),l+=i,h+=m*i,t.translate(l,h),t.rotate(p),t.translate(-r/2,-a/2),0===C&&n.uh(t,e),t.translate(r/2,a/2),t.rotate(-p),t.translate(-l,-h),v-=w,y-=w,0!==C){if(P++,P===b.length)return void d.it(b);M=b[P],f=M[0],p=M[1],m=M[2],y=M[3],w=C}}d.it(b)}uh(t,e){const i=t instanceof Ht;let n=this.ji;const s=this.Ca;if(null===n&&null===s)return;const o=this.ft;if(null===o)return;t.commitTransform();const r=this.actualBounds,a=this.naturalBounds;null!==s&&this.mn(t,s,!0,!1,a,r);const l=this.part;let h=this.qo;null!==n&&0===h&&null!==l&&(this.isPanelMain||l.findMainElement()===this)&&(h=l.pv()),0===h&&(n=null),null!==n&&0!==h&&(this.mn(t,n,!1,!1,a,r),t.lineWidth=h,t.lineJoin=this.strokeJoin,t.lineCap=this.strokeCap,t.miterLimit=this.strokeMiterLimit);let u=!1;l&&e.getRenderingHint("drawShadows")&&(u=l.isShadowed),!1===t.sl&&(u=!1);let c=!0;null!==n&&(null===s||"transparent"===s)&&(c=!1);let d=!1;const f=this.strokeDashArray;if(null!==f&&(d=!0,t.enableDash(f,this.strokeDashOffset)),1===o.type)t.beginPath(),t.moveTo(o.startX,o.startY),t.lineTo(o.endX,o.endY),null!==n&&t.strokeContext(),t.endPath();else if(2===o.type){const e=o.startX,i=o.startY,r=o.endX,a=o.endY,l=Math.min(e,r),h=Math.min(i,a),d=Math.abs(r-e),f=Math.abs(a-i);t.beginPath(),t.rect(l,h,d,f),null!==s&&t.fillContext(s,!1,null),null!==n&&(c&&u&&t.shadowsOff(),t.strokeContext(),c&&u&&t.shadowsOn()),t.endPath()}else if(3===o.type){const e=o.startX,i=o.startY,r=o.endX,a=o.endY,l=Math.abs(r-e)/2,h=Math.abs(a-i)/2,d=Math.min(e,r)+l,f=Math.min(i,a)+h;t.beginPath(),t.moveTo(d,f-h),t.bezierCurveTo(d+E.Un*l,f-h,d+l,f-E.Un*h,d+l,f),t.bezierCurveTo(d+l,f+E.Un*h,d+E.Un*l,f+h,d,f+h),t.bezierCurveTo(d-E.Un*l,f+h,d-l,f+E.Un*h,d-l,f),t.bezierCurveTo(d-l,f-E.Un*h,d-E.Un*l,f-h,d,f-h),t.closePath(),null!==s&&t.fillContext(s,!1,null),null!==n&&(c&&u&&t.shadowsOff(),t.strokeContext(),c&&u&&t.shadowsOn()),t.endPath()}else if(4===o.type){const e=o.figures,r=e.length;for(let o=0;o<r;o++){const r=e.r[o];i?this.buildPath(t,r):null===r.ze&&(r.ze=new Path2D,this.buildPath(r.ze,r));const a=r.isFilled;u?r.isShadowed?(!0===a&&"transparent"!==s&&null!==s&&t.fillContext(s,r.isEvenOdd,r.ze),null!==n&&(a&&c&&t.shadowsOff(),t.stroke(r.ze),a&&c&&t.shadowsOn())):(t.shadowsOff(),a&&"transparent"!==s&&null!==s&&t.fillContext(s,r.isEvenOdd,r.ze),null!==n&&t.stroke(r.ze),t.shadowsOn()):(a&&null!==s&&t.fillContext(s,r.isEvenOdd,r.ze),null!==n&&t.stroke(r.ze)),t.endPath(o)}}d&&t.disableDash(),null!==this.pathPattern&&this.gv(t,e)}buildPath(t,e){t instanceof Path2D||t.beginPath(),t.moveTo(e.startX,e.startY);const i=e.segments.r,n=i.length;let s=null;for(let o=0;o<n;o++){const n=i[o];switch(n.type){case 1:t.moveTo(n.endX,n.endY);break;case 2:t.lineTo(n.endX,n.endY);break;case 3:t.bezierCurveTo(n.point1X,n.point1Y,n.point2X,n.point2Y,n.endX,n.endY);break;case 4:t.quadraticCurveTo(n.point1X,n.point1Y,n.endX,n.endY);break;case 5:if(n.radiusX===n.radiusY){const i=null!==s?s.endX:e.startX,o=null!==s?s.endY:e.startY,r=Math.PI/180;t.arc(n.point1X,n.point1Y,n.radiusX,n.startAngle*r,(n.startAngle+n.sweepAngle)*r,n.sweepAngle<0,i,o)}else{const i=n.Co(e),s=i.length;if(0===s){t.lineTo(n.centerX,n.centerY);break}for(let e=0;e<s;e++){const n=i[e];0===e&&t.lineTo(n[0],n[1]),t.bezierCurveTo(n[2],n[3],n[4],n[5],n[6],n[7])}}break;case 6:{let i,o=0,r=0;if(null!==s&&5===s.type){i=s.Co(e);const a=i.length;if(0===a){t.lineTo(n.endX,n.endY);break}const l=i[a-1]||null;null!==l&&(o=l[6],r=l[7])}else o=null!==s?s.endX:e.startX,r=null!==s?s.endY:e.startY;i=n.Vh(e,o,r);const a=i.length;if(0===a){t.lineTo(n.endX,n.endY);break}for(let e=0;e<a;e++){const n=i[e];t.bezierCurveTo(n[2],n[3],n[4],n[5],n[6],n[7])}break}}n.isClosed&&t.closePath(),s=n}}$c(t,e,i){if(!super.$c(t,e,i)||null===this.ji&&null===this.Ca||null===this.ft||null!==this.pathPattern)return!1;const n=this.svg.getElementsByTagName("path");return this.geometry.figures.length===n.length&&(t.currentPath=this.svg,this.uh(t,e),t.currentPath=null,!0)}sd(t){return null!==this.geometry&&this.geometry.figures.length>1||null!==this.pathPattern||super.sd(t)}s2(t,e){if("g"!==t.nodeName)t.setAttributeNS(null,"filter",e);else{const i=t.getElementsByTagName("path");for(let t=0;t<i.length;t++)i[t].setAttributeNS(null,"filter",e)}}getDocumentPoint(t,e){if(void 0===e&&(e=new T),t instanceof O){const i=t;i.isNoSpot()&&d.o("getDocumentPoint Spot must be a real, specific Spot, not: "+i.toString());const n=this.naturalBounds,s=this.strokeWidth;return e.e(i.x*(n.width+s)-s/2+n.x+i.offsetX,i.y*(n.height+s)-s/2+n.y+i.offsetY),this.ws.xt(e),e}return e.set(t),this.ws.xt(e),e}getDocumentBounds(t){void 0===t&&(t=new D);const e=this.naturalBounds,i=this.ws,n=D.X(e.x,e.y,e.width,e.height),s=this.strokeWidth;n.inflate(s/2,s/2);const o=T.X(n.x,n.y).L(i);return t.e(o.x,o.y,0,0),o.e(n.right,n.y).L(i),t.unionNoCheck(o.x,o.y,0,0),o.e(n.right,n.bottom).L(i),t.unionNoCheck(o.x,o.y,0,0),o.e(n.x,n.bottom).L(i),t.unionNoCheck(o.x,o.y,0,0),D.s(n),T.s(o),t}ah(t,e){const i=this.geometry;if(null===i||null===this.fill&&null===this.stroke)return!1;const n=i.bounds;let s=this.strokeWidth/2;1===i.type&&!e&&(s+=2);const o=D.l();if(o.a(n),o.inflate(s+2,s+2),!o.containsPoint(t))return D.s(o),!1;const r=s+1e-4;if(1===i.type){if(null===this.stroke)return!1;const e=(i.startX-i.endX)*(t.x-i.endX)+(i.startY-i.endY)*(t.y-i.endY),n=(i.endX-i.startX)*(t.x-i.startX)+(i.endY-i.startY)*(t.y-i.startY);return!(e<0||n<0)&&(D.s(o),E.vi(i.startX,i.startY,i.endX,i.endY,s,t.x,t.y))}if(2===i.type){const e=i.startX,n=i.startY,a=i.endX,l=i.endY;if(o.x=Math.min(e,a),o.y=Math.min(n,l),o.width=Math.abs(a-e),o.height=Math.abs(l-n),null===this.fill){if(o.inflate(-r,-r),o.containsPoint(t))return D.s(o),!1;o.inflate(r,r)}null!==this.stroke&&o.inflate(s,s);const h=o.containsPoint(t);return D.s(o),h}if(3===i.type){const e=i.startX,n=i.startY,s=i.endX,a=i.endY;let l=Math.min(e,s),h=Math.min(n,a);let u=Math.abs(s-e)/2,c=Math.abs(a-n)/2;if(l=t.x-(l+u),h=t.y-(h+c),null===this.fill){if(u-=r,c-=r,u<=0||c<=0)return D.s(o),!1;if(l*l/(u*u)+h*h/(c*c)<=1)return D.s(o),!1;u+=r,c+=r}return null!==this.stroke&&(u+=r,c+=r),D.s(o),!(u<=0||c<=0)&&l*l/(u*u)+h*h/(c*c)<=1}if(4===i.type)return D.s(o),null===this.fill?i.pC(t.x,t.y,s):i.Bk(t,s,this.strokeWidth>1,e);d.o("Unknown Geometry type: "+i.type)}_u(t,e,i,n){const s=this.desiredSize,o=this.qo;let r;if(t=Math.max(t,0),e=Math.max(e,0),null!==this.Ps)r=this.geometry.bounds;else{const t=this.figure;let e=le.v2[t];if(void 0===e){let i=E.No[t];"string"==typeof i&&(i=E.No[i]),"function"==typeof i?(e=i(null,100,100),le.v2[t]=e):d.o("Unsupported Figure: "+t)}r=e.bounds}let a=r.width,l=r.height,h=r.width,u=r.height;switch(this.Xs(!0)){case 0:i=0,n=0;break;case 2:h=Math.max(t-o,0),u=Math.max(e-o,0);break;case 5:h=Math.max(t-o,0),n=0;break;case 4:i=0,u=Math.max(e-o,0)}isFinite(s.width)&&(h=s.width),isFinite(s.height)&&(u=s.height);const c=this.maxSize,f=this.minSize;i=Math.max(i-o,f.width),n=Math.max(n-o,f.height),h=Math.min(c.width,h),u=Math.min(c.height,u),h=isFinite(h)?Math.max(i,h):Math.max(a,i),u=isFinite(u)?Math.max(n,u):Math.max(l,n);const g=this._P();switch(g){case 0:break;case 2:a=h,l=u;break;case 6:{let t=Math.min(h/a,u/l);isFinite(t)||(t=1),a*=t,l*=t;break}default:d.o(g+" is not a valid geometryStretch.")}if(null!==this.Ps){0===a&&(a=.001),0===l&&(l=.001);const t=(null!==this.Ps?this.Ps:this.ft).UD(a,l);this.ft=t}else(null===this.ft||!E.Y(this.ft.ec,t-o)||!E.Y(this.ft.sc,e-o))&&(this.ft=le.yv(this,a,l));r=this.ft.bounds,t===1/0||e===1/0?this._n(r.x-o/2,r.y-o/2,0===t&&0===a?0:r.width+o,0===e&&0===l?0:r.height+o):this._n(-o/2,-o/2,h+o,u+o),s.isReal()?(h=s.width,u=s.height,h=Math.min(c.width,h),u=Math.min(c.height,u),h=Math.max(f.width,h),u=Math.max(f.height,u),this.Bi.e(0,0,h,u)):this.Bi.a(r)}_P(){const t=this.geometryStretch;return null!==this.Ps?1===t?2:t:1===t?le.v2[this.figure].defaultStretch:t}ch(t,e,i,n){this.commonArrange(t,e,i,n)}getNearestIntersectionPoint(t,e,i){return this.Jc(t.x,t.y,e.x,e.y,i)}Jc(t,e,i,n,s){const o=this.L,r=1/(o.m11*o.m22-o.m12*o.m21),a=o.m22*r,l=-o.m12*r,h=-o.m21*r,u=o.m11*r,c=r*(o.m21*o.dy-o.m22*o.dx),f=r*(o.m12*o.dx-o.m11*o.dy),g=t*a+e*h+c,m=t*l+e*u+f,p=i*a+n*h+c,y=i*l+n*u+f,v=this.qo/2;let b=this.ft;null===b&&(this.ut(1/0,1/0),b=this.ft);const x=b.bounds;let w=!1;if(1===b.type)if(this.strokeWidth<=1.5)w=E.zn(b.startX,b.startY,b.endX,b.endY,g,m,p,y,s);else{let t=0,e=0;if(b.startX===b.endX)t=v,e=0;else{const i=(b.endY-b.startY)/(b.endX-b.startX);e=v/Math.sqrt(1+i*i),t=e*i}const i=d.rt();let n=new T;E.zn(b.startX+t,b.startY+e,b.endX+t,b.endY+e,g,m,p,y,n)&&i.push(n),n=new T,E.zn(b.startX-t,b.startY-e,b.endX-t,b.endY-e,g,m,p,y,n)&&i.push(n),n=new T,E.zn(b.startX+t,b.startY+e,b.startX-t,b.startY-e,g,m,p,y,n)&&i.push(n),n=new T,E.zn(b.endX+t,b.endY+e,b.endX-t,b.endY-e,g,m,p,y,n)&&i.push(n);const o=i.length;if(0===o)return d.it(i),!1;w=!0;let r=1/0;for(let a=0;a<o;a++){const t=i[a],e=(t.x-g)*(t.x-g)+(t.y-m)*(t.y-m);e<r&&(r=e,s.x=t.x,s.y=t.y)}d.it(i)}else if(2===b.type)w=E.xl(x.x-v,x.y-v,x.x+x.width+v,x.y+x.height+v,g,m,p,y,s);else if(3===b.type){const t=D.X(x.x,x.y,x.width,x.height).inflate(v,v);w=this.wv(t,g,m,p,y,s),D.s(t)}else if(4===b.type){let o=0,r=0,a=0,l=0;const h=T.l();let u=p-g,c=y-m,f=u*u+c*c,k=g,S=m;if(f>0&&x.contains(k,S)&&(h.x=k,h.y=S,this.containsPoint(h)))for(0!==u&&Math.abs(u)<.5?(c*=.5/u,u=.5):0!==c&&Math.abs(c)<.5&&(u*=.5/c,c=.5),k-=u,S-=c;x.contains(k,S);)k-=u,S-=c;const P=.6;s.x=p,s.y=y;for(let t=0;t<b.figures.count;t++){const e=b.figures.r[t],i=e.isFilled?k:g,n=e.isFilled?S:m,u=e.segments;o=e.startX,r=e.startY;let c=o,v=r;for(let t=0;t<u.count;t++){const g=u.r[t],m=g.type;a=g.endX,l=g.endY;let b=!1;switch(m){case 1:c=a,v=l;break;case 2:b=this.Wb(o,r,a,l,i,n,p,y,h);break;case 3:b=E.zg(o,r,g.point1X,g.point1Y,g.point2X,g.point2Y,a,l,i,n,p,y,P,h);break;case 4:b=E.zg(o,r,o+2/3*(g.point1X-o),r+2/3*(g.point1Y-r),a+2/3*(g.point1X-a),l+2/3*(g.point1Y-l),a,l,i,n,p,y,P,h);break;case 5:case 6:{const t=5===g.type?g.Co(e):g.Vh(e,o,r),u=t.length;if(0===u){b=this.Wb(o,r,5===g.type?g.centerX:g.endX,5===g.type?g.centerY:g.endY,i,n,p,y,h);break}let c=null;for(let e=0;e<u;e++){if(c=t[e],0===e&&this.Wb(o,r,c[0],c[1],i,n,p,y,h)){const t=this.Jb(i,n,h,f,s);t<f&&(f=t,w=!0)}if(E.zg(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],i,n,p,y,P,h)){const t=this.Jb(i,n,h,f,s);t<f&&(f=t,w=!0)}}a=c[6],l=c[7];break}default:d.o("Unknown Segment type: "+m)}if(o=a,r=l,b){const t=this.Jb(i,n,h,f,s);t<f&&(f=t,w=!0)}if(g.isClosed&&(a=c,l=v,this.Wb(o,r,a,l,i,n,p,y,h))){const t=this.Jb(i,n,h,f,s);t<f&&(f=t,w=!0)}}}let M=i-t,C=n-e;const N=Math.sqrt(M*M+C*C);0!==N&&(M/=N,C/=N),s.x-=M*v,s.y-=C*v,T.s(h)}else d.o("Unknown Geometry type: "+b.type);return!!w&&(this.L.xt(s),!0)}Jb(t,e,i,n,s){const o=i.x-t,r=i.y-e,a=o*o+r*r;return a<n?(s.x=i.x,s.y=i.y,a):n}Wb(t,e,i,n,s,o,r,a,l){if(E.Y(t,i)&&E.Y(e,n)||E.Y(s,r)&&E.Y(o,a))return!1;let h=!1;const u=(s-r)*(e-n)-(o-a)*(t-i);if(0===u)return!1;if(l.x=((s*a-o*r)*(t-i)-(s-r)*(t*n-e*i))/u,l.y=((s*a-o*r)*(e-n)-(o-a)*(t*n-e*i))/u,(t>i?t-i:i-t)<(e>n?e-n:n-e)){const t=e<n?e:n,i=e<n?n:e;(l.y>t||E.Y(l.y,t))&&(l.y<i||E.Y(l.y,i))&&(h=!0)}else{const e=t<i?t:i,n=t<i?i:t;(l.x>e||E.Y(l.x,e))&&(l.x<n||E.Y(l.x,n))&&(h=!0)}return h}xv(t,e,i){return!1!==this.pickable&&(i.tc(this.L),e?this.bv(t,i):this.containedInRect(t,i))}containedInRect(t,e){if(void 0===e)return t.containsRect(this.actualBounds);let i=this.ft;null===i&&(this.ut(1/0,1/0),i=this.ft);const n=i.bounds,s=this.strokeWidth/2;let o=!1;const r=T.l();return r.e(n.x-s,n.y-s),t.containsPoint(e.xt(r))&&(r.e(n.x-s,n.bottom+s),t.containsPoint(e.xt(r))&&(r.e(n.right+s,n.bottom+s),t.containsPoint(e.xt(r))&&(r.e(n.right+s,n.y-s),t.containsPoint(e.xt(r))&&(o=!0)))),T.s(r),o}intersectsRect(t,e){if(this.containedInRect(t,e)||void 0===e&&(e=this.L,t.containsRect(this.actualBounds)))return!0;const i=R.l();i.set(e),i.pw();const n=t.left,s=t.right,o=t.top,r=t.bottom,a=T.l();if(a.e(n,o),i.xt(a),this.ah(a,!0))return T.s(a),!0;if(a.e(s,o),i.xt(a),this.ah(a,!0))return T.s(a),!0;if(a.e(n,r),i.xt(a),this.ah(a,!0))return T.s(a),!0;if(a.e(s,r),i.xt(a),this.ah(a,!0))return T.s(a),!0;const l=T.l(),h=T.l();i.set(e),i.oC(this.L),i.pw(),l.x=s,l.y=o,l.L(i),a.x=n,a.y=o,a.L(i);let u=!1;return this.Aa(a,l,h)?u=!0:(a.x=s,a.y=r,a.L(i),this.Aa(a,l,h)?u=!0:(l.x=n,l.y=r,l.L(i),this.Aa(a,l,h)?u=!0:(a.x=n,a.y=o,a.L(i),this.Aa(a,l,h)&&(u=!0)))),T.s(a),R.s(i),T.s(l),T.s(h),u}Aa(t,e,i){if(!this.getNearestIntersectionPoint(t,e,i))return!1;const n=t.x,s=t.y,o=e.x,r=e.y,a=i.x,l=i.y;if(n===o){let t=0,e=0;return s<r?(t=s,e=r):(t=r,e=s),l>=t&&l<=e}{let t=0,e=0;return n<o?(t=n,e=o):(t=o,e=n),a>=t&&a<=e}}bv(t,e){if(this.containedInRect(t,e)||void 0===e&&(e=this.L,t.containsRect(this.actualBounds)))return!0;const i=t.left,n=t.right,s=t.top,o=t.bottom,r=T.l(),a=T.l(),l=T.l(),h=R.l();h.set(e),h.oC(this.L),h.pw(),a.x=n,a.y=s,a.L(h),r.x=i,r.y=s,r.L(h);let u=!1;return this.Aa(r,a,l)?u=!0:(r.x=n,r.y=o,r.L(h),this.Aa(r,a,l)?u=!0:(a.x=i,a.y=o,a.L(h),this.Aa(r,a,l)?u=!0:(r.x=i,r.y=s,r.L(h),this.Aa(r,a,l)&&(u=!0)))),R.s(h),T.s(r),T.s(a),T.s(l),u}JL(t,e,i){if(i&&null!==this.fill&&this.ah(t,!0))return!0;let n=t.distanceSquaredPoint(e);const s=n;this.strokeWidth>1.5&&(n=this.strokeWidth/2+Math.sqrt(n),n*=n);let o=this.ft;if(null===o&&(this.ut(1/0,1/0),o=this.ft,null===o))return!1;if(!i){const e=o.bounds,i=e.x,s=e.y,r=e.x+e.width,a=e.y+e.height;if(T.distanceSquared(t.x,t.y,i,s)<=n&&T.distanceSquared(t.x,t.y,r,s)<=n&&T.distanceSquared(t.x,t.y,i,a)<=n&&T.distanceSquared(t.x,t.y,r,a)<=n)return!0}function r(t,e){const i=t.length;for(let s=0;s<i;s+=2)if(e.distanceSquared(t[s],t[s+1])>n)return!0;return!1}const a=o.startX,l=o.startY,h=o.endX,u=o.endY;if(1===o.type){const e=T.distanceLineSegmentSquared(t.x,t.y,a,l,h,u),i=(h-a)*(t.x-a)+(u-l)*(t.y-l),o=(a-h)*(t.x-h)+(l-u)*(t.y-u);return e<=(i>=0&&o>=0?n:s)}if(2===o.type){let e=!1;return i&&(e=T.distanceLineSegmentSquared(t.x,t.y,a,l,a,u)<=n||T.distanceLineSegmentSquared(t.x,t.y,a,l,h,l)<=n||T.distanceLineSegmentSquared(t.x,t.y,h,l,h,u)<=n||T.distanceLineSegmentSquared(t.x,t.y,a,u,h,u)<=n),e}if(3===o.type){const e=(a+h)/2,s=(l+u)/2,o=t.x-e,r=t.y-s,c=Math.abs(h-a)/2,d=Math.abs(u-l)/2;if(0===c||0===d)return T.distanceLineSegmentSquared(t.x,t.y,a,l,h,u)<=n;if(i){const t=E.TD(c,d,o,r);return t*t<=n}return!(T.distanceSquared(o,r,-c,0)>=n||T.distanceSquared(o,r,0,-d)>=n||T.distanceSquared(o,r,0,d)>=n||T.distanceSquared(o,r,c,0)>=n)}if(4===o.type){const e=o.bounds,s=e.x,a=e.y,l=e.x+e.width,h=e.y+e.height;if(t.x>l&&t.x<s&&t.y>h&&t.y<a&&T.distanceLineSegmentSquared(t.x,t.y,s,a,s,h)>n&&T.distanceLineSegmentSquared(t.x,t.y,s,a,l,a)>n&&T.distanceLineSegmentSquared(t.x,t.y,l,h,s,h)>n&&T.distanceLineSegmentSquared(t.x,t.y,l,h,l,a)>n)return!1;const u=Math.sqrt(n);if(!i){const e=o.figures;for(let i=0;i<e.count;i++){const s=e.r[i];let o=s.startX,a=s.startY;if(t.distanceSquared(o,a)>n)return!1;const l=s.segments.r,h=l.length;for(let e=0;e<h;e++){const i=l[e];switch(i.type){case 1:case 2:if(o=i.endX,a=i.endY,t.distanceSquared(o,a)>n)return!1;break;case 3:{const e=d.rt();E.Bn(o,a,i.point1X,i.point1Y,i.point2X,i.point2Y,i.endX,i.endY,.8,e);const s=r(e,t);if(d.it(e),s||(o=i.endX,a=i.endY,t.distanceSquared(o,a)>n))return!1;break}case 4:{const e=d.rt();E.Bg(o,a,i.point1X,i.point1Y,i.endX,i.endY,.8,e);const s=r(e,t);if(d.it(e),s||(o=i.endX,a=i.endY,t.distanceSquared(o,a)>n))return!1;break}case 5:case 6:{const e=5===i.type?i.Co(s):i.Vh(s,o,a),l=e.length;if(0===l){if(o=5===i.type?i.centerX:i.endX,a=5===i.type?i.centerY:i.endY,t.distanceSquared(o,a)>n)return!1;break}let h=null;const u=d.rt();for(let i=0;i<l;i++)if(h=e[i],u.length=0,E.Bn(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],.8,u),r(u,t))return d.it(u),!1;d.it(u),null!==h&&(o=h[6],a=h[7]);break}default:d.o("Unknown Segment type: "+i.type)}}}return!0}if(null===this.fill?o.pC(t.x,t.y,u):o.Bk(t,u,!0,!1))return!0}return!1}wv(t,e,i,n,s,o){if(0===t.width)return E.zn(t.x,t.y,t.x,t.y+t.height,e,i,n,s,o);if(0===t.height)return E.zn(t.x,t.y,t.x+t.width,t.y,e,i,n,s,o);{const r=t.width/2,a=t.height/2,l=t.x+r,h=t.y+a;let u=9999;if(e!==n&&(u=(i-s)/(e-n)),Math.abs(u)<9999){const t=i-h-u*(e-l);if(r*r*(u*u)+a*a-t*t<0)return o.x=NaN,o.y=NaN,!1;const n=Math.sqrt(r*r*(u*u)+a*a-t*t),s=(-r*r*u*t+r*a*n)/(a*a+r*r*(u*u))+l,c=(-r*r*u*t-r*a*n)/(a*a+r*r*(u*u))+l,d=u*(s-l)+t+h,f=u*(c-l)+t+h;Math.abs((e-s)*(e-s))+Math.abs((i-d)*(i-d))<Math.abs((e-c)*(e-c))+Math.abs((i-f)*(i-f))?(o.x=s,o.y=d):(o.x=c,o.y=f)}else{const t=a*a,n=e-l,s=t-t/(r*r)*(n*n);if(s<0)return o.x=NaN,o.y=NaN,!1;const u=Math.sqrt(s),c=h+u,d=h-u;Math.abs(c-i)<Math.abs(d-i)?(o.x=e,o.y=c):(o.x=e,o.y=d)}return!0}}av(){return this.qo/2*this.strokeMiterLimit*this.getDocumentScale()}get geometry(){return null!==this.ft?this.ft:this.Ps}set geometry(t){const e=this.ft,i=this.Ps;if(e===t)return;null!==t?(this.ft=t.g(),this.Ps=this.ft):(this.ft=null,this.Ps=null);const n=this.part;if(null!==n&&n.hf(),this.c(),this.t("geometry",e||i,t),this.Wc()){const t=this.part;null!==t&&this.ya(t,"geometryString")}}get geometryString(){return null===this.geometry?"":this.geometry.toString()}set geometryString(t){const e=z.parse(t),i=e.normalize();this.geometry=e;const n=T.X(-i.x,-i.y);this.position=n,T.s(n)}get isGeometryPositioned(){return 0!==(1048576&this.n)}set isGeometryPositioned(t){const e=0!==(1048576&this.n);e!==t&&(this.n=1048576^this.n,this.c(),this.t("isGeometryPositioned",e,t))}oe(){this.ft=null}get fill(){return this.Ca}set fill(t){const e=this.Ca;e!==t&&(null!==t&&Qt.od(t,"Shape.fill"),t instanceof Qt&&t.g(),this.Ca=t,this.C(),this.t("fill",e,t))}get stroke(){return this.ji}set stroke(t){const e=this.ji;e!==t&&(null!==t&&Qt.od(t,"Shape.stroke"),t instanceof Qt&&t.g(),this.ji=t,this.C(),this.t("stroke",e,t))}get strokeWidth(){return this.qo}set strokeWidth(t){const e=this.qo;if(e!==t)if(t>=0){this.qo=t,this.c();const i=this.part;null!==i&&i.hf(),this.t("strokeWidth",e,t)}else d.tt(t,"value >= 0",le,"strokeWidth:value")}Tb(){return this.qo}get strokeCap(){return null!==this.Lt?this.Lt.pp:"butt"}set strokeCap(t){const e=this.strokeCap;e!==t&&("string"!=typeof t||"butt"!==t&&"round"!==t&&"square"!==t?d.tt(t,'"butt", "round", or "square"',le,"strokeCap"):(this.La(),this.Lt.pp=t,this.C(),this.t("strokeCap",e,t)))}get strokeJoin(){return null!==this.Lt?this.Lt.yp:"miter"}set strokeJoin(t){const e=this.strokeJoin;e!==t&&("string"!=typeof t||"miter"!==t&&"bevel"!==t&&"round"!==t?d.tt(t,'"miter", "bevel", or "round"',le,"strokeJoin"):(this.La(),this.Lt.yp=t,this.C(),this.t("strokeJoin",e,t)))}get strokeMiterLimit(){return null!==this.Lt?this.Lt.wp:10}set strokeMiterLimit(t){const e=this.strokeMiterLimit;if(e!==t&&t>=1){this.La(),this.Lt.wp=t,this.C();const i=this.part;null!==i&&i.hf(),this.t("strokeMiterLimit",e,t)}}get strokeDashArray(){return this.Yo}set strokeDashArray(t){const e=this.Yo;if(e!==t){if(null!==t&&!Array.isArray(t)&&d.ke(t,"Array",le,"strokeDashArray:value"),null!==t){const i=t.length;let n=0;for(let e=0;e<i;e++){const i=t[e];(!(i>=0)||!isFinite(i))&&d.o("strokeDashArray:value "+i+" at index "+e+" must be a positive number or zero."),n+=i}if(0===n){if(null===e)return;t=null}}this.Yo=t,this.C(),this.t("strokeDashArray",e,t)}}get strokeDashOffset(){return null!==this.Lt?this.Lt.gh:0}set strokeDashOffset(t){const e=this.strokeDashOffset;e!==t&&t>=0&&(this.La(),this.Lt.gh=t,this.C(),this.t("strokeDashOffset",e,t))}get figure(){return this.bd}set figure(t){const e=this.bd;if(e!==t){let i=E.No[t];if("function"==typeof i?i=t:(i=E.No[t.toLowerCase()],i||d.o("Unknown Shape.figure: "+t)),e!==i){const t=this.part;null!==t&&t.hf(),this.bd=i,this.Ps=null,this.oe(),this.c(),this.t("figure",e,i)}}}get toArrow(){return null!==this.Vt?this.Vt.xp:"None"}set toArrow(t){const e=this.toArrow;if(!0===t?t="Standard":!1===t&&(t=""),e!==t){const i=le.MA(t);null===i?d.o("Unknown Shape.toArrow: "+t):e!==i&&(null===this.Vt&&(this.Vt=new Ie),this.Vt.xp=i,this.Ps=null,this.oe(),this.c(),this.SA(i),this.t("toArrow",e,i))}}get fromArrow(){return null!==this.Vt?this.Vt.bp:"None"}set fromArrow(t){const e=this.fromArrow;if(!0===t?t="Standard":!1===t&&(t=""),e!==t){const i=le.MA(t);null===i?d.o("Unknown Shape.fromArrow: "+t):e!==i&&(null===this.Vt&&(this.Vt=new Ie),this.Vt.bp=i,this.Ps=null,this.oe(),this.c(),this.SA(i),this.t("fromArrow",e,i))}}SA(t){const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;this.RR();const i=O.MiddleRight;"None"!==this.toArrow?(this.segmentIndex=-1,this.alignmentFocus=i):"None"!==this.fromArrow&&(this.segmentIndex=0,this.alignmentFocus=new O(1-i.x,i.y))}get spot1(){return null!==this.Lt?this.Lt.Xn:O.Default}set spot1(t){const e=this.spot1;e.equals(t)||(t=t.N(),this.La(),this.Lt.Xn=t,this.c(),this.t("spot1",e,t))}get spot2(){return null!==this.Lt?this.Lt.Kn:O.Default}set spot2(t){const e=this.spot2;e.equals(t)||(t=t.N(),this.La(),this.Lt.Kn=t,this.c(),this.t("spot2",e,t))}get parameter1(){return this.kd}set parameter1(t){const e=this.kd;e!==t&&(this.kd=t,this.oe(),this.c(),this.t("parameter1",e,t))}get parameter2(){return this.Pd}set parameter2(t){const e=this.Pd;e!==t&&(this.Pd=t,this.oe(),this.c(),this.t("parameter2",e,t))}get naturalBounds(){return this.Bi}QR(){const t=this.desiredSize;if(t.isReal()||null===this.ft)this.Bi.e(0,0,t.width,t.height);else{const t=this.ft.bounds;this.Bi.a(t)}}get pathPattern(){return null!==this.Lt?this.Lt.kp:null}set pathPattern(t){const e=this.pathPattern;e!==t&&(this.La(),this.Lt.kp=t,this.C(),this.t("pathPattern",e,t))}get geometryStretch(){return null!==this.Lt?this.Lt.Pp:1}set geometryStretch(t){const e=this.geometryStretch;e!==t&&(this.La(),this.Lt.Pp=t,this.c(),this.t("geometryStretch",e,t))}get interval(){return null!==this.$?this.$.cf:1}set interval(t){const e=this.interval;if(e!==(t=Math.round(t))&&0!==t&&isFinite(t)){null===this.$&&(this.$=new me),this.$.cf=t;const i=this.diagram;null!==i&&this.panel===i.grid&&i.Wr(),this.c();const n=this.panel;null!==n&&(n.rs=null),this.t("interval",e,t)}}get graduatedStart(){return null!==this.$?this.$.ff:0}set graduatedStart(t){const e=this.graduatedStart;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.$&&(this.$=new me),this.$.ff=t,this.c(),this.t("graduatedStart",e,t))}get graduatedEnd(){return null!==this.$?this.$.uf:1}set graduatedEnd(t){const e=this.graduatedEnd;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.$&&(this.$=new me),this.$.uf=t,this.c(),this.t("graduatedEnd",e,t))}get graduatedSkip(){return null!==this.$?this.$.df:null}set graduatedSkip(t){const e=this.graduatedSkip;e!==t&&(null!==t&&d.i(t,"function",le,"graduatedSkip"),null===this.$&&(this.$=new me),this.$.df=t,this.c(),this.t("graduatedSkip",e,t))}static yv(t,e,i){let n=null;if("None"!==t.toArrow)n=le.oo[t.toArrow];else if("None"!==t.fromArrow)n=le.oo[t.fromArrow];else{let s=E.No[t.figure];"string"==typeof s&&(s=E.No[s]),void 0===s&&d.o("Unknown Shape.figure: "+t.figure),n=s(t,e,i),n.ec=e,n.sc=i}if(null===n){const s=E.No.Rectangle;"function"==typeof s&&(n=s(t,e,i))}return n}static getFigureGenerators(){const t=new L;for(const e in E.No){if(e===e.toLowerCase())continue;const i=E.No[e];t.add(e,i)}return t.g(),t}static defineFigureGenerator(t,e){d.i(t,"string",le,"defineFigureGenerator:name"),"string"==typeof e||d.i(e,"function",le,"defineFigureGenerator:func");const i=t.toLowerCase(),n=E.No;n[t]=e,n[i]=t}static getArrowheadGeometries(){const t=new L;for(const e in E.Yg)if(void 0===le.oo[e]){const t=z.parse(E.Yg[e],!1);le.oo[e]=t;const i=e.toLowerCase();i!==e&&(le.oo[i]=e)}for(const e in le.oo){if(e===e.toLowerCase())continue;const i=le.oo[e];i instanceof z&&t.add(e,i)}return t.g(),t}static defineArrowheadGeometry(t,e){d.i(t,"string",le,"defineArrowheadGeometry:name");let i=null;"string"==typeof e?(d.i(e,"string",le,"defineArrowheadGeometry:pathstr"),i=z.parse(e,!1)):i=e;const n=t.toLowerCase();("none"===n||t===n)&&d.o("Shape.defineArrowheadGeometry name must not be empty or None or all-lower-case: "+t);const s=le.oo;s[t]=i,s[n]=t}static MA(t){let e=le.oo[t];if(void 0===e){const i=t.toLowerCase();if("none"===i)return"None";if(e=le.oo[i],void 0===e){let t=null;for(const e in E.Yg)if(e.toLowerCase()===i){t=e;break}if(null!==t){const e=z.parse(E.Yg[t],!1);return le.oo[t]=e,i!==t&&(le.oo[i]=t),t}}}return"string"==typeof e?e:e instanceof z?t:null}}y(le,"oo",new g),y(le,"v2",new g);class he{constructor(){y(this,"mi",void 0),y(this,"pp",void 0),y(this,"yp",void 0),y(this,"wp",void 0),y(this,"gh",void 0),y(this,"kp",void 0),y(this,"Pp",void 0),y(this,"Xn",void 0),y(this,"Kn",void 0),this.mi=!1,this.pp="butt",this.yp="miter",this.wp=10,this.gh=0,this.kp=null,this.Pp=1,this.Xn=O.Default,this.Kn=O.Default}copy(){const t=new he;return t.pp=this.pp,t.yp=this.yp,t.wp=this.wp,t.gh=this.gh,t.kp=this.kp,t.Pp=this.Pp,t.Xn=this.Xn.N(),t.Kn=this.Kn.N(),t}}var ue=(t=>(t[t.None=0]="None",t[t.Fit=1]="Fit",t[t.DesiredSize=2]="DesiredSize",t[t.BreakAll=3]="BreakAll",t))(ue||{}),ce=(t=>(t[t.Clip=0]="Clip",t[t.Ellipsis=1]="Ellipsis",t))(ce||{}),de=(t=>(t[t.Trim=0]="Trim",t[t.None=1]="None",t))(de||{});class fe extends Kt{constructor(t,e){return super(),y(this,"ai",void 0),y(this,"ji",void 0),y(this,"Mn",void 0),y(this,"Te",void 0),y(this,"pi",void 0),y(this,"x0",void 0),y(this,"Sd",void 0),y(this,"$",void 0),y(this,"J",void 0),y(this,"vl",void 0),y(this,"ro",void 0),y(this,"Sn",void 0),y(this,"De",void 0),y(this,"Fi",void 0),y(this,"Nn",void 0),this.n|=2097152,this.ai="",this.ji="black",this.Mn="13px sans-serif",this.Te=0,this.pi=0,this.x0=0,this.Sd=null,this.$=null,this.J=null,this.vl=0,this.ro=null,this.Sn=0,this.De=null,this.Fi=null,this.Nn=null,"string"==typeof t?this.text=t:t&&Object.assign(this,t),e&&Object.assign(this,e),this}cloneProtected(t){super.cloneProtected(t),t.ai=this.ai,t.ji=this.ji,t.Mn=this.Mn,t.Te=this.Te,t.pi=this.pi,t.x0=this.x0,t.Sd=this.Sd,null!==this.$&&(t.$=this.$.copy()),null!==this.J&&(this.J.mi?t.J=this.J:t.J=this.J.copy()),t.vl=this.vl,t.ro=this.ro,t.Sn=this.Sn,t.De=this.De,t.Fi=this.Fi,t.Nn=this.Nn}Cn(){null===this.J?this.J=new ge:this.J.mi&&(this.J=this.J.copy())}hh(){super.hh(),null!==this.J&&(this.J.mi=!0)}ov(t){this.n=6144|t.n,this.Wt=t.opacity,this.Ct=t.background,this.Ke=t.desiredSize.N(),this.minSize=t.minSize.N(),this.maxSize=t.maxSize.N(),null!==t.ki?this.ki=t.ki.copy():this.ki=null,this.K=t.scale,this.Xt=t.angle,this.stretch=t.stretch,this.tl=t.margin.N(),this.oi=t.alignment.N(),this.jc=t.alignmentFocus.N(),this.segmentFraction=t.segmentFraction,this.segmentOffset=t.segmentOffset.N(),this.segmentOrientation=t.segmentOrientation,null!==t.si&&(this.si=t.si.copy()),this.shadowVisible=t.shadowVisible,this.ai=t.ai,this.ji=t.ji,this.Mn=t.Mn,null!==this.$&&(this.$=t.$.copy()),null!==t.J&&(t.J.mi?this.J=t.J:this.J=t.J.copy()),this.vl=t.vl}sv(t){if(this.ai=t.text||"",this.Xt=t.labelAngle||0,this.Te=t.lineCount||0,this.kv(t.lines),t.naturalBounds&&(this.Bi=t.naturalBounds),t.actualBounds){const e=t.actualBounds;this.zt(e.x,e.y,e.width,e.height)}}li(t){t in ue?this.wrap=t:super.li(t)}toString(){return this.ai.length>22?'TextBlock("'+this.ai.substring(0,20)+'"...)':'TextBlock("'+this.ai+'")'}static getEllipsis(){return fe.Mp}static setEllipsis(t){fe.Mp=t,fe.$b=new g,fe.O2=0}static getBaseline(){return fe.Zb}static setBaseline(t){fe.Zb=t}static getUnderline(){return fe.Qb}static setUnderline(t){fe.Qb=t}c(){super.c()}get font(){return this.Mn}set font(t){const e=this.Mn;e!==t&&(this.Mn=t,this.ro=null,this.c(),this.t("font",e,t))}static isValidFont(t){return!c.CSS||c.CSS.supports("font",t)}get text(){return this.ai}set text(t){const e=this.ai;e!==(t=null!=t?t.toString():"")&&(this.ai=t,this.c(),this.t("text",e,t),this.os(!0))}get textAlign(){return null!==this.J?this.J.Sp:"start"}set textAlign(t){const e=this.textAlign;e!==t&&("start"===t||"end"===t||"left"===t||"right"===t||"center"===t)&&(this.Cn(),this.J.Sp=t,this.C(),this.t("textAlign",e,t))}get flip(){return null!==this.J?this.J.lo:0}set flip(t){const e=this.flip;e!==t&&(this.Cn(),this.J.lo=t,this.C(),this.t("flip",e,t))}get verticalAlignment(){return null!==this.J?this.J.rl:O.Top}set verticalAlignment(t){const e=this.verticalAlignment;e.equals(t)||(t=t.N(),this.Cn(),this.J.rl=t,this._c(),this.t("verticalAlignment",e,t))}get naturalBounds(){if(!this.Bi.isReal()){const t=A.l();this.I2(this.ai,999999,t);let e=t.width;A.s(t);let i=this.NA(e);const n=this.desiredSize;isNaN(n.width)||(e=n.width),isNaN(n.height)||(i=n.height),this.Bi.So(e,i)}return this.Bi}get isMultiline(){return 0!==(2097152&this.n)}set isMultiline(t){const e=0!==(2097152&this.n);e!==t&&(this.n=2097152^this.n,this.c(),this.t("isMultiline",e,t))}get isUnderline(){return 0!==(4194304&this.n)}set isUnderline(t){const e=0!==(4194304&this.n);e!==t&&(this.n=4194304^this.n,this.os(!0),this.C(),this.t("isUnderline",e,t))}get isStrikethrough(){return 0!==(8388608&this.n)}set isStrikethrough(t){const e=0!==(8388608&this.n);e!==t&&(this.n=8388608^this.n,this.os(!0),this.C(),this.t("isStrikethrough",e,t))}get wrap(){return null!==this.J?this.J.Np:2}set wrap(t){const e=this.wrap;e!==t&&(this.Cn(),this.J.Np=t,this.c(),this.t("wrap",e,t))}get overflow(){return null!==this.J?this.J.Cp:0}set overflow(t){const e=this.overflow;e!==t&&(this.Cn(),this.J.Cp=t,this.c(),this.t("overflow",e,t))}get isOverflowed(){return 0!==(16777216&this.n)}E2(t){t?this.n|=16777216:this.n&=-16777217}get stroke(){return this.ji}set stroke(t){const e=this.ji;e!==t&&(null!==t&&Qt.od(t,"TextBlock.stroke"),t instanceof Qt&&t.g(),this.ji=t,this.C(),this.t("stroke",e,t))}get lineCount(){return this.Te}get lineHeight(){return this.Lp()}get editable(){return 0!==(1048576&this.n)}set editable(t){const e=0!==(1048576&this.n);e!==t&&(this.n=1048576^this.n,this.t("editable",e,t))}get textEditor(){return null!==this.J?this.J.Ap:null}set textEditor(t){const e=this.textEditor;e!==t&&(this.Cn(),this.J.Ap=t,this.t("textEditor",e,t))}get errorFunction(){return null!==this.J?this.J.ls:null}set errorFunction(t){const e=this.errorFunction;e!==t&&(null!==t&&d.i(t,"function",fe,"errorFunction"),this.Cn(),this.J.ls=t,this.t("errorFunction",e,t))}get interval(){return null!==this.$?this.$.cf:1}set interval(t){const e=this.interval;if(e!==(t=Math.round(t))&&0!==t&&isFinite(t)){null===this.$&&(this.$=new me),this.$.cf=t,this.c();const i=this.panel;null!==i&&(i.rs=null),this.t("interval",e,t)}}get graduatedStart(){return null!==this.$?this.$.ff:0}set graduatedStart(t){const e=this.graduatedStart;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.$&&(this.$=new me),this.$.ff=t,this.c(),this.t("graduatedStart",e,t))}get graduatedEnd(){return null!==this.$?this.$.uf:1}set graduatedEnd(t){const e=this.graduatedEnd;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.$&&(this.$=new me),this.$.uf=t,this.c(),this.t("graduatedEnd",e,t))}get graduatedFunction(){return null!==this.$?this.$.Tp:null}set graduatedFunction(t){const e=this.graduatedFunction;e!==t&&(null!==t&&d.i(t,"function",fe,"graduatedFunction"),null===this.$&&(this.$=new me),this.$.Tp=t,this.c(),this.t("graduatedFunction",e,t))}get graduatedSkip(){return null!==this.$?this.$.df:null}set graduatedSkip(t){const e=this.graduatedSkip;e!==t&&(null!==t&&d.i(t,"function",fe,"graduatedSkip"),null===this.$&&(this.$=new me),this.$.df=t,this.c(),this.t("graduatedSkip",e,t))}uh(t,e){if(null===this.ji||0===this.ai.length||null===this.Mn)return;const i=this.naturalBounds,n=this.actualBounds,s=i.width,o=i.height,r=this.Lp();let a=t.textAlign=this.textAlign;const l=e.Xu;"start"===a?a=l?"right":"left":"end"===a&&(a=l?"left":"right");const h=this.isUnderline,u=this.isStrikethrough;this.mn(t,this.ji,!0,!1,i,n),(h||u)&&this.mn(t,this.ji,!1,!1,i,n);let c=0;const d=s;let f=!1;const g=this.ws,m=g.dx-(r*g.m21+g.dx),p=g.dy-(r*g.m22+g.dy);let y=m*m+p*p;const v=e.scale;y=y*v*v,y<8&&(f=!0),e.ni!==t&&(f=!1),e.ni instanceof Ht&&(f=!1),!1===e.getRenderingHint("textGreeking")&&(f=!1);const b=this.spacingAbove,x=this.spacingBelow;switch(this.flip){case 0:break;case 2:t.translate(s,0),t.scale(-1,1);break;case 1:t.translate(0,o),t.scale(1,-1);break;case 3:t.translate(s,o),t.scale(-1,-1)}t.commitTransform();const w=this.Te,k=(b+r+x)*w;if(o>k){const t=this.verticalAlignment;c=t.y*o-t.y*k+t.offsetY}if(1===w&&null!==this.Nn){let e=this.pi;e>d&&(e=d),c+=b,this.CA(this.Nn,t,0,c,d,r,e,f,a,h,u)}else if(null!==this.De&&null!==this.Fi)for(let S=0;S<w;S++){let e=this.De[S];e>d&&(e=d),c+=b,this.CA(this.Fi[S],t,0,c,d,r,e,f,a,h,u),c+=r+x}switch(this.flip){case 0:break;case 2:t.scale(-1,1),t.translate(-s,0);break;case 1:t.scale(1,-1),t.translate(0,-o);break;case 3:t.scale(-1,-1),t.translate(-s,-o)}}CA(t,e,i,n,s,o,r,a,l,h,u){let c=0;if(a)return"left"===l?c=0:"right"===l?c=s-r:"center"===l&&(c=(s-r)/2),void e.fillRect(i+c,n+.25*o,r,1);"left"===l?c=0:"right"===l?c=s:"center"===l&&(c=s/2);const d=null!==fe.Zb?fe.Zb(this,o):.75*o;e.fillText(t,i+c,n+d);let f=o/20|0;if(0===f&&(f=1),"right"===l?c-=r:"center"===l&&(c-=r/2),h){const t=null!==fe.Qb?fe.Qb(this,o):.8*o;this.LA(i+c,n+t,i+c+r,n+t,f,e),e instanceof Ht&&e.lastCreatedElement.classList.add("gojs-td")}if(u){let t=n+o-o/2.2|0;f%2!==0&&(t+=.5),this.LA(i+c,t,i+c+r,t,f,e),e instanceof Ht&&e.lastCreatedElement.classList.add("gojs-td")}}LA(t,e,i,n,s,o){o.beginPath(),o.lineWidth=s,o.moveTo(t,e),o.lineTo(i,n),o.stroke(),o.endPath()}$c(t,e,i){if(!super.$c(t,e,i))return!1;if(this.mn(t,this.ji,!0,!1,this.naturalBounds,this.actualBounds),i){if(0===this.svg.getElementsByTagName("text").length)return!0;const e=this.svg.getElementsByClassName("gojs-td");for(let i=0;i<e.length;i++)t.setFillOrStrokeInPlace(e[i],!1)}else this.Pv(this.svg,this.text,t);return!0}Pv(t,e,i){t.innerHTML=e,i.setFillOrStrokeInPlace(t,!0)}sd(t){return!!(this.lineCount>1||this.isUnderline||this.isStrikethrough)||super.sd(t)}s2(t,e){if("g"!==t.nodeName)t.setAttributeNS(null,"filter",e);else{const i=t.getElementsByTagName("text");for(let t=0;t<i.length;t++)i[t].setAttributeNS(null,"filter",e)}}Mv(){this.Sn=0,this.pi=0,this.ro=null,this.De=null,this.Fi=null,this.Nn=null}_u(t,e,i,n){const s=this.Te;this.vl=t,this.E2(!1);const o=this.Mn;null!==fe.nl&&fe.AA!==o&&(fe.nl.font=o,fe.AA=o),this.Mv();let r=0,a=0;isNaN(this.desiredSize.width)?(r=this.Sv(),r=Math.min(r,t/this.scale)):r=this.desiredSize.width,null!==this.panel&&(r=Math.min(r,this.panel.maxSize.width)),a=this.NA(r),a=isNaN(this.desiredSize.height)?Math.min(a,e/this.scale):this.desiredSize.height,this.Nv(t,a),(1===this.wrap||isNaN(this.desiredSize.width))&&(r=isNaN(t)?this.pi:Math.min(t,this.pi)),r=Math.max(i,r),a=Math.max(n,a),this.Bi.So(r,a),this._n(0,0,r,a),null!==this.svg&&s!==this.Te&&this.os(!0)}ch(t,e,i,n){this.commonArrange(t,e,i,n)}Ln(t,e){null===this.Nn?(this.Nn=t,this.pi=e):((null===this.Fi||null===this.De)&&(this.Fi=[],this.De=[],this.Fi.push(this.Nn),this.De.push(this.pi)),this.Fi.push(t),this.De.push(e),this.Fi.length>this.maxLines&&(this.n|=16777216))}I2(t,e,i){const n=0===this.formatting;n&&(t=t.trim());let s=0,o=0,r=0;const a=this.Mn,l=this.spacingAbove+this.spacingBelow,h=Math.max(0,this.Lp()+l),u=1===this.overflow?this.TA(a):0;if(this.Te>=this.maxLines)return void(null!==i&&i.e(0,h));let c=t;if(0===this.wrap){if(this.Sn=1,o=this.getStringWidth(t),0===u||o<=e)return this.pi=Math.max(this.pi,o),this.Ln(t,this.pi),void(null!==i&&i.e(o,h));let s=this.Nd(c);c=c.substring(s.length);let a=this.Nd(c);for(o=this.getStringWidth(s+a),r=0;a.length>0&&o<=e;){s+=a,c=c.substring(a.length),a=this.Nd(c),r=o;let t=s+a;n&&(t=t.trim()),o=this.getStringWidth(t)}for(n&&(a=a.trim()),s+=a,e=Math.max(1,e-u);this.getStringWidth(s)>e&&s.length>1;)s=s.substring(0,s.length-1);return this.E2(!0),s+=fe.Mp,r=this.getStringWidth(s),this.pi=r,this.Ln(s,r),void(null!==i&&i.e(r,h))}let d=0;for(0===c.length&&(d=1,this.Ln(c,0));c.length>0;){let t=this.Nd(c);for(c=c.substring(t.length);this.getStringWidth(t)>e;){let i=1;for(o=this.getStringWidth(t.substring(0,i)),r=0;o<=e;)i++,r=o,o=this.getStringWidth(t.substring(0,i));let n=0;1===i?(n=o,s=Math.max(s,o)):(n=r,s=Math.max(s,r)),i--,i<1&&(i=1);const a=t.substring(0,i);if(this.Ln(a,n),d++,t=t.substring(i),this.Te+d>this.maxLines)break}let i=this.Nd(c);for(o=this.getStringWidth(t+i),r=0;i.length>0&&o<=e;){t+=i,c=c.substring(i.length),i=this.Nd(c),r=o;let e=t+i;n&&(e=e.trim()),o=this.getStringWidth(e)}if(n&&(t=t.trim()),""===t)continue;"\xad"===t[t.length-1]&&(t=t.substring(0,t.length-1)+"\u2010");let a=0;if(0===i.length?(a=o,s=Math.max(s,o)):(r=this.getStringWidth(t),a=r,s=Math.max(s,r)),this.Ln(t,a),d++,this.Te+d>this.maxLines)break}this.Sn=Math.min(this.maxLines,d),this.pi=Math.max(this.pi,s),null!==i&&i.e(this.pi,h*this.Sn)}Nv(t,e){if(0===this.pi||null===this.De||null===this.Fi||1!==this.overflow)return;const i=this.Mn,n=1===this.overflow?this.TA(i):0,s=this.spacingAbove+this.spacingBelow,o=Math.max(0,this.Lp()+s),r=Math.min(this.maxLines-1,Math.max(Math.floor(e/o+.01)-1,0));if(r+1>=this.Fi.length)return;this.E2(!0);let a=this.Fi[r];const l=Math.max(1,t-n);for(;this.getStringWidth(a)>l&&a.length>1;)a=a.substring(0,a.length-1);a+=fe.Mp;const h=this.getStringWidth(a);this.Fi[r]=a,this.Fi=this.Fi.slice(0,r+1),this.De[r]=h,this.De=this.De.slice(0,r+1),this.Sn=this.Fi.length,this.pi=Math.max(this.pi,h),this.Te=this.Sn,1===this.Te&&(this.Nn=this.Fi[0])}Nd(t){if(3===this.wrap)return t.substring(0,1);let e=t.length,i=0;const n=fe.Cv;for(;i<e&&!n.test(t.charAt(i));)i++;for(1===this.formatting&&(e=Math.min(e,i+1));i<e&&n.test(t.charAt(i));)i++;return i>=t.length?t:t.substring(0,i)}getStringWidth(t){return null===fe.nl?8*t.length:fe.nl.measureText(t).width}Lp(){if(null!==this.ro)return this.ro;const t=this.Mn;let e=0;return null===fe.nl?(e=16,this.ro=e,e):(void 0!==fe.V2[t]&&fe.DA<5e3?e=fe.V2[t]:(e=1.3*fe.nl.measureText("M").width,fe.V2[t]=e,fe.DA++),this.ro=e,e)}TA(t){if(null===fe.nl)return 6;let e=0;return void 0!==fe.$b[t]&&fe.O2<5e3?e=fe.$b[t]:(e=fe.nl.measureText(fe.Mp).width,fe.$b[t]=e,fe.O2++),e}_b(t,e){return t.indexOf("\n",e)}NA(t){let e=this.ai.replace(/\r\n/g,"\n").replace(/\r/g,"\n");const i=this.spacingAbove+this.spacingBelow,n=Math.max(0,this.Lp()+i);if(0===e.length)return this.pi=0,this.Te=1,n;if(!this.isMultiline){const t=this._b(e,0);t>=0&&(e=e.substring(0,t))}let s=0;this.Te=0;let o=0,r=-1,a=!1;for(;!a;){if(r=this._b(e,o),-1===r&&(r=e.length,a=!0),o<=r){const i=e.substring(o,r);if(0!==this.wrap){this.Sn=0;const e=A.l();this.I2(i,t,e),s+=e.height,A.s(e),this.Te+=this.Sn}else this.I2(i,t,null),s+=n,this.Te++;this.Te===this.maxLines&&(a=!0)}o=r+1}return this.x0=s,s}Sv(){let t=this.ai.replace(/\r\n/g,"\n").replace(/\r/g,"\n");if(0===t.length)return 8;if(this.isMultiline){let e=0,i=0,n=!1;for(;!n;){let s=this._b(t,i);-1===s&&(s=t.length,n=!0);let o=t.substring(i,s);0===this.formatting&&(o=o.trim()),e=Math.max(e,this.getStringWidth(o)),i=s+1}return e}{const e=this._b(t,0);return e>=0&&(t=t.substring(0,e)),this.getStringWidth(t)}}get textValidation(){return null!==this.J?this.J.Rl:null}set textValidation(t){const e=this.textValidation;e!==t&&(null!==t&&d.i(t,"function",fe,"textValidation"),this.Cn(),this.J.Rl=t,this.t("textValidation",e,t))}get textEdited(){return null!==this.J?this.J.Dp:null}set textEdited(t){const e=this.textEdited;e!==t&&(null!==t&&d.i(t,"function",fe,"textEdited"),this.Cn(),this.J.Dp=t,this.t("textEdited",e,t))}get spacingAbove(){return null!==this.J?this.J.Fp:0}set spacingAbove(t){const e=this.spacingAbove;e!==t&&(this.Cn(),this.J.Fp=t,this.c(),this.t("spacingAbove",e,t))}get spacingBelow(){return null!==this.J?this.J.Rp:0}set spacingBelow(t){const e=this.spacingBelow;e!==t&&(this.Cn(),this.J.Rp=t,this.c(),this.t("spacingBelow",e,t))}get formatting(){return null!==this.J?this.J.vp:0}set formatting(t){const e=this.formatting;e!==t&&(this.Cn(),this.J.vp=t,this.c(),this.t("formatting",e,t))}get maxLines(){return null!==this.J?this.J.Op:1/0}set maxLines(t){const e=this.maxLines;e!==t&&((t=Math.floor(t))<=0&&d.tt(t,"> 0",fe,"maxLines"),this.Cn(),this.J.Op=t,this.c(),this.t("maxLines",e,t))}getMetrics(){return[this.pi,this.vl,this.ro,this.Sn,this.De,this.Fi,this.Nn]}kv(t){void 0!==t&&(this.pi=t[0],this.vl=t[1],this.ro=t[2],this.Sn=t[3],this.De=t[4],this.Fi=t[5],this.Nn=t[6])}get metrics(){return{arrSize:null!==this.De?this.De:[this.pi],arrText:null!==this.Fi?this.Fi:[this.Nn],maxLineWidth:this.pi,fontHeight:this.ro}}get choices(){return this.Sd}set choices(t){const e=this.Sd;e!==t&&(this.Sd=t,this.t("choices",e,t))}}y(fe,"Zb",null),y(fe,"Qb",null),y(fe,"None",0),y(fe,"WrapFit",1),y(fe,"WrapDesiredSize",2),y(fe,"WrapBreakAll",3),y(fe,"OverflowClip",0),y(fe,"OverflowEllipsis",1),y(fe,"FormatTrim",0),y(fe,"FormatNone",1),y(fe,"Cv",new RegExp("[ \u200b\xad]")),y(fe,"V2",new g),y(fe,"DA",0),y(fe,"$b",new g),y(fe,"O2",0),y(fe,"Mp","..."),y(fe,"AA",""),y(fe,"nl",Dt.isUsingDOM()?new qt(null).ci:null);class ge{constructor(){y(this,"mi",void 0),y(this,"ls",void 0),y(this,"lo",void 0),y(this,"vp",void 0),y(this,"Op",void 0),y(this,"Cp",void 0),y(this,"Fp",void 0),y(this,"Rp",void 0),y(this,"Sp",void 0),y(this,"Dp",void 0),y(this,"Ap",void 0),y(this,"Rl",void 0),y(this,"rl",void 0),y(this,"Np",void 0),this.mi=!1,this.ls=null,this.lo=0,this.vp=0,this.Op=1/0,this.Cp=0,this.Fp=0,this.Rp=0,this.Sp="start",this.Dp=null,this.Ap=null,this.Rl=null,this.rl=O.Top,this.Np=2}copy(){const t=new ge;return t.ls=this.ls,t.lo=this.lo,t.vp=this.vp,t.Op=this.Op,t.Cp=this.Cp,t.Fp=this.Fp,t.Rp=this.Rp,t.Sp=this.Sp,t.Dp=this.Dp,t.Ap=this.Ap,t.Rl=this.Rl,t.rl=this.rl,t.Np=this.Np,t}}class me{constructor(){y(this,"cf",void 0),y(this,"ff",void 0),y(this,"uf",void 0),y(this,"Tp",void 0),y(this,"df",void 0),this.cf=1,this.ff=0,this.uf=1,this.Tp=null,this.df=null}copy(){const t=new me;return t.cf=this.cf,t.ff=this.ff,t.uf=this.uf,t.Tp=this.Tp,t.df=this.df,t}}var pe=(t=>(t[t.None=0]="None",t[t.Fill=2]="Fill",t[t.Uniform=6]="Uniform",t[t.UniformToFill=7]="UniformToFill",t))(pe||{});class ye extends Kt{constructor(t,e){super(),y(this,"ll",void 0),y(this,"yt",void 0),y(this,"hl",void 0),y(this,"gf",void 0),y(this,"ls",void 0),y(this,"al",void 0),y(this,"mf",void 0),y(this,"lo",void 0),y(this,"pf",void 0),y(this,"yf",void 0),y(this,"Ob",void 0),this.n|=2097152,this.ll=null,this.yt="",this.hl=D.SD,this.gf=2,this.ls=null,this.al=null,this.mf=O.Center,this.lo=0,this.pf=null,this.yf=null,this.Ob=null,"string"==typeof t?this.source=t:t&&Object.assign(this,t),e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.yt=this.yt,t.element=this.ll,t.hl=this.hl.N(),t.gf=this.gf,t.lo=this.lo,t.ls=this.ls,t.al=this.al,t.mf=this.mf.N(),t.yf=this.yf}li(t){t in pe?this.imageStretch=t:super.li(t)}toString(){return"Picture("+this.source+")#"+k.fs(this)}get wf(){return 0!==(1048576&this.n)}set wf(t){this.wf!==t&&(this.n=1048576^this.n)}get Ip(){return 0!==(2097152&this.n)}set Ip(t){this.Ip!==t&&(this.n=2097152^this.n)}get yn(){return 0!==(4194304&this.n)}set yn(t){this.yn!==t&&(this.n=4194304^this.n)}static clearCache(t){void 0===t&&(t=""),d.i(t,"string",ye,"clearCache:url"),""!==t?ye.Ep[t]&&(delete ye.Ep[t],ye.t1--):(ye.Ep=new g,ye.t1=0)}static DL(t,e){e.FA||(e.i1=i=>{ye.Lv(e,i),t.desiredSize.isReal()||(t.ne(!1),t.c())},e.e1=t=>ye.Av(e,t),e.addEventListener("load",e.i1),e.addEventListener("error",e.e1),e.FA=!0)}static mR(t){t.i1&&t.removeEventListener("load",t.i1),t.e1&&t.removeEventListener("error",t.e1),delete t.i1,delete t.e1,delete t.FA}get element(){return this.ll}set element(t){const e=this.ll;if(this.os(!0),e!==t){this.wf=t instanceof HTMLCanvasElement;const i=t instanceof HTMLImageElement;null!==t&&!(i||t instanceof HTMLVideoElement||this.wf)&&d.o("Picture.element must be an instance of Image, Canvas, or Video, not: "+t);const n=this.diagram;null!==n&&n.LS(this),this.ll=t,null!==t&&i&&void 0===t.ns&&(t.ns=new k),null!==n&&i&&n.CS(this),this.t("element",e,t),this.C()}}dR(){const t=this.ll;null!==t&&((this.wf||!0===t.complete)&&(t.f0&&(t.Vp instanceof Event&&null!==this.ls?this.ls(this,t.Vp):!0===t.yn&&!t.Vp&&null!==this.al&&t.U2&&this.al(this,t.U2)),t.yn=!0,this.desiredSize.isReal()||(this.ne(!1),this.c())),!0===t.yn&&null!==this.diagram&&this.diagram.zu.add(this))}Tv(){if(null===this.ll)return void(this.pf=!1);const t=new qt(null).ci;try{t.drawImage(this.ll,0,0)}catch{this.Ip=!1}try{t.getImageData(0,0,1,1).data[3]&&(this.pf=!1),this.pf=!1}catch{this.pf=!0}}get source(){return this.yt}set source(t){const e=this.yt;if(e!==t){this.os(!0),d.i(t,"string",ye,"source"),this.yt=t;let i=ye.Ep;if(!Dt.isUsingDOM())return void this.t("source",e,t);let n=null;if(void 0!==i[t])n=i[t];else if(""!==t){ye.t1>30&&(ye.clearCache(),i=ye.Ep),n=d.sn("img"),n.f0=!0,ye.DL(this,n);const e=this.yf;null!==e&&(n.crossOrigin=e(this)),n.src=t,i[t]=n,ye.t1++}this.element=n,null!==n&&void 0===n.__goCache&&(n.__goCache=new ve),this.c(),this.C(),this.t("source",e,t)}}static Lv(t,e){let i;t.yn=!0,t.Vp=!1;const n=t.ns.copy();if(null==n)return;const s=n.iterator;for(;s.next();){const n=s.value;n.C();const o=t.getAttribute("src")||"",r=n.Ql.getValue(o);if(null===r)continue;const a=r.length;for(let s=0;s<a;s++)i=r[s],n.zu.add(i),i.os(!0),n.requestUpdate(),t.f0&&(void 0===t.U2&&(t.U2=e),null!==i.al&&i.al(i,e))}t.ns.clear()}static Av(t,e){let i;t.Vp=e;const n=t.ns.copy();if(null==n)return;const s=n.iterator;for(;s.next();){const n=s.value,o=t.getAttribute("src")||"",r=n.Ql.getValue(o);if(null===r)continue;const a=r.length,l=d.rt();for(let t=0;t<a;t++)l.push(r[t]);if(t.f0)for(let t=0;t<a;t++)i=l[t],null!==i.ls&&i.ls(i,e);d.it(l)}t.ns.clear()}reloadSource(){if(""===this.source)return;ye.clearCache(this.source);const t=this.source;this.source="",this.source=t}redraw(){this.C(),this.os(!0)}get sourceCrossOrigin(){return this.yf}set sourceCrossOrigin(t){if(this.yf!==t&&(null!==t&&d.i(t,"function",ye,"sourceCrossOrigin"),this.yf=t,null!==this.element)){const e=this.element.getAttribute("src");null===t&&"string"==typeof e?this.element.crossOrigin=null:null!==t&&(this.element.crossOrigin=t(this)),this.element.src=e}}get sourceRect(){return this.hl}set sourceRect(t){const e=this.hl;e.equals(t)||(t=t.N(),this.hl=t,this.C(),this.t("sourceRect",e,t))}get imageStretch(){return this.gf}set imageStretch(t){const e=this.gf;e!==t&&(this.gf=t,this.C(),this.t("imageStretch",e,t))}get flip(){return this.lo}set flip(t){const e=this.lo;e!==t&&(this.lo=t,this.C(),this.t("flip",e,t))}get imageAlignment(){return this.mf}set imageAlignment(t){const e=this.mf;e.equals(t)||(t=t.N(),this.mf=t,this.C(),this.t("imageAlignment",e,t))}get errorFunction(){return this.ls}set errorFunction(t){const e=this.ls;e!==t&&(null!==t&&d.i(t,"function",ye,"errorFunction"),this.ls=t,this.t("errorFunction",e,t))}get successFunction(){return this.al}set successFunction(t){const e=this.al;e!==t&&(null!==t&&d.i(t,"function",ye,"successFunction"),this.al=t,this.t("successFunction",e,t))}uh(t,e){const i=this.ll;if(null===i)return;const n=i.getAttribute("src");if(i instanceof HTMLImageElement&&(null===n||""===n)||i.Vp instanceof Event&&t instanceof Wt)return;const s=t instanceof Ht,o=this.naturalBounds;let r=0,a=0;const l=this.wf;let h=l?+i.width:i.naturalWidth,u=l?+i.height:i.naturalHeight;if(void 0===h&&i.videoWidth&&(h=i.videoWidth),void 0===u&&i.videoHeight&&(u=i.videoHeight),0===h||0===u)return;const c=h,d=u;this.sourceRect.isReal()&&(r=this.hl.x,a=this.hl.y,h=this.hl.width,u=this.hl.height);let f=h,g=u;const m=this.gf,p=this.mf;switch(m){case 0:if(this.sourceRect.isReal())break;f>=o.width&&(r=r+p.offsetX+(f*p.x-o.width*p.x)),g>=o.height&&(a=a+p.offsetY+(g*p.y-o.height*p.y)),h=Math.min(o.width,f),u=Math.min(o.height,g);break;case 2:f=o.width,g=o.height;break;case 6:case 7:let t=0;6===m?(t=Math.min(o.height/g,o.width/f),f*=t,g*=t):7===m&&(t=Math.max(o.height/g,o.width/f),f*=t,g*=t,f>=o.width&&(r=(r+p.offsetX+(f*p.x-o.width*p.x)/f)*h),g>=o.height&&(a=(a+p.offsetY+(g*p.y-o.height*p.y)/g)*u),h*=1/(f/o.width),u*=1/(g/o.height),f=o.width,g=o.height)}const y=h*u,v=this.getDocumentScale()*e.scale,b=f*v*(g*v),x=y/b,w=i.__goCache;let k=null;const S=ye.Dv;if(!s){if(i.yn&&void 0!==w&&b>4&&x>S*S){null===w.Ot&&(w.RA(4,c,d,i),w.RA(16,c,d,i));const t=w.Ot,e=t.length;for(let i=0;i<e&&t[i].Cd*t[i].Cd<x;i++)k=t[i]}if(!e.Bu&&(null===this.pf&&this.Tv(),this.pf))return}const P=f<o.width?p.offsetX+(o.width*p.x-f*p.x):0,M=g<o.height?p.offsetY+(o.height*p.y-g*p.y):0;switch(this.flip){case 0:break;case 2:t.translate(Math.min(o.width,f),0),t.scale(-1,1);break;case 1:t.translate(0,Math.min(o.height,g)),t.scale(1,-1);break;case 3:t.translate(Math.min(o.width,f),Math.min(o.height,g)),t.scale(-1,-1)}if(t.commitTransform(),e.getRenderingHint("pictureRatioOptimization")&&!e._h&&void 0!==w&&null!==k&&1!==k.Cd){t.save();const e=k.Cd;try{t.drawImage(k.yt,r/e,a/e,Math.min(k.yt.width,h/e),Math.min(k.yt.height,u/e),P,M,Math.min(o.width,f),Math.min(o.height,g)),t instanceof Ht&&(this.Ob=[r/e,a/e,Math.min(k.yt.width,h/e),Math.min(k.yt.height,u/e),P,M,Math.min(o.width,f),Math.min(o.height,g)])}catch{this.Ip=!1}t.restore()}else try{t.drawImage(i,r,a,h,u,P,M,Math.min(o.width,f),Math.min(o.height,g)),t instanceof Ht&&(this.Ob=[r,a,h,u,P,M,Math.min(o.width,f),Math.min(o.height,g)])}catch{this.Ip=!1}switch(this.flip){case 0:break;case 2:t.scale(-1,1),t.translate(-Math.min(o.width,f),0);break;case 1:t.scale(1,-1),t.translate(0,-Math.min(o.height,g));break;case 3:t.scale(-1,-1),t.translate(-Math.min(o.width,f),-Math.min(o.height,g))}}get naturalBounds(){return this.Bi}_u(t,e,i,n){const s=this.desiredSize,o=this.Xs(!0),r=this.ll,a=this.wf;let l=0,h=0;(a||!this.yn&&r&&r.complete)&&(this.yn=!0),null===r?(isFinite(s.width)||(t=i),isFinite(s.height)||(e=n)):(l=a?+r.width:r.naturalWidth,h=a?+r.height:r.naturalHeight),isFinite(s.width)||2===o||5===o?(isFinite(t)||(this.sourceRect.isReal()?t=this.sourceRect.width:null!==r&&(t=l)),i=0):null!==r&&!1!==this.yn&&(t=this.sourceRect.isReal()?this.sourceRect.width:l),isFinite(s.height)||2===o||4===o?(isFinite(e)||(this.sourceRect.isReal()?e=this.sourceRect.height:null!==r&&(e=h)),n=0):null!==r&&!1!==this.yn&&(e=this.sourceRect.isReal()?this.sourceRect.height:h),isFinite(s.width)&&(t=s.width),isFinite(s.height)&&(e=s.height);const u=this.maxSize,c=this.minSize;i=Math.max(i||0,c.width),n=Math.max(n||0,c.height),t=Math.min(u.width,t),e=Math.min(u.height,e),t=Math.max(i,t),e=Math.max(n,e),null!==r&&!r.complete&&(isFinite(t)||(t=0),isFinite(e)||(e=0)),this.Bi.So(t,e),this._n(0,0,t,e)}ch(t,e,i,n){this.commonArrange(t,e,i,n)}}y(ye,"Ep",new g),y(ye,"t1",0),y(ye,"Dv",4);class ve{constructor(){y(this,"Ot",void 0),this.Ot=null}RA(t,e,i,n){null===this.Ot&&(this.Ot=[]);const s=new qt(null),o=s.ci,r=1/t;if(s.width=e/t,s.height=i/t,0===s.width||0===s.height)return;const a=new be(s.Ft,t);let l=n,h=1;if(this.Ot.length>0){const t=this.Ot[this.Ot.length-1];l=t.yt,h=t.Cd}o.setTransform(r*h,0,0,r*h,0,0),o.commitTransform(),o.drawImage(l,0,0),this.Ot.push(a)}}class be{constructor(t,e){y(this,"yt",void 0),y(this,"Cd",void 0),this.yt=t,this.Cd=e}}class xe{constructor(){y(this,"Mi",void 0),y(this,"Wg",void 0),this.Wg=new z,this.Mi=null}Jt(t){null!==t?(t.lt(),this.Wg=t,t.figures.clear()):this.Wg=new z,this.Mi=null}fu(t,e,i,n,s,o){if(void 0!==n&&!0===n){const i=new K(1);i.endX=t,i.endY=e,this.Mi.segments.add(i)}else this.Mi=new j,this.Mi.startX=t,this.Mi.startY=e,this.Mi.isFilled=i,this.Mi.isEvenOdd=o||!1,this.Wg.figures.add(this.Mi);void 0!==s&&(this.Mi.isShadowed=s)}OD(){const t=this.Mi.segments.length;t>0&&this.Mi.segments.elt(t-1).close()}ID(){this.Mi.segments.length>0&&(this.Mi.isFilled=!0)}ED(t){this.Mi.isShadowed=t}dE(t){this.Mi.isEvenOdd=t}FD(t,e,i){void 0===i&&(i=!1);const n=new K(1);n.endX=t,n.endY=e,i&&n.close(),this.Mi.segments.add(n)}gr(t,e,i){void 0===i&&(i=!1);const n=new K(2);n.endX=t,n.endY=e,i&&n.close(),this.Mi.segments.add(n)}mr(t,e,i,n,s,o,r){void 0===r&&(r=!1);const a=new K(3);a.point1X=t,a.point1Y=e,a.point2X=i,a.point2Y=n,a.endX=s,a.endY=o,r&&a.close(),this.Mi.segments.add(a)}Mw(t,e,i,n,s){void 0===s&&(s=!1);const o=new K(4);o.point1X=t,o.point1Y=e,o.endX=i,o.endY=n,s&&o.close(),this.Mi.segments.add(o)}RD(t,e,i,n,s,o,r){void 0===o&&(o=0),void 0===r&&(r=!1);const a=new K(5);a.startAngle=t,a.sweepAngle=e,a.centerX=i,a.centerY=n,a.radiusX=s,a.radiusY=0!==o?o:s,r&&a.close(),this.Mi.segments.add(a)}vD(t,e,i,n,s,o,r,a){void 0===a&&(a=!1);const l=new K(6,o,r,t,e,i,n,s);a&&l.close(),this.Mi.segments.add(l)}static uC(t){const e=xe.B2;if(null!==e)return xe.B2=null,e.Jt(t),e;{const e=new xe;return e.Jt(t),e}}static dC(t){xe.B2=t}}y(xe,"B2",null);{const t=function(t,e){const i=t.toLowerCase(),n=E.No;n[t]=e,n[i]=t};t("Rectangle",((t,e,i)=>{const n="r"+e+","+i;let s=E.ur[n];return void 0!==s||(s=new z(2),s.endX=e,s.endY=i,E.dr<E.Gg&&(E.ur[n]=s,E.dr++)),s})),t("Square",((t,e,i)=>{const n="s"+e+","+i;let s=E.ur[n];return void 0!==s||(s=new z(2),s.endX=e,s.endY=i,s.defaultStretch=6,E.dr<E.Gg&&(E.ur[n]=s,E.dr++)),s}));const e=(t,e,i,n,s)=>{(isNaN(n)||n<0)&&(n=5),isNaN(s)&&(s=15);const o="rr"+e+","+i+","+n+","+s;let r=E.ur[o];if(void 0!==r)return r;let a=n;1===(1&s)?(a=Math.min(a,2===(2&s)?e/3:e),a=Math.min(a,8===(8&s)?i/3:i)):a=0;const l=new j(a,0,!0);r=(new z).add(l);const h=O.TopLeft.copy(),u=O.BottomRight.copy();if(2===(2&s)){let t=n;t=Math.min(t,1===(1&s)?e/3:e),t=Math.min(t,4===(4&s)?i/3:i);const o=t*E.Un;l.add(new K(2,e-t,0)).add(new K(3,e,t,e-o,0,e,o)),h.offsetY=o,u.offsetX=-o}else l.add(new K(2,e,0));if(4===(4&s)){let t=n;t=Math.min(t,8===(8&s)?e/3:e),t=Math.min(t,2===(2&s)?i/3:i);const o=t*E.Un;l.add(new K(2,e,i-t)).add(new K(3,e-t,i,e,i-o,e-o,i)),u.offsetX=-o,u.offsetY=-o}else l.add(new K(2,e,i));if(8===(8&s)){let t=n;t=Math.min(t,4===(4&s)?e/3:e),t=Math.min(t,1===(1&s)?i/3:i);const o=t*E.Un;l.add(new K(2,t,i)).add(new K(3,0,i-t,o,i,0,i-o)),h.offsetX=o,u.offsetY=-o}else l.add(new K(2,0,i));if(1===(1&s)){const t=a*E.Un;l.add(new K(2,0,a)).add(new K(3,a,0,0,t,t,0).close()),h.offsetX=t,h.offsetY=t}else l.add(new K(2,0,0).close());return r.spot1=h,r.spot2=u,E.dr<E.Gg&&(E.ur[o]=r,E.dr++),r};t("RoundedRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN,o=t?t.parameter2:NaN;return e(t,i,n,s,o)})),t("Border","RoundedRectangle"),t("RoundedTopRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,3)})),t("RoundedBottomRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,12)})),t("RoundedLeftRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,9)})),t("RoundedRightRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,6)})),t("Ellipse",((t,e,i)=>{const n="e"+e+","+i;let s=E.ur[n];return void 0!==s||(s=new z(3),s.endX=e,s.endY=i,s.spot1=O.Rk,s.spot2=O.vk,E.dr<E.Gg&&(E.ur[n]=s,E.dr++)),s})),t("Circle",((t,e,i)=>{const n="c"+e+","+i;let s=E.ur[n];return void 0!==s||(s=new z(3),s.endX=e,s.endY=i,s.spot1=O.Rk,s.spot2=O.vk,s.defaultStretch=6,E.dr<E.Gg&&(E.ur[n]=s,E.dr++)),s})),t("TriangleRight",((t,e,i)=>(new z).add(new j(0,0).add(new K(2,e,.5*i)).add(new K(2,0,i).close())).setSpots(0,.25,.5,.75))),t("TriangleDown",((t,e,i)=>(new z).add(new j(0,0).add(new K(2,e,0)).add(new K(2,.5*e,i).close())).setSpots(.25,0,.75,.5))),t("TriangleLeft",((t,e,i)=>(new z).add(new j(e,i).add(new K(2,0,.5*i)).add(new K(2,e,0).close())).setSpots(.5,.25,1,.75))),t("TriangleUp",((t,e,i)=>(new z).add(new j(e,i).add(new K(2,0,i)).add(new K(2,.5*e,0).close())).setSpots(.25,.5,.75,1))),t("Triangle","TriangleUp"),t("Diamond",((t,e,i)=>(new z).add(new j(.5*e,0).add(new K(2,0,.5*i)).add(new K(2,.5*e,i)).add(new K(2,e,.5*i).close())).setSpots(.25,.25,.75,.75))),t("LineH",((t,e,i)=>{const n=new z(1);return n.startX=0,n.startY=i/2,n.endX=e,n.endY=i/2,n})),t("LineV",((t,e,i)=>{const n=new z(1);return n.startX=e/2,n.startY=0,n.endX=e/2,n.endY=i,n})),t("None","Rectangle"),t("BarH","Rectangle"),t("BarV","Rectangle"),t("MinusLine","LineH"),t("PlusLine",((t,e,i)=>(new z).add(new j(0,i/2,!1).add(new K(2,e,i/2)).add(new K(1,e/2,0)).add(new K(2,e/2,i))))),t("XLine",((t,e,i)=>(new z).add(new j(0,i,!1).add(new K(2,e,0)).add(new K(1,0,0)).add(new K(2,e,i))))),t("LineRight",((t,e,i)=>(new z).add(new j(.25*e,0,!1).add(new K(2,.75*e,.5*i)).add(new K(2,.25*e,i))))),t("LineDown",((t,e,i)=>(new z).add(new j(0,.25*i,!1).add(new K(2,.5*e,.75*i)).add(new K(2,e,.25*i))))),t("LineLeft",((t,e,i)=>(new z).add(new j(.75*e,0,!1).add(new K(2,.25*e,.5*i)).add(new K(2,.75*e,i))))),t("LineUp",((t,e,i)=>(new z).add(new j(0,.75*i,!1).add(new K(2,.5*e,.25*i)).add(new K(2,e,.75*i))))),t("Capsule",((t,e,i)=>{const n=new z;if(e<i){const t=new j(0,e/2,!0);return n.add(t),t.add(new K(5,180,180,e/2,e/2,e/2,e/2)),t.add(new K(2,e,i-e/2)),t.add(new K(5,0,180,e/2,i-e/2,e/2,e/2)),t.add(new K(2,0,e/2)),n.spot1=new O(.156,0,0,.156*e),n.spot2=new O(.844,1,0,.156*-e),n}if(e>i){const t=new j(i/2,0,!0);return n.add(t),t.add(new K(2,e-i/2,0)),t.add(new K(5,270,180,e-i/2,i/2,i/2,i/2)),t.add(new K(2,i/2,i)),t.add(new K(5,90,180,i/2,i/2,i/2,i/2)),n.spot1=new O(0,.156,.156*i,0),n.spot2=new O(1,.844,.156*-i,0),n}return n.type=3,n.endX=e,n.endY=i,n.spot1=O.Rk,n.spot2=O.vk,n}));const i=(t,e)=>new j(t,e,!1,!1),n=(t,e,i)=>t.add(new K(2,e,i)),s=(t,e,i)=>t.add(new K(1,e,i));t("Borders",((t,e,o)=>{let r=t?t.parameter1:NaN;isNaN(r)?r=10:r&=15;const a=new z;let l;return 10===r?(l=i(e,0),n(l,e,o),s(l,0,o),n(l,0,0)):5===r?(l=i(0,0),n(l,e,0),s(l,e,o),n(l,0,o)):1===r?(l=i(0,0),n(l,e,0),s(l,e,o)):2===r?(l=i(e,0),n(l,e,o)):4===r?(l=i(e,o),n(l,0,o)):8===r?(l=i(0,o),n(l,0,0),s(l,e,o)):3===r?(l=i(0,0),n(l,e,0),n(l,e,o)):6===r?(l=i(e,0),n(l,e,o),n(l,0,o)):12===r?(l=i(e,o),n(l,0,o),n(l,0,0)):9===r?(l=i(0,o),n(l,0,0),n(l,e,0)):7===r?(l=i(0,0),n(l,e,0),n(l,e,o),n(l,0,o)):14===r?(l=i(e,0),n(l,e,o),n(l,0,o),n(l,0,0)):13===r?(l=i(e,o),n(l,0,o),n(l,0,0),n(l,e,0)):11===r?(l=i(0,o),n(l,0,0),n(l,e,0),n(l,e,o)):15===r?(l=i(0,0),n(l,e,0),n(l,e,o),n(l,0,o),l.add(new K(2,0,0).close())):(l=i(0,0),s(l,e,o)),a.add(l),a}))}E.Yg={"":"",Standard:"F1 m 0,0 l 8,4 -8,4 2,-4 z",Backward:"F1 m 8,0 l -2,4 2,4 -8,-4 z",Triangle:"F1 m 0,0 l 8,4.62 -8,4.62 z",BackwardTriangle:"F1 m 8,4 l 0,4 -8,-4 8,-4 0,4 z",Boomerang:"F1 m 0,0 l 8,4 -8,4 4,-4 -4,-4 z",BackwardBoomerang:"F1 m 8,0 l -8,4 8,4 -4,-4 4,-4 z",SidewaysV:"m 0,0 l 8,4 -8,4 0,-1 6,-3 -6,-3 0,-1 z",BackwardV:"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z",OpenTriangle:"m 0,0 l 8,4 -8,4",BackwardOpenTriangle:"m 8,0 l -8,4 8,4",OpenTriangleLine:"m 0,0 l 8,4 -8,4 m 8.5,0 l 0,-8",BackwardOpenTriangleLine:"m 8,0 l  -8,4 8,4 m -8.5,0 l 0,-8",OpenTriangleTop:"m 0,0 l 8,4 m 0,4",BackwardOpenTriangleTop:"m 8,0 l -8,4 m 0,4",OpenTriangleBottom:"m 0,8 l 8,-4",BackwardOpenTriangleBottom:"m 0,4 l 8,4",HalfTriangleTop:"F1 m 0,0 l 0,4 8,0 z m 0,8",BackwardHalfTriangleTop:"F1 m 8,0 l 0,4 -8,0 z m 0,8",HalfTriangleBottom:"F1 m 0,4 l 0,4 8,-4 z",BackwardHalfTriangleBottom:"F1 m 8,4 l 0,4 -8,-4 z",ForwardSemiCircle:"m 4,0 b 270 180 0 4 4",BackwardSemiCircle:"m 4,8 b 90 180 0 -4 4",Feather:"m 0,0 l 3,4 -3,4",BackwardFeather:"m 3,0 l -3,4 3,4",DoubleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardDoubleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4",TripleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardTripleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4 m 3,-8 l -3,4 3,4",ForwardSlash:"m 0,8 l 5,-8",BackSlash:"m 0,0 l 5,8",DoubleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8",DoubleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8",TripleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8 m -2,8 l 4,-8",TripleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8 m -2,-8 l 4,8",Fork:"m 0,4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4",LineFork:"m 0,0 l 0,8 m 0,-4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardLineFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4 m 8,-8 l 0,8",CircleFork:"F1 m 6,4 b 0 360 -3 0 3 z m 0,0 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 6,0 b 0 360 -3 0 3",CircleLineFork:"F1 m 6,4 b 0 360 -3 0 3 z m 1,-4 l 0,8 m 0,-4 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleLineFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 0,-4 l 0,8 m 7,-4 b 0 360 -3 0 3",Circle:"F1 m 8,4 b 0 360 -4 0 4 z",Block:"F1 m 0,0 l 0,8 8,0 0,-8 z",StretchedDiamond:"F1 m 0,3 l 5,-3 5,3 -5,3 -5,-3 z",Diamond:"F1 m 0,4 l 4,-4 4,4 -4,4 -4,-4 z",Chevron:"F1 m 0,0 l 5,0 3,4 -3,4 -5,0 3,-4 -3,-4 z",StretchedChevron:"F1 m 0,0 l 8,0 3,4 -3,4 -8,0 3,-4 -3,-4 z",NormalArrow:"F1 m 0,2 l 4,0 0,-2 4,4 -4,4 0,-2 -4,0 z",X:"m 0,0 l 8,8 m 0,-8 l -8,8",TailedNormalArrow:"F1 m 0,0 l 2,0 1,2 3,0 0,-2 2,4 -2,4 0,-2 -3,0 -1,2 -2,0 1,-4 -1,-4 z",DoubleTriangle:"F1 m 0,0 l 4,4 -4,4 0,-8 z  m 4,0 l 4,4 -4,4 0,-8 z",BigEndArrow:"F1 m 0,0 l 5,2 0,-2 3,4 -3,4 0,-2 -5,2 0,-8 z",ConcaveTailArrow:"F1 m 0,2 h 4 v -2 l 4,4 -4,4 v -2 h -4 l 2,-2 -2,-2 z",RoundedTriangle:"F1 m 0,1 a 1,1 0 0 1 1,-1 l 7,3 a 0.5,1 0 0 1 0,2 l -7,3 a 1,1 0 0 1 -1,-1 l 0,-6 z",SimpleArrow:"F1 m 1,2 l -1,-2 2,0 1,2 -1,2 -2,0 1,-2 5,0 0,-2 2,2 -2,2 0,-2 z",AccelerationArrow:"F1 m 0,0 l 0,8 0.2,0 0,-8 -0.2,0 z m 2,0 l 0,8 1,0 0,-8 -1,0 z m 3,0 l 2,0 2,4 -2,4 -2,0 0,-8 z",BoxArrow:"F1 m 0,0 l 4,0 0,2 2,0 0,-2 2,4 -2,4 0,-2 -2,0 0,2 -4,0 0,-8 z",TriangleLine:"F1 m 8,4 l -8,-4 0,8 8,-4 z m 0.5,4 l 0,-8",CircleEndedArrow:"F1 m 10,4 l -2,-3 0,2 -2,0 0,2 2,0 0,2 2,-3 z m -4,0 b 0 360 -3 0 3 z",DynamicWidthArrow:"F1 m 0,3 l 2,0 2,-1 2,-2 2,4 -2,4 -2,-2 -2,-1 -2,0 0,-2 z",EquilibriumArrow:"m 0,3 l 8,0 -3,-3 m 3,5 l -8,0 3,3",FastForward:"F1 m 0,0 l 3.5,4 0,-4 3.5,4 0,-4 1,0 0,8 -1,0 0,-4 -3.5,4 0,-4 -3.5,4 0,-8 z",Kite:"F1 m 0,4 l 2,-4 6,4 -6,4 -2,-4 z",HalfArrowTop:"F1 m 0,0 l 4,4 4,0 -8,-4 z m 0,8",HalfArrowBottom:"F1 m 0,8 l 4,-4 4,0 -8,4 z",OpposingDirectionDoubleArrow:"F1 m 0,4 l 2,-4 0,2 4,0 0,-2 2,4 -2,4 0,-2 -4,0 0,2 -2,-4 z",PartialDoubleTriangle:"F1 m 0,0 4,3 0,-3 4,4 -4,4 0,-3 -4,3 0,-8 z",LineCircle:"F1 m 0,0 l 0,8 m 7 -4 b 0 360 -3 0 3 z",DoubleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",TripleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",CircleLine:"F1 m 6 4 b 0 360 -3 0 3 z m 1,-4 l 0,8",DiamondCircle:"F1 m 8,4 l -4,4 -4,-4 4,-4 4,4 m 8,0 b 0 360 -4 0 4 z",PlusCircle:"F1 m 8,4 b 0 360 -4 0 4 l -8 0 z m -4 -4 l 0 8",OpenRightTriangleTop:"m 8,0 l 0,4 -8,0 m 0,4",OpenRightTriangleBottom:"m 8,8 l 0,-4 -8,0",Line:"m 0,0 l 0,8",DoubleLine:"m 0,0 l 0,8 m 2,0 l 0,-8",TripleLine:"m 0,0 l 0,8 m 2,0 l 0,-8 m 2,0 l 0,8",PentagonArrow:"F1 m 8,4 l -4,-4 -4,0 0,8 4,0 4,-4 z"};var we=(t=>(t[t.None=0]="None",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Shown=4]="Shown",t[t.Hidden=8]="Hidden",t[t.NodeSized=16]="NodeSized",t[t.GroupLayout=32]="GroupLayout",t[t.NodeReplaced=64]="NodeReplaced",t[t.Standard=127]="Standard",t[t.All=16777215]="All",t))(we||{});class ke extends ie{constructor(t,e){void 0===t||t instanceof te||"number"==typeof t||"string"==typeof t?(super(t),y(this,"P",void 0),y(this,"Wo",void 0),y(this,"F",void 0),y(this,"cl",void 0),y(this,"fl",void 0),y(this,"Jo",void 0),y(this,"ai",void 0),y(this,"$o",void 0),y(this,"yh",void 0),y(this,"js",void 0),y(this,"Zo",void 0),y(this,"Ld",void 0),y(this,"VM",void 0),y(this,"vA",void 0),y(this,"Up",void 0),y(this,"Bp",void 0)):(super(),y(this,"P",void 0),y(this,"Wo",void 0),y(this,"F",void 0),y(this,"cl",void 0),y(this,"fl",void 0),y(this,"Jo",void 0),y(this,"ai",void 0),y(this,"$o",void 0),y(this,"yh",void 0),y(this,"js",void 0),y(this,"Zo",void 0),y(this,"Ld",void 0),y(this,"VM",void 0),y(this,"vA",void 0),y(this,"Up",void 0),y(this,"Bp",void 0),t&&(e=t)),this.P=2408959,this.Wo="",this.F=null,this.cl="",this.fl=null,this.Jo=null,this.ai="",this.$o=null,this.yh=null,this.js=new T(NaN,NaN).g(),this.Zo=null,this.Ld=NaN,this.VM=-1,this.vA=new D,this.Up=null,this.Bp=NaN,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.P=49152|-4097&this.P,t.Wo=this.Wo,null!==this.F&&(this.F.mi?t.F=this.F:t.F=this.F.copy()),t.cl=this.cl,t.Jo=null,t.ai=this.ai,t.js.a(this.js),t.Ld=this.Ld}Xo(t){super.Xo(t),t.fh(),t.fl=null,t.Zo=null,t.Up=null}toString(){let t=d.nn(this.constructor)+"#"+k.fs(this);return null!==this.data&&(t+="("+d.toString(this.data)+")"),t}qi(){null===this.F?this.F=new Se:this.F.mi&&(this.F=this.F.copy())}hh(){super.hh(),null!==this.F&&(this.F.mi=!0)}qc(t,e,i,n,s,o,r){const a=this.diagram;null!==a&&(3===t&&"elements"===e?s instanceof ie?s.$r((t=>{a.partManager.bS(t,a)})):s instanceof ye&&a.CS(s):4===t&&"elements"===e&&(s instanceof ie?s.$r((t=>a.partManager.kS(t,a))):s instanceof ye&&a.LS(s)),a.raiseChangedEvent(t,e,i,n,s,o,r))}updateTargetBindings(t){if(super.updateTargetBindings(t),null===this.data)return;const e=this.T.r,i=e.length;for(let s=0;s<i;s++){const t=e[s];t instanceof ie&&t.$r((t=>{null!==t.data&&t.updateTargetBindings()}))}const n=this.adornments;for(;n.next();)n.value.updateTargetBindings(t)}Vo(){if(super.Vo(),this.u2()){const t=this.T.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];e instanceof ie&&e.$r((t=>t.Vo()))}}const t=this.adornments;for(;t.next();)t.value.Vo()}updateRelationshipsFromData(){var t;null!==this.data&&(null===(t=this.diagram)||void 0===t||t.partManager.updateRelationshipsFromData(this))}get key(){const t=this.diagram;if(null!==t)return t.model.getKeyForNodeData(this.data)}get adornments(){return null===this.Jo?m.instance:this.Jo.iteratorValues}findAdornment(t){const e=this.Jo;return null===e?null:e.getValue(t)}addAdornment(t,e){if(null===e)return;let i=null,n=this.Jo;if(null!==n&&(i=n.getValue(t)),i!==e){if(null!==i){const t=i.diagram;null!==t&&t.remove(i)}null===n&&(n=new L,this.Jo=n),e.Wo!==t&&(e.category=t),n.add(t,e);const s=this.diagram;if(null!==s){s.add(e);const t=e.adornedObject;if(null!==t){const i=t.findBindingPanel();null!==i&&(e.data=i.data)}}}}removeAdornment(t){const e=this.Jo;if(null===e)return;const i=e.getValue(t);if(null!==i){const t=i.diagram;null!==t&&(t.remove(i),i.data=null)}e.remove(t),0===e.count&&(this.Jo=null)}clearAdornments(){const t=this.Jo;if(null===t)return;const e=d.rt(),i=t.iterator;for(;i.next();){const t=i.key;e.push(t)}const n=e.length;for(let s=0;s<n;s++)this.removeAdornment(e[s]);d.it(e)}updateAdornments(){const t=this.diagram;if(null===t)return;this.Fv(t),this.Rv(t);let e=this.adornments;for(;e.next();){const t=e.value;t.c(),t.hasPlaceholder()&&t.placeholder.c()}for(e=this.adornments;e.next();)e.value.updateTargetBindings()}invalidateAdornments(){const t=this.diagram;null!==t&&(t.ih(),!0!==this.OA()&&this.IA(!0))}UM(){!1!==this.OA()&&(this.updateAdornments(),this.IA(!1))}Fv(t){const e="Selection";if(this.isSelected&&this.selectionAdorned){const i=this.selectionObject;if(null!==i&&this.actualBounds.isReal()&&this.isVisible()&&i.isVisibleObject()&&i.actualBounds.isReal()){let n=this.findAdornment(e);if(null===n){let e=this.selectionAdornmentTemplate;if(null===e&&(e=this.Tl()?t.linkSelectionAdornmentTemplate:this instanceof Ve?t.groupSelectionAdornmentTemplate:t.nodeSelectionAdornmentTemplate),!(e instanceof Pe))return;e.hi(),n=e.copy(),null!==n&&(this.Tl()&&this.selectionObject===this.path&&(n.type=ie.Link),n.adornedObject=i)}if(null!==n)return n.type===ie.Link&&n.c(),void this.addAdornment(e,n)}}this.removeAdornment(e)}Rv(t){const e=this;t.toolManager.mouseDownTools.each((t=>{t.isEnabled&&t.updateAdornments(e)})),t.toolManager.updateAdornments(e)}IM(t){this.$o=t,null===t&&this.TR()}get layer(){return this.$o}get diagram(){const t=this.$o;return null==t?null:t.diagram}get layerName(){return this.cl}set layerName(t){const e=this.cl;if(e===t)return;d.i(t,"string",ke,"layerName");let i=this.diagram;if(null!==i&&(null===i.findLayer(t)||i.partManager.addsToTemporaryLayer))return;this.cl=t,null!==i&&i.invalidateDocumentBounds(),this.t("layerName",e,t);const n=this.layer;if(null===n||n.name===t||(i=n.diagram,null===i))return;const s=i.findLayer(t);if(null===s||s===n)return;let o=n.ie(-1,this,!0);o>=0&&i.raiseChangedEvent(4,"parts",n,this,null,o,!0),o=s.Wh(99999999,this,!0),n.visible!==s.visible&&this.Ei(s.visible),o>=0&&i.raiseChangedEvent(3,"parts",s,null,this,!0,o);const r=this.layerChanged;if(null===r)return;const a=i.G;i.G=!0,r(this,n,s),i.G=a}get layerChanged(){return null!==this.F?this.F.zp:null}set layerChanged(t){const e=this.layerChanged;e!==t&&(null!==t&&d.i(t,"function",ke,"layerChanged"),this.qi(),this.F.zp=t,this.t("layerChanged",e,t))}get zOrder(){return this.Ld}set zOrder(t){const e=this.Ld;if(e===t)return;d.i(t,"number",ke,"zOrder"),this.Ld=t;const i=this.layer;null!==i&&i.yx(-1,this),this.t("zOrder",e,t);const n=this.diagram;null!==n&&n.C()}vv(){const t=this.layer;null!==t&&t.yx(-1,this)}s1(){if(!1!==this.eh())return;this.z2(!0),this.td();const t=this.diagram;null!==t&&(t.r0(this),t.requestUpdate())}EA(){if(this.P|=2097152,!1===this.eh())return;const t=this.position,e=this.location;(!e.isReal()||!t.isReal())&&this.VA(t,e);const i=this.Ai,n=D.l().a(i);i.lt(),i.x=t.x,i.y=t.y,i.g(),this.ed(n,i),D.s(n),this.z2(!1)}_n(t,e,i,n){const s=this.re;s.e(t,e,i,n),null===this.ki&&(this.ki=new R);const o=this.ki;o.Jt(),this.y0(o,t,e,i,n),this.ki=o,o.Ok()||o.ww(s)}y0(t,e,i,n,s){if(1!==this.K&&t.K(this.K),0===this.Xt)return;let o=O.Center;this.locationSpot.isSpot()&&(o=this.locationSpot);const r=T.l();if(this.locationObject!==this){const t=this.locationObject,e=t.naturalBounds;r.setSpot(e.x,e.y,e.width,e.height,o),null!==t.ki&&t.ki.xt(r),r.offset(-t.measuredBounds.x,-t.measuredBounds.y);let i=t.panel;for(;null!==i&&i!==this;)null!==i.ki&&i.ki.xt(r),r.offset(-i.measuredBounds.x,-i.measuredBounds.y),i=i.panel}else r.setSpot(e,i,n,s,o);t.us(this.Xt,r.x,r.y),T.s(r)}get locationObject(){if(null===this.Zo)if(this instanceof Pe&&this.type!==ie.Link&&this.hasPlaceholder())this.Zo=this.placeholder;else{const t=this.locationObjectName;if(""!==t){const e=this.findObject(t);this.Zo=null!==e?e:this}else this.Zo=this}return this.Zo.visible?this.Zo:this}get minLocation(){return null!==this.F?this.F.Xp:T.qN}set minLocation(t){const e=this.minLocation;e.equals(t)||(t=t.N(),this.qi(),this.F.Xp=t,this.t("minLocation",e,t))}get maxLocation(){return null!==this.F?this.F.Kp:T.WN}set maxLocation(t){const e=this.maxLocation;e.equals(t)||(t=t.N(),this.qi(),this.F.Kp=t,this.t("maxLocation",e,t))}get locationObjectName(){return null!==this.F?this.F.Yp:""}set locationObjectName(t){const e=this.locationObjectName;e!==t&&(this.qi(),this.F.Yp=t,this.Zo=null,this.c(),this.t("locationObjectName",e,t))}get locationSpot(){return null!==this.F?this.F.Gp:O.TopLeft}set locationSpot(t){const e=this.locationSpot;e.equals(t)||(t=t.N(),this.qi(),this.F.Gp=t,this.c(),this.t("locationSpot",e,t))}move(t,e){!0===e?this.location=t:this.position=t}moveTo(t,e,i){const n=T.X(t,e);this.move(n,i),T.s(n)}isVisible(){if(!this.visible)return!1;const t=this.layer;if(null!==t){if(!t.visible)return!1;const e=t.diagram;if(null!==e&&e.animationManager.nx(this))return!0}const e=this.containingGroup;return!(null!==e&&(!e.isSubGraphExpanded||!e.isVisible()))}Ei(t){const e=this.diagram;t?(this.invalidateLayout(4),this.invalidateAdornments(),null!==e&&e.r0(this)):(this.invalidateLayout(8),this.clearAdornments()),this.fh(),null!==e&&(e.invalidateDocumentBounds(),e.C())}findObject(t){if(this.name===t)return this;let e=this.Up;if(null===e&&(this.Up=e=new L),null!==e.getValue(t))return e.getValue(t);const i=super.findObject(t);return null!==i?(e.set(t,i),i):(e.set(t,null),null)}T0(){this.Up=null}getRelativePoint(t,e,i){void 0===i&&(i=new T);const n=e.isNoSpot()?O.Center:e,s=t.naturalBounds;if(i.e(s.width*n.x+n.offsetX,s.height*n.y+n.offsetY),null===t||t===this)return i;t.L.xt(i);let o=t.panel;for(;null!==o&&o!==this;)o.L.xt(i),o=o.panel;return null!==this.ki&&this.ki.xt(i),i.offset(-this.re.x,-this.re.y),i}getDocumentBounds(t){return void 0===t&&(t=new D),t.a(this.actualBounds)}ensureBounds(){this.ut(1/0,1/0),this.zt()}fA(t){const e=this.locationSpot,i=this.locationObject,n=i.naturalBounds,s=i instanceof le?i.strokeWidth:0;if(t.setSpot(0,0,n.width+s,n.height+s,e),i!==this){t.offset(-s/2,-s/2),i.L.xt(t);let e=i.panel;for(;null!==e&&e!==this;)e.L.xt(t),e=e.panel}return null!==this.ki&&this.ki.xt(t),t.offset(-this.re.x,-this.re.y),t}qh(t,e){const i=void 0===e?this.vA:e,n=this.Ov(),s=2*n;if(!this.isShadowed)return i.e(t.x-1-n,t.y-1-n,t.width+2+s,t.height+2+s),i;let o=t.x,r=t.y,a=t.width,l=t.height;const h=this.shadowBlur,u=this.shadowOffset;return a+=h,l+=h,o-=h/2,r-=h/2,u.x>0?a+=u.x:(o+=u.x,a-=u.x),u.y>0?l+=u.y:(r+=u.y,l-=u.y),i.e(o-1,r-1,a+2,l+2),i}pv(){return this.type===ie.Link&&this instanceof Pe&&"Selection"===this.category&&this.adornedObject instanceof le&&this.adornedPart.findMainElement()===this.adornedObject?this.adornedObject.strokeWidth:0}Ov(){return isNaN(this.Bp)&&(this.Bp=this.wA()),this.Bp}hf(){this.Bp=NaN}zt(){if(!1===this.ss())return void this.EA();this.to(!1);const t=this.Ai,e=D.l();e.a(t);const i=this.Al();this.ch(0,0,this.re.width,this.re.height);const n=this.position;this.VA(n,this.location),t.lt(),t.x=n.x,t.y=n.y,t.g(),this.ed(e,t),e.equals(t)?this.Us(i):this.Ne()&&(!E.u(e.width,t.width)||!E.u(e.height,t.height))&&this.VM>=0&&this.invalidateLayout(16),D.s(e),this.z2(!1)}ed(t,e){const i=this.diagram;if(null===i)return;let n=!1;if(!1===i.Qh&&t.isReal()){const s=D.l();s.a(i.documentBounds),s.subtractMargin(i.padding),t.x>s.x&&t.y>s.y&&t.right<s.right&&t.bottom<s.bottom&&e.x>s.x&&e.y>s.y&&e.right<s.right&&e.bottom<s.bottom&&(n=!0),D.s(s)}(!0===this.Iv()||!t.equals(e))&&this.bL(n,i),i.C(),(t.isReal()||e.isReal())&&!t.equalsApproxClose(e)&&(this instanceof Ce&&!i.undoManager.isUndoingRedoing&&this.invalidateConnectedLinks(),this.fh())}get location(){return this.js}set location(t){const e=t.x,i=t.y,n=this.js;(n.x!==e&&(!isNaN(n.x)||!isNaN(e))||n.y!==i&&(!isNaN(n.y)||!isNaN(i)))&&(t=t.copy(),this.Ev(t,n)&&this.t("location",n,t.copy()))}Ev(t,e){if(this.Tl())return!1;if(this.js=t,this.P|=2097152,!1===this.ss()){this.s1();const i=this.st;if(i.isReal()){const n=this.diagram;if(null===n||n.animationManager.isTicking||!n.undoManager.isUndoingRedoing){const s=i.copy();i.e(i.x+(t.x-e.x),i.y+(t.y-e.y)),this.UA(n,i,s.x,s.y),this.t("position",s,i.copy())}}}return!0}a2(t,e,i){if(this.Tl()||!t.isReal())return!1;const n=this.diagram;if(null!==n&&this.UA(n,t,e,i),this.st=t,this.P&=-2097153,this.js.isReal()&&(null===n||n.animationManager.isTicking||!n.undoManager.isUndoingRedoing)){const n=this.js;this.js=new T(n.x+(t.x-e),n.y+(t.y-i)),this.t("location",n,this.js.copy())}return!1===this.eh()&&!1===this.ss()&&(this.s1(),this.EA()),!0}UA(t,e,i,n){if(null===t||this instanceof Pe)return;const s=t.animationManager;s.xi&&s.GC(this,new T(i,n),e,!1)}yc(t,e,i){const n=this.js,s=this.st;if(i){if(n.x===t&&n.y===e)return;this.eh()||this.ss()?s.e(NaN,NaN):s.e(s.x+t-n.x,s.y+e-n.y),n.e(t,e)}else{if(s.x===t&&s.y===e)return;n.e(n.x+t-s.x,n.y+e-s.y),s.e(t,e)}this.s1()}c2(){this.P&=-2097153,this.s1()}VA(t,e){const i=this.fA(T.l()),n=this.diagram,s=e.isReal(),o=t.isReal();s&&o?2097152&this.P?this.BA(t,e,n,i):this.zA(t,e,n,i):s?this.BA(t,e,n,i):o&&this.zA(t,e,n,i),this.P|=2097152,T.s(i),this.td()}BA(t,e,i,n){const s=t.x,o=t.y;if(t.e(e.x-n.x,e.y-n.y),null!==i){const e=i.animationManager,n=e.defaultAnimation.isAnimating;!n&&e.xi&&!(this instanceof Pe)&&e.GC(this,new T(s,o),t,!1),!n&&(t.x!==s||t.y!==o)&&this.t("position",new T(s,o),t.copy())}}zA(t,e,i,n){const s=e.copy();e.e(t.x+n.x,t.y+n.y),!e.equals(s)&&null!==i&&this.t("location",s,e.copy())}bL(t,e){this.i2(!1),this instanceof Ce&&e.vS(this),!this.layer.isTemporary&&!t&&e.invalidateDocumentBounds();const i=this.Ai,n=e.viewportBounds;n.isReal()?this.Al()?(i.intersectsRectPlus(n,10)||this.Us(!1),this.updateAdornments()):this.isVisible()&&i.intersectsRect(n)?(this.Us(!0),this.updateAdornments()):this.invalidateAdornments():e.vc=!0}Jr(){return!0}Ne(){return!0}Tl(){return!1}Ks(){return!0}hasPlaceholder(){return!1}get category(){return this.Wo}set category(t){const e=this.Wo;if(e===t)return;null!==this.svg&&(this.svg.remove(),this.os(!0)),d.i(t,"string",ke,"category");const i=this.diagram,n=this.data;let s=null;if(null!==i&&null!==n&&!(this instanceof Pe)){const t=i.model.undoManager;t.isEnabled&&!t.isUndoingRedoing&&(s=this.clone(),s.T.addAll(this.T))}if(this.Wo=t,this.t("category",e,t),null===i||null===n||this instanceof Pe){if(this instanceof Pe){const t=this.adornedPart;if(null!==t){const i=t.Jo;null!==i&&i.remove(e),t.addAdornment(this.category,this)}}}else{const o=i.model;if(o.undoManager.isUndoingRedoing)return;if(this.Tl()){i.partManager.setLinkCategoryForData(n,t);const s=i.partManager.findLinkTemplateForCategory(t);if(null!==s){s.hi();const i=s.copy();null!==i&&this.X2(i,e,t)}}else{null!==o&&o.setCategoryForNodeData(n,t);const s=i.partManager.findTemplateForNodeData(n,t);if(null!==s){s.hi();const i=s.copy();if(null!==i&&!(i instanceof De)){const n=this.location.copy();this.X2(i,e,t),this.location.isReal()||(this.location=n)}}}if(null!==s){const t=this.clone();t.T.addAll(this.T),this.t("self",s,t)}}}get self(){return this}set self(t){this.X2(t,this.category,t.category)}X2(t,e,i){t.constructor!==this.constructor&&(ke.XA||(ke.XA=!0,d.ri('Should not change the class of the Part when changing category from "'+e+'" to "'+i+'"'),d.ri("  Old class: "+d.nn(this.constructor)+", new class: "+d.nn(t.constructor)+", part: "+this.toString()))),this.clearAdornments();const n=this.data,s=this.layerName,o=this.isSelected,r=this.isHighlighted;let a=!0,l=!0,h=!1;this instanceof Ce&&(a=this.isTreeLeaf,l=this.isTreeExpanded,h=this.wasTreeExpanded),t.Xo(this),t.cloneProtected(this),this.Wo=i,null!==this.svg&&(this.svg.remove(),this.svg=null,this.os(!0)),this.c(),this.C();const u=this.diagram;let c=!0;null!==u&&(c=u.skipsUndoManager,u.skipsUndoManager=!0),this.Qt=n,this.P=o?4096|this.P:-4097&this.P,this.P=r?524288|this.P:-524289&this.P,this instanceof Ce&&(this.E=a?4|this.E:-5&this.E,this.E=l?1|this.E:-2&this.E,this.E=h?2|this.E:-3&this.E),null!==n&&this.updateTargetBindings();const f=this.layerName;f!==s&&(this.cl=s,this.layerName=f),null!==u&&(u.skipsUndoManager=c),this.Ne()&&this.invalidateLayout(64)}canCopy(){if(!this.copyable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowCopy)return!1;const e=t.diagram;return null===e||!!e.allowCopy}canDelete(){if(!this.deletable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowDelete)return!1;const e=t.diagram;return null===e||!!e.allowDelete}canEdit(){if(!this.textEditable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowTextEdit)return!1;const e=t.diagram;return null===e||!!e.allowTextEdit}canGroup(){if(!this.groupable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowGroup)return!1;const e=t.diagram;return null===e||!!e.allowGroup}canMove(){if(!this.movable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowMove)return!1;const e=t.diagram;return null===e||!!e.allowMove}canReshape(){if(!this.reshapable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowReshape)return!1;const e=t.diagram;return null===e||!!e.allowReshape}canResize(){if(!this.resizable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowResize)return!1;const e=t.diagram;return null===e||!!e.allowResize}canRotate(){if(!this.rotatable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRotate)return!1;const e=t.diagram;return null===e||!!e.allowRotate}canSelect(){if(!this.selectable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowSelect)return!1;const e=t.diagram;return null===e||!!e.allowSelect}get copyable(){return 0!==(1&this.P)}set copyable(t){const e=0!==(1&this.P);e!==t&&(this.P=1^this.P,this.t("copyable",e,t))}get deletable(){return 0!==(2&this.P)}set deletable(t){const e=0!==(2&this.P);e!==t&&(this.P=2^this.P,this.t("deletable",e,t))}get textEditable(){return 0!==(4&this.P)}set textEditable(t){const e=0!==(4&this.P);e!==t&&(this.P=4^this.P,this.t("textEditable",e,t),this.invalidateAdornments())}get groupable(){return 0!==(8&this.P)}set groupable(t){const e=0!==(8&this.P);e!==t&&(this.P=8^this.P,this.t("groupable",e,t))}get movable(){return 0!==(16&this.P)}set movable(t){const e=0!==(16&this.P);e!==t&&(this.P=16^this.P,this.t("movable",e,t))}get selectionAdorned(){return 0!==(32&this.P)}set selectionAdorned(t){const e=0!==(32&this.P);e!==t&&(this.P=32^this.P,this.t("selectionAdorned",e,t),this.invalidateAdornments())}get isInDocumentBounds(){return 0!==(64&this.P)}set isInDocumentBounds(t){const e=0!==(64&this.P);if(e!==t){this.P=64^this.P;const i=this.diagram;null!==i&&i.invalidateDocumentBounds(),this.t("isInDocumentBounds",e,t)}}get isLayoutPositioned(){return 0!==(128&this.P)}set isLayoutPositioned(t){const e=0!==(128&this.P);e!==t&&(this.P=128^this.P,this.t("isLayoutPositioned",e,t),this.invalidateLayout(t?4:8))}get selectable(){return 0!==(256&this.P)}set selectable(t){const e=0!==(256&this.P);e!==t&&(this.P=256^this.P,this.t("selectable",e,t),this.invalidateAdornments())}get reshapable(){return 0!==(512&this.P)}set reshapable(t){const e=0!==(512&this.P);e!==t&&(this.P=512^this.P,this.t("reshapable",e,t),this.invalidateAdornments())}get resizable(){return 0!==(1024&this.P)}set resizable(t){const e=0!==(1024&this.P);e!==t&&(this.P=1024^this.P,this.t("resizable",e,t),this.invalidateAdornments())}get rotatable(){return 0!==(2048&this.P)}set rotatable(t){const e=0!==(2048&this.P);e!==t&&(this.P=2048^this.P,this.t("rotatable",e,t),this.invalidateAdornments())}get isSelected(){return 0!==(4096&this.P)}set isSelected(t){const e=0!==(4096&this.P);if(e!==t){const i=this.diagram;if(t){if(!this.canSelect())return;if(null!==i){const t=i.maxSelectionCount;if(i.selection.count>=t)return}}this.P=4096^this.P;let n=!1;if(null!==i){n=i.skipsUndoManager,i.skipsUndoManager=!0;const e=i.selection;e.lt(),t?e.add(this):e.remove(this),e.g()}this.t("isSelected",e,t),this.invalidateAdornments();const s=this.selectionChanged;null!==s&&s(this),null!==i&&(i.requestUpdate(),i.skipsUndoManager=n)}}get isHighlighted(){return 0!==(524288&this.P)}set isHighlighted(t){const e=0!==(524288&this.P);if(e!==t){this.P=524288^this.P;const i=this.diagram;if(null!==i){const e=i.highlighteds;e.lt(),t?e.add(this):e.remove(this),e.g()}this.t("isHighlighted",e,t),this.C();const n=this.highlightedChanged;null!==n&&n(this)}}get isShadowed(){return 0!==(8192&this.P)}set isShadowed(t){const e=0!==(8192&this.P);e!==t&&(this.P=8192^this.P,this.os(!0),this.t("isShadowed",e,t),this.C())}OA(){return 0!==(16384&this.P)}IA(t){t?this.P|=16384:this.P&=-16385}eh(){return 0!==(32768&this.P)}z2(t){t?this.P|=32768:this.P&=-32769}Iv(){return 0!==(65536&this.P)}i2(t){t?this.P|=65536:this.P&=-65537}Al(){return 0!==(131072&this.P)}Us(t){t?this.P|=131072:this.P&=-131073}KA(){return 0!==(1048576&this.P)}o1(t){t?this.P|=1048576:this.P&=-1048577}get isAnimated(){return 0!==(262144&this.P)}set isAnimated(t){const e=0!==(262144&this.P);e!==t&&(this.P=262144^this.P,this.t("isAnimated",e,t))}get highlightedChanged(){return null!==this.F?this.F.Hp:null}set highlightedChanged(t){const e=this.highlightedChanged;e!==t&&(null!==t&&d.i(t,"function",ke,"highlightedChanged"),this.qi(),this.F.Hp=t,this.t("highlightedChanged",e,t))}get selectionObjectName(){return null!==this.F?this.F.jp:""}set selectionObjectName(t){const e=this.selectionObjectName;e!==t&&(this.qi(),this.F.jp=t,this.fl=null,this.t("selectionObjectName",e,t))}get selectionAdornmentTemplate(){return null!==this.F?this.F.qp:null}set selectionAdornmentTemplate(t){const e=this.selectionAdornmentTemplate;e!==t&&(this.qi(),this.F.qp=t,this.t("selectionAdornmentTemplate",e,t))}get selectionObject(){if(null===this.fl){const t=this.selectionObjectName;if(null!==t&&""!==t){const e=this.findObject(t);this.fl=null!==e?e:this}else if(this instanceof De){const t=this.path;this.fl=null!==t?t:this}else this.fl=this}return this.fl}get selectionChanged(){return null!==this.F?this.F.Wp:null}set selectionChanged(t){const e=this.selectionChanged;e!==t&&(null!==t&&d.i(t,"function",ke,"selectionChanged"),this.qi(),this.F.Wp=t,this.t("selectionChanged",e,t))}get resizeAdornmentTemplate(){return null!==this.F?this.F.Jp:null}set resizeAdornmentTemplate(t){const e=this.resizeAdornmentTemplate;e!==t&&(this.qi(),this.F.Jp=t,this.t("resizeAdornmentTemplate",e,t))}get resizeObjectName(){return null!==this.F?this.F.$p:""}set resizeObjectName(t){const e=this.resizeObjectName;e!==t&&(this.qi(),this.F.$p=t,this.t("resizeObjectName",e,t))}get resizeObject(){const t=this.resizeObjectName;if(""!==t){const e=this.findObject(t);if(null!==e)return e}return this}get resizeCellSize(){return null!==this.F?this.F.Zp:A.gw}set resizeCellSize(t){const e=this.resizeCellSize;e.equals(t)||(t=t.N(),this.qi(),this.F.Zp=t,this.t("resizeCellSize",e,t))}get rotateAdornmentTemplate(){return null!==this.F?this.F.Qp:null}set rotateAdornmentTemplate(t){const e=this.rotateAdornmentTemplate;e!==t&&(this.qi(),this.F.Qp=t,this.t("rotateAdornmentTemplate",e,t))}get rotateObjectName(){return null!==this.F?this.F._p:""}set rotateObjectName(t){const e=this.rotateObjectName;e!==t&&(this.qi(),this.F._p=t,this.t("rotateObjectName",e,t))}get rotateObject(){const t=this.rotateObjectName;if(""!==t){const e=this.findObject(t);if(null!==e)return e}return this}get rotationSpot(){return null!==this.F?this.F.ty:O.Default}set rotationSpot(t){const e=this.rotationSpot;e.equals(t)||(t=t.N(),this.qi(),this.F.ty=t,this.t("rotationSpot",e,t))}get text(){return this.ai}set text(t){const e=this.ai;e!==t&&(this.ai=t,this.t("text",e,t))}get containingGroup(){return this.yh}set containingGroup(t){if(this.Ne()){const e=this.yh;if(e!==t){null!==t&&(this===t||t.isMemberOf(this))&&(this===t&&d.o("Cannot make a Group a member of itself: "+this.toString()),d.o("Cannot make a Group indirectly contain itself: "+this.toString()+" already contains "+t.toString())),this.invalidateLayout(2);const i=this.diagram;if(null!==e?e.K2(this):this instanceof Ve&&null!==i&&i.Hr.remove(this),this.yh=t,null!==t?t.Y2(this):this instanceof Ve&&null!==i&&i.Hr.add(this),this.invalidateLayout(1),null!==i&&i.G){const e=this.data,n=i.model;if(null!==e&&n.Gc()){const i=null!==t?t.data:null;n.setGroupForData(e,n.getKeyForNodeData(i))}}const n=this.containingGroupChanged;if(null!==n){let s=!0;null!==i&&(s=i.G,i.G=!0),n(this,e,t),null!==i&&(i.G=s)}if(this instanceof Ve){const t=new k;ke.oh(t,this,!0,0,!0);const e=t.iterator;for(;e.next();){const t=e.value;if(t instanceof Ce){const e=t.linksConnected;for(;e.next();)e.value.Ad()}}}if(this instanceof Ce){const t=this.linksConnected;for(;t.next();)t.value.Ad();const e=this.labeledLink;null!==e&&e.Ad()}this.t("containingGroup",e,t),null!==t&&t.vv()}}else d.o("cannot set the Part.containingGroup of a Link or Adornment")}fh(){const t=this.containingGroup;null!==t&&(t.hasPlaceholder()&&t.placeholder.c(),t.c(),t.invalidateConnectedLinks())}C(){const t=this.diagram;null!==t&&!this.ss()&&!this.eh()&&this.isVisible()&&this.Ai.isReal()&&t.C(this.qh(this.Ai))}c(){if(this.Eo())return;super.c();const t=this.diagram;null!==t&&(t.r0(this),this instanceof Ce&&null!==this.labeledLink&&this.labeledLink._c(),t.requestUpdate(!0))}_c(t){if(this.ss())return;const e=this.diagram;null!==e&&(e.r0(this),this instanceof Ce&&this.invalidateConnectedLinks(),e.requestUpdate()),this.to(!0)}Um(t){if(!t){const t=this.yh;null!==t&&t.Y2(this)}}Bm(t){if(!t){const t=this.yh;null!==t&&t.K2(this)}}Bc(){const t=this.data;if(null!==t){const e=this.diagram;if(null!==e){const i=e.model;null!==i&&i.removeNodeData(t)}}}get containingGroupChanged(){return null!==this.F?this.F.iy:null}set containingGroupChanged(t){const e=this.containingGroupChanged;e!==t&&(null!==t&&d.i(t,"function",ke,"containingGroupChanged"),this.qi(),this.F.iy=t,this.t("containingGroupChanged",e,t))}findSubGraphLevel(){return this.G2(this)}G2(t){const e=t.containingGroup;if(null!==e)return 1+this.G2(e);if(t instanceof Ce){const e=t.labeledLink;if(null!==e)return this.G2(e)}return 0}findTopLevelPart(){return this.H2(this)}H2(t){const e=t.containingGroup;if(null!==e)return this.H2(e);if(t instanceof Ce){const e=t.labeledLink;if(null!==e)return this.H2(e)}return t}get isTopLevel(){return!(null!==this.containingGroup||this instanceof Ce&&null!==this.labeledLink)}isMemberOf(t){return t instanceof Ve&&this.j2(this,t)}j2(t,e){if(t===e||null===e)return!1;const i=t.containingGroup;if(null!==i&&(i===e||this.j2(i,e)))return!0;if(t instanceof Ce){const i=t.labeledLink;if(null!==i)return this.j2(i,e)}return!1}findCommonContainingGroup(t){if(null===t)return null;if(this===t)return this.containingGroup;let e=this;for(;null!==e;){if(e instanceof Ve&&e.o1(!0),e instanceof Ce){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}let i=null;for(e=t;null!==e;){if(e.KA()){i=e;break}if(e instanceof Ce){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}for(e=this;null!==e;){if(e instanceof Ve&&e.o1(!1),e instanceof Ce){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}return i}get layoutConditions(){return null!==this.F?this.F.ey:127}set layoutConditions(t){const e=this.layoutConditions;e!==t&&(this.qi(),this.F.ey=t,this.t("layoutConditions",e,t))}canLayout(){if(!this.isLayoutPositioned||!this.isVisible())return!1;const t=this.layer;return!(null!==t&&t.isTemporary||this instanceof Ce&&this.isLinkLabel)}Vv(t){if(!this.isLayoutPositioned||!(t&this.layoutConditions))return!1;const e=this.layer;if(null!==e&&e.isTemporary||this instanceof Ce&&this.isLinkLabel)return!1;const i=this.diagram;return!(null!==i&&i.undoManager.isUndoingRedoing)}invalidateLayout(t){if(void 0===t&&(t=16777215),!this.Vv(t))return;const e=this.yh;if(null!==e){const i=e.layout;null!==i?i.invalidateLayout():e.invalidateLayout(t)}else{const t=this.diagram;if(null!==t){const e=t.layout;null!==e&&e.invalidateLayout()}}}kL(){if(!this.isVisible())return!1;const t=this.layer;return!(null!==t&&t.isTemporary)}static oh(t,e,i,n,s,o){if(void 0===o&&(o=null),!t.contains(e)&&(null===o||o(e))&&!(e instanceof Pe))if(t.add(e),e instanceof Ce){if(i&&e instanceof Ve){const r=e.memberParts;for(;r.next();){const e=r.value;ke.oh(t,e,i,n,s,o)}}if(!1!==s){const r=e.linksConnected;for(;r.next();){const e=r.value;if(t.contains(e))continue;const a=e.fromNode,l=e.toNode,h=null===a||t.contains(a),u=null===l||t.contains(l);(s?h&&u:h||u)&&ke.oh(t,e,i,n,s,o)}}if(n>1){const r=e.findTreeChildrenNodes();for(;r.next();){const e=r.value;ke.oh(t,e,i,n-1,s,o)}}}else if(e instanceof De){const r=e.labelNodes;for(;r.next();){const e=r.value;ke.oh(t,e,i,n,s,o)}}}get dragComputation(){return null!==this.F?this.F.sy:null}set dragComputation(t){const e=this.dragComputation;e!==t&&(null!==t&&d.i(t,"function",ke,"dragComputation"),this.qi(),this.F.sy=t,this.t("dragComputation",e,t))}get shadowOffset(){return null!==this.F?this.F.ny:T.JN}set shadowOffset(t){const e=this.shadowOffset;e.equals(t)||(t=t.N(),this.qi(),this.F.ny=t,this.C(),this.t("shadowOffset",e,t))}get shadowColor(){return null!==this.F?this.F.oy:"gray"}set shadowColor(t){const e=this.shadowColor;e!==t&&(this.qi(),this.F.oy=t,this.C(),this.t("shadowColor",e,t))}get shadowBlur(){return null!==this.F?this.F.kn:4}set shadowBlur(t){const e=this.shadowBlur;e!==t&&(this.qi(),this.F.kn=t,this.C(),this.t("shadowBlur",e,t))}}y(ke,"LayoutNone",0),y(ke,"LayoutAdded",1),y(ke,"LayoutRemoved",2),y(ke,"LayoutShown",4),y(ke,"LayoutHidden",8),y(ke,"LayoutNodeSized",16),y(ke,"LayoutGroupLayout",32),y(ke,"LayoutNodeReplaced",64),y(ke,"LayoutStandard",127),y(ke,"LayoutAll",16777215),y(ke,"XA",!1);class Se{constructor(){y(this,"mi",void 0),y(this,"zp",void 0),y(this,"iy",void 0),y(this,"qp",void 0),y(this,"jp",void 0),y(this,"Wp",void 0),y(this,"Hp",void 0),y(this,"Jp",void 0),y(this,"$p",void 0),y(this,"Zp",void 0),y(this,"Qp",void 0),y(this,"_p",void 0),y(this,"ty",void 0),y(this,"Yp",void 0),y(this,"Gp",void 0),y(this,"Xp",void 0),y(this,"Kp",void 0),y(this,"sy",void 0),y(this,"ey",void 0),y(this,"ny",void 0),y(this,"oy",void 0),y(this,"kn",void 0),this.mi=!1,this.zp=null,this.iy=null,this.qp=null,this.jp="",this.Wp=null,this.Hp=null,this.Jp=null,this.$p="",this.Zp=A.gw,this.Qp=null,this._p="",this.ty=O.Default,this.Yp="",this.Gp=O.TopLeft,this.Xp=T.qN,this.Kp=T.WN,this.sy=null,this.ey=127,this.ny=T.JN,this.oy="gray",this.kn=4}copy(){const t=new Se;return t.zp=this.zp,t.iy=this.iy,t.qp=this.qp,t.jp=this.jp,t.Wp=this.Wp,t.Hp=this.Hp,t.Jp=this.Jp,t.$p=this.$p,t.Zp=this.Zp.N(),t.Qp=this.Qp,t._p=this._p,t.ty=this.ty.N(),t.Yp=this.Yp,t.Gp=this.Gp.N(),t.Xp=this.Xp.N(),t.Kp=this.Kp.N(),t.sy=this.sy,t.ey=this.ey,t.ny=this.ny.N(),t.oy=this.oy,t.kn=this.kn,t}}class Pe extends ke{constructor(t,e){void 0===t||t instanceof te||"number"==typeof t||"string"==typeof t?(super(t),y(this,"gs",void 0),y(this,"It",void 0),y(this,"JP",void 0),y(this,"$P",void 0),y(this,"rf",void 0)):(super(),y(this,"gs",void 0),y(this,"It",void 0),y(this,"JP",void 0),y(this,"$P",void 0),y(this,"rf",void 0),t&&(e=t)),this.P&=-257,this.cl="Adornment",this.gs=null,this.JP=0,this.$P=!1,this.It=null,this.rf=null,e&&Object.assign(this,e)}toString(){const t=this.adornedPart;return"Adornment("+this.category+")"+(null!==t?t.toString():"")}updateRelationshipsFromData(){}ad(t){const e=this.adornedObject,i=null===e||void 0===e?void 0:e.part;if(!(i instanceof De)||!(e instanceof le))return;const n=i.path;let s=n.geometry;i.ad(t),s=n.geometry;const o=this.T.r,r=o.length;for(let a=0;a<r;a++){const t=o[a];t.isPanelMain&&t instanceof le&&(t.ft=s)}}hasPlaceholder(){return null!==this.It&&this.It.isVisibleObject()}get placeholder(){return this.It}get adornedObject(){return this.gs}set adornedObject(t){const e=this.adornedPart;let i=null;null!==t&&(i=t.part),null!==e&&(null===t||e!==i)&&e.removeAdornment(this.category),this.gs=t,null!==i&&i.addAdornment(this.category,this)}get adornedPart(){const t=this.gs;return null!==t?t.part:null}Jr(){const t=this.gs;if(null===t)return!0;const e=t.part;return null===e||!e.ss()}Ne(){return!1}get containingGroup(){return null}qc(t,e,i,n,s,o,r){if(3===t&&"elements"===e){if(s instanceof ze)null===this.It&&(this.It=s);else if(s instanceof ie){const t=s.findInVisualTree((t=>t instanceof ze));t instanceof ze&&null===this.It&&(this.It=t)}}else 4===t&&"elements"===e&&null!==this.It&&(n===this.It||n instanceof ie&&this.It.isContainedBy(n))&&(this.It=null);super.qc(t,e,i,n,s,o,r)}updateAdornments(){}Bc(){}}var Me=(t=>(t[t.None=0]="None",t[t.Evenly=1]="Evenly",t[t.Packed=2]="Packed",t))(Me||{});class Ce extends ke{constructor(t,e){void 0===t||t instanceof te||"number"==typeof t||"string"==typeof t?(super(t),y(this,"E",void 0),y(this,"gt",void 0),y(this,"xf",void 0),y(this,"ul",void 0),y(this,"wh",void 0),y(this,"le",void 0),y(this,"_t",void 0)):(super(),y(this,"E",void 0),y(this,"gt",void 0),y(this,"xf",void 0),y(this,"ul",void 0),y(this,"wh",void 0),y(this,"le",void 0),y(this,"_t",void 0),t&&(e=t)),this.E=13,this.gt=null,this._t=new x,this.xf=null,this.ul=null,this.le=null,this.wh=!1,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.E=this.E,null!==this.gt&&(this.gt.mi?t.gt=this.gt:t.gt=this.gt.copy())}Xo(t){super.Xo(t),t.invalidateConnectedLinks(),t.ul=this.ul,t.le=null}dl(){null===this.gt?this.gt=new Ne:this.gt.mi&&(this.gt=this.gt.copy())}hh(){super.hh(),null!==this.gt&&(this.gt.mi=!0)}YA(t){null!==t&&(null===this.ul&&(this.ul=new k),this.ul.add(t))}GA(t){null!==t&&null!==this.ul&&this.ul.remove(t)}HA(t,e,i){if(null===t||null===this.ul)return null;const n=this.ul.iterator;for(;n.next();){const s=n.value;if(s.ry===this&&s.l1===t&&s.q2===e&&s.W2===i||s.ry===t&&s.l1===this&&s.q2===i&&s.W2===e)return s}return null}invalidateLinkBundle(t,e,i){null==e&&(e=""),null==i&&(i="");const n=this.HA(t,e,i);null!==n&&n.Td()}qc(t,e,i,n,s,o,r){(3===t&&"elements"===e||4===t&&"elements"===e)&&(this.le=null),super.qc(t,e,i,n,s,o,r)}invalidateConnectedLinks(t){const e=this.linksConnected;for(;e.next();){const i=e.value;void 0!==t&&t.contains(i)||(this.ye(i.fromPort),this.ye(i.toPort),i.invalidateRoute())}}$L(t){const e=this.linksConnected;for(;e.next();){const i=e.value;i.fromPort!==t&&i.toPort!==t||(this.ye(i.fromPort),this.ye(i.toPort),i.invalidateRoute())}}ye(t){if(null===t)return;const e=t.$u;null!==e&&e.Td();const i=t.part,n=i.containingGroup;null!==n&&!i.isVisible()&&n.ye(n.port)}Jr(){return!0}get portSpreading(){return null!==this.gt?this.gt.ly:1}set portSpreading(t){const e=this.portSpreading;if(e!==t){this.dl(),this.gt.ly=t,this.t("portSpreading",e,t);const i=this.diagram;if(null!==i&&i.undoManager.isUndoingRedoing)return;this.invalidateConnectedLinks()}}get avoidable(){return 0!==(8&this.E)}set avoidable(t){const e=0!==(8&this.E);if(e!==t){this.E=8^this.E;const i=this.diagram;null!==i&&i.vS(this),this.t("avoidable",e,t)}}get avoidableMargin(){return null!==this.gt?this.gt.hy:F.eC}set avoidableMargin(t){"number"==typeof t&&(t=new F(t));const e=this.avoidableMargin;if(!e.equals(t)){t=t.N(),this.dl(),this.gt.hy=t;const i=this.diagram;null!==i&&i.vS(this),this.t("avoidableMargin",e,t)}}canAvoid(){return this.avoidable&&!this.isLinkLabel}getAvoidableRect(t){return t.set(this.actualBounds),t.addMargin(this.avoidableMargin),t}findVisibleNode(){let t=this;for(;null!==t&&!t.isVisible();)t=t.containingGroup;return t}isVisible(){if(!super.isVisible())return!1;let t=!0,e=1;const i=this.diagram;if(null!==i){if(i.animationManager.nx(this))return!0;t=i.isTreePathToChildren,e=i.treeCollapsePolicy}if(1===e){const t=this.findTreeParentNode();if(null!==t&&!t.isTreeExpanded)return!1}else if(2===e){const e=t?this.findLinksInto():this.findLinksOutOf();let i=!1,n=!1;for(;e.next();){const s=e.value;if(s.isTreeLink){i=!0;const e=t?s.fromNode:s.toNode;if(e&&e.isTreeExpanded){n=!0;break}}}if(i&&!n)return!1}else if(3===e){const e=t?this.findLinksInto():this.findLinksOutOf();let i=!1,n=!1;for(;e.next();){const s=e.value;if(s.isTreeLink){i=!0;const e=t?s.fromNode:s.toNode;if(e&&!e.isTreeExpanded){n=!0;break}}}if(i&&n)return!1}const n=this.labeledLink;return null===n||n.isVisible()}Ei(t){super.Ei(t);const e=this.linksConnected;for(;e.next();){const i=e.value;if(t&&null!==this.containingGroup){const t=i.getOtherNode(this);null!==t&&!t.isMemberOf(this.containingGroup)&&i.invalidateRoute()}i.Ei(t)}}get linksConnected(){return this._t.iterator}findExternalTreeLinksConnected(){const t=new k,e=new k;return this.jA(this,t,e),e.iterator}jA(t,e,i){if(null===t||e.has(t))return;e.add(t);let n=!0;const s=this.diagram;null!==s&&(n=s.isTreePathToChildren),t.linksConnected.each((s=>{s.isTreeLink?(n?s.fromNode===t:s.toNode===t)&&this.jA(n?s.toNode:s.fromNode,e,i):i.add(s)}))}findLinksConnected(t){if(void 0===t&&(t=null),null===t)return this._t.iterator;const e=new v(this._t),i=this;return e.predicate=e=>e.fromNode===i&&e.fromPortId===t||e.toNode===i&&e.toPortId===t,e}findLinksOutOf(t){void 0===t&&(t=null);const e=new v(this._t),i=this;return e.predicate=e=>e.fromNode===i&&(null===t||e.fromPortId===t),e}findLinksInto(t){void 0===t&&(t=null);const e=new v(this._t),i=this;return e.predicate=e=>e.toNode===i&&(null===t||e.toPortId===t),e}findNodesConnected(t){void 0===t&&(t=null);let e=null,i=null;const n=this._t.iterator;for(;n.next();){const s=n.value;if(s.fromNode===this){if(null===t||s.fromPortId===t){const t=s.toNode;null!==e?e.add(t):null!==i&&i!==t?(e=new k,e.add(i),e.add(t)):i=t}}else if(s.toNode===this&&(null===t||s.toPortId===t)){const t=s.fromNode;null!==e?e.add(t):null!==i&&i!==t?(e=new k,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new p(i):m.instance}findNodesOutOf(t){void 0===t&&(t=null);let e=null,i=null;const n=this._t.iterator;for(;n.next();){const s=n.value;if(s.fromNode===this&&(null===t||s.fromPortId===t)){const t=s.toNode;null!==e?e.add(t):null!==i&&i!==t?(e=new k,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new p(i):m.instance}findNodesInto(t){void 0===t&&(t=null);let e=null,i=null;const n=this._t.iterator;for(;n.next();){const s=n.value;if(s.toNode===this&&(null===t||s.toPortId===t)){const t=s.fromNode;null!==e?e.add(t):null!==i&&i!==t?(e=new k,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new p(i):m.instance}findLinksBetween(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);const n=new v(this._t),s=this;return n.predicate=n=>n.fromNode===s&&n.toNode===t&&(null===e||n.fromPortId===e)&&(null===i||n.toPortId===i)||n.fromNode===t&&n.toNode===s&&(null===i||n.fromPortId===i)&&(null===e||n.toPortId===e),n}findLinksTo(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);const n=new v(this._t),s=this;return n.predicate=n=>!(n.fromNode!==s||n.toNode!==t||null!==e&&n.fromPortId!==e||null!==i&&n.toPortId!==i),n}get linkConnected(){return null!==this.gt?this.gt.ay:null}set linkConnected(t){const e=this.linkConnected;e!==t&&(null!==t&&d.i(t,"function",Ce,"linkConnected"),this.dl(),this.gt.ay=t,this.t("linkConnected",e,t))}get linkDisconnected(){return null!==this.gt?this.gt.cy:null}set linkDisconnected(t){const e=this.linkDisconnected;e!==t&&(null!==t&&d.i(t,"function",Ce,"linkDisconnected"),this.dl(),this.gt.cy=t,this.t("linkDisconnected",e,t))}get linkValidation(){return null!==this.gt?this.gt.Ll:null}set linkValidation(t){const e=this.linkValidation;e!==t&&(null!==t&&d.i(t,"function",Ce,"linkValidation"),this.dl(),this.gt.Ll=t,this.t("linkValidation",e,t))}h1(t,e){this.ye(e);const i=this._t.contains(t);if(i||this._t.add(t),!i||t.fromNode===t.toNode){const i=this.linkConnected;if(null!==i){let n=!0;const s=this.diagram;null!==s&&(n=s.G,s.G=!0),i(this,t,e),null!==s&&(s.G=n)}}if(!i){if(!t.isTreeLink)return;const e=t.fromNode,i=t.toNode;if(null!==e&&null!==i&&e!==i){let t=!0;const n=this.diagram;null!==n&&(t=n.isTreePathToChildren);const s=t?i:e,o=t?e:i;if(s.wh||(s.wh=o),o.isTreeLeaf){if(null!==n&&n.undoManager.isUndoingRedoing)return;t?e===o&&(o.isTreeLeaf=!1):i===o&&(o.isTreeLeaf=!1)}}}}a1(t,e){this.ye(e);const i=this._t.remove(t);let n=null;if(i||t.toNode===t.fromNode){const i=this.linkDisconnected;if(n=this.diagram,null!==i){let s=!0;null!==n&&(s=n.G,n.G=!0),i(this,t,e),null!==n&&(n.G=s)}}if(i){if(!t.isTreeLink)return;let e=!0;null!==n&&(e=n.isTreePathToChildren);const i=e?t.toNode:t.fromNode,s=e?t.fromNode:t.toNode;if(null!==i&&(i.wh=!1),null!==s&&!s.isTreeLeaf)if(0===s._t.count){if(s.wh=null,null!==n&&n.undoManager.isUndoingRedoing)return;s.isTreeLeaf=!0}else s.u0()}}u0(){if(this.wh=!1,0===this._t.count)return;let t=!0;const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;null!==e&&(t=e.isTreePathToChildren);const i=this._t.iterator;for(;i.next();){const e=i.value;if(e.isTreeLink)if(t){if(e.fromNode===this)return void(this.isTreeLeaf=!1)}else if(e.toNode===this)return void(this.isTreeLeaf=!1)}this.isTreeLeaf=!0}updateRelationshipsFromData(){const t=this.diagram;null!==t&&t.partManager.updateRelationshipsFromData(this)}Um(t){if(super.Um(t),!t){this.u0();const t=this.xf;null!==t&&t.qA(this)}}Bm(t){if(super.Bm(t),!t){const t=this.xf;null!==t&&t.WA(this)}}Bc(){if(this._t.count>0){const t=this.diagram;if(null!==t){const e=null===t.commandHandler||t.commandHandler.deletesConnectedLinks,i=this._t.copy().iterator;for(;i.next();){const n=i.value;e?t.remove(n):(n.fromNode===this&&(n.fromNode=null),n.toNode===this&&(n.toNode=null))}}}this.labeledLink=null,super.Bc()}get isLinkLabel(){return null!==this.xf}get labeledLink(){return this.xf}set labeledLink(t){const e=this.xf;if(e!==t){const i=this.diagram,n=this.data;if(null!==e){if(e.WA(this),null!==i&&null!==n&&!i.undoManager.isUndoingRedoing){const t=e.data,s=i.model;if(null!==t&&s.Ta()){const e=s.getKeyForNodeData(n);void 0!==e&&s.removeLabelKeyForLinkData(t,e)}}this.containingGroup=null}if(this.xf=t,null!==t){if(t.qA(this),null!==i&&null!==n&&!i.undoManager.isUndoingRedoing){const e=t.data,s=i.model;if(null!==e&&s.Ta()){const t=s.getKeyForNodeData(n);void 0!==t&&s.addLabelKeyForLinkData(e,t)}}this.containingGroup=t.containingGroup}this._c(),this.t("labeledLink",e,t)}}findVisiblePort(t){let e=t;for(;null!==e&&(!e.actualBounds.isReal()||!e.isVisibleObject());)e=e.panel;return null===e?this.port:e}findPort(t){if(null===this.le){if(""===t&&!1===this.bn)return this;this.JA()}let e=this.le.getValue(t);return null!==e||""!==t&&(e=this.le.getValue(""),null!==e)?e:this}get port(){return this.findPort("")}get ports(){return null===this.le&&this.JA(),this.le.iteratorValues}JA(){null===this.le?this.le=new L:this.le.clear(),this.walkVisualTreeFrom(this,((t,e)=>t.nA(e))),0===this.le.count&&this.le.add("",this)}nA(t){const e=t.portId;null!==e&&null!==this.le&&this.le.add(e,t)}f2(t,e){const i=t.portId;if(null!==i){null!==this.le&&this.le.remove(i);const t=this.diagram;if(null!==t&&e){let e=null;const n=this.findLinksConnected(i);for(;n.next();){const t=n.value;null===e&&(e=d.rt()),e.push(t)}if(null!==e){for(let i=0;i<e.length;i++){const n=e[i];t.remove(n)}d.it(e)}}}}isInTreeOf(t){if(null===t||t===this)return!1;let e=!0;const i=this.diagram;null!==i&&(e=i.isTreePathToChildren);let n=this;const s=t;let o;if(e)for(;n!==s;){o=null;const t=n._t.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(o=e.fromNode,o!==n&&o!==this))break}if(o===this||null===o||o===n)return!1;n=o}else for(;n!==s;){o=null;const t=n._t.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(o=e.toNode,o!==n&&o!==this))break}if(o===this||null===o||o===n)return!1;n=o}return!0}findTreeRoot(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);let i,n=this;if(t)for(;;){i=null;const t=n._t.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(i=e.fromNode,i!==n&&i!==this))break}if(i===this)return this;if(null===i||i===n)return n;n=i}else for(;;){i=null;const t=n._t.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(i=e.toNode,i!==n&&i!==this))break}if(i===this)return this;if(null===i||i===n)return n;n=i}}findCommonTreeParent(t){if(null===t)return null;if(this===t)return this;let e=this;for(;null!==e;)e.o1(!0),e=e.findTreeParentNode();let i=null;for(e=t;null!==e;){if(e.KA()){i=e;break}e=e.findTreeParentNode()}for(e=this;null!==e;)e.o1(!1),e=e.findTreeParentNode();return i}findTreeParentLink(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);const i=this._t.iterator;if(t)for(;i.next();){const t=i.value;if(t.isTreeLink&&t.fromNode!==this)return t}else for(;i.next();){const t=i.value;if(t.isTreeLink&&t.toNode!==this)return t}return null}findTreeParentNode(){const t=this.wh;if(null===t)return null;if(t instanceof Ce)return t;const e=this.diagram,i=null===e||e.isTreePathToChildren,n=this._t.iterator;for(;n.next();){const t=n.value;if(!t.isTreeLink)continue;const e=i?t.fromNode:t.toNode;if(e!==this)return this.wh=e,e}return this.wh=null,null}findTreeParentChain(){const t=new k;return function t(e,i){i.add(e);const n=e.findTreeParentLink();if(null!==n){i.add(n);const s=e.findTreeParentNode();if(null===s)return;t(s,i)}}(this,t),t}findTreeLevel(){return this.Uv(this)}Uv(t){let e=0,i=t.findTreeParentNode();for(;null!==i&&i!==t;)i=i.findTreeParentNode(),e++;return e}findTreeChildrenLinks(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);const i=new v(this._t),n=this;return i.predicate=t?t=>!(!t.isTreeLink||t.fromNode!==n):t=>!(!t.isTreeLink||t.toNode!==n),i}findTreeChildrenNodes(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);let i=null,n=null;const s=this._t.iterator;if(t)for(;s.next();){const t=s.value;if(t.isTreeLink&&t.fromNode===this){const e=t.toNode;null!==i?i.add(e):null!==n&&n!==e?(i=new x,i.add(n),i.add(e)):n=e}}else for(;s.next();){const t=s.value;if(t.isTreeLink&&t.toNode===this){const e=t.fromNode;null!==i?i.add(e):null!==n&&n!==e?(i=new x,i.add(n),i.add(e)):n=e}}return null!==i?i.iterator:null!==n?new p(n):m.instance}findTreeParts(t){void 0===t&&(t=1/0),d.i(t,"number",Ce,"findTreeParts:level");const e=new k;return ke.oh(e,this,!1,t,!0),e}collapseTree(t){void 0===t&&(t=1),t<1&&(t=1);const e=this.diagram;if(null===e||e.isCollapsingExpanding)return;e.isCollapsingExpanding=!0;const i=new k;i.add(this),this.$A(i,e.isTreePathToChildren,t,e,this,1===e.treeCollapsePolicy),e.isCollapsingExpanding=!1}$A(t,e,i,n,s,o){if(i>1){const r=e?this.findLinksOutOf():this.findLinksInto();for(;r.next();){const a=r.value;if(!a.isTreeLink)continue;const l=a.getOtherNode(this);null!==l&&l!==this&&!t.contains(l)&&(t.add(l),l.$A(t,e,i-1,n,s,o))}}else this.ZA(t,e,n,s,o)}ZA(t,e,i,n,s){const o=n===this||this.isTreeExpanded,r=e?this.findLinksOutOf():this.findLinksInto();for(;r.next();){const a=r.value;if(!a.isTreeLink)continue;const l=a.getOtherNode(this);if(null!==l&&l!==this){const r=t.contains(l);if(r||t.add(l),o){const t=e?l.findNodesInto():l.findNodesOutOf(),s=this;t.all((t=>t===s||!t.isTreeExpanded))&&i.Sc(l,n),l.fh(),l.Ei(!1)}l.isTreeExpanded&&(l.wasTreeExpanded=l.isTreeExpanded,r||l.ZA(t,e,i,n,s))}}this.isTreeExpanded=!1}expandTree(t){void 0===t&&(t=2),t<2&&(t=2);const e=this.diagram;if(null===e||e.isCollapsingExpanding)return;e.isCollapsingExpanding=!0;const i=new k;i.add(this),this.QA(i,e.isTreePathToChildren,t,e,this,1===e.treeCollapsePolicy),e.isCollapsingExpanding=!1}QA(t,e,i,n,s,o){const r=s!==this&&this.isTreeExpanded,a=e?this.findLinksOutOf():this.findLinksInto();for(;a.next();){const l=a.value;if(!l.isTreeLink)continue;r||l.Le||l.invalidateRoute();const h=l.getOtherNode(this);if(null!==h&&h!==this&&!t.contains(h)){if(t.add(h),!r){h.Ei(!0),h.fh();const t=e?h.findNodesInto():h.findNodesOutOf(),i=this;t.all((t=>t===i||!t.isTreeExpanded))&&n.Mc(h,s)}(i>2||h.wasTreeExpanded)&&(h.wasTreeExpanded=!1,h.QA(t,e,i-1,n,s,o))}}this.isTreeExpanded=!0}get isTreeExpanded(){return 0!==(1&this.E)}set isTreeExpanded(t){const e=0!==(1&this.E);if(e!==t){this.E=1^this.E;const i=this.diagram;this.t("isTreeExpanded",e,t);const n=this.treeExpandedChanged;if(null!==n){let t=!0;null!==i&&(t=i.G,i.G=!0),n(this),null!==i&&(i.G=t)}if(null!==i&&i.undoManager.isUndoingRedoing)return void this.Ei(t);t?this.expandTree():this.collapseTree()}}get wasTreeExpanded(){return 0!==(2&this.E)}set wasTreeExpanded(t){const e=0!==(2&this.E);e!==t&&(this.E=2^this.E,this.t("wasTreeExpanded",e,t))}get treeExpandedChanged(){return null!==this.gt?this.gt.fy:null}set treeExpandedChanged(t){const e=this.treeExpandedChanged;e!==t&&(null!==t&&d.i(t,"function",Ce,"treeExpandedChanged"),this.dl(),this.gt.fy=t,this.t("treeExpandedChanged",e,t))}get isTreeLeaf(){return 0!==(4&this.E)}set isTreeLeaf(t){const e=0!==(4&this.E);e!==t&&(this.E=4^this.E,this.t("isTreeLeaf",e,t))}get isTreeRoot(){return null===this.findTreeParentLink()}}y(Ce,"SpreadingNone",0),y(Ce,"SpreadingEvenly",1),y(Ce,"SpreadingPacked",2);class Ne{constructor(){y(this,"mi",void 0),y(this,"ay",void 0),y(this,"cy",void 0),y(this,"Ll",void 0),y(this,"fy",void 0),y(this,"hy",void 0),y(this,"ly",void 0),y(this,"uy",void 0),y(this,"gy",void 0),y(this,"nh",void 0),y(this,"my",void 0),this.mi=!1,this.ay=null,this.cy=null,this.Ll=null,this.fy=null,this.hy=F.eC,this.ly=1,this.uy=null,this.gy=null,this.nh=null,this.my=null}copy(){const t=new Ne;return t.ay=this.ay,t.cy=this.cy,t.Ll=this.Ll,t.fy=this.fy,t.hy=this.hy.N(),t.ly=this.ly,t.uy=this.uy,t.gy=this.gy,t.nh=this.nh,t.my=this.my,t}}var Le=(t=>(t[t.None=0]="None",t[t.End=17]="End",t[t.Scale=18]="Scale",t[t.Stretch=19]="Stretch",t))(Le||{}),Te=(t=>(t[t.Normal=1]="Normal",t[t.Orthogonal=2]="Orthogonal",t[t.AvoidsNodes=6]="AvoidsNodes",t[t.AvoidsNodesStraight=7]="AvoidsNodesStraight",t))(Te||{}),Ae=(t=>(t[t.None=0]="None",t[t.Bezier=9]="Bezier",t[t.JumpGap=10]="JumpGap",t[t.JumpOver=11]="JumpOver",t))(Ae||{});class De extends ke{constructor(t){super(ie.Link),y(this,"Nt",void 0),y(this,"ho",void 0),y(this,"ao",void 0),y(this,"Dd",void 0),y(this,"co",void 0),y(this,"fo",void 0),y(this,"Fd",void 0),y(this,"bf",void 0),y(this,"Rd",void 0),y(this,"vd",void 0),y(this,"Od",void 0),y(this,"Da",void 0),y(this,"Id",void 0),y(this,"qs",void 0),y(this,"Pi",void 0),y(this,"gl",void 0),y(this,"Nr",void 0),y(this,"kf",void 0),y(this,"Qo",void 0),y(this,"J2",void 0),y(this,"$2",void 0),y(this,"c1",void 0),y(this,"Z2",void 0),y(this,"Q2",void 0),y(this,"py",void 0),y(this,"f1",void 0),y(this,"ft",void 0),y(this,"_o",void 0),y(this,"rf",void 0),y(this,"_2",void 0),y(this,"tN",void 0),this.Nt=8,this.ho=null,this.ao="",this.Dd=null,this.co=null,this.fo="",this.Fd=null,this.bf=0,this.Rd=0,this.vd=0,this.Od=NaN,this.Da=1,this.Id=.5,this.qs=null,this.Pi=(new x).g(),this.gl=null,this.Nr=null,this.kf=new D,this.ft=new z,this.Qo=null,this._o=null,this.J2=null,this.$2=null,this._2=0,this.tN=0,this.c1=new T,this.Z2=null,this.Q2=null,this.py=null,this.f1=NaN,this.W=null,this.rf=[],t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Nt=-113&this.Nt,t.ao=this.ao,t.Dd=this.Dd,t.fo=this.fo,t.Fd=this.Fd,t.bf=this.bf,t.Rd=this.Rd,t.vd=this.vd,t.Od=this.Od,t.Da=this.Da,t.Id=this.Id,null!==this.W&&(t.W=this.W.copy())}Xo(t){super.Xo(t),this.ao=t.ao,this.fo=t.fo,t.gl=null,t.invalidateRoute(),t._o=this._o;const e=t.fromPort;null!==e&&t.fromNode.ye(e);const i=t.toPort;null!==i&&t.toNode.ye(i)}li(t){t in Te||t in Ae||t in Le?De.iN(t)?this.routing=t:9===t||10===t||11===t?this.curve=t:17===t||18===t||19===t?this.adjusting=t:1===t||0===t||d.o("Unknown Link enum value for a Link property: "+t):super.li(t)}Ye(){null===this.W&&(this.W=new Be)}ZR(t,e,i){const n=t.segmentIndex,s=t.segmentFraction;let o=t.alignmentFocus;const r=t.segmentOrientation,a=t.segmentOffset;let l=0,h=0,u=0,c=0;if(isNaN(n)){const e=this.ft,i=d.rt();e.getPointAndAngleAlongPath(s,i);const n=T.X(i[0],i[1]);if(n.add(this.getPoint(0)),1===e.type)n.offset(-e.startX,-e.startY);else{const t=e.figures.first();n.offset(-t.startX,-t.startY)}c=i[2],0!==r&&(u=this.computeAngle(t,r,c),t.angle=u),l=n.x,h=n.y,T.s(n),d.it(i)}else if(n<-e||n>=e){const e=T.l();this.cA(e),c=this.midAngle,0!==r&&(u=this.computeAngle(t,r,c),t.angle=u),l=e.x,h=e.y,T.s(e)}else{let o,a,d=0;if(n>=0?(o=i.r[n],a=n<e-1?i.r[n+1]:o):(d=e+n,o=i.r[d],a=d>0?i.r[d-1]:o),o.equalsApprox(a)){let t,s;n>=0?(t=n>0?i.r[n-1]:o,s=n<e-2?i.r[n+2]:a):(t=d<e-1?i.r[d+1]:o,s=d>1?i.r[d-2]:a);const r=t.distanceSquaredPoint(o),l=a.distanceSquaredPoint(s);c=r>l+10?n>=0?t.directionPoint(o):o.directionPoint(t):l>r+10?n>=0?a.directionPoint(s):s.directionPoint(a):n>=0?t.directionPoint(s):s.directionPoint(t)}else c=n>=0?o.directionPoint(a):a.directionPoint(o);0!==r&&(u=this.computeAngle(t,r,c),t.angle=u),l=o.x+(a.x-o.x)*s,h=o.y+(a.y-o.y)*s}if(o.isNone())return void(t.location=new T(l,h));o.isNoSpot()&&(o=O.Center);const f=R.l();f.Jt(),f.K(t.scale,t.scale),f.us(t.angle,0,0);const g=t.naturalBounds,m=D.X(0,0,g.width,g.height),p=T.l();p.setRectSpot(m,o),f.xt(p);let y=-p.x,v=-p.y;const b=g.width,x=g.height,w=T.l();w.a(a);const k=isNaN(a.x),S=isNaN(a.y);if(k||S){const t=b/2+3,e=x/2+3,i=c>=45&&c<=135,o=c>=225&&c<=315;0===r&&(i||o)?(w.x=S?t:a.y,w.y=k?e:a.x,i?n>=0||isNaN(n)&&s<.5||k&&(w.y=-e):o&&((n>=0||isNaN(n)&&s<.5)&&k&&(w.y=-e),S&&(w.x=-t))):(k&&(n>=0||isNaN(n)&&s<.5?w.x=t:w.x=-t),S&&(w.y=-e),w.rotate(c))}else w.rotate(c);l+=w.x,h+=w.y,f.ww(m),y+=m.x,v+=m.y;const P=T.X(l+y,h+v);t.move(P),T.s(P),T.s(w),T.s(p),D.s(m),R.s(f)}Jr(){let t=this.fromNode;if(null!==t){const e=t.findVisibleNode();if(null!==e&&(t=e),t.ss()||t.eh())return!1}let e=this.toNode;if(null!==e){const t=e.findVisibleNode();if(null!==t&&(e=t),e.ss()||e.eh())return!1}return!0}a2(t,e,i){return!1}c2(){}Ne(){return!1}computeAngle(t,e,i){return De.computeAngle(e,i)}static computeAngle(t,e){let i=0;switch(t){default:case 0:i=0;break;case 21:i=e;break;case 22:i=e+90;break;case 23:i=e-90;break;case 24:i=e+180;break;case 25:i=E.Kg(e),i>90&&i<270&&(i-=180);break;case 26:i=E.Kg(e+90),i>90&&i<270&&(i-=180);break;case 27:i=E.Kg(e-90),i>90&&i<270&&(i-=180);break;case 28:if(i=E.Kg(e),i>45&&i<135||i>225&&i<315)return 0;i>90&&i<270&&(i-=180)}return E.Kg(i)}get fromNode(){return this.ho}set fromNode(t){const e=this.ho;if(e!==t){const i=this.fromPort;null!==e&&(this.co!==e&&e.a1(this,i),this.yy(),this.invalidateLayout(2)),this.ho=t,null!==t&&this.Ei(t.isVisible()),this.Qo=null,this.invalidateRoute();const n=this.diagram;null!==n&&n.G&&n.partManager.setFromNodeForLink(this,t,e);const s=this.fromPort,o=this.fromPortChanged;if(null!==o){let t=!0;null!==n&&(t=n.G,n.G=!0),o(this,i,s),null!==n&&(n.G=t)}null!==t&&(this.co!==t&&t.h1(this,s),this.wy(),this.invalidateLayout(1)),this.t("fromNode",e,t),this.Ad()}}get fromPortId(){return this.ao}set fromPortId(t){const e=this.ao;if(e!==t){const i=this.fromPort;null!==i&&this.fromNode.ye(i),this.yy(),this.ao=t;const n=this.fromPort;null!==n&&this.fromNode.ye(n);const s=this.diagram;if(null!==s){const e=this.data,i=s.model;null!==e&&i.Ta()&&i.setFromPortIdForLinkData(e,t)}if(i!==n){this.Qo=null,this.invalidateRoute();const t=this.fromPortChanged;if(null!==t){let e=!0;null!==s&&(e=s.G,s.G=!0),t(this,i,n),null!==s&&(s.G=e)}}this.wy(),this.t("fromPortId",e,t)}}get fromPort(){const t=this.ho;if(null===t)return null;const e=this.ao;return t.findPort(e)}get fromPortChanged(){return this.Dd}set fromPortChanged(t){const e=this.Dd;e!==t&&(null!==t&&d.i(t,"function",De,"fromPortChanged"),this.Dd=t,this.t("fromPortChanged",e,t))}get toNode(){return this.co}set toNode(t){const e=this.co;if(e!==t){const i=this.toPort;null!==e&&(this.ho!==e&&e.a1(this,i),this.yy(),this.invalidateLayout(2)),this.co=t,null!==t&&this.Ei(t.isVisible()),this.Qo=null,this.invalidateRoute();const n=this.diagram;null!==n&&n.G&&n.partManager.setToNodeForLink(this,t,e);const s=this.toPort,o=this.toPortChanged;if(null!==o){let t=!0;null!==n&&(t=n.G,n.G=!0),o(this,i,s),null!==n&&(n.G=t)}null!==t&&(this.ho!==t&&t.h1(this,s),this.wy(),this.invalidateLayout(1)),this.t("toNode",e,t),this.Ad()}}get toPortId(){return this.fo}set toPortId(t){const e=this.fo;if(e!==t){const i=this.toPort;null!==i&&this.toNode.ye(i),this.yy(),this.fo=t;const n=this.toPort;null!==n&&this.toNode.ye(n);const s=this.diagram;if(null!==s){const e=this.data,i=s.model;null!==e&&i.Ta()&&i.setToPortIdForLinkData(e,t)}if(i!==n){this.Qo=null,this.invalidateRoute();const t=this.toPortChanged;if(null!==t){let e=!0;null!==s&&(e=s.G,s.G=!0),t(this,i,n),null!==s&&(s.G=e)}}this.wy(),this.t("toPortId",e,t)}}get toPort(){const t=this.co;if(null===t)return null;const e=this.fo;return t.findPort(e)}get toPortChanged(){return this.Fd}set toPortChanged(t){const e=this.Fd;e!==t&&(null!==t&&d.i(t,"function",De,"toPortChanged"),this.Fd=t,this.t("toPortChanged",e,t))}get fromSpot(){return null!==this.W?this.W.fa:O.Default}set fromSpot(t){const e=this.fromSpot;if(!e.equals(t)){if(t=t.N(),this.Ye(),this.W.fa=t,this.t("fromSpot",e,t),e.isSide()||t.isSide()){const t=this.fromNode;null!==t&&t.ye(this.fromPort)}this.invalidateRoute()}}get fromEndSegmentLength(){return null!==this.W?this.W.da:NaN}set fromEndSegmentLength(t){const e=this.fromEndSegmentLength;e!==t&&(t<0&&d.tt(t,">= 0",De,"fromEndSegmentLength"),this.Ye(),this.W.da=t,this.t("fromEndSegmentLength",e,t),this.invalidateRoute())}get fromShortLength(){return null!==this.W?this.W.ma:NaN}set fromShortLength(t){const e=this.fromShortLength;e!==t&&(this.Ye(),this.W.ma=t,this.oe(),this.t("fromShortLength",e,t))}get toSpot(){return null!==this.W?this.W.ua:O.Default}set toSpot(t){const e=this.toSpot;if(!e.equals(t)){if(t=t.N(),this.Ye(),this.W.ua=t,this.t("toSpot",e,t),e.isSide()||t.isSide()){const t=this.toNode;null!==t&&t.ye(this.toPort)}this.invalidateRoute()}}get toEndSegmentLength(){return null!==this.W?this.W.ga:NaN}set toEndSegmentLength(t){const e=this.toEndSegmentLength;e!==t&&(t<0&&d.tt(t,">= 0",De,"toEndSegmentLength"),this.Ye(),this.W.ga=t,this.t("toEndSegmentLength",e,t),this.invalidateRoute())}get toShortLength(){return null!==this.W?this.W.pa:NaN}set toShortLength(t){const e=this.toShortLength;e!==t&&(this.Ye(),this.W.pa=t,this.oe(),this.t("toShortLength",e,t))}Ad(){const t=this.fromNode,e=this.toNode;let i=null;if(i=null!==t?null!==e?t.findCommonContainingGroup(e):t.containingGroup:null!==e?e.containingGroup:null,this.Kv(i),this.isLabeledLink){const t=this.labelNodes;for(;t.next();){t.value.containingGroup=i}}}Kv(t){const e=this.yh;if(e!==t){null!==e&&e.K2(this),this.yh=t,null!==t&&t.Y2(this);const i=this.containingGroupChanged;if(null!==i){let n=!0;const s=this.diagram;null!==s&&(n=s.G,s.G=!0),i(this,e,t),null!==s&&(s.G=n)}this.Le&&(this.Z2===e||this.Q2===e)&&this.invalidateRoute()}}fh(){const t=this.containingGroup;null!==t&&this.fromNode!==t&&this.toNode!==t&&t.computesBoundsIncludingLinks&&super.fh()}getOtherNode(t){const e=this.fromNode;return t===e?this.toNode:e}getOtherPort(t){const e=this.fromPort;return t===e?this.toPort:e}get isLabeledLink(){return null!==this.qs&&this.qs.count>0}get labelNodes(){return null===this.qs?m.instance:this.qs.iterator}qA(t){null===this.qs&&(this.qs=new k),this.qs.add(t),this.c()}WA(t){null!==this.qs&&(this.qs.remove(t),this.c())}Um(t){if(super.Um(t),this.Oa()&&this.invalidateOtherJumpOvers(this.actualBounds),!t){const t=this.ho;let e=null;null!==t&&(e=this.fromPort,t.h1(this,e));const i=this.co;let n=null;null!==i&&(n=this.toPort,(i!==t||n!==e)&&i.h1(this,n)),this.wy()}}Bm(t){if(super.Bm(t),this.Oa()&&this.invalidateOtherJumpOvers(this.actualBounds),!t){const t=this.ho;let e=null;null!==t&&(e=this.fromPort,t.a1(this,e));const i=this.co;let n=null;null!==i&&(n=this.toPort,(i!==t||n!==e)&&i.a1(this,n)),this.yy()}}Bc(){if(this.Le=!0,null!==this.qs){const t=this.diagram;if(null!==t){const e=this.qs.copy().iterator;for(;e.next();){const i=e.value;t.remove(i)}}}if(null!==this.data){const t=this.diagram;null!==t&&t.partManager.eN(this)}}updateRelationshipsFromData(){if(null===this.data)return;const t=this.diagram;null!==t&&t.partManager.updateRelationshipsFromData(this)}move(t,e){const i=e?this.location:this.position;let n=i.x;isNaN(n)&&(n=0);let s=i.y;isNaN(s)&&(s=0);const o=t.x-n,r=t.y-s;if(!0===e)super.move(t,!1);else{const t=T.X(i.x+o,i.y+r);super.move(t,!1),T.s(t)}this.wr(o,r);const a=this.labelNodes;for(;a.next();){const t=a.value,e=t.position;t.moveTo(e.x+o,e.y+r)}}get relinkableFrom(){return 0!==(1&this.Nt)}set relinkableFrom(t){const e=0!==(1&this.Nt);e!==t&&(this.Nt=1^this.Nt,this.t("relinkableFrom",e,t),this.invalidateAdornments())}get relinkableTo(){return 0!==(2&this.Nt)}set relinkableTo(t){const e=0!==(2&this.Nt);e!==t&&(this.Nt=2^this.Nt,this.t("relinkableTo",e,t),this.invalidateAdornments())}canRelinkFrom(){if(!this.relinkableFrom)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRelink)return!1;const e=t.diagram;return!(null!==e&&!e.allowRelink)}canRelinkTo(){if(!this.relinkableTo)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRelink)return!1;const e=t.diagram;return!(null!==e&&!e.allowRelink)}get resegmentable(){return 0!==(4&this.Nt)}set resegmentable(t){const e=0!==(4&this.Nt);e!==t&&(this.Nt=4^this.Nt,this.t("resegmentable",e,t),this.invalidateAdornments())}get isTreeLink(){return 0!==(8&this.Nt)}set isTreeLink(t){const e=0!==(8&this.Nt);e!==t&&(this.Nt=8^this.Nt,this.t("isTreeLink",e,t),null!==this.fromNode&&this.fromNode.u0(),null!==this.toNode&&this.toNode.u0())}get path(){const t=this.findMainElement();return t instanceof le?t:null}get routeBounds(){return this.updateRoute(),this.Yv(this.kf)}Yv(t){let e=1/0,i=1/0;const n=this.pointsCount;if(0===n)return t.e(NaN,NaN,0,0),t;if(1===n){const n=this.getPoint(0);e=Math.min(n.x,e),i=Math.min(n.y,i),t.e(n.x,n.y,0,0)}else if(2===n){const n=this.getPoint(0),s=this.getPoint(1);e=Math.min(n.x,s.x),i=Math.min(n.y,s.y),t.e(n.x,n.y,0,0),t.unionPoint(s)}else if(9===this.computeCurve()&&n>=3&&!this.isOrthogonal){let s=this.getPoint(0);if(e=s.x,i=s.y,t.e(e,i,0,0),3===n){const n=this.getPoint(1);e=Math.min(n.x,e),i=Math.min(n.y,i);const o=this.getPoint(2);e=Math.min(o.x,e),i=Math.min(o.y,i),E.hu(s.x,s.y,n.x,n.y,n.x,n.y,o.x,o.y,.5,t)}else for(let o=3;o<n;o+=3){const r=this.getPoint(o-2);o+3>=n&&(o=n-1);const a=this.getPoint(o-1),l=this.getPoint(o);E.hu(s.x,s.y,r.x,r.y,a.x,a.y,l.x,l.y,.5,t),e=Math.min(l.x,e),i=Math.min(l.y,i),s=l}}else{const s=this.getPoint(0),o=this.getPoint(1);e=Math.min(s.x,o.x),i=Math.min(s.y,o.y),t.e(s.x,s.y,0,0),t.unionPoint(o);for(let r=2;r<n;r++){const n=this.getPoint(r);e=Math.min(n.x,e),i=Math.min(n.y,i),t.unionPoint(n)}}return this.c1.e(e-t.x,i-t.y),t}get midPoint(){return this.updateRoute(),this.computeMidPoint(new T)}cA(t){return this.updateRoute(),this.computeMidPoint(t)}computeMidPoint(t){const e=this.pointsCount;if(0===e)return t.a(T.Lk),t;if(1===e)return t.a(this.getPoint(0)),t;if(2===e){const e=this.getPoint(0),i=this.getPoint(1);return t.e((e.x+i.x)/2,(e.y+i.y)/2),t}if(this.isOrthogonal&&(this.computeCorner()>=15||9===this.computeCurve())){this.ft.getPointAlongPath(.5,t),t.add(this.getPoint(0));const e=this.ft.figures.first();return t.offset(-e.startX,-e.startY),t}if(9===this.computeCurve()){if(3===e){const e=this.getPoint(0),i=this.getPoint(1),n=this.getPoint(2);return E.hC(e.x,e.y,i.x,i.y,i.x,i.y,n.x,n.y,t),t}const i=(e-1)/3|0,n=3*(i/2|0);if(i%2===1){const e=this.getPoint(n),i=this.getPoint(n+1),s=this.getPoint(n+2),o=this.getPoint(n+3);return E.hC(e.x,e.y,i.x,i.y,s.x,s.y,o.x,o.y,t),t}return t.a(this.getPoint(n)),t}const i=this.flattenedLengths,n=this.flattenedTotalLength;let s=0,o=0,r=0;for(;s<n/2&&o<e&&(r=i[o],!(s+r>n/2));)s+=r,o++;const a=this.getPoint(o),l=this.getPoint(o+1);if(Math.abs(a.x-l.x)<1)a.y>l.y?t.e(a.x,a.y-(n/2-s)):t.e(a.x,a.y+(n/2-s));else if(Math.abs(a.y-l.y)<1)a.x>l.x?t.e(a.x-(n/2-s),a.y):t.e(a.x+(n/2-s),a.y);else{const e=(n/2-s)/r,i=e*(l.x-a.x),o=e*(l.y-a.y);t.e(a.x+i,a.y+o)}return t}get midAngle(){return this.updateRoute(),this.computeMidAngle()}computeMidAngle(){const t=this.pointsCount;if(t<2)return NaN;if(2===t){const t=this.getPoint(0),e=this.getPoint(1);return t.directionPoint(e)}if(this.isOrthogonal&&(this.computeCorner()>=15||9===this.computeCurve()))return this.ft.getAngleAlongPath(.5);if(9===this.computeCurve()&&t>=4){const e=(t-1)/3|0;let i=3*(e/2|0);if(e%2===1){i=Math.floor(i);const t=this.getPoint(i),e=this.getPoint(i+1),n=this.getPoint(i+2),s=this.getPoint(i+3);return E.LD(t.x,t.y,e.x,e.y,n.x,n.y,s.x,s.y)}if(i>0&&i+1<t){const t=this.getPoint(i-1),e=this.getPoint(i+1);return t.directionPoint(e)}}const e=this.flattenedLengths,i=this.flattenedTotalLength;let n=0,s=0,o=0;for(;n<i/2&&s<t&&(o=e[s],!(n+o>i/2));)n+=o,s++;const r=this.getPoint(s),a=this.getPoint(s+1);if(Math.abs(r.x-a.x)<1&&Math.abs(r.y-a.y)<1){if(s>0&&s+2<t){const t=this.getPoint(s-1),e=this.getPoint(s+2);return t.directionPoint(e)}}else{if(Math.abs(r.x-a.x)<1)return r.y>a.y?270:90;if(Math.abs(r.y-a.y)<1)return r.x>a.x?180:0}return r.directionPoint(a)}Gv(){if(null===this.py){this.Le||this.u1();const t=this.py=[];this.Hv(t)}}get flattenedLengths(){return this.Gv(),this.py}get flattenedTotalLength(){let t=this.f1;if(isNaN(t)){const e=this.flattenedLengths,i=e.length;t=0;for(let n=0;n<i;n++)t+=e[n];this.f1=t}return t}Hv(t){const e=this.pointsCount;for(let i=0;i<e-1;i++){let e=0;const n=this.getPoint(i),s=this.getPoint(i+1);E.Y(n.x,s.x)?(e=s.y-n.y,e<0&&(e=-e),t.push(e)):E.Y(n.y,s.y)?(e=s.x-n.x,e<0&&(e=-e),t.push(e)):(e=Math.sqrt(n.distanceSquaredPoint(s)),t.push(e))}}get points(){return this.Pi}set points(t){const e=this.Pi;if(e===t)return;let i=null;if(Array.isArray(t)){const e=t;let n=e.length%2===0;if(n)for(let t=0;t<e.length;t++)if("number"!=typeof e[t]||isNaN(e[t])){n=!1;break}if(n){i=new x;for(let t=0;t<e.length/2;t++){const n=new T(e[2*t],e[2*t+1]).g();i.add(n)}}else{let t=!0;for(let i=0;i<e.length;i++){const n=e[i];if(!d.wt(n)||"number"!=typeof n.x||isNaN(n.x)||"number"!=typeof n.y||isNaN(n.y)){t=!1;break}}if(t){i=new x;for(let t=0;t<e.length;t++){const n=e[t];i.add(new T(n.x,n.y).g())}}}}else if(t instanceof x){i=t.copy();const e=i.iterator;for(;e.next();)e.value.g()}else d.o("Link.points value is not an instance of List or Array: "+t);i.g(),this.Pi=i,this.oe(),this.u1();const n=this.diagram;null!==n&&(!n.Uh&&!n.undoManager.isUndoingRedoing&&n.mx.add(this),n.animationManager.xi&&n.animationManager.AM(this,i)),this.t("points",e,i)}get pointsCount(){return this.Pi.count}getPoint(t){return this.Pi.r[t]}setPoint(t,e){this.Pi.setElt(t,e)}setPointAt(t,e,i){this.Pi.setElt(t,new T(e,i))}insertPoint(t,e){this.Pi.insertAt(t,e)}insertPointAt(t,e,i){this.Pi.insertAt(t,new T(e,i))}addPoint(t){this.Pi.add(t)}addPointAt(t,e){this.Pi.add(new T(t,e))}removePoint(t){this.Pi.removeAt(t)}clearPoints(){this.Pi.clear()}wr(t,e){if(0===t&&0===e)return;if(0===this.pointsCount)return this.defaultFromPoint&&this.defaultFromPoint.offset(t,e),void(this.defaultToPoint&&this.defaultToPoint.offset(t,e));const i=this.Le,n=new x,s=this.Pi.iterator;for(;s.next();){const i=s.value;n.add(new T(i.x+t,i.y+e).g())}n.g();const o=this.Pi;this.Pi=n;const r=this.diagram;isNaN(t)||isNaN(e)||null!==r&&r.animationManager.xi?this.c():(this.js.e(this.js.x+t,this.js.y+e),this.st.e(this.st.x+t,this.st.y+e),this._c()),i?this.u1():(this.defaultFromPoint&&(this.defaultFromPoint=this.getPoint(0)),this.defaultToPoint&&(this.defaultToPoint=this.getPoint(this.pointsCount-1))),null!==r&&r.animationManager.xi&&r.animationManager.AM(this,n),this.t("points",o,n)}startRoute(){null===this.gl&&(this.gl=this.Pi,this.Pi=this.Pi.copy())}commitRoute(){if(null===this.gl)return;const t=this.gl,e=this.Pi;let i=1/0,n=1/0;const s=t.r,o=s.length;for(let c=0;c<o;c++){const t=s[c];i=Math.min(t.x,i),n=Math.min(t.y,n)}let r=1/0,a=1/0;const l=e.r,h=l.length;for(let c=0;c<h;c++){const t=l[c];r=Math.min(t.x,r),a=Math.min(t.y,a),t.g()}if(e.g(),h===o)for(let c=0;c<h;c++){const t=s[c],e=l[c];if(t.x-i!==e.x-r||t.y-n!==e.y-a){this.oe();break}}else this.oe();this.gl=null;const u=this.diagram;null!==u&&u.animationManager.xi&&u.animationManager.AM(this,e),this.u1(),this.t("points",t,e)}rollbackRoute(){null!==this.gl&&(this.Pi=this.gl,this.gl=null)}fF(){null!==this.Nr&&(this.points=this.Nr,this.Nr=null)}u1(){0!==this.Pi.count?(this.Le=!0,this.py=null,this.f1=NaN,this.defaultFromPoint=this.getPoint(0),this.defaultToPoint=this.getPoint(this.pointsCount-1),this.d1(!1)):this.Le=!1}invalidateRoute(){if(this.dn)return;const t=this.path;if(null===t)return;const e=this.diagram;if(e){if(e.mx.contains(this)||e.undoManager.isUndoingRedoing)return;const t=e.animationManager;if(t.isTicking&&!t.isAnimating)return;null!==this.Nr&&!t.isTicking&&(this.Nr=null)}this.Le=!1,this.c(),t.c()}get Le(){return 0!==(16&this.Nt)}set Le(t){0!==(16&this.Nt)!==t&&(this.Nt=16^this.Nt)}get dn(){return 0!==(32&this.Nt)}set dn(t){0!==(32&this.Nt)!==t&&(this.Nt=32^this.Nt)}get xy(){return 0!==(64&this.Nt)}set xy(t){0!==(64&this.Nt)!==t&&(this.Nt=64^this.Nt)}get sN(){return 0!==(512&this.Nt)}set sN(t){0!==(512&this.Nt)!==t&&(this.Nt=512^this.Nt)}get defaultFromPoint(){return this.J2}set defaultFromPoint(t){this.J2=t.copy()}get defaultToPoint(){return this.$2}set defaultToPoint(t){this.$2=t.copy()}updateRoute(){if(this.Le||this.xy)return;let t=!0;try{this.xy=!0,this.startRoute(),t=this.computePoints()}catch{this.xy=!1,this.rollbackRoute()}finally{this.xy=!1,t?this.commitRoute():this.rollbackRoute()}}computePoints(){const t=this.diagram;if(null===t)return!1;let e=this.fromNode,i=null;if(null===e?(De.Fa||(De.Fa=new Ce,De.Fa.desiredSize=A.ru,De.Fa.ensureBounds()),this.defaultFromPoint&&(De.Fa.location=this.defaultFromPoint,De.Fa.ensureBounds(),e=De.Fa,i=De.Fa)):i=this.fromPort,null!==i&&!e.isVisible()){const t=e.findVisibleNode();null!==t&&t!==e?(e=t,i=t.port):e=t}if(this.Z2=e,null===e||!e.location.isReal()||(i=e.findVisiblePort(i),null===i))return!1;let n=this.toNode,s=null;if(null===n?(De.Ra||(De.Ra=new Ce,De.Ra.desiredSize=A.ru,De.Ra.ensureBounds()),this.defaultToPoint&&(De.Ra.location=this.defaultToPoint,De.Ra.ensureBounds(),n=De.Ra,s=De.Ra)):s=this.toPort,null!==s&&!n.isVisible()){const t=n.findVisibleNode();null!==t&&t!==n?(n=t,s=t.port):n=t}if(this.Q2=n,null===n||!n.location.isReal()||(s=n.findVisiblePort(s),null===s))return!1;const o=this.pointsCount,r=this.computeSpot(!0,i),a=this.computeSpot(!1,s),l=this.Ed(r),h=this.Ed(a),u=i===s&&null!==i,c=this.isOrthogonal;let d=9===this.curve;u&&!c?(d=!0,this.Qo=!0):this.Qo=!1;const f=0===this.computeAdjusting()||u;if(!c&&!u&&l&&h){let t=!1;if(!f&&o>=3){let l=this.getLinkPoint(e,i,r,!0,!1,n,s),h=this.getLinkPoint(n,s,a,!1,!1,e,i);t=this.adjustPoints(0,l,o-1,h),t&&(l=this.getLinkPoint(e,i,r,!0,!1,n,s),h=this.getLinkPoint(n,s,a,!1,!1,e,i),this.adjustPoints(0,l,o-1,h))}t||(this.clearPoints(),d?this.jv(e,i,r,n,s,a):this.qv(e,i,r,n,s,a))}else{const t=this.isAvoiding;f&&(c&&t||u)&&this.clearPoints();const d=u?this.computeCurviness():0,g=this.getLinkPoint(e,i,r,!0,c,n,s);let m=0,p=0,y=0;if(c||!l||u){let t=this.computeEndSegmentLength(e,i,r,!0);if(y=this.getLinkDirection(e,i,g,r,!0,c,n,s),u&&(l||r.equals(a)||!c&&r.x+a.x===1&&r.y+a.y===1)&&(y-=c?90:30,d<0&&(y-=180)),y<0?y+=360:y>=360&&(y-=360),u&&(t+=Math.abs(d)*(c?1:2)),0===y?m=t:90===y?p=t:180===y?m=-t:270===y?p=-t:(m=t*Math.cos(y*Math.PI/180),p=t*Math.sin(y*Math.PI/180)),r.isNoSpot()&&u){const t=i.getDocumentPoint(O.Center,T.l()),n=T.X(t.x+1e3*m,t.y+1e3*p);this.getLinkPointFromPoint(e,i,t,n,!0,g),T.s(t),T.s(n)}}const v=this.getLinkPoint(n,s,a,!1,c,e,i);let b=0,x=0,w=0;if(c||!h||u){let t=this.computeEndSegmentLength(n,s,a,!1);if(w=this.getLinkDirection(n,s,v,a,!1,c,e,i),u&&(h||r.equals(a)||!c&&r.x+a.x===1&&r.y+a.y===1)&&(w+=c?0:30,d<0&&(w+=180)),w<0?w+=360:w>=360&&(w-=360),u&&(t+=Math.abs(d)*(c?1:2)),0===w?b=t:90===w?x=t:180===w?b=-t:270===w?x=-t:(b=t*Math.cos(w*Math.PI/180),x=t*Math.sin(w*Math.PI/180)),a.isNoSpot()&&u){const t=s.getDocumentPoint(O.Center,T.l()),e=T.X(t.x+1e3*b,t.y+1e3*x);this.getLinkPointFromPoint(n,s,t,e,!1,v),T.s(t),T.s(e)}}let k=g;(c||!l||u)&&(k=new T(g.x+m,g.y+p));let S=v;(c||!h||u)&&(S=new T(v.x+b,v.y+x)),!f&&!c&&l&&o>3&&this.adjustPoints(0,g,o-2,S)?this.setPoint(o-1,v):!f&&!c&&h&&o>3&&this.adjustPoints(1,k,o-1,v)?this.setPoint(0,g):!f&&(c?o>=6:o>4)&&this.adjustPoints(1,k,o-2,S)?(this.setPoint(0,g),this.setPoint(o-1,v)):(this.clearPoints(),this.addPoint(g),(c||!l||u)&&this.addPoint(k),c&&this.addOrthoPoints(k,y,S,w,e,n),(c||!h||u)&&this.addPoint(S),this.addPoint(v))}return t.addInvalidRoute(this),!0}nN(t,e){return Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?(e.x>=t.x?e.x=t.x+9e9:e.x=t.x-9e9,e.y=t.y):(e.y>=t.y?e.y=t.y+9e9:e.y=t.y-9e9,e.x=t.x),e}getLinkPointFromPoint(t,e,i,n,s,o){if(void 0===o&&(o=new T),null===t||null===e)return o.a(i),o;if(!t.isVisible()){const i=t.findVisibleNode();null!==i&&i!==t&&(e=(t=i).port)}let r=0,a=0,l=0,h=0,u=null,c=e.panel;if(null!==c&&!c.wn()&&(c=c.panel),null===c)r=n.x,a=n.y,l=i.x,h=i.y;else{u=c.ws;const t=1/(u.m11*u.m22-u.m12*u.m21),e=u.m22*t,s=-u.m12*t,o=-u.m21*t,d=u.m11*t,f=t*(u.m21*u.dy-u.m22*u.dx),g=t*(u.m12*u.dx-u.m11*u.dy);r=n.x*e+n.y*o+f,a=n.x*s+n.y*d+g,l=i.x*e+i.y*o+f,h=i.x*s+i.y*d+g}return e.Jc(r,a,l,h,o),null!==u&&o.L(u),o}Wv(t,e){const i=t.$u;return null!==i?i._A(e):null}g1(t){let e=t.$u;return null===e&&(e=new Re,e.tr=t,e.me=t.part,t.$u=e),e._A(this)}getLinkPoint(t,e,i,n,s,o,r,a){if(void 0===a&&(a=new T),i.isSpot()&&!this.Ed(i))return e.getDocumentPoint(i,a),a;if(i.isSide()){const l=this.g1(e);if(null!==l){const h=l.Vd;if(a.a(h),s&&7===this.routing){const h=this.g1(r);if(null!==h&&l.Pf<h.Pf){const l=T.l(),h=T.l(),u=new D(e.getDocumentPoint(O.TopLeft,l),e.getDocumentPoint(O.BottomRight,h)),c=this.computeSpot(!n,r),d=this.getLinkPoint(o,r,c,!n,s,t,e,h);(i.includesSide(O.LeftSide)||i.includesSide(O.RightSide))&&d.y>=u.y&&d.y<=u.y+u.height?a.y=d.y:(i.includesSide(O.TopSide)||i.includesSide(O.BottomSide))&&d.x>=u.x&&d.x<=u.x+u.width&&(a.x=d.x),T.s(l),T.s(h)}}return a}}const l=e.getDocumentPoint(this.m1(i,n),T.l());let h=null;if(this.pointsCount>(s?6:2))h=n?this.getPoint(1):this.getPoint(this.pointsCount-2),s&&(h=this.nN(l,h.copy()));else{const t=this.computeSpot(!n,r),e=T.l();h=r.getDocumentPoint(this.m1(t,!n),e),s&&(h=this.nN(l,h)),T.s(e)}return this.getLinkPointFromPoint(t,e,l,h,n,a),T.s(l),a}getLinkDirection(t,e,i,n,s,o,r,a){let l=this.Jv(t,e,i,n,s,o,r,a);if(r&&n.isNoSpot()&&r.isMemberOf(t)&&(l+=180,l>=360&&(l-=360)),this.Ed(n))return l;const h=e.getDocumentAngle();return 0===h||(45<=h&&h<135?l+=90:135<=h&&h<225?l+=180:225<=h&&h<315&&(l+=270),l>=360&&(l-=360)),l}Jv(t,e,i,n,s,o,r,a){if(n.isSpot())return n.x>n.y?n.x>1-n.y?0:n.x<1-n.y?270:315:n.x<n.y?n.x>1-n.y?90:n.x<1-n.y?180:135:n.x<.5?225:n.x>.5?45:0;if(n.isSide()){const t=this.g1(e);if(null!==t)switch(t.we){case 1:return 270;case 2:return 180;default:case 4:return 0;case 8:return 90}}const l=e.getDocumentPoint(O.Center,T.l());let h=null;if(this.pointsCount>(o?6:2))h=s?this.getPoint(1):this.getPoint(this.pointsCount-2),h=o?this.nN(l,h.copy()):i;else{const t=T.l();h=a.getDocumentPoint(O.Center,t),T.s(t)}let u=0;return u=Math.abs(h.x-l.x)>Math.abs(h.y-l.y)?h.x>=l.x?0:180:h.y>=l.y?90:270,T.s(l),u}computeEndSegmentLength(t,e,i,n){if(null!==e&&i.isSide()){const t=this.g1(e);if(null!==t)return t.p1}let s=NaN;return s=n?this.fromEndSegmentLength:this.toEndSegmentLength,null!==e&&isNaN(s)&&(s=n?e.fromEndSegmentLength:e.toEndSegmentLength),isNaN(s)&&(s=10),s}computeSpot(t,e){return void 0===e&&(e=null),t?this.$v(e||this.fromPort):this.Zv(e||this.toPort)}$v(t){if(null===t)return O.Center;let e=this.fromSpot;return e.isDefault()&&(e=t.fromSpot),e===O.Default?O.None:e}Zv(t){if(null===t)return O.Center;let e=this.toSpot;return e.isDefault()&&(e=t.toSpot),e===O.Default?O.None:e}Ed(t){return t===O.None||.5===t.x&&.5===t.y}m1(t,e){return.5===t.x&&.5===t.y?t:O.Center}computeOtherPoint(t,e){if(0!==this.computeAdjusting()&&this.pointsCount>4)return this.computeMidPoint(new T);{const t=this.Wv(e,this);return null!==t?t.Vd:e.getDocumentPoint(O.Center)}}computeShortLength(t){if(t){let t=this.fromShortLength;if(isNaN(t)){const e=this.fromPort;null!==e&&(t=e.fromShortLength)}return isNaN(t)?0:t}{let t=this.toShortLength;if(isNaN(t)){const e=this.toPort;null!==e&&(t=e.toShortLength)}return isNaN(t)?0:t}}Im(t,e,i,n,s,o){if(!1===this.pickable)return!1;void 0===e&&(e=null),void 0===i&&(i=null);let r=o;if(void 0===o&&(r=R.l(),r.Jt()),r.tc(this.L),this.containedInRect(t,r))return this.A2(e,i,s),void 0===o&&R.s(r),!0;if(this.intersectsRect(t,r)){let a=!1;if(!this.lf){const o=this.T.r;for(let l=o.length;l--;){const h=o[l];if(!h.visible&&h!==this.locationObject)continue;const u=h.actualBounds,c=this.naturalBounds;if(u.x>c.width||u.y>c.height||u.x+u.width<0||u.y+u.height<0)continue;const d=h,f=R.l();if(f.set(r),d instanceof ie?a=d.Im(t,e,i,n,s,f):this.path===d?d instanceof le&&(a=d.xv(t,n,f)):a=d.WL(t,n,f),a){let t=d;null!==e&&(t=e(d)),t&&(null===i||i(t))&&s.add(t)}R.s(f)}}return void 0===o&&R.s(r),a||null!==this.background}return void 0===o&&R.s(r),!1}get isOrthogonal(){return 2===(2&this.Da)}static iN(t){return 2===(2&t)}get isAvoiding(){return 4===(4&this.Da)}computeCurve(){if(null===this.Qo){const t=this.fromPort,e=null!==t&&t===this.toPort,i=this.isOrthogonal;this.Qo=e&&!i}return this.Qo?9:this.curve}computeCorner(){if(9===this.curve)return 0;let t=this.corner;return(isNaN(t)||t<0)&&(t=10),t}findMidLabel(){const t=this.path,e=this.T.r,i=e.length;for(let s=0;s<i;s++){const i=e[s];if(i!==t&&!i.isPanelMain&&(i.segmentIndex===-1/0||isNaN(i.segmentIndex)))return i}const n=this.labelNodes;for(;n.next();){const t=n.value;if(t.segmentIndex===-1/0||isNaN(t.segmentIndex))return t}return null}computeSpacing(){if(!this.isVisible())return 0;let t=De.Xv;t=Math.max(t,this.computeThickness());const e=this.fromPort,i=this.toPort;if(null!==e&&null!==i){const n=this.findMidLabel();if(null!==n){const s=n.naturalBounds,o=n.margin,r=isNaN(s.width)?30:s.width*n.scale+o.left+o.right,a=isNaN(s.height)?14:s.height*n.scale+o.top+o.bottom,l=n.segmentOrientation;if(21===l||25===l||24===l)t=Math.max(t,a);else if(23===l||27===l||22===l||26===l)t=Math.max(t,r);else{const n=e.getDocumentPoint(O.Center).directionPoint(i.getDocumentPoint(O.Center))/180*Math.PI;t=Math.max(t,Math.abs(Math.sin(n)*r)+Math.abs(Math.cos(n)*a)+1)}9===this.curve&&(t*=1.333)}}return t}arrangeBundledLinks(t,e){if(e)for(let i=0;i<t.length;i++){const e=t[i];0===e.computeAdjusting()&&e.invalidateRoute()}}computeCurviness(){let t=this.curviness;if(isNaN(t)){t=De.zv;const e=this._o;if(null!==e){const i=d.rt();let n=0;const s=e.Ws;for(let t=0;t<s.length;t++){const e=s[t].computeSpacing();i.push(e),n+=e}let o=-n/2;for(let e=0;e<s.length;e++){if(s[e]===this){t=o+i[e]/2;break}o+=i[e]}e.ry===this.fromNode&&(t=-t),d.it(i)}}return t}computeThickness(){if(!this.isVisible())return 0;const t=this.path;return null!==t?Math.max(t.strokeWidth,1):1}hasCurviness(){return!isNaN(this.curviness)||null!==this._o}qv(t,e,i,n,s,o){const r=this.getLinkPoint(t,e,i,!0,!1,n,s),a=this.getLinkPoint(n,s,o,!1,!1,t,e);if(this.hasCurviness()){const t=a.x-r.x,e=a.y-r.y,i=this.computeCurviness(),n=i,s=r.x+t/2,o=r.y+e/2;let l=s,h=o;if(E.u(e,0))t>0?h-=n:h+=n;else{const r=-t/e;let a=Math.sqrt(n*n/(r*r+1));i<0&&(a=-a),l=(e<0?-1:1)*a+s,h=r*(l-s)+o}this.addPoint(r),this.addPointAt(l,h),this.addPoint(a)}else{this.addPoint(r),this.addPoint(a);const l=D.l();e.getDocumentBounds(l);const h=l.containsPoint(a);s.getDocumentBounds(l);const u=l.containsPoint(r);if(h||u){const l=e.getDocumentPoint(this.m1(i,!0),new T);this.setPoint(0,this.getLinkPointFromPoint(t,e,l,a,!0,l));const h=s.getDocumentPoint(this.m1(o,!1),new T);this.setPoint(1,this.getLinkPointFromPoint(n,s,h,r,!1,h))}D.s(l)}}jv(t,e,i,n,s,o){const r=this.getLinkPoint(t,e,i,!0,!1,n,s),a=this.getLinkPoint(n,s,o,!1,!1,t,e),l=a.x-r.x,h=a.y-r.y,u=this.computeCurviness();let c=0,d=0,f=r.x+l/3,g=r.y+h/3,m=f,p=g;E.u(h,0)?l>0?p-=u:p+=u:(c=-l/h,d=Math.sqrt(u*u/(c*c+1)),u<0&&(d=-d),m=(h<0?-1:1)*d+f,p=c*(m-f)+g),f=r.x+2*l/3,g=r.y+2*h/3;let y=f,v=g;E.u(h,0)?l>0?v-=u:v+=u:(y=(h<0?-1:1)*d+f,v=c*(y-f)+g),this.clearPoints(),this.addPoint(r),this.addPointAt(m,p),this.addPointAt(y,v),this.addPoint(a),this.setPoint(0,this.getLinkPoint(t,e,i,!0,!1,n,s)),this.setPoint(3,this.getLinkPoint(n,s,o,!1,!1,t,e))}adjustPoints(t,e,i,n){let s=this.computeAdjusting();if(this.isOrthogonal){if(18===s)return!1;19===s&&(s=17)}switch(s){case 18:return this.Qv(t,e,i,n);case 19:return this._v(t,e,i,n);case 17:return this.tO(t,e,i,n);default:return!1}}Qv(t,e,i,n){const s=this.getPoint(t),o=this.getPoint(i);if(s.equalsApprox(e)&&o.equalsApprox(n))return!0;const r=s.x,a=s.y;let l=o.x-r,h=o.y-a;const u=Math.sqrt(l*l+h*h);if(E.Y(u,0))return!0;let c=0;E.Y(l,0)?c=h<0?-Math.PI/2:Math.PI/2:(c=Math.atan(h/Math.abs(l)),l<0&&(c=Math.PI-c));const d=e.x,f=e.y,g=n.x-d,m=n.y-f,p=Math.sqrt(g*g+m*m);let y=0;E.Y(g,0)?y=m<0?-Math.PI/2:Math.PI/2:(y=Math.atan(m/Math.abs(g)),g<0&&(y=Math.PI-y));const v=p/u,b=y-c;this.setPoint(t,e);for(let x=t+1;x<i;x++){const t=this.getPoint(x);l=t.x-r,h=t.y-a;const e=Math.sqrt(l*l+h*h);if(E.Y(e,0))continue;let i=0;E.Y(l,0)?i=h<0?-Math.PI/2:Math.PI/2:(i=Math.atan(h/Math.abs(l)),l<0&&(i=Math.PI-i));const n=i+b,s=e*v,o=d+s*Math.cos(n),u=f+s*Math.sin(n);this.setPointAt(x,o,u)}return this.setPoint(i,n),!0}_v(t,e,i,n){const s=this.getPoint(t),o=this.getPoint(i);if(s.equalsApprox(e)&&o.equalsApprox(n))return!0;const r=s.x,a=s.y,l=o.x,h=o.y,u=(l-r)*(l-r)+(h-a)*(h-a),c=e.x,d=e.y,f=n.x,g=n.y;let m=0,p=1;f-c!==0?(m=(g-d)/(f-c),p=Math.sqrt(1+1/(m*m))):m=9e9,this.setPoint(t,e);for(let y=t+1;y<i;y++){const t=this.getPoint(y),e=t.x,i=t.y;let n=.5;0!==u&&(n=((r-e)*(r-l)+(a-i)*(a-h))/u);const s=r+n*(l-r),o=a+n*(h-a);let v=Math.sqrt((e-s)*(e-s)+(i-o)*(i-o));i<m*(e-s)+o&&(v=-v),m>0&&(v=-v);const b=c+n*(f-c),x=d+n*(g-d);if(0!==m){const t=b+v/p,e=x-(t-b)/m;this.setPointAt(y,t,e)}else this.setPointAt(y,b,x+v)}return this.setPoint(i,n),!0}tO(t,e,i,n){if(this.isOrthogonal){let s=this.getPoint(t),o=this.getPoint(t+1),r=this.getPoint(t+2),a=o.x,l=o.y;const h=a,u=l;E.u(s.y,o.y)?E.u(o.x,r.x)?l=e.y:E.u(o.y,r.y)&&(a=e.x):E.u(s.x,o.x)&&(E.u(o.y,r.y)?a=e.x:E.u(o.x,r.x)&&(l=e.y)),this.setPointAt(t+1,a,l),s=this.getPoint(i),o=this.getPoint(i-1),r=this.getPoint(i-2);let c=o.x,d=o.y;const f=c,g=d;if(E.u(s.y,o.y)?E.u(o.x,r.x)?d=n.y:E.u(o.y,r.y)&&(c=n.x):E.u(s.x,o.x)&&(E.u(o.y,r.y)?c=n.x:E.u(o.x,r.x)&&(d=n.y)),this.setPointAt(i-1,c,d),this.SL())return this.setPointAt(t+1,h,u),this.setPointAt(i-1,f,g),!1}return this.setPoint(t,e),this.setPoint(i,n),!0}addOrthoPoints(t,e,i,n,s,o){e<0?e+=360:e>=360&&(e-=360),n<0?n+=360:n>=360&&(n-=360);const r=n;e=e>=315||e<45?0:45<=e&&e<135?90:135<=e&&e<225?180:270,n=n>=315||n<45?0:45<=n&&n<135?90:135<=n&&n<225?180:270;const a=t,l=i,h=s.actualBounds.copy(),u=o.actualBounds.copy();if(!h.isReal()||!u.isReal())return;h.inflate(De.va,De.va),u.inflate(De.va,De.va),h.unionPoint(t),u.unionPoint(i);const c=T.l(),d=T.l();0===e?l.x>a.x||270===n&&l.y<a.y&&u.right>a.x||90===n&&l.y>a.y&&u.right>a.x?(c.e(l.x,a.y),d.e(l.x,(a.y+l.y)/2),180===n?(c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1),d.x=c.x,d.y=l.y):270===n&&l.y<a.y||90===n&&l.y>a.y?(a.x<u.left?c.x=this.computeMidOrthoPosition(a.x,a.y,u.left,l.y,!1):a.x<u.right&&(270===n&&a.y<u.top||90===n&&a.y>u.bottom)?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):c.x=u.right,d.x=c.x,d.y=l.y):0===n&&a.x<u.left&&a.y>u.top&&a.y<u.bottom&&(c.x=a.x,a.y<l.y?c.y=Math.min(l.y,u.top):c.y=Math.max(l.y,u.bottom),d.y=c.y)):(c.e(a.x,l.y),d.e((a.x+l.x)/2,l.y),(180===n||90===n&&l.y<h.top||270===n&&l.y>h.bottom)&&(180===n&&(u.containsPoint(a)||h.containsPoint(l))?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):l.y<a.y&&(180===n||90===n)?c.y=this.computeMidOrthoPosition(a.x,h.top,l.x,Math.max(l.y,u.bottom),!0):l.y>a.y&&(180===n||270===n)&&(c.y=this.computeMidOrthoPosition(a.x,h.bottom,l.x,Math.min(l.y,u.top),!0)),d.x=l.x,d.y=c.y),c.y>h.top&&c.y<h.bottom&&(l.x>=h.left&&l.x<=a.x||a.x<=u.right&&a.x>=l.x?(90===n||270===n)&&(c.e(Math.max((a.x+l.x)/2,a.x),a.y),d.e(c.x,l.y)):(270===n||(0===n||180===n)&&l.y<a.y?c.y=Math.min(l.y,0===n?h.top:Math.min(h.top,u.top)):c.y=Math.max(l.y,0===n?h.bottom:Math.max(h.bottom,u.bottom)),d.x=l.x,d.y=c.y))):180===e?l.x<a.x||270===n&&l.y<a.y&&u.left<a.x||90===n&&l.y>a.y&&u.left<a.x?(c.e(l.x,a.y),d.e(l.x,(a.y+l.y)/2),0===n?(c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1),d.x=c.x,d.y=l.y):270===n&&l.y<a.y||90===n&&l.y>a.y?(a.x>u.right?c.x=this.computeMidOrthoPosition(a.x,a.y,u.right,l.y,!1):a.x>u.left&&(270===n&&a.y<u.top||90===n&&a.y>u.bottom)?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):c.x=u.left,d.x=c.x,d.y=l.y):180===n&&a.x>u.right&&a.y>u.top&&a.y<u.bottom&&(c.x=a.x,a.y<l.y?c.y=Math.min(l.y,u.top):c.y=Math.max(l.y,u.bottom),d.y=c.y)):(c.e(a.x,l.y),d.e((a.x+l.x)/2,l.y),(0===n||90===n&&l.y<h.top||270===n&&l.y>h.bottom)&&(0===n&&(u.containsPoint(a)||h.containsPoint(l))?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):l.y<a.y&&(0===n||90===n)?c.y=this.computeMidOrthoPosition(a.x,h.top,l.x,Math.max(l.y,u.bottom),!0):l.y>a.y&&(0===n||270===n)&&(c.y=this.computeMidOrthoPosition(a.x,h.bottom,l.x,Math.min(l.y,u.top),!0)),d.x=l.x,d.y=c.y),c.y>h.top&&c.y<h.bottom&&(l.x<=h.right&&l.x>=a.x||a.x>=u.left&&a.x<=l.x?(90===n||270===n)&&(c.e(Math.min((a.x+l.x)/2,a.x),a.y),d.e(c.x,l.y)):(270===n||(0===n||180===n)&&l.y<a.y?c.y=Math.min(l.y,180===n?h.top:Math.min(h.top,u.top)):c.y=Math.max(l.y,180===n?h.bottom:Math.max(h.bottom,u.bottom)),d.x=l.x,d.y=c.y))):90===e?l.y>a.y||180===n&&l.x<a.x&&u.bottom>a.y||0===n&&l.x>a.x&&u.bottom>a.y?(c.e(a.x,l.y),d.e((a.x+l.x)/2,l.y),270===n?(c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0),d.x=l.x,d.y=c.y):180===n&&l.x<a.x||0===n&&l.x>a.x?(a.y<u.top?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,u.top,!0):a.y<u.bottom&&(180===n&&a.x<u.left||0===n&&a.x>u.right)?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):c.y=u.bottom,d.x=l.x,d.y=c.y):90===n&&a.y<u.top&&a.x>u.left&&a.x<u.right&&(a.x<l.x?c.x=Math.min(l.x,u.left):c.x=Math.max(l.x,u.right),c.y=a.y,d.x=c.x)):(c.e(l.x,a.y),d.e(l.x,(a.y+l.y)/2),(270===n||0===n&&l.x<h.left||180===n&&l.x>h.right)&&(270===n&&(u.containsPoint(a)||h.containsPoint(l))?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):l.x<a.x&&(270===n||0===n)?c.x=this.computeMidOrthoPosition(h.left,a.y,Math.max(l.x,u.right),l.y,!1):l.x>a.x&&(270===n||180===n)&&(c.x=this.computeMidOrthoPosition(h.right,a.y,Math.min(l.x,u.left),l.y,!1)),d.x=c.x,d.y=l.y),c.x>h.left&&c.x<h.right&&(l.y>=h.top&&l.y<=a.y||a.y<=u.bottom&&a.y>=l.y?(0===n||180===n)&&(c.e(a.x,Math.max((a.y+l.y)/2,a.y)),d.e(l.x,c.y)):(180===n||(90===n||270===n)&&l.x<a.x?c.x=Math.min(l.x,90===n?h.left:Math.min(h.left,u.left)):c.x=Math.max(l.x,90===n?h.right:Math.max(h.right,u.right)),d.x=c.x,d.y=l.y))):l.y<a.y||180===n&&l.x<a.x&&u.top<a.y||0===n&&l.x>a.x&&u.top<a.y?(c.e(a.x,l.y),d.e((a.x+l.x)/2,l.y),90===n?(c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0),d.x=l.x,d.y=c.y):180===n&&l.x<a.x||0===n&&l.x>=a.x?(a.y>u.bottom?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,u.bottom,!0):a.y>u.top&&(180===n&&a.x<u.left||0===n&&a.x>u.right)?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):c.y=u.top,d.x=l.x,d.y=c.y):270===n&&a.y>u.bottom&&a.x>u.left&&a.x<u.right&&(a.x<l.x?c.x=Math.min(l.x,u.left):c.x=Math.max(l.x,u.right),c.y=a.y,d.x=c.x)):(c.e(l.x,a.y),d.e(l.x,(a.y+l.y)/2),(90===n||0===n&&l.x<h.left||180===n&&l.x>h.right)&&(90===n&&(u.containsPoint(a)||h.containsPoint(l))?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):l.x<a.x&&(90===n||0===n)?c.x=this.computeMidOrthoPosition(h.left,a.y,Math.max(l.x,u.right),l.y,!1):l.x>a.x&&(90===n||180===n)&&(c.x=this.computeMidOrthoPosition(h.right,a.y,Math.min(l.x,u.left),l.y,!1)),d.x=c.x,d.y=l.y),c.x>h.left&&c.x<h.right&&(l.y<=h.bottom&&l.y>=a.y||a.y>=u.top&&a.y<=l.y?(0===n||180===n)&&(c.e(a.x,Math.min((a.y+l.y)/2,a.y)),d.e(l.x,c.y)):(180===n||(90===n||270===n)&&l.x<a.x?c.x=Math.min(l.x,270===n?h.left:Math.min(h.left,u.left)):c.x=Math.max(l.x,270===n?h.right:Math.max(h.right,u.right)),d.x=c.x,d.y=l.y))),this.sN=n!==r,this._2=e,this.tN=n,this.addPoint(c.copy()),this.addPoint(d.copy()),T.s(c),T.s(d)}computeMidOrthoPosition(t,e,i,n,s){let o=0;return this.hasCurviness()&&!this.computeSpot(!0,this.fromPort).isSide()&&!this.computeSpot(!1,this.toPort).isSide()&&(o=this.computeCurviness()),s?(e+n)/2+o:(t+i)/2+o}SL(){if(null===this.diagram||!this.isAvoiding)return!1;const t=this.points.r,e=t.length;if(e<4)return!1;const i=this.diagram.getPositions(!0,this.containingGroup,null);for(let n=1;n<e-2;n++){const e=t[n],s=t[n+1];if(!i.isUnoccupied(Math.min(e.x,s.x),Math.min(e.y,s.y),Math.abs(e.x-s.x),Math.abs(e.y-s.y)))return!0}return!1}Ud(t,e,i,n,s,o){const r=t.cellWidth,a=t.cellHeight;let l=t.Wi(e,i),h=e,u=i,c=h,d=u;for(0===n?c+=r:90===n?d+=a:180===n?c-=r:d-=a,n!==o&&l>Oe.uo&&t.Wi(c,d)!==l-1&&(t.Wi(h-r,u)===l-1?(n=180,c=h-r,d=u):t.Wi(h+r,u)===l-1?(n=0,c=h+r,d=u):t.Wi(h,u-a)===l-1?(n=270,c=h,d=u-a):t.Wi(h,u+a)===l-1&&(n=90,c=h,d=u+a));l>Oe.uo&&t.Wi(c,d)===l-1;)h=c,u=d,0===n?c+=r:90===n?d+=a:180===n?c-=r:d-=a,l-=1;if(s?l>Oe.uo&&(180===n||0===n?h=Math.floor(h/r)*r+r/2:(90===n||270===n)&&(u=Math.floor(u/a)*a+a/2)):(h=Math.floor(h/r)*r+r/2,u=Math.floor(u/a)*a+a/2),l>Oe.uo){let e=n,i=h,s=u;if(0===n?(e=90,s+=a):90===n?(e=180,i-=r):180===n?(e=270,s-=a):270===n&&(e=0,i+=r),t.Wi(i,s)===l-1)this.Ud(t,i,s,e,!1,e);else{let i=h,s=u;0===n?(e=270,s-=a):90===n?(e=0,i+=r):180===n?(e=90,s+=a):270===n&&(e=180,i-=r),t.Wi(i,s)===l-1&&this.Ud(t,i,s,e,!1,e)}}this.addPointAt(h,u)}findClosestSegment(t){const e=t.x,i=t.y;let n=this.getPoint(0),s=this.getPoint(1),o=T.distanceLineSegmentSquared(e,i,n.x,n.y,s.x,s.y),r=0;for(let a=1;a<this.pointsCount-1;a++){n=this.getPoint(a+1);const t=T.distanceLineSegmentSquared(e,i,s.x,s.y,n.x,n.y);s=n,t<o&&(r=a,o=t)}return r}oe(){this.xh=!1,this.c()}get xh(){return 0!==(128&this.Nt)}set xh(t){0!==(128&this.Nt)!==t&&(this.Nt=128^this.Nt)}get geometry(){if(!this.xh){if(this.updateRoute(),this.pointsCount<2)return this.xh=!0,this.ft;this.ft=this.makeGeometry()}return this.ft}ad(t){if(!t){if(!1===this.Le)return;const t=this.findMainElement();if(this.xh&&(null===t||null!==t.geometry))return}this.pointsCount<2?this.xh=!0:this.ft=this.makeGeometry();const e=this.path;if(null===e)return;e.ft=this.ft;const i=this.T.r,n=i.length;for(let s=0;s<n;s++){const t=i[s];t!==e&&t.isPanelMain&&t instanceof le&&(t.ft=this.ft)}}iO(t){return this.Oa()&&t._l.contains(this)&&(0!==this.kf.width||0!==this.kf.height)&&(t.animationManager.isAnimating||t.currentTool!==t.toolManager)}makeGeometry(){const t=this.ft,e=this.pointsCount;let i=!1;const n=this.diagram;null!==n&&this.iO(n)&&(i=!0);let s=0,o=0,r=this.getPoint(0).copy();const a=r.copy(),l=this.Pi.r,h=this.computeCurve();if(9===h&&e>=3&&!E.Y(this.smoothness,0))if(3===e){let t=this.getPoint(1);s=Math.min(r.x,t.x),o=Math.min(r.y,t.y),t=this.getPoint(2),s=Math.min(s,t.x),o=Math.min(o,t.y)}else if(this.isOrthogonal){for(let t=0;t<e;t++){const e=l[t];a.x=Math.min(e.x,a.x),a.y=Math.min(e.y,a.y)}s=a.x,o=a.y}else{for(let t=3;t<e;t+=3){t+3>=e&&(t=e-1);const i=this.getPoint(t);a.x=Math.min(i.x,a.x),a.y=Math.min(i.y,a.y)}s=a.x,o=a.y}else{for(let t=0;t<e;t++){const e=l[t];a.x=Math.min(e.x,a.x),a.y=Math.min(e.y,a.y)}s=a.x,o=a.y}if(s-=this.c1.x,o-=this.c1.y,r.x-=s,r.y-=o,2!==e||this.Oa()){t.type=4;const n=xe.uC(t);if(0!==this.computeShortLength(!0)&&(r=this.Mf(r,!0,a)),n.fu(r.x,r.y,!1,!1),9===h&&e>=3&&!E.Y(this.smoothness,0))if(3===e){const t=this.getPoint(1),e=t.x-s,i=t.y-o;let r=this.getPoint(2).copy();r.x-=s,r.y-=o,0!==this.computeShortLength(!1)&&(r=this.Mf(r,!1,a)),n.mr(e,i,e,i,r.x,r.y)}else if(this.isOrthogonal){const t=T.X(s,o),e=T.l();e.a(this.getPoint(1));const i=T.X(s,o),r=T.X(s,o);let a=this.getPoint(0),l=null;const h=this.smoothness/3;for(let f=1;f<this.pointsCount-1;f++){l=this.getPoint(f);const u=a,c=l,d=this.getPoint(this.oN(l,f,!1));E.Y(u.x,c.x)&&E.Y(c.x,d.x)||E.Y(u.y,c.y)&&E.Y(c.y,d.y)||(this.eO(u,c,d,h,i,r),(1===f||2===f&&E.Y(a.x,this.getPoint(0).x)&&E.Y(a.y,this.getPoint(0).y))&&(e.x=.5*(a.x+l.x),e.y=.5*(a.y+l.y)),n.mr(e.x-s,e.y-o,i.x-s,i.y-o,l.x-s,l.y-o),t.set(i),e.set(r),a=l)}let u=a.x,c=a.y,d=this.getPoint(this.pointsCount-1);0!==this.computeShortLength(!1)&&(d=this.Mf(d.copy(),!1,T.Mo)),u=.5*(u+d.x),c=.5*(c+d.y),n.mr(r.x-s,r.y-o,u-s,c-o,d.x-s,d.y-o),T.s(t),T.s(e),T.s(i),T.s(r)}else for(let t=3;t<e;t+=3){const i=this.getPoint(t-2);t+3>=e&&(t=e-1);const r=this.getPoint(t-1);let a=this.getPoint(t);t===e-1&&0!==this.computeShortLength(!1)&&(a=this.Mf(a.copy(),!1,T.Mo)),n.mr(i.x-s,i.y-o,r.x-s,r.y-o,a.x-s,a.y-o)}else{const t=T.l();t.a(this.getPoint(0));const r=T.l();r.a(t);const a=this.computeCorner();let l=1,h=0;for(;l<e;){l=this.oN(t,l,l>1);let u=this.getPoint(l);if(l>=e-1){if(t.equals(u)){if(0===h)for(l=1;l<e;)r.a(t),u=this.getPoint(l++),this.Ln(n,-s,-o,t,u,i),t.a(u)}else 0!==this.computeShortLength(!1)&&(u=this.Mf(u.copy(),!1,T.Mo)),this.Ln(n,-s,-o,t,u,i);break}h=this.oN(u,l+1,l<e-3);const c=this.getPoint(h);this.sO(n,-s,-o,t,u,c,t,r,a,i),r.a(u),l=h}T.s(t)}return xe.dC(n),this.xh=!0,t}{let e=this.getPoint(1).copy();return e.x-=s,e.y-=o,0!==this.computeShortLength(!0)&&(r=this.Mf(r,!0,a)),0!==this.computeShortLength(!1)&&(e=this.Mf(e,!1,a)),t.type=1,t.startX=r.x,t.startY=r.y,t.endX=e.x,t.endY=e.y,this.xh=!0,t}}w1(t,e,i,n){let s=i-t;if(isNaN(s)||s===1/0||s===-1/0)return NaN;s<0&&(s=-s);let o=n-e;return isNaN(o)||o===1/0||o===-1/0?NaN:(o<0&&(o=-o),E.Y(s,0)?o:E.Y(o,0)?s:Math.sqrt(s*s+o*o))}eO(t,e,i,n,s,o){isNaN(n)&&(n=this.smoothness/3);const r=t.x,a=t.y,l=e.x,h=e.y,u=i.x,c=i.y,d=n*this.w1(r,a,l,h),f=n*this.w1(l,h,u,c);if(E.Y(a,h)&&E.Y(l,u)&&(l>r?c>h?(s.x=l-d,s.y=h-d,o.x=l+f,o.y=h+f):(s.x=l-d,s.y=h+d,o.x=l+f,o.y=h-f):c>h?(s.x=l+d,s.y=h-d,o.x=l-f,o.y=h+f):(s.x=l+d,s.y=h+d,o.x=l-f,o.y=h-f)),E.Y(r,l)&&E.Y(h,c)&&(h>a?u>l?(s.x=l-d,s.y=h-d,o.x=l+f,o.y=h+f):(s.x=l+d,s.y=h-d,o.x=l-f,o.y=h+f):u>l?(s.x=l-d,s.y=h+d,o.x=l+f,o.y=h-f):(s.x=l+d,s.y=h+d,o.x=l-f,o.y=h-f)),E.Y(r,l)&&E.Y(l,u)||E.Y(a,h)&&E.Y(h,c)){const t=.5*(r+u),e=.5*(a+c);s.x=t,s.y=e,o.x=t,o.y=e}}Mf(t,e,i){const n=this.pointsCount;if(n<2)return t;if(e){const e=this.getPoint(1),s=e.x-i.x,o=e.y-i.y,r=this.w1(t.x,t.y,s,o);if(0===r)return t;const a=2===n?.5*r:r;let l=this.computeShortLength(!0);l>a&&(l=a);const h=l*(s-t.x)/r,u=l*(o-t.y)/r;t.x+=h,t.y+=u}else{const e=this.getPoint(n-2),s=e.x-i.x,o=e.y-i.y,r=this.w1(t.x,t.y,s,o);if(0===r)return t;const a=2===n?.5*r:r;let l=this.computeShortLength(!1);l>a&&(l=a);const h=l*(t.x-s)/r,u=l*(t.y-o)/r;t.x-=h,t.y-=u}return t}oN(t,e,i){const n=this.pointsCount;let s=t;for(;E.Y(t.x,s.x)&&E.Y(t.y,s.y);){if(e>=n)return n-1;s=this.getPoint(e++)}if(!E.Y(t.x,s.x)&&!E.Y(t.y,s.y))return e-1;let o=s;for(;E.Y(t.x,s.x)&&E.Y(s.x,o.x)&&(!i||(t.y>=s.y?s.y>=o.y:s.y<=o.y))||E.Y(t.y,s.y)&&E.Y(s.y,o.y)&&(!i||(t.x>=s.x?s.x>=o.x:s.x<=o.x));){if(e>=n)return n-1;o=this.getPoint(e++)}return e-2}sO(t,e,i,n,s,o,r,a,l,h){if(E.u(n.y,s.y)&&E.u(s.x,o.x)){let u=Math.min(l,Math.abs(s.x-a.x)/2);const c=Math.min(u,Math.abs(o.y-s.y)/2);if(u=c,E.u(u,0))return this.Ln(t,e,i,n,s,h),void r.a(s);let d=s.x;const f=s.y,g=d;let m=f;s.x>n.x?(d=s.x-u,m=o.y>s.y?s.y+c:s.y-c):(d=s.x+u,m=o.y>s.y?s.y+c:s.y-c);const p=T.X(d,f);this.Ln(t,e,i,n,p,h),T.s(p),t.Mw(s.x+e,s.y+i,g+e,m+i),r.e(g,m)}else if(E.u(n.x,s.x)&&E.u(s.y,o.y)){let u=Math.min(l,Math.abs(s.y-a.y)/2);const c=Math.min(u,Math.abs(o.x-s.x)/2);if(u=c,E.u(c,0))return this.Ln(t,e,i,n,s,h),void r.a(s);const d=s.x;let f=s.y,g=d;const m=f;s.y>n.y?(f=s.y-u,g=o.x>s.x?s.x+c:s.x-c):(f=s.y+u,g=o.x>s.x?s.x+c:s.x-c);const p=T.X(d,f);this.Ln(t,e,i,n,p,h),T.s(p),t.Mw(s.x+e,s.y+i,g+e,m+i),r.e(g,m)}else this.Ln(t,e,i,n,s,h),r.a(s)}computeJumpLength(){return 10}Ln(t,e,i,n,s,o){if(o||!this.Oa())t.gr(s.x+e,s.y+i);else{const o=this.computeJumpLength(),r=o/2,a=[];let l=0;this.isVisible()&&(l=this.nO(n,s,a));let h=n.x,u=n.y;if(l>0)if(E.u(n.y,s.y))if(n.x<s.x){let c=0;for(;c<l;){const d=Math.max(n.x,Math.min(a[c++]-r,s.x-o));t.gr(d+e,s.y+i),h=d+e,u=s.y+i;let f=Math.min(d+o,s.x);for(;c<l;){const t=a[c];if(!(t<f+o))break;c++,f=Math.min(t+r,s.x)}const g=s.y-o+i,m=f+e,p=s.y+i;10===this.curve?t.fu(m,p,!1,!1):t.mr(h,g,m,g,m,p),h=m,u=p}}else{let c=l-1;for(;c>=0;){const l=Math.min(n.x,Math.max(a[c--]+r,s.x+o));t.gr(l+e,s.y+i),h=l+e,u=s.y+i;let d=Math.max(l-o,s.x);for(;c>=0;){const t=a[c];if(!(t>d-o))break;c--,d=Math.max(t-r,s.x)}const f=s.y-o+i,g=d+e,m=s.y+i;10===this.curve?t.fu(g,m,!1,!1):t.mr(h,f,g,f,g,m),h=g,u=m}}else if(E.u(n.x,s.x))if(n.y<s.y){let c=0;for(;c<l;){const d=Math.max(n.y,Math.min(a[c++]-r,s.y-o));t.gr(s.x+e,d+i),h=s.x+e,u=d+i;let f=Math.min(d+o,s.y);for(;c<l;){const t=a[c];if(!(t<f+o))break;c++,f=Math.min(t+r,s.y)}const g=s.x-o+e,m=s.x+e,p=f+i;10===this.curve?t.fu(m,p,!1,!1):t.mr(g,u,g,p,m,p),h=m,u=p}}else{let c=l-1;for(;c>=0;){const l=Math.min(n.y,Math.max(a[c--]+r,s.y+o));t.gr(s.x+e,l+i),h=s.x+e,u=l+i;let d=Math.max(l-o,s.y);for(;c>=0;){const t=a[c];if(!(t>d-o))break;c--,d=Math.max(t-r,s.y)}const f=s.x-o+e,g=s.x+e,m=d+i;10===this.curve?t.fu(g,m,!1,!1):t.mr(f,u,f,m,g,m),h=g,u=m}}t.gr(s.x+e,s.y+i)}}nO(t,e,i){const n=this.diagram;if(null===n||t.equals(e))return 0;const s=n.layers;for(;s.next();){const n=s.value;if(null!==n&&n.visible){const s=n.EM(),o=s.length;for(let n=0;n<o;n++){const o=s[n];if(!(o instanceof De))continue;if(o===this)return i.length>0&&i.sort(((t,e)=>t-e)),i.length;if(!o.isVisible()||!o.Oa())continue;const r=o.routeBounds;if(!r.isReal()||!this.routeBounds.intersectsRect(r)||this.usesSamePort(o))continue;const a=o.path;null!==a&&a.isVisibleObject()&&this.oO(t,e,i,o)}}}return i.length>0&&i.sort(((t,e)=>t-e)),i.length}oO(t,e,i,n){const s=E.u(t.y,e.y),o=n.pointsCount;let r=n.getPoint(0);const a=T.l();for(let l=1;l<o;l++){const h=n.getPoint(l);if(l<o-1){const t=n.getPoint(l+1);if(r.y===h.y&&h.y===t.y){if(h.x>r.x&&t.x>=h.x||h.x<r.x&&t.x<=h.x)continue}else if(r.x===h.x&&h.x===t.x&&(h.y>r.y&&t.y>=h.y||h.y<r.y&&t.y<=h.y))continue}this.rO(t,e,r,h,a)&&(s?i.push(a.x):i.push(a.y)),r=h}T.s(a)}rO(t,e,i,n,s){const o=t.x,r=t.y,a=e.x,l=e.y,h=i.x,u=i.y,c=n.x,d=n.y;if(E.u(o,a)){if(!E.u(r,l)&&E.u(u,d)&&Math.min(r,l)<u&&Math.max(r,l)>u&&Math.min(h,c)<o&&Math.max(h,c)>o&&!E.u(h,c))return s.x=o,s.y=u,!0}else if(E.u(r,l)&&E.u(h,c)&&Math.min(o,a)<h&&Math.max(o,a)>h&&Math.min(u,d)<r&&Math.max(u,d)>r&&!E.u(u,d))return s.x=h,s.y=r,!0;return s.x=0,s.y=0,!1}get firstPickIndex(){return this.pointsCount<=2?0:this.isOrthogonal||!this.Ed(this.computeSpot(!0))?1:0}get lastPickIndex(){const t=this.pointsCount;return 0===t?0:t<=2?t-1:this.isOrthogonal||!this.Ed(this.computeSpot(!1))?t-2:t-1}Oa(){const t=this.curve;return 11===t||10===t}d1(t){if(t||this.Oa()){const t=this.diagram;null!==t&&!t.animationManager.isTicking&&!t._l.contains(this)&&(0!==this.kf.width||0!==this.kf.height)&&t._l.add(this,this.kf.copy())}}invalidateOtherJumpOvers(t){const e=this.layer;if(null===e||!e.visible||e.isTemporary)return;const i=e.diagram;if(null===i||i.animationManager.isTicking)return;let n=!1;const s=i.layers;for(;s.next();){const i=s.value;if(i.visible)if(i===e){n=!0;let e=!1;const s=i.EM(),o=s.length;for(let i=0;i<o;i++){const n=s[i];n instanceof De&&(n===this?e=!0:e&&this.tT(n,t))}}else if(n){const e=i.EM(),n=e.length;for(let i=0;i<n;i++){const n=e[i];n instanceof De&&this.tT(n,t)}}}}tT(t,e){if(null===t||!t.xh||!t.Le||!t.Oa())return;const i=t.routeBounds;i.isReal()&&(!this.routeBounds.intersectsRect(i)&&!e.intersectsRect(i)||this.usesSamePort(t)||t.oe())}usesSamePort(t){const e=this.pointsCount,i=t.pointsCount;if(e>0&&i>0){const n=this.getPoint(0),s=t.getPoint(0);if(n.equalsApprox(s))return!0;const o=this.getPoint(e-1),r=t.getPoint(i-1);if(o.equalsApprox(r)||n.equalsApprox(r)||o.equalsApprox(s))return!0}else if(this.fromNode===t.fromNode||this.toNode===t.toNode||this.fromNode===t.toNode||this.toNode===t.fromNode)return!0;return!1}isVisible(){if(!super.isVisible())return!1;const t=this.containingGroup;let e=!0;const i=this.diagram;null!==i&&(e=i.isTreePathToChildren);const n=this.fromNode;if(null!==n){if(this.isTreeLink&&e&&!n.isTreeExpanded)return!1;if(n===t)return!0;let i=n;for(;null!==i;){if(i.labeledLink===this)return!0;i=i.containingGroup}const s=n.findVisibleNode();if(null===s||s===t)return!1}const s=this.toNode;if(null!==s){if(this.isTreeLink&&!e&&!s.isTreeExpanded)return!1;if(s===t)return!0;let i=s;for(;null!==i;){if(i.labeledLink===this)return!0;i=i.containingGroup}const n=s.findVisibleNode();if(null===n||n===t)return!1}return!0}Ei(t){if(super.Ei(t),t&&this.d1(!1),null!==this._o&&this._o.Td(),null!==this.qs){const e=this.qs.iterator;for(;e.next();)e.value.Ei(t)}}get adjusting(){return this.bf}set adjusting(t){const e=this.bf;e!==t&&(this.bf=t,this.t("adjusting",e,t))}computeAdjusting(){return this.isAvoiding&&null!==this.diagram&&this.diagram.animationManager.defaultAnimation.isAnimating?17:this.bf}get corner(){return this.Rd}set corner(t){const e=this.Rd;e!==t&&(this.Rd=t,this.oe(),this.t("corner",e,t))}get curve(){return this.vd}set curve(t){const e=this.vd;e!==t&&(this.vd=t,this.invalidateRoute(),this.oe(),this.d1(10===e||11===e||10===t||11===t),this.t("curve",e,t))}get curviness(){return this.Od}set curviness(t){const e=this.Od;e!==t&&(this.Od=t,this.invalidateRoute(),this.oe(),this.t("curviness",e,t))}get routing(){return this.Da}set routing(t){const e=this.Da;e!==t&&(this.Da=t,this.Qo=null,this.invalidateRoute(),this.d1(De.iN(e)||De.iN(t)),this.t("routing",e,t))}get smoothness(){return this.Id}set smoothness(t){const e=this.Id;e!==t&&(this.Id=t,this.oe(),this.t("smoothness",e,t))}wy(){const t=this.ho;if(null===t)return;const e=this.co;if(null===e||!isNaN(this.curviness))return;const i=this.ao,n=this.fo;let s=null,o=null;const r=t._t.r,a=r.length;for(let l=0;l<a;l++){const a=r[l];(a.ho!==t||a.ao!==i||a.co!==e||a.fo!==n)&&(a.ho!==e||a.ao!==n||a.co!==t||a.fo!==i)||(null===o?o=a:(null===s&&(s=[],s.push(o)),s.push(a)))}if(null!==s){let o=t.HA(e,i,n);null===o&&(o=new Fe(t,i,e,n),t.YA(o),e.YA(o)),o.Ws=s;for(let t=0;t<s.length;t++){s[t]._o=o}o.Td()}}yy(){const t=this._o;if(null!==t){if(!isNaN(this.curviness))return;this._o=null;const e=t.Ws.indexOf(this);e>=0&&(d._a(t.Ws,e),t.Td())}}Tl(){return!0}get key(){const t=this.diagram;if(null!==t&&t.model.Ta())return t.model.getKeyForLinkData(this.data)}}y(De,"Fa",null),y(De,"Ra",null),y(De,"Normal",1),y(De,"Orthogonal",2),y(De,"AvoidsNodes",6),y(De,"AvoidsNodesStraight",7),y(De,"None",0),y(De,"Bezier",9),y(De,"JumpGap",10),y(De,"JumpOver",11),y(De,"End",17),y(De,"Scale",18),y(De,"Stretch",19),y(De,"OrientAlong",21),y(De,"OrientPlus90",22),y(De,"OrientMinus90",23),y(De,"OrientOpposite",24),y(De,"OrientUpright",25),y(De,"OrientPlus90Upright",26),y(De,"OrientMinus90Upright",27),y(De,"OrientUpright45",28),y(De,"Bv",8),y(De,"zv",16),y(De,"Xv",14),y(De,"va",8);class Fe{constructor(t,e,i,n){y(this,"Uo",void 0),y(this,"Es",void 0),y(this,"ry",void 0),y(this,"q2",void 0),y(this,"l1",void 0),y(this,"W2",void 0),y(this,"Ws",void 0),k.Yi(this),this.Uo=!1,this.Es=!1,this.ry=t,this.q2=e,this.l1=i,this.W2=n,this.Ws=[]}Td(){if(!this.Uo){const t=this.Ws;if(t.length>0){const e=t[0].diagram;null!==e&&(e.nS.add(this),this.Es=e.undoManager.isUndoingRedoing)}}this.Uo=!0}yS(){if(this.Uo){this.Uo=!1;const t=this.Ws;if(t.length>0){const e=t[0],i=e.diagram,n=null===i||i.Uh&&!this.Es;this.Es=!1,e.arrangeBundledLinks(t,n),1===t.length&&(e._o=null,t.length=0)}0===t.length&&(this.ry.GA(this),this.l1.GA(this))}}}class Oe{constructor(t){y(this,"he",void 0),y(this,"ae",void 0),y(this,"Ia",void 0),y(this,"Ea",void 0),y(this,"yi",void 0),y(this,"wi",void 0),y(this,"Ot",void 0),y(this,"bh",void 0),y(this,"kh",void 0),y(this,"aa",void 0),y(this,"TS",void 0),y(this,"Uo",void 0),y(this,"by",void 0),y(this,"Xc",void 0),y(this,"DS",void 0),y(this,"FS",void 0),k.Yi(this),this.aa=null,this.TS=null,this.Uo=!0,this.by=!1,this.he=1,this.ae=1,this.Ia=-1,this.Ea=-1,this.yi=t.width,this.wi=t.height,this.Ot=null,this.bh=0,this.kh=0,this.Xc=11,this.DS=2*this.Xc,this.FS=2*this.Xc}bb(t){if(t.width<=0||t.height<=0)return;const e=t.x,i=t.y,n=t.x+t.width,s=t.y+t.height;this.he=Math.floor((e-this.yi)/this.yi)*this.yi,this.ae=Math.floor((i-this.wi)/this.wi)*this.wi,this.Ia=Math.ceil((n+2*this.yi)/this.yi)*this.yi,this.Ea=Math.ceil((s+2*this.wi)/this.wi)*this.wi;const o=1+(0|Math.ceil((this.Ia-this.he)/this.yi)),r=1+(0|Math.ceil((this.Ea-this.ae)/this.wi));if(null===this.Ot||this.bh<o-1||this.kh<r-1){const t=[];for(let e=0;e<=o;e++)t[e]=new Uint32Array(r);this.Ot=t,this.bh=o-1,this.kh=r-1}this.lO(Oe.rN)}get bounds(){return new D(this.he,this.ae,this.Ia-this.he,this.Ea-this.ae)}get cellWidth(){return this.yi}set cellWidth(t){t>0&&t!==this.yi&&(this.yi=t,this.bb(this.bounds))}get cellHeight(){return this.wi}set cellHeight(t){t>0&&t!==this.wi&&(this.wi=t,this.bb(this.bounds))}zd(t,e){return this.he<=t&&t<=this.Ia&&this.ae<=e&&e<=this.Ea}Wi(t,e){if(!this.zd(t,e))return Oe.rN;t-=this.he,t/=this.yi,e-=this.ae;const i=0|t,n=0|(e/=this.wi);return this.Ot[i][n]}pR(t,e,i,n){if(!this.zd(t,e))return;const s=(t-this.he)/this.yi|0,o=(e-this.ae)/this.wi|0,r=(t+i-this.he)/this.yi|0,a=(e+n-this.ae)/this.wi|0,l=Math.min(r,this.bh),h=Math.min(a,this.kh);for(let u=s;u<=l;u++){const t=this.Ot[u];if(t.fill)t.fill(Oe.Js,o,h+1);else for(let e=o;e<=h;e++)t[e]=Oe.Js}}lO(t){if(null!==this.Ot)for(let e=0;e<=this.bh;e++){const i=this.Ot[e];if(i.fill)i.fill(t);else for(let e=0;e<=this.kh;e++)i[e]=t}}EL(){if(null!==this.Ot)for(let t=0;t<=this.bh;t++){const e=this.Ot[t];for(let t=0;t<=this.kh;t++)e[t]>=Oe.uo&&(e[t]=Oe.rN)}}hO(t,e){return this.Wi(t,e)===Oe.Js}isUnoccupied(t,e,i,n){if(t>this.Ia||t+i<this.he||e>this.Ea||e+n<this.ae)return!0;let s=(t-this.he)/this.yi|0,o=(e-this.ae)/this.wi|0,r=Math.max(0,i)/this.yi+1|0,a=Math.max(0,n)/this.wi+1|0;if(s<0&&(r+=s,s=0),o<0&&(a+=o,o=0),r<0||a<0)return!0;const l=0|Math.min(s+r-1,this.bh),h=0|Math.min(o+a-1,this.kh);for(let u=s;u<=l;u++){const t=this.Ot[u];for(let e=o;e<=h;e++)if(t[e]===Oe.Js)return!1}return!0}maxUnoccupiedH(t,e,i,n){if(t>this.Ia||e<this.he||i>this.Ea||i<this.ae)return 0;const s=(t-this.he)/this.yi|0,o=(e-this.he)/this.yi|0,r=(i-this.ae)/this.wi|0,a=n/this.wi+1|0;let l;for(l=0;l<a/2;l++){let t=!1;for(let e=s;e<=o;e++)if(this.Ot[e][r+l]===Oe.Js||this.Ot[e][r-l]===Oe.Js){t=!0;break}if(t)return Math.max(0,(2*l-1)*this.wi)}return n}maxUnoccupiedV(t,e,i,n){if(t>this.Ea||e<this.ae||i>this.Ia||i<this.he)return 0;const s=(t-this.ae)/this.wi|0,o=(e-this.ae)/this.wi|0,r=(i-this.he)/this.yi|0,a=n/this.yi+1|0;let l;for(l=0;l<a/2;l++){let t=!1;for(let e=s;e<=o;e++)if(this.Ot[r+l][e]===Oe.Js||this.Ot[r-l][e]===Oe.Js){t=!0;break}if(t)return Math.max(0,(2*l-1)*this.yi)}return n}aO(t,e,i,n,s,o,r,a){t|=0,e|=0;let l=this.Ot[t][e];if(l>=Oe.uo&&l<Oe.Bd)for(n?e+=i:t+=i,l+=1;s<=t&&t<=o&&r<=e&&e<=a;){if(l>=this.Ot[t][e])break;this.Ot[t][e]=l,l+=1,n?e+=i:t+=i}return n?e:t}go(t,e,i,n,s,o,r,a){if(t<s||t>o||e<r||e>a)return;const l=this.aO(t,e,i,n,s,o,r,a);if(n)if(i>0)for(let h=e+i;h<l;h+=i)this.go(t,h,1,!n,s,o,r,a),this.go(t,h,-1,!n,s,o,r,a);else for(let h=e+i;h>l;h+=i)this.go(t,h,1,!n,s,o,r,a),this.go(t,h,-1,!n,s,o,r,a);else if(i>0)for(let h=t+i;h<l;h+=i)this.go(h,e,1,!n,s,o,r,a),this.go(h,e,-1,!n,s,o,r,a);else for(let h=t+i;h>l;h+=i)this.go(h,e,1,!n,s,o,r,a),this.go(h,e,-1,!n,s,o,r,a)}b1(t,e,i,n,s,o,r,a,l,h){let u=0|t,c=0|e,d=Oe.Js,f=Oe.uo;for(this.Ot[u][c]=f;d===Oe.Js&&u>r&&u<a&&c>l&&c<h;)f+=1,this.Ot[u][c]=f,o?c+=s:u+=s,d=this.Ot[u][c];return o?c:u}k1(t,e,i,n,s,o,r,a,l,h){let u=0|i,c=0|n,d=Oe.Js;const f=Oe.Bd;for(this.Ot[u][c]=f;d===Oe.Js&&u>r&&u<a&&c>l&&c<h;)this.Ot[u][c]=f,o?c+=s:u+=s,d=this.Ot[u][c]}iT(t,e,i,n,s,o){if(null===this.Ot)return;this.by=!1;let r=t.x,a=t.y;if(!this.zd(r,a))return;r-=this.he,r/=this.yi,a-=this.ae,a/=this.wi;let l=i.x,h=i.y;if(!this.zd(l,h))return;if(l-=this.he,l/=this.yi,h-=this.ae,h/=this.wi,Math.abs(r-l)<=1&&Math.abs(a-h)<=1)return void(this.by=!0);let u=s.x,c=s.y,f=s.x+s.width,g=s.y+s.height;u-=this.he,u/=this.yi,c-=this.ae,c/=this.wi,f-=this.he,f/=this.yi,g-=this.ae,g/=this.wi;const m=Math.max(0,Math.min(this.bh,0|u)),p=Math.min(this.bh,Math.max(0,0|f)),y=Math.max(0,Math.min(this.kh,0|c)),v=Math.min(this.kh,Math.max(0,0|g)),b=90,x=270,w=this.Ot,k=0|r,S=0|a,P=0|l,M=0|h,C=0===e||e===b?1:-1,N=e===b||e===x;w[k][S]===Oe.Js?(this.b1(k,S,P,M,C,N,m,p,y,v),this.b1(k,S,P,M,1,!N,m,p,y,v),this.b1(k,S,P,M,-1,!N,m,p,y,v)):this.b1(k,S,P,M,C,N,k,S,k,S),w[P][M]===Oe.Js?(this.k1(k,S,P,M,0===n||n===b?1:-1,n===b||n===x,m,p,y,v),this.k1(k,S,P,M,1,!(n===b||n===x),m,p,y,v),this.k1(k,S,P,M,-1,!(n===b||n===x),m,p,y,v)):this.k1(k,S,P,M,C,N,P,M,P,M);const L=d.rt();if(o&&this.eT(P,M,n,k,S,L)){(L[0]!==P||L[1]!==M)&&(L.unshift(M),L.unshift(P)),(L[L.length-2]!==k||L[L.length-1]!==S)&&(L.push(k),L.push(S));let t=Oe.uo,e=L[L.length-2],i=L[L.length-1];w[e][i]=t++;for(let n=L.length-4;n>=0;n-=2){e=L[n+2],i=L[n+3];const s=L[n],o=L[n+1];for(;s>e?e++:s<e?e--:o>i?i++:o<i&&i--,w[e][i]=t++,e!==s||i!==o;);}}else this.go(k,S,1,!1,m,p,y,v),this.go(k,S,-1,!1,m,p,y,v),this.go(k,S,1,!0,m,p,y,v),this.go(k,S,-1,!0,m,p,y,v);d.it(L)}eT(t,e,i,n,s,o){const r=this.Ot;let a=t,l=e;for(;;){if(a===n&&l===s)return!0;let t=a,e=l;if(0===i){if(!(t<n))break;t++}else if(90===i){if(!(e<s))break;e++}else if(180===i){if(!(t>n))break;t--}else{if(!(e>s))break;e--}const o=r[t][e];if(0===o||o===Oe.lN)break;a=t,l=e}for(;;){let h=i,u=a,c=l;0===i?c<s?(h=90,c++):c>s&&(h=270,c--):90===i?u<n?(h=0,u++):u>n&&(h=180,u--):180===i?c<s?(h=90,c++):c>s&&(h=270,c--):u<n?(h=0,u++):u>n&&(h=180,u--);const d=r[u][c];if(h!==i&&0!==d&&d!==Oe.lN){if(o.push(a),o.push(l),this.eT(a,l,h,n,s,o))return!0;o.pop(),o.pop()}if(r[a][l]=Oe.lN,0===i){if(a===t)return!1;a--}else if(90===i){if(l===e)return!1;l--}else if(180===i){if(a===t)return!1;a++}else{if(l===e)return!1;l++}}}}h=Oe,y(Oe,"Js",0),y(Oe,"uo",1),y(Oe,"Bd",999999),y(Oe,"rN",h.Bd+1),y(Oe,"lN",h.Bd+2);class Re{constructor(){y(this,"me",void 0),y(this,"tr",void 0),y(this,"hs",void 0),y(this,"Xd",void 0),k.Yi(this),this.me=null,this.tr=null,this.hs=[],this.Xd=!1}toString(){const t=this.hs;let e=this.me.toString()+" "+t.length.toString()+":";for(let i=0;i<t.length;i++){const n=t[i];null!==n&&(e+="\n  "+n.toString())}return e}cO(t,e,i,n){const s=e.offsetY;switch(s){case 8:return 90;case 2:return 180;case 1:return 270;case 4:return 0}let o=i;switch(s){case 9:return o>180?270:90;case 6:return o>90&&o<=270?180:0}const r=180*Math.atan2(t.height,t.width)/Math.PI;switch(s){case 3:return o>r&&o<=180+r?180:270;case 5:return o>180-r&&o<=360-r?270:0;case 12:return o>r&&o<=180+r?90:0;case 10:return o>180-r&&o<=360-r?180:90;case 7:return o>90&&o<=180+r?180:o>180+r&&o<=360-r?270:0;case 13:return o>180&&o<=360-r?270:o>r&&o<=180?90:0;case 14:return o>r&&o<=180-r?90:o>180-r&&o<=270?180:0;case 11:return o>180-r&&o<=180+r?180:o>180+r?270:90}return n&&15!==s&&(o-=15,o<0&&(o+=360)),o>r&&o<180-r?90:o>=180-r&&o<=180+r?180:o>180+r&&o<360-r?270:0}Td(){this.hs.length=0}_A(t){let e=this.hs;0===e.length&&(this.fO(),e=this.hs);for(let i=0;i<e.length;i++){const n=e[i];if(null!==n&&n.We===t)return n}return null}fO(){if(!this.Xd){const t=this.Xd;this.Xd=!0;let e,i=null;const n=this.me,s=n instanceof Ve?n:null;if(null===s||s.isSubGraphExpanded)e=n.isTreeExpanded?n.findLinksConnected(this.tr.portId):n.findExternalTreeLinksConnected();else{if(!s.actualBounds.isReal())return this.Xd=t,this.hs;i=s,e=i.findExternalLinksConnected()}this.hs.length=0;let o=0;const r=this.tr.getDocumentPoint(O.TopLeft,T.l()),a=this.tr.getDocumentPoint(O.BottomRight,T.l()),l=D.X(r.x,r.y,0,0);l.unionPoint(a),T.s(r),T.s(a);const h=T.X(l.x+l.width/2,l.y+l.height/2),u=this.tr.getDocumentAngle(),c=e.iterator;for(;c.next();){const t=c.value;if(!t.isVisible()||t.fromPort===t.toPort)continue;const e=t.fromPort===this.tr||null!==t.fromNode&&t.fromNode.isMemberOf(i),n=t.computeSpot(e,this.tr);if(!n.isSide())continue;let s;if(s=e?t.toPort:t.fromPort,null===s)continue;let r=s.part;if(null===r)continue;const a=r.findVisibleNode();null!==a&&a!==r&&(r=a,s=r.port);const d=t.computeOtherPoint(r,s);let f=h.directionPoint(d);f-=u,f<0?f+=360:f>=360&&(f-=360);const g=this.cO(l,n,f,t.isOrthogonal);let m=0;0===g?(m=4,f>180&&(f-=360)):90===g?(m=8,f>270&&(f-=360)):180===g?m=2:(m=1,f<90&&(f+=360));let p=this.hs[o];void 0===p?(p=new Ee(t,f,m),this.hs[o]=p):(p.We=t,p.Xt=f,p.we=m),p.P1.set(d),o++}T.s(h),this.uO();const d=this.hs.length;let f=-1,g=0;for(o=0;o<d;o++){const t=this.hs[o];void 0!==t&&(t.we!==f&&(f=t.we,g=0),t.Kd=g,g++)}for(f=-1,g=0,o=d-1;o>=0;o--){const t=this.hs[o];void 0!==t&&(t.we!==f&&(f=t.we,g=t.Kd+1),t.Pf=g)}this.dO(this.hs),this.gO(this.hs),this.Xd=t,D.s(l)}return this.hs}mO(t,e){return t===e?0:null===t?-1:null===e?1:t.we<e.we?-1:t.we>e.we?1:t.Xt<e.Xt?-1:t.Xt>e.Xt?1:0}uO(){this.hs.sort(Re.prototype.mO)}dO(t){const e=this.tr,i=this.me.portSpreading,n=T.l(),s=T.l(),o=T.l(),r=T.l();e.getDocumentPoint(O.TopLeft,n),e.getDocumentPoint(O.TopRight,s),e.getDocumentPoint(O.BottomRight,o),e.getDocumentPoint(O.BottomLeft,r);let a=0,l=0,h=0,u=0;if(2===i)for(let v=0;v<t.length;v++){const e=t[v];if(null===e)continue;const i=e.We.computeThickness();switch(e.we){case 8:h+=i;break;case 2:u+=i;break;case 1:a+=i;break;default:l+=i}}let c,d,f=0,g=0,m=1,p=0,y=0;for(let v=0;v<t.length;v++){const e=t[v];if(null===e)continue;if(f!==e.we){switch(f=e.we,f){case 8:c=o,d=r;break;case 2:c=r,d=n;break;case 1:c=n,d=s;break;default:c=s,d=o}switch(p=d.x-c.x,y=d.y-c.y,f){case 8:h>Math.abs(p)?(m=Math.abs(p)/h,h=Math.abs(p)):m=1;break;case 2:u>Math.abs(y)?(m=Math.abs(y)/u,u=Math.abs(y)):m=1;break;case 1:a>Math.abs(p)?(m=Math.abs(p)/a,a=Math.abs(p)):m=1;break;default:l>Math.abs(y)?(m=Math.abs(y)/l,l=Math.abs(y)):m=1}g=0}const b=e.Vd;if(2===i){let t=e.We.computeThickness();switch(t*=m,b.set(c),f){case 8:b.x=c.x+p/2+h/2-g-t/2;break;case 2:b.y=c.y+y/2+u/2-g-t/2;break;case 1:b.x=c.x+p/2-a/2+g+t/2;break;default:b.y=c.y+y/2-l/2+g+t/2}g+=t}else{let t=.5;1===i&&(t=(e.Kd+1)/(e.Pf+1)),b.x=c.x+p*t,b.y=c.y+y*t}}T.s(n),T.s(s),T.s(o),T.s(r)}gO(t){for(let e=0;e<t.length;e++){const i=t[e];null!==i&&(i.p1=this.pO(i))}}pO(t){const e=t.We,i=e.fromPort===this.tr,n=e.computeEndSegmentLength(this.me,this.tr,O.None,i);let s=t.Kd;if(s<0)return n;const o=t.Pf;if(o<=1||!e.isOrthogonal)return n;const r=t.P1,a=t.Vd;(2===t.we||8===t.we)&&(s=o-1-s);const l=De.Bv,h=2===t.we||4===t.we;return(h?r.y<a.y:r.x<a.x)?n+s*l:(h?r.y===a.y:r.x===a.x)?n:n+(o-1-s)*l}}class Ee{constructor(t,e,i){y(this,"We",void 0),y(this,"Xt",void 0),y(this,"we",void 0),y(this,"P1",void 0),y(this,"Kd",void 0),y(this,"Pf",void 0),y(this,"Vd",void 0),y(this,"p1",void 0),this.We=t,this.Xt=e,this.we=i,this.P1=new T,this.Kd=0,this.Pf=0,this.Vd=new T,this.p1=0}toString(){return this.We.toString()+" "+this.Xt.toString()+" "+this.we.toString()+":"+this.Kd.toString()+"/"+this.Pf.toString()+" "+this.Vd.toString()+" "+this.p1.toString()+" "+this.P1.toString()}}class Be{constructor(){y(this,"fa",void 0),y(this,"ua",void 0),y(this,"da",void 0),y(this,"ga",void 0),y(this,"ma",void 0),y(this,"pa",void 0),y(this,"I0",void 0),y(this,"v0",void 0),y(this,"E0",void 0),y(this,"O0",void 0),this.fa=O.Default,this.ua=O.Default,this.da=NaN,this.ga=NaN,this.ma=NaN,this.pa=NaN,this.I0=null,this.v0=null,this.E0=1/0,this.O0=1/0}copy(){const t=new Be;return t.fa=this.fa.N(),t.ua=this.ua.N(),t.da=this.da,t.ga=this.ga,t.ma=this.ma,t.pa=this.pa,t.I0=this.I0,t.v0=this.v0,t.E0=this.E0,t.O0=this.O0,t}}class Ie{constructor(){y(this,"C0",void 0),y(this,"L0",void 0),y(this,"A0",void 0),y(this,"N0",void 0),y(this,"xp",void 0),y(this,"bp",void 0),this.C0=-1/0,this.L0=0,this.A0=T.Mo,this.N0=0,this.xp="None",this.bp="None"}copy(){const t=new Ie;return t.C0=this.C0,t.L0=this.L0,t.A0=this.A0.N(),t.N0=this.N0,t.xp=this.xp,t.bp=this.bp,t}}class Ve extends Ce{constructor(t,e){void 0===t||t instanceof te||"number"==typeof t||"string"==typeof t?(super(t),y(this,"Yd",void 0),y(this,"It",void 0),y(this,"ha",void 0),y(this,"d0",void 0),y(this,"si",void 0),y(this,"ee",void 0)):(super(),y(this,"Yd",void 0),y(this,"It",void 0),y(this,"ha",void 0),y(this,"d0",void 0),y(this,"si",void 0),y(this,"ee",void 0),t&&(e=t)),this.E=4608|this.E,this.Yd=new k,this.It=null,this.ee=new je,this.ee.group=this,this.ha=new k,this.d0=null,this.si=null,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),this.E=-32769&this.E;const e=t.findInVisualTree((t=>t instanceof ze));t.It=e instanceof ze?e:null,null!==this.ee?(t.ee=this.ee.copy(),t.ee.group=t):(null!==t.ee&&(t.ee.group=null),t.ee=null),null!==this.si&&(t.si=this.si.copy())}Xo(t){super.Xo(t);const e=t.findSubGraphParts(),i=t.memberParts;for(;i.next();){const t=i.value;if(t.c(),t.invalidateLayout(8),t.clearAdornments(),t instanceof Ce)t.invalidateConnectedLinks(e);else if(t instanceof De){const i=t.labelNodes;for(;i.next();)i.value.invalidateConnectedLinks(e)}}}qc(t,e,i,n,s,o,r){if(3===t&&"elements"===e){if(s instanceof ze)null===this.It?this.It=s:this.It!==s&&d.o("Cannot insert a second Placeholder into the visual tree of a Group.");else if(s instanceof ie){const t=s.findInVisualTree((t=>t instanceof ze));t instanceof ze&&(null===this.It?this.It=t:this.It!==t&&d.o("Cannot insert a second Placeholder into the visual tree of a Group."))}}else 4===t&&"elements"===e&&null!==this.It&&(n===this.It||n instanceof ie&&this.It.isContainedBy(n))&&(this.It=null);super.qc(t,e,i,n,s,o,r)}ed(t,e){if(super.ed(t,e),this.isClipping&&this.type!==ie.Spot&&this.isSubGraphExpanded){let t=this.resizeObject;t instanceof ie&&(t=t.findMainElement()),null===this.si&&(this.si=new D),t.getDocumentBounds(this.si),t instanceof le&&this.si.inflate(-t.strokeWidth,-t.strokeWidth)}}ch(t,e,i,n){this.hasPlaceholder()&&(this.Zo=this.placeholder),super.ch(t,e,i,n)}ensureBounds(){const t=this;t.isSubGraphExpanded&&this.memberParts.each((e=>{!t.computesBoundsIncludingLinks&&e instanceof De||e.ensureBounds()})),super.ensureBounds()}Jr(){if(!super.Jr())return!1;const t=this.memberParts;for(;t.next();){const e=t.value;if(e instanceof Ce){if(!e.isVisible())continue;if(e.ss())return!1}else if(e instanceof De){if(!e.isVisible())continue;if(e.ss()&&e.fromNode!==this&&e.toNode!==this)return!1}}return!0}hasPlaceholder(){return null!==this.It&&this.It.isVisibleObject()&&this.isSubGraphExpanded}get placeholder(){return this.It}get computesBoundsAfterDrag(){return 0!==(2048&this.E)}set computesBoundsAfterDrag(t){const e=0!==(2048&this.E);e!==t&&(d.i(t,"boolean",Ve,"computesBoundsAfterDrag"),this.E=2048^this.E,this.t("computesBoundsAfterDrag",e,t))}get computesBoundsIncludingLinks(){return 0!==(4096&this.E)}set computesBoundsIncludingLinks(t){d.i(t,"boolean",Ve,"computesBoundsIncludingLinks");const e=0!==(4096&this.E);e!==t&&(this.E=4096^this.E,this.t("computesBoundsIncludingLinks",e,t))}get computesBoundsIncludingLocation(){return 0!==(8192&this.E)}set computesBoundsIncludingLocation(t){d.i(t,"boolean",Ve,"computesBoundsIncludingLocation");const e=0!==(8192&this.E);e!==t&&(this.E=8192^this.E,this.t("computesBoundsIncludingLocation",e,t))}get handlesDragDropForMembers(){return 0!==(16384&this.E)}set handlesDragDropForMembers(t){d.i(t,"boolean",Ve,"handlesDragDropForMembers");const e=0!==(16384&this.E);e!==t&&(this.E=16384^this.E,this.t("handlesDragDropForMembers",e,t))}get avoidableMembers(){return 0!==(131072&this.E)}set avoidableMembers(t){d.i(t,"boolean",Ve,"avoidableMembers");const e=0!==(131072&this.E);e!==t&&(this.E=131072^this.E,this.t("avoidableMembers",e,t))}get memberParts(){return this.Yd.iterator}Y2(t){if(this.Yd.add(t)){t instanceof Ve&&this.ha.add(t);const e=this.memberAdded;if(null!==e){let i=!0;const n=this.diagram;null!==n&&(i=n.G,n.G=!0),e(this,t),null!==n&&(n.G=i)}(!this.isVisible()||!this.isSubGraphExpanded)&&t.Ei(!1)}if(t instanceof De&&!this.computesBoundsIncludingLinks)return;let e=this.It;null===e&&(e=this),e.c()}K2(t){if(this.Yd.remove(t)){t instanceof Ve&&this.ha.remove(t);const e=this.memberRemoved;if(null!==e){let i=!0;const n=this.diagram;null!==n&&(i=n.G,n.G=!0),e(this,t),null!==n&&(n.G=i)}(!this.isVisible()||!this.isSubGraphExpanded)&&t.Ei(!0)}if(t instanceof De&&!this.computesBoundsIncludingLinks)return;let e=this.It;null===e&&(e=this),e.c()}Bc(){if(this.Yd.count>0){const t=this.diagram;if(null!==t){const e=this.Yd.copy().iterator;for(;e.next();){const i=e.value;t.remove(i)}}}super.Bc()}get layout(){return this.ee}set layout(t){const e=this.ee;if(e!==t){null!==t&&null!==t.diagram&&t.diagram.layout===t&&d.o("A layout cannot be both the Diagram.layout and a Group.layout: "+t),null!==e&&(e.diagram=null,e.group=null),this.ee=t;const i=this.diagram;null!==t&&(t.diagram=i,t.group=this),null!==i&&(i.Gr=!0),this.t("layout",e,t),null!==i&&i.requestUpdate()}}get memberAdded(){return null!==this.gt?this.gt.uy:null}set memberAdded(t){const e=this.memberAdded;e!==t&&(null!==t&&d.i(t,"function",Ve,"memberAdded"),this.dl(),this.gt.uy=t,this.t("memberAdded",e,t))}get memberRemoved(){return null!==this.gt?this.gt.gy:null}set memberRemoved(t){const e=this.memberRemoved;e!==t&&(null!==t&&d.i(t,"function",Ve,"memberRemoved"),this.dl(),this.gt.gy=t,this.t("memberRemoved",e,t))}get memberValidation(){return null!==this.gt?this.gt.nh:null}set memberValidation(t){const e=this.memberValidation;e!==t&&(null!==t&&d.i(t,"function",Ve,"memberValidation"),this.dl(),this.gt.nh=t,this.t("memberValidation",e,t))}canAddMembers(t){const e=this.diagram;if(null===e)return!1;const i=e.commandHandler,n=i.QS(t).iterator;for(;n.next();){const t=n.value;if(!i.isValidMember(this,t))return!1}return!0}addMembers(t,e){const i=this.diagram;if(null===i)return!1;const n=i.commandHandler;let s=!0;const o=n.QS(t).iterator;for(;o.next();){const t=o.value;!e||n.isValidMember(this,t)?t.containingGroup=this:s=!1}return s}get ungroupable(){return 0!==(256&this.E)}set ungroupable(t){const e=0!==(256&this.E);e!==t&&(d.i(t,"boolean",Ve,"ungroupable"),this.E=256^this.E,this.t("ungroupable",e,t))}canUngroup(){if(!this.ungroupable)return!1;const t=this.layer;if(null===t||!t.allowUngroup)return!1;const e=t.diagram;return!(null!==e&&!e.allowUngroup)}invalidateConnectedLinks(t){const e=this.yO();if(super.invalidateConnectedLinks(t),e)return;this.yL(!0);const i=this.findExternalLinksConnected();for(;i.next();){const e=i.value;if(void 0!==t&&t.contains(e))continue;const n=e.fromNode;if(null!==n&&n!==this&&n.isMemberOf(this)&&!n.isVisible())n.ye(e.fromPort),n.ye(e.toPort),e.invalidateRoute();else{const t=e.toNode;null!==t&&t!==this&&t.isMemberOf(this)&&!t.isVisible()&&(t.ye(e.fromPort),t.ye(e.toPort),e.invalidateRoute())}}}findExternalLinksConnected(){const t=null!==this.diagram&&this.diagram.cS;if(t&&null!==this.d0)return this.d0.iterator;const e=this.findSubGraphParts();e.add(this);const i=new k,n=e.iterator;for(;n.next();){const t=n.value;if(!(t instanceof Ce))continue;const s=t.linksConnected;for(;s.next();){const t=s.value;e.contains(t)||i.add(t)}}return t&&(this.d0=i),i.iterator}findExternalNodesConnected(){const t=this.findSubGraphParts();t.add(this);const e=new k,i=t.iterator;for(;i.next();){const n=i.value;if(!(n instanceof Ce))continue;const s=n.linksConnected;for(;s.next();){const i=s.value,n=i.fromNode;null!==n&&(!t.contains(n)||n===this)&&e.add(n);const o=i.toNode;null!==o&&(!t.contains(o)||o===this)&&e.add(o)}}return e.iterator}gE(){const t=new k;return function t(e,i){null!==e&&(i.add(e),t(e.containingGroup,i))}(this,t),t}findSubGraphParts(){const t=new k;return ke.oh(t,this,!0,0,!0),t.remove(this),t}Ei(t){super.Ei(t);const e=this.memberParts;for(;e.next();)e.value.Ei(t)}collapseSubGraph(){const t=this.diagram;if(null===t||t.isCollapsingExpanding)return;t.isCollapsingExpanding=!0;const e=this.findSubGraphParts();this.sT(e,t,this),t.isCollapsingExpanding=!1}sT(t,e,i){const n=this.memberParts;for(;n.next();){const s=n.value;if(s.Ei(!1),s instanceof Ve&&s.isSubGraphExpanded&&(s.wasSubGraphExpanded=s.isSubGraphExpanded,s.sT(t,e,i)),s instanceof Ce)s.invalidateConnectedLinks(t),e.Sc(s,i);else if(s instanceof De){const e=s.labelNodes;for(;e.next();)e.value.invalidateConnectedLinks(t)}}this.isSubGraphExpanded=!1}expandSubGraph(){const t=this.diagram;if(null===t||t.isCollapsingExpanding)return;t.isCollapsingExpanding=!0;const e=this.findSubGraphParts();this.nT(e,t,this),t.isCollapsingExpanding=!1}nT(t,e,i){const n=this.memberParts;for(;n.next();){const s=n.value;if(s.Ei(!0),s instanceof Ve&&s.wasSubGraphExpanded&&(s.wasSubGraphExpanded=!1,s.nT(t,e,i)),s instanceof Ce)s.invalidateConnectedLinks(t);else if(s instanceof De){const e=s.labelNodes;for(;e.next();)e.value.invalidateConnectedLinks(t)}}this.isSubGraphExpanded=!0}get isSubGraphExpanded(){return 0!==(512&this.E)}set isSubGraphExpanded(t){const e=0!==(512&this.E);if(e!==t){d.i(t,"boolean",Ve,"isSubGraphExpanded"),this.E=512^this.E;const i=this.diagram;this.t("isSubGraphExpanded",e,t);const n=this.subGraphExpandedChanged;if(null!==n){let t=!0;null!==i&&(t=i.G,i.G=!0),n(this),null!==i&&(i.G=t)}if(null!==i&&i.undoManager.isUndoingRedoing)return null!==this.It&&this.It.c(),void this.memberParts.each((t=>t.updateAdornments()));t?this.expandSubGraph():this.collapseSubGraph()}}get wasSubGraphExpanded(){return 0!==(1024&this.E)}set wasSubGraphExpanded(t){const e=0!==(1024&this.E);e!==t&&(d.i(t,"boolean",Ve,"wasSubGraphExpanded"),this.E=1024^this.E,this.t("wasSubGraphExpanded",e,t))}get subGraphExpandedChanged(){return null!==this.gt?this.gt.my:null}set subGraphExpandedChanged(t){const e=this.subGraphExpandedChanged;e!==t&&(null!==t&&d.i(t,"function",Ve,"subGraphExpandedChanged"),this.dl(),this.gt.my=t,this.t("subGraphExpandedChanged",e,t))}move(t,e){void 0===e&&(e=!1);const i=e?this.location:this.position,n=i.x,s=i.y,o=t.x,r=t.y;if((n===o||isNaN(n)&&isNaN(o))&&(s===r||isNaN(s)&&isNaN(r)))return;const a=o-(isNaN(n)?0:n),l=r-(isNaN(s)?0:s),h=T.l();super.move(t,e);const u=new k,c=this.findSubGraphParts().iterator;for(;c.next();){const t=c.value;t instanceof De&&(t.dn&&u.add(t),(t.Le||t.fromNode!==this&&t.toNode!==this)&&(t.dn=!0))}for(c.reset();c.next();){const t=c.value;if(t.Tl()||t instanceof Ce&&t.isLinkLabel)continue;const e=t.position,i=t.location;e.isReal()?(h.x=e.x+a,h.y=e.y+l,t.position=h):i.isReal()&&(h.x=i.x+a,h.y=i.y+l,t.location=h)}for(c.reset();c.next();){const t=c.value;if(!(t instanceof De)||(t.dn=u.contains(t),!t.Le&&(t.fromNode===this||t.toNode===this)))continue;const e=t.position;h.x=e.x+a,h.y=e.y+l,h.isReal()?t.move(h):t.invalidateRoute()}T.s(h)}yO(){return 0!==(65536&this.E)}yL(t){0!==(65536&this.E)!==t&&(this.E=65536^this.E)}get Qr(){return 0!==(32768&this.E)}set Qr(t){0!==(32768&this.E)!==t&&(this.E=32768^this.E)}}class ze extends Kt{constructor(t){super(),y(this,"Zt",void 0),y(this,"Gd",void 0),this.Zt=F.Ug,this.Gd=new D(NaN,NaN,NaN,NaN),t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Zt=this.Zt.N(),t.Gd=this.Gd.copy()}ah(t){if(null===this.background)return!1;const e=this.naturalBounds;return D.contains(0,0,e.width,e.height,t.x,t.y)}_u(t,e,i,n){const s=this.part;if((null===s||!(s instanceof Ve)&&!(s instanceof Pe))&&d.o("Placeholder is not inside a Group or Adornment."),s instanceof Ve){const t=this.computeBorder(this.Gd),e=this.minSize,i=isFinite(e.width)?Math.max(e.width,t.width):t.width,n=isFinite(e.height)?Math.max(e.height,t.height):t.height,o=this.Bi;o.So(i||0,n||0),this._n(0,0,o.width,o.height);const r=s.memberParts;let a=!1;for(;r.next();)if(r.value.isVisible()){a=!0;break}const l=s.diagram;if(a&&null!==l&&!l.animationManager.CM(s)&&!isNaN(t.x)&&!isNaN(t.y)){const e=T.l();e.setRectSpot(t,s.locationSpot),s.location=e,T.s(e)}}else{const t=s,e=this.Bi,i=this.Zt,n=i.left+i.right,o=i.top+i.bottom,r=t.adornedObject,a=r.getDocumentAngle();t.angle=a;let l=0;r instanceof le&&(l=r.strokeWidth);const h=r.getDocumentScale(),u=r.naturalBounds,c=(u.width+l)*h,d=(u.height+l)*h;if(t.type!==ie.Link){const e="Selection"===t.category?O.TopLeft:t.locationSpot,i=r.getDocumentPoint(e,T.l());t.location=i,T.s(i)}if(isNaN(c)||isNaN(d)){const t=r.getDocumentPoint(O.TopLeft,T.l()),s=D.X(t.x,t.y,0,0);s.unionPoint(r.getDocumentPoint(O.BottomRight,t)),s.unionPoint(r.getDocumentPoint(O.TopRight,t)),s.unionPoint(r.getDocumentPoint(O.BottomLeft,t)),e.So(s.width+n||0,s.height+o||0),this._n(-i.left,-i.top,e.width,e.height),T.s(t),D.s(s)}else e.So(c+n||0,d+o||0),this._n(-i.left,-i.top,e.width,e.height)}}ch(t,e,i,n){this.actualBounds.e(t,e,i,n)}computeBorder(t){const e=this.part,i=e.diagram,n=null===i||!i.animationManager.isAnimating;if(null!==i&&e instanceof Ve&&!e.layer.isTemporary&&e.computesBoundsAfterDrag&&this.Gd.isReal()){const n=i.toolManager.findTool("Dragging");if(n===i.currentTool){const i=n.computeBorder(e,this.Gd,t);if(null!==i)return i}}const s=D.l(),o=this.computeMemberBounds(s),r=this.Zt;return e instanceof Ve&&!e.isSubGraphExpanded?t.e(o.x-r.left,o.y-r.top,0,0):t.e(o.x-r.left,o.y-r.top,Math.max(o.width+r.left+r.right,0),Math.max(o.height+r.top+r.bottom,0)),D.s(s),n&&e instanceof Ve&&e.computesBoundsIncludingLocation&&e.location.isReal()&&t.unionPoint(e.location),t}computeMemberBounds(t){if(!(this.part instanceof Ve))return t.e(0,0,0,0),t;const e=this.part;let i=1/0,n=1/0,s=-1/0,o=-1/0;const r=e.memberParts;for(;r.next();){const t=r.value;if(!t.isVisible()||t instanceof De&&(!e.computesBoundsIncludingLinks||t.Eo()||t.fromNode===e||t.toNode===e))continue;const a=t.actualBounds;a.left<i&&(i=a.left),a.top<n&&(n=a.top),a.right>s&&(s=a.right),a.bottom>o&&(o=a.bottom)}if(isFinite(i)&&isFinite(n))t.e(i,n,s-i,o-n);else{const i=e.location;t.e(i.x,i.y,0,0)}return t}get padding(){return this.Zt}set padding(t){"number"==typeof t&&(t=new F(t));const e=this.Zt;e.equals(t)||(t=t.N(),this.Zt=t,this.t("padding",e,t),this.c())}}class je{constructor(t){y(this,"k",void 0),y(this,"aa",void 0),y(this,"Hd",void 0),y(this,"Mr",void 0),y(this,"jd",void 0),y(this,"qd",void 0),y(this,"vo",void 0),y(this,"ml",void 0),y(this,"Wd",void 0),y(this,"Jd",void 0),y(this,"mo",void 0),k.Yi(this),this.k=null,this.aa=null,this.Hd=!0,this.Mr=!0,this.jd=!1,this.qd=new T(0,0).g(),this.vo=!0,this.ml=null,this.Wd=null,this.Jd=!1,this.mo=null,t&&Object.assign(this,t)}cloneProtected(t){t.Hd=this.Hd,t.Mr=this.Mr,t.jd=this.jd,t.qd.a(this.qd),t.vo=this.vo,t.ml=this.ml,t.Wd=this.Wd,t.Jd=!0}copy(){const t=new this.constructor;return this.cloneProtected(t),t}li(t){d.ar(this,t)}toString(){let t=d.nn(this.constructor);return t+="(",null!==this.group&&(t+=" in "+this.group),null!==this.diagram&&(t+=" for "+this.diagram),t+=")",t}get diagram(){return this.k}set diagram(t){this.k=t}get group(){return this.aa}set group(t){this.aa!==t&&(this.aa=t,null!==t&&(this.k=t.diagram))}get isOngoing(){return this.Hd}set isOngoing(t){this.Hd!==t&&(d.i(t,"boolean",je,"isOngoing"),this.Hd=t)}get isInitial(){return this.Mr}set isInitial(t){d.i(t,"boolean",je,"isInitial"),this.Mr=t,t||(this.Jd=!0)}get isViewportSized(){return this.jd}set isViewportSized(t){this.jd!==t&&(d.i(t,"boolean",je,"isViewportSized"),this.jd=t,t&&this.invalidateLayout())}get isRouting(){return this.vo}set isRouting(t){this.vo!==t&&(d.i(t,"boolean",je,"isRouting"),this.vo=t)}get isRealtime(){return this.ml}set isRealtime(t){this.ml!==t&&(null!==t&&d.i(t,"boolean",je,"isRealtime"),this.ml=t)}get isValidLayout(){return this.Jd}set isValidLayout(t){if(this.Jd!==t&&(d.i(t,"boolean",je,"isValidLayout"),this.Jd=t,!t)){const t=this.diagram;null!==t&&(t.Gr=!0)}}invalidateLayout(){if(this.isValidLayout){const t=this.diagram;if(null===t||t.undoManager.isUndoingRedoing)return;const e=t.animationManager;if(e.isTicking)return;e.defaultAnimation.isAnimating&&e.stopAnimation(),(this.isOngoing&&t.Uh||this.isInitial&&!t.Uh)&&(this.isValidLayout=!1,t.requestUpdate())}}get network(){return this.mo}set network(t){this.mo!==t&&(this.mo=t,null!==t&&(t.layout=this))}createNetwork(){return new Ue(this)}makeNetwork(t){const e=this.createNetwork();return t instanceof Dt?(e.addParts(t.nodes,!0),e.addParts(t.links,!0)):t instanceof Ve?e.addParts(t.memberParts):e.addParts(t.iterator),e}updateParts(){this.isValidLayout=!0;let t=this.diagram;if(null===t&&null!==this.network){const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value.node;if(null!==i&&(t=i.diagram,null!==t))break}}try{null!==t&&t.startTransaction("Layout"),this.commitLayout()}finally{null!==t&&t.commitTransaction("Layout")}}commitLayout(){if(null===this.network)return;const t=this.network.vertexes.iterator;for(;t.next();)t.value.commit();if(this.isRouting){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}}doLayout(t){const e=new k;if(t instanceof Dt?(this.Ph(e,t.nodes,!0,this.Qr,!0,!1,!0),this.Ph(e,t.parts,!0,this.Qr,!0,!1,!0)):t instanceof Ve?this.Ph(e,t.memberParts,!1,this.Qr,!0,!1,!0):e.addAll(t.iterator),e.count>0){const t=this.diagram;null!==t&&t.startTransaction("Layout"),this.doMinimalNoNetworkLayout(e),null!==t&&t.commitTransaction("Layout")}this.isValidLayout=!0}doMinimalNoNetworkLayout(t){const e=t.count,i=Math.ceil(Math.sqrt(e));this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const n=this.arrangementOrigin.x;let s=n,o=this.arrangementOrigin.y,r=0,a=0;const l=t.iterator;for(;l.next();){const t=l.value;t.ensureBounds();const e=t.measuredBounds,h=e.width,u=e.height;t.moveTo(s,o),t instanceof Ve&&(t.Qr=!1),s+=Math.max(h,50)+20,a=Math.max(a,Math.max(u,50)),r>=i-1?(r=0,s=n,o+=a+20,a=0):r++}}doMinimalNetworkLayout(){const t=this.network.vertexes.count,e=Math.ceil(Math.sqrt(t));this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const i=this.arrangementOrigin.x;let n=i,s=this.arrangementOrigin.y,o=0,r=0;const a=this.network.vertexes.iterator;for(;a.next();){const t=a.value.node;if(null===t||t instanceof De||(t.ensureBounds(),!this.Qr(t)))continue;const l=t.measuredBounds,h=l.width,u=l.height;t.moveTo(n,s),t instanceof Ve&&(t.Qr=!1),n+=Math.max(h,50)+20,r=Math.max(r,Math.max(u,50)),o>=e-1?(o=0,n=i,s+=r+20,r=0):o++}}Qr(t){return!!(!t.location.isReal()&&!t.position.isReal()||t instanceof Ve&&t.Qr)}Ph(t,e,i,n,s,o,r){const a=e.iterator;for(;a.next();){const e=a.value;if((!i||e.isTopLevel)&&(null===n||n(e))&&e.canLayout())if(s&&e instanceof Ce){if(e.isLinkLabel)continue;e instanceof Ve&&null===e.layout?this.Ph(t,e.memberParts,!1,n,s,o,r):(e.ensureBounds(),t.add(e))}else o&&e instanceof De?t.add(e):r&&e.Ne()&&!(e instanceof Ce)&&(e.ensureBounds(),t.add(e))}}getLayoutBounds(t,e){const i=this.boundsComputation;return null!==i?(e||(e=new D),i(t,this,e)):!e&&t.margin.equalTo(0,0,0,0)?t.actualBounds:(e||(e=new D),e.set(t.actualBounds),e.addMargin(t.margin),e)}get boundsComputation(){return this.Wd}set boundsComputation(t){this.Wd!==t&&(null!==t&&d.i(t,"function",je,"boundsComputation"),this.Wd=t,this.invalidateLayout())}collectParts(t){const e=new k;return t instanceof Dt?(this.Ph(e,t.nodes,!0,null,!0,!0,!0),this.Ph(e,t.links,!0,null,!0,!0,!0),this.Ph(e,t.parts,!0,null,!0,!0,!0)):t instanceof Ve?this.Ph(e,t.memberParts,!1,null,!0,!0,!0):this.Ph(e,t.iterator,!1,null,!0,!0,!0),e}get arrangementOrigin(){return this.qd}set arrangementOrigin(t){this.qd.equals(t)||(this.qd.a(t),this.invalidateLayout())}initialOrigin(t){const e=this.group;if(null!==e){if(e.hasPlaceholder()){const i=e.placeholder,n=i.getDocumentPoint(O.TopLeft);(isNaN(n.x)||isNaN(n.y))&&n.set(t);const s=i.padding;return n.x+=s.left,n.y+=s.top,n}{const i=e.position.copy();return(isNaN(i.x)||isNaN(i.y))&&i.set(t),i}}return t}}class Ue{constructor(t){y(this,"ee",void 0),y(this,"po",void 0),y(this,"An",void 0),y(this,"ky",void 0),y(this,"Py",void 0),k.Yi(this),this.ee=t,this.po=new k,this.An=new k,this.ky=new L,this.Py=new L}clear(){if(this.po){const t=this.po.iterator;for(;t.next();)t.value.clear()}if(this.An){const t=this.An.iterator;for(;t.next();)t.value.clear()}this.po=new k,this.An=new k,this.ky=new L,this.Py=new L}toString(t){void 0===t&&(t=0);let e="LayoutNetwork"+(null!==this.layout?"("+this.layout.toString()+")":"");if(t<=0)return e;if(e+=" vertexes: "+this.po.count+" edges: "+this.An.count,t>1){const i=this.po.iterator;for(;i.next();){e+="\n    "+i.value.toString(t-1)}const n=this.An.iterator;for(;n.next();){e+="\n    "+n.value.toString(t-1)}}return e}get layout(){return this.ee}set layout(t){null!==t&&(this.ee=t)}get vertexes(){return this.po}get edges(){return this.An}createVertex(){return new Ke(this)}createEdge(){return new Ge(this)}addParts(t,e,i){if(null===t)return;void 0===e&&(e=!1),d.i(e,"boolean",Ue,"addParts:toplevelonly"),void 0===i&&(i=null),null===i&&(i=t=>{if(t instanceof Ce)return!t.isLinkLabel;if(t instanceof De){const e=t.fromNode;if(null===e||e.isLinkLabel)return!1;const i=t.toNode;return!(null===i||i.isLinkLabel)}return!1});const n=t.iterator;for(;n.next();){const t=n.value;if(t instanceof Ce&&(!e||t.isTopLevel)&&t.canLayout()&&i(t))if(t instanceof Ve&&null===t.layout)this.addParts(t.memberParts,!1);else{if(null!==this.findVertex(t))continue;const e=this.createVertex();e.node=t,this.addVertex(e)}}for(n.reset();n.next();){const t=n.value;if(!(t instanceof De)||e&&!t.isTopLevel||!t.canLayout()||!i(t)||null!==this.findEdge(t))continue;const s=t.fromNode,o=t.toNode;if(null===s||null===o||s===o)continue;const r=this.findGroupVertex(s),a=this.findGroupVertex(o);this.linkVertexes(r,a,t)}}findGroupVertex(t){if(null===t)return null;const e=t.findVisibleNode();if(null===e)return null;let i=this.findVertex(e);if(null!==i)return i;let n=e.containingGroup;for(;null!==n;){if(i=this.findVertex(n),null!==i)return i;n=n.containingGroup}return null}addVertex(t){if(null===t)return;this.po.add(t);const e=t.node;null!==e&&this.ky.add(e,t),t.network=this}addNode(t){if(null===t)return null;let e=this.findVertex(t);return null===e&&(e=this.createVertex(),e.node=t,this.addVertex(e)),e}deleteVertex(t){if(null!==t&&this.oT(t)){let e=t.ir;for(let t=e.count-1;t>=0;t--){const i=e.elt(t);this.deleteEdge(i)}e=t.er;for(let t=e.count-1;t>=0;t--){const i=e.elt(t);this.deleteEdge(i)}}}oT(t){if(null===t)return!1;const e=this.po.remove(t);if(e){const e=t.node;null!==e&&this.ky.remove(e)}return e}deleteNode(t){if(null===t)return;const e=this.findVertex(t);null!==e&&this.deleteVertex(e)}findVertex(t){return null===t?null:this.ky.getValue(t)}addEdge(t){if(null===t)return;this.hN(t);const e=t.toVertex;null!==e&&e.addSourceEdge(t);const i=t.fromVertex;null!==i&&i.addDestinationEdge(t)}hN(t){if(null===t)return;this.An.add(t);const e=t.link;null!==e&&null===this.findEdge(e)&&this.Py.add(e,t),t.network=this}addLink(t){if(null===t)return null;const e=t.fromNode,i=t.toNode;let n=this.findEdge(t);return null===n?(n=this.createEdge(),n.link=t,null!==e&&(n.fromVertex=this.addNode(e)),null!==i&&(n.toVertex=this.addNode(i)),this.addEdge(n)):(n.fromVertex=null!==e?this.addNode(e):null,n.toVertex=null!==i?this.addNode(i):null),n}deleteEdge(t){if(null===t)return;const e=t.toVertex;null!==e&&e.deleteSourceEdge(t);const i=t.fromVertex;null!==i&&i.deleteDestinationEdge(t),this.aN(t)}aN(t){if(null===t)return!1;const e=this.An.remove(t);if(e){const e=t.link;null!==e&&this.Py.remove(e)}return e}deleteLink(t){if(null===t)return;const e=this.findEdge(t);null!==e&&this.deleteEdge(e)}findEdge(t){return null===t?null:this.Py.getValue(t)}linkVertexes(t,e,i){if(null===t||null===e)return null;if(t.network===this&&e.network===this){const n=this.createEdge();return n.link=i,n.fromVertex=t,n.toVertex=e,this.addEdge(n),n}return null}reverseEdge(t){if(null===t)return;const e=t.fromVertex,i=t.toVertex;null===e||null===i||(e.deleteDestinationEdge(t),i.deleteSourceEdge(t),t.reverseEdge(),e.addSourceEdge(t),i.addDestinationEdge(t))}deleteSelfEdges(){const t=d.rt(),e=this.An.iterator;for(;e.next();){const i=e.value;i.fromVertex===i.toVertex&&t.push(i)}const i=t.length;for(let n=0;n<i;n++)this.deleteEdge(t[n]);d.it(t)}deleteArtificialVertexes(){const t=d.rt(),e=this.po.iterator;for(;e.next();){const i=e.value;null===i.node&&null===i.data&&t.push(i)}let i=t.length;for(let o=0;o<i;o++)this.deleteVertex(t[o]);const n=d.rt(),s=this.An.iterator;for(;s.next();){const t=s.value;null===t.link&&null===t.data&&n.push(t)}i=n.length;for(let o=0;o<i;o++)this.deleteEdge(n[o]);d.it(t),d.it(n)}deleteUselessEdges(){const t=d.rt(),e=this.An.iterator;for(;e.next();){const i=e.value;(null===i.fromVertex||null===i.toVertex)&&t.push(i)}const i=t.length;for(let n=0;n<i;n++)this.deleteEdge(t[n]);d.it(t)}isSingleton(t){return!(t.ir.count>0||t.er.count>0)}splitIntoSubNetworks(t){void 0===t&&(t=!0),t&&(this.deleteArtificialVertexes(),this.deleteUselessEdges(),this.deleteSelfEdges());const e=new x;let i=!0;for(;i;){i=!1;const t=this.po.iterator;for(;t.next();){const n=t.value;if(this.isSingleton(n))continue;const s=this.layout.createNetwork();e.add(s),this.wO(s,n),i=!0;break}}return e.sort(((t,e)=>null===t||null===e||t===e?0:e.vertexes.count-t.vertexes.count)),e}wO(t,e){if(null===e)return;const i=new x;for(i.add(e);i.count>0;){const e=i.first();if(i.removeAt(0),e.network===t)continue;this.oT(e),t.addVertex(e);let n=e.sourceEdges;for(;n.next();){const e=n.value;e.network!==t&&(this.aN(e),t.hN(e),i.add(e.fromVertex))}for(n=e.destinationEdges;n.next();){const e=n.value;e.network!==t&&(this.aN(e),t.hN(e),i.add(e.toVertex))}}}findAllParts(){const t=new k,e=this.po.iterator;for(;e.next();){const i=e.value;t.add(i.node)}const i=this.An.iterator;for(;i.next();){const e=i.value;t.add(e.link)}return t}}class Ke{constructor(t){y(this,"mo",void 0),y(this,"Qt",void 0),y(this,"me",void 0),y(this,"Fe",void 0),y(this,"Je",void 0),y(this,"ir",void 0),y(this,"er",void 0),k.Yi(this),this.mo=t,this.Fe=new D(0,0,10,10).g(),this.Je=new T(5,5).g(),this.Qt=null,this.me=null,this.ir=new x,this.er=new x}clear(){this.Qt=null,this.me=null,this.ir=new x,this.er=new x}toString(t){void 0===t&&(t=0);let e="LayoutVertex#"+k.fs(this);if(t>0&&(e+=null!==this.node?"("+this.node.toString()+")":"",t>1)){let t="",i=!0,n=this.ir.iterator;for(;n.next();){i?i=!1:t+=",",t+=n.value.toString(0)}let s="";for(i=!0,n=this.er.iterator;n.next();){i?i=!1:s+=",",s+=n.value.toString(0)}e+=" sources: "+t+" destinations: "+s}return e}get yo(){return this.ir.HN}get sr(){return this.er.HN}get data(){return this.Qt}set data(t){if(this.Qt=t,null!==t&&t.bounds){const e=t.bounds,i=e.x,n=e.y,s=e.width,o=e.height;this.Je.e(s/2,o/2),this.Fe.e(i,n,s,o)}}get node(){return this.me}set node(t){if(this.me!==t){this.me=t,t.ensureBounds();const e=this.network.layout,i=D.l(),n=e.getLayoutBounds(t,i);let s=n.x,o=n.y;const r=n.width,a=n.height;if(isNaN(s)&&(s=0),isNaN(o)&&(o=0),this.Fe.e(s,o,r,a),D.s(i),!(t instanceof Ve)){const e=t.locationObject.getDocumentPoint(O.Center);if(e.isReal())return void this.Je.e(e.x-s,e.y-o)}this.Je.e(r/2,a/2)}}get bounds(){return this.Fe}set bounds(t){this.Fe.equals(t)||this.Fe.a(t)}get focus(){return this.Je}set focus(t){this.Je.equals(t)||this.Je.a(t)}get centerX(){return this.Fe.x+this.Je.x}set centerX(t){const e=this.Fe;e.x+this.Je.x!==t&&(e.lt(),e.x=t-this.Je.x,e.g())}get centerY(){return this.Fe.y+this.Je.y}set centerY(t){const e=this.Fe;e.y+this.Je.y!==t&&(e.lt(),e.y=t-this.Je.y,e.g())}get focusX(){return this.Je.x}set focusX(t){const e=this.Je;e.x!==t&&(e.lt(),e.x=t,e.g())}get focusY(){return this.Je.y}set focusY(t){const e=this.Je;e.y!==t&&(e.lt(),e.y=t,e.g())}get x(){return this.Fe.x}set x(t){const e=this.Fe;e.x!==t&&(e.lt(),e.x=t,e.g())}get y(){return this.Fe.y}set y(t){const e=this.Fe;e.y!==t&&(e.lt(),e.y=t,e.g())}get width(){return this.Fe.width}set width(t){const e=this.Fe;e.width!==t&&(e.lt(),e.width=t,e.g())}get height(){return this.Fe.height}set height(t){const e=this.Fe;e.height!==t&&(e.lt(),e.height=t,e.g())}commit(){const t=this.Qt;if(null!==t){const e=this.bounds,i=t.bounds;return void(d.wt(i)?(i.x=e.x,i.y=e.y,i.width=e.width,i.height=e.height):t.bounds=e.copy())}const e=this.node;if(null!==e){const t=this.bounds;if(!(e instanceof Ve)){const i=D.l();e.ensureBounds();const n=this.network.layout.getLayoutBounds(e,i),s=e.locationObject.getDocumentPoint(O.Center);if(n.isReal()&&s.isReal())return e.moveTo(t.x+this.focusX-(s.x-n.x),t.y+this.focusY-(s.y-n.y)),void D.s(i);D.s(i)}e.moveTo(t.x,t.y)}}addSourceEdge(t){null!==t&&(this.ir.contains(t)||this.ir.add(t))}deleteSourceEdge(t){null!==t&&this.ir.remove(t)}addDestinationEdge(t){null!==t&&(this.er.contains(t)||this.er.add(t))}deleteDestinationEdge(t){null!==t&&this.er.remove(t)}get network(){return this.mo}set network(t){this.mo=t}get sourceVertexes(){const t=new k,e=this.sourceEdges;for(;e.next();){const i=e.value;t.add(i.fromVertex)}return t.iterator}get destinationVertexes(){const t=new k,e=this.destinationEdges;for(;e.next();){const i=e.value;t.add(i.toVertex)}return t.iterator}get vertexes(){const t=new k;let e=this.sourceEdges;for(;e.next();){const i=e.value;t.add(i.fromVertex)}for(e=this.destinationEdges;e.next();){const i=e.value;t.add(i.toVertex)}return t.iterator}get sourceEdges(){return this.ir.iterator}get destinationEdges(){return this.er.iterator}get edges(){const t=new x;let e=this.sourceEdges;for(;e.next();){const i=e.value;t.add(i)}for(e=this.destinationEdges;e.next();){const i=e.value;t.add(i)}return t.iterator}get edgesCount(){return this.ir.count+this.er.count}static standardComparer(t,e){const i=t.me,n=e.me;if(i){if(n){const t=i.text,e=n.text;return t<e?-1:t>e?1:0}return 1}return null!==n?-1:0}static smartComparer(t,e){if(null!==t){if(null!==e){const i=t.me,n=e.me;if(null!==i){if(null!==n){const t=i.text.toLocaleLowerCase(),e=n.text.toLocaleLowerCase(),s=t.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/),o=e.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);let r=0;for(;r<s.length;r++){if(""!==o[r]&&void 0!==o[r]){const t=parseFloat(s[r]),e=parseFloat(o[r]);if(isNaN(t)){if(isNaN(e)){if(0!==s[r].localeCompare(o[r]))return s[r].localeCompare(o[r]);continue}return 1}if(isNaN(e))return-1;if(t-e!==0)return t-e;continue}if(""===s[r])continue;return 1}return""!==o[r]&&void 0!==o[r]?-1:0}return 1}return null!==n?-1:0}return 1}return null!==e?-1:0}}class Ge{constructor(t){y(this,"mo",void 0),y(this,"Qt",void 0),y(this,"We",void 0),y(this,"$e",void 0),y(this,"Ze",void 0),k.Yi(this),this.mo=t,this.Qt=null,this.We=null,this.$e=null,this.Ze=null}clear(){this.Qt=null,this.We=null,this.$e=null,this.Ze=null}toString(t){void 0===t&&(t=0);let e="LayoutEdge#"+k.fs(this);return t>0&&(e+=null!==this.We?"("+this.We.toString()+")":"",t>1&&(e+=" "+(this.$e?this.$e.toString():"null")+" --\x3e "+(this.Ze?this.Ze.toString():"null"))),e}reverseEdge(){const t=this.$e;this.$e=this.Ze,this.Ze=t}commit(){}getOtherVertex(t){return this.Ze===t?this.$e:this.$e===t?this.Ze:null}get network(){return this.mo}set network(t){this.mo=t}get data(){return this.Qt}set data(t){this.Qt!==t&&(this.Qt=t)}get link(){return this.We}set link(t){this.We!==t&&(this.We=t)}get fromVertex(){return this.$e}set fromVertex(t){this.$e!==t&&(this.$e=t)}get toVertex(){return this.Ze}set toVertex(t){this.Ze!==t&&(this.Ze=t)}}var Xe=(t=>(t[t.Position=0]="Position",t[t.Location=1]="Location",t))(Xe||{}),Ye=(t=>(t[t.LeftToRight=10]="LeftToRight",t[t.RightToLeft=11]="RightToLeft",t))(Ye||{}),_e=(t=>(t[t.Forwards=20]="Forwards",t[t.Reverse=21]="Reverse",t[t.Ascending=22]="Ascending",t[t.Descending=23]="Descending",t))(_e||{});class He extends je{constructor(t){super(),y(this,"$d",void 0),y(this,"Zd",void 0),y(this,"To",void 0),y(this,"Tn",void 0),y(this,"oi",void 0),y(this,"zi",void 0),y(this,"xe",void 0),y(this,"be",void 0),this.isViewportSized=!0,this.$d=NaN,this.Zd=NaN,this.To=new A(NaN,NaN).g(),this.Tn=new A(10,10).g(),this.oi=1,this.zi=10,this.xe=22,this.be=He.standardComparer,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.$d=this.$d,t.Zd=this.Zd,t.To.a(this.To),t.Tn.a(this.Tn),t.oi=this.oi,t.zi=this.zi,t.xe=this.xe,t.be=this.be}li(t){t in _e?this.sorting=t:t in Ye?this.arrangement=t:t in Xe?this.alignment=t:super.li(t)}doLayout(t){this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const e=this.collectParts(t),i=this.diagram,n=e.copy().iterator;for(;n.next();){const t=n.value;if(!t.Tl()||null===t.fromNode&&null===t.toNode){if(t.ensureBounds(),t instanceof Ve){const i=t.memberParts;for(;i.next();){const t=i.value;e.remove(t)}}}else e.remove(t)}const s=e.toArray();if(0===s.length)return;switch(this.sorting){case 20:break;case 21:s.reverse();break;case 22:s.sort(this.comparer);break;case 23:s.sort(this.comparer),s.reverse()}let o=this.wrappingColumn;isNaN(o)&&(o=0);let r=this.wrappingWidth;if(isNaN(r)&&null!==i){const t=i.viewportBounds,e=i.padding;r=Math.max(t.width-e.left-e.right,0)}else r=Math.max(this.wrappingWidth,0);o<=0&&r<=0&&(o=1);let a=this.spacing.width;isFinite(a)||(a=0);let l=this.spacing.height;isFinite(l)||(l=0),null!==i&&i.startTransaction("Layout");const h=[];switch(this.alignment){case 0:this.xO(s,r,o,a,l,h);break;case 1:this.bO(s,r,o,a,l,h)}let u=0,c=0,d=0;for(let f=0;f<h.length;f++){const t=h[f];u=Math.min(u,t.x),c=Math.min(c,t.y),d=Math.max(d,t.x+t.width)}11===this.arrangement?this.commitLayers(h,new T(u+a/2-(d+u),c-l/2)):this.commitLayers(h,new T(u-a/2,c-l/2)),null!==i&&i.commitTransaction("Layout"),this.isValidLayout=!0}xO(t,e,i,n,s,o){const r=D.l();let a=Math.max(this.cellSize.width,1);if(!isFinite(a)){a=0;for(let e=0;e<t.length;e++){const i=t[e],n=this.getLayoutBounds(i,r);a=Math.max(a,n.width)}}a+=n,a=Math.max(a,1);let l=Math.max(this.cellSize.height,1);if(!isFinite(l)){l=0;for(let e=0;e<t.length;e++){const i=t[e],n=this.getLayoutBounds(i,r);l=Math.max(l,n.height)}}l+=s,l=Math.max(l,1);const h=this.arrangement,u=this.arrangementOrigin.x;let c=u,d=this.arrangementOrigin.y,f=0,g=0;for(let m=0;m<t.length;m++){const p=t[m],y=this.getLayoutBounds(p,r),v=Math.ceil((y.width+n)/a)*a,b=Math.ceil((y.height+s)/l)*l;let x=0;if(11===h)x=Math.abs(c-y.width);else x=c+y.width;(i>0&&f>i-1||e>0&&f>0&&x-u>e)&&(o.push(new D(0,d,e+n,g)),f=0,c=u,d+=g,g=0),g=Math.max(g,b);let w=0;if(11===h)w=-y.width;else w=0;if(11===(p.moveTo(c+w,d),h))c-=v;else c+=v;f++}o.push(new D(0,d,e+n,g)),D.s(r)}bO(t,e,i,n,s,o){const r=D.l();let a=Math.max(this.cellSize.width,1),l=0,h=0,u=0;const c=T.l();for(let S=0;S<t.length;S++){const e=t[S],i=this.getLayoutBounds(e,r),n=e.getRelativePoint(e.locationObject,e.locationSpot,c);l=Math.max(l,n.x),h=Math.max(h,i.width-n.x),u=Math.max(u,n.y)}const d=this.arrangement;if(11===d)l+=n;else h+=n;a=isFinite(a)?Math.max(a+n,1):Math.max(l+h,1);const f=this.arrangementOrigin.x;let g=f,m=this.arrangementOrigin.y,p=0;e>=l&&(e-=l);let y=0,v=0;const b=Math.max(this.cellSize.height,1);u=0;let x=0,w=!0;const k=T.l();for(let S=0;S<t.length;S++){const l=t[S],h=this.getLayoutBounds(l,r),P=l.getRelativePoint(l.locationObject,l.locationSpot,c);if(p>0)switch(d){case 11:{let t=(g-f-(h.width-P.x))/a;t=E.Y(Math.round(t),t)?Math.round(t):Math.floor(t),g=t*a+f;break}default:{let t=(g-f+P.x)/a;t=E.Y(Math.round(t),t)?Math.round(t):Math.ceil(t),g=t*a+f;break}}else if(11===d)y=g+P.x+h.width;else y=g-P.x;let M=0;if(11===d)M=-(g+P.x)+y;else M=g+h.width-P.x-y;if(i>0&&p>i-1||e>0&&p>0&&M>e){o.push(new D(0,w?m-u:m,e+n,x+u+s));for(let e=0;e<p&&S!==p;e++){const i=t[S-p+e],n=i.getRelativePoint(i.locationObject,i.locationSpot,k);i.moveTo(i.position.x,i.position.y+u-n.y)}x+=s,m+=w?x:x+u,u=0,x=0,p=0,g=f,w=!1}if(11===(g===f&&(v=11===d?Math.max(v,h.width-P.x):Math.min(v,-P.x)),u=Math.max(u,P.y),x=Math.max(x,h.height-P.y),isFinite(b)&&(x=Math.max(x,Math.max(h.height,b)-P.y)),w?l.moveTo(g-P.x,m-P.y):l.moveTo(g-P.x,m),d))g-=P.x+n;else g+=h.width-P.x+n;p++}if(o.push(new D(0,m,e+n,(w?x:x+u)+s)),t.length!==p)for(let S=0;S<p;S++){const e=t[t.length-p+S],i=e.getRelativePoint(e.locationObject,e.locationSpot,c);e.moveTo(e.position.x,e.position.y+u-i.y)}if(T.s(c),T.s(k),11===d)for(let S=0;S<o.length;S++){const t=o[S];t.width+=v,t.x-=v}else for(let S=0;S<o.length;S++){const t=o[S];t.x>v&&(t.width+=t.x-v,t.x=v)}D.s(r)}commitLayers(t,e){}get wrappingWidth(){return this.$d}set wrappingWidth(t){this.$d!==t&&(d.i(t,"number",He,"wrappingWidth"),(t>0||isNaN(t))&&(this.$d=t,this.isViewportSized=isNaN(t),this.invalidateLayout()))}get wrappingColumn(){return this.Zd}set wrappingColumn(t){this.Zd!==t&&(d.i(t,"number",He,"wrappingColumn"),(t>0||isNaN(t))&&(this.Zd=t,this.invalidateLayout()))}get cellSize(){return this.To}set cellSize(t){this.To.equals(t)||(this.To.a(t),this.invalidateLayout())}get spacing(){return this.Tn}set spacing(t){this.Tn.equals(t)||(this.Tn.a(t),this.invalidateLayout())}get alignment(){return this.oi}set alignment(t){this.oi!==t&&(1===t||0===t)&&(this.oi=t,this.invalidateLayout())}get arrangement(){return this.zi}set arrangement(t){this.zi!==t&&(10===t||11===t)&&(this.zi=t,this.invalidateLayout())}get sorting(){return this.xe}set sorting(t){this.xe!==t&&(20===t||21===t||22===t||23===t)&&(this.xe=t,this.invalidateLayout())}get comparer(){return this.be}set comparer(t){this.be!==t&&(d.i(t,"function",He,"comparer"),this.be=t,this.invalidateLayout())}static standardComparer(t,e){const i=t.text,n=e.text;return i<n?-1:i>n?1:0}static smartComparer(t,e){if(null!==t){if(null!==e){const i=t.text.toLocaleLowerCase(),n=e.text.toLocaleLowerCase(),s=i.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/),o=n.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);let r=0;for(;r<s.length;r++){if(""!==o[r]&&void 0!==o[r]){const t=parseFloat(s[r]),e=parseFloat(o[r]);if(isNaN(t)){if(isNaN(e)){if(0!==s[r].localeCompare(o[r]))return s[r].localeCompare(o[r]);continue}return 1}if(isNaN(e))return-1;if(t-e!==0)return t-e;continue}if(""===s[r])continue;return 1}return""!==o[r]&&void 0!==o[r]?-1:0}return 1}return null!==e?-1:0}}y(He,"Position",0),y(He,"Location",1),y(He,"LeftToRight",10),y(He,"RightToLeft",11),y(He,"Forward",20),y(He,"Reverse",21),y(He,"Ascending",22),y(He,"Descending",23);class qe{constructor(){y(this,"Qd",void 0),y(this,"Ws",void 0),y(this,"At",void 0),y(this,"Va",void 0),y(this,"k",void 0),y(this,"My",void 0),y(this,"wo",void 0),y(this,"pl",void 0),y(this,"cN",void 0),this.Qd=new k,this.Ws=new k,this.At=new k,this.wo=new L,this.pl=new L,this.Va=new L,this.k=null,this.My=!1,this.cN=!0}clear(){this.Qd.clear(),this.Ws.clear(),this.At.clear(),this.wo.clear(),this.pl.clear(),this.Va.clear()}Fo(t){this.k=t}Wh(t){if(t instanceof Ce){if(this.Qd.add(t),t instanceof Ve){const e=t.containingGroup;null===e?this.k.Hr.add(t):e.ha.add(t);const i=t.layout;null!==i&&(i.diagram=this.k)}}else t instanceof De?this.Ws.add(t):t instanceof Pe||this.At.add(t);const e=t.data;null!==e&&(t instanceof Pe||(t instanceof De?this.rT(e,t):this.wo.add(e,t)))}ie(t){if(t.clearAdornments(),t instanceof Ce){if(this.Qd.remove(t),t instanceof Ve){const e=t.containingGroup;null===e?this.k.Hr.remove(t):e.ha.remove(t);const i=t.layout;null!==i&&(i.diagram=null)}}else t instanceof De?this.Ws.remove(t):t instanceof Pe||this.At.remove(t);const e=t.data;null!==e&&(t instanceof Pe||(t instanceof De?this.lT(e,t):this.wo.remove(e)))}rT(t,e){this.pl.add(t,e)}lT(t,e){this.pl.remove(t)}rebuildParts(){const t=this.k;if(null===t)return;const e=t.nodeTemplateMap.iterator;for(;e.next();){const t=e.value,i=e.key;(!t.Ne()||t instanceof Ve)&&d.o('Invalid node template in Diagram.nodeTemplateMap: template for "'.concat(i,'" must be a Node or a simple Part, not a Group or Link: ').concat(t))}const i=t.groupTemplateMap.iterator;for(;i.next();){const t=i.value,e=i.key;t instanceof Ve||d.o('Invalid group template in Diagram.groupTemplateMap: template for "'.concat(e,'" must be a Group, not a normal Node or Link: ').concat(t))}const n=t.linkTemplateMap.iterator;for(;n.next();){const t=n.value,e=n.key;t instanceof De||d.o('Invalid link template in Diagram.linkTemplateMap: template for "'.concat(e,'" must be a Link, not a normal Node or simple Part: ').concat(t))}const s=d.rt(),o=t.selection.iterator;for(;o.next();){const t=o.value.data;t&&s.push(t)}const r=d.rt(),a=t.highlighteds.iterator;for(;a.next();){const t=a.value.data;t&&r.push(t)}const l=d.rt();if(this.preservesRebuildLocations){const t=this.nodes.iterator;for(;t.next();){const e=t.value;null!==e.data&&(l.push(e.data),l.push(e.location))}const e=this.links.iterator;for(;e.next();){const t=e.value;null!==t.data&&(l.push(t.data),l.push(t.location))}const i=this.parts.iterator;for(;i.next();){const t=i.value;null!==t.data&&(l.push(t.data),l.push(t.location))}}this.hT(),this.SS();for(let h=0;h<s.length;h++){const t=this.findPartForData(s[h]);null!==t&&(t.isSelected=!0)}for(let h=0;h<r.length;h++){const t=this.findPartForData(r[h]);null!==t&&(t.isHighlighted=!0)}if(this.preservesRebuildLocations)for(let h=0;h<l.length;h+=2){const t=this.findPartForData(l[h]);null!==t&&(t.location=l[h+1])}d.it(s),d.it(r),d.it(l)}SS(){const t=this.diagram.model;this.Sy(t.nodeDataArray)}Sy(t,e){const i=this.diagram.model;t.forEach((t=>{i.containsNodeData(t)&&this.aT(t,!1)})),t.forEach((t=>{i.containsNodeData(t)&&this.M1(t)})),!1!==e&&this.diagram.xb(!1)}aT(t,e){if(null==t||this.diagram.undoManager.isUndoingRedoing||this.wo.contains(t))return null;void 0===e&&(e=!0);const i=this.kO(t);return null!==i&&e&&this.M1(t),i}kO(t){if(null==t||this.k.undoManager.isUndoingRedoing||this.wo.contains(t))return null;const e=this.PO(t),i=this.findTemplateForNodeData(t,e);if(null!==i){i.hi();const n=i.copy();if(null!==n){const i=this.diagram.ge;return this.diagram.ge=!0,n.Wo=e,n.Qt=t,this.My&&(n.cl="Tool"),this.diagram.add(n),n.Qt=null,n.data=t,this.diagram.ge=i,n}}return null}insertLink(t,e,i,n){return null}M1(t){}PO(t){return this.k.model.getCategoryForNodeData(t)}findTemplateForNodeData(t,e){const i=this.k,n=i.model;let s=null;return n.Gc()&&n.isGroupForData(t)?(s=i.groupTemplateMap.getValue(e),null===s&&(s=i.groupTemplateMap.getValue(""),null===s&&(qe.fT||(qe.fT=!0,d.ri('No Group template found for category "'+e+'"'),d.ri("  Using default group template")),s=i.CF))):(s=i.nodeTemplateMap.getValue(e),null===s&&(s=i.nodeTemplateMap.getValue(""),null===s&&(qe.cT||(qe.cT=!0,d.ri('No Node template found for category "'+e+'"'),d.ri("  Using default node template")),s=i.SF))),s}getLinkCategoryForData(t){return""}setLinkCategoryForData(t,e){}setFromNodeForLink(t,e,i){}setToNodeForLink(t,e,i){}findLinkTemplateForCategory(t){const e=this.k;let i=e.linkTemplateMap.getValue(t);return null===i&&(i=e.linkTemplateMap.getValue(""),null===i&&(qe.uT||(qe.uT=!0,d.ri('No Link template found for category "'+t+'"'),d.ri("  Using default link template")),i=e.NF)),i}cv(t,e,i){t instanceof De?(null!==e&&this.lT(e,t),null!==i&&this.rT(i,t)):t instanceof ke&&(null!==e&&this.wo.remove(e),null!==i&&this.wo.add(i,t))}hT(){const t=this.diagram.model;this.fN(t.nodeDataArray)}fN(t){t.forEach((t=>{this.S1(t)}))}S1(t){const e=this.findPartForData(t);null!==e&&(this.diagram.PS(e,!1),this.uN(e))}uN(t){}eN(t){}findPartForKey(t){if(null==t)return null;const e=this.k.model.findNodeDataForKey(t);return null!==e?this.wo.getValue(e):null}findNodeForKey(t){if(null==t)return null;const e=this.k.model.findNodeDataForKey(t);if(null===e)return null;const i=this.wo.getValue(e);return i instanceof Ce?i:null}findLinkForKey(t){return null}findPartForData(t){if(null===t)return null;let e=this.wo.getValue(t);return null!==e||(e=this.pl.getValue(t)),e}findNodeForData(t){if(null===t)return null;const e=this.wo.getValue(t);return e instanceof Ce?e:null}findLinkForData(t,e){return null===t?null:this.pl.getValue(t)}findNodesByExample(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];const n=new k,s=this.Qd.iterator;for(;s.next();){const t=s.value,e=t.data;if(null!==e)for(let i=0;i<arguments.length;i++){const s=arguments[i];if(d.wt(s)&&this.dN(e,s)){n.add(t);break}}}return n.iterator}findLinksByExample(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];const n=new k,s=this.Ws.iterator;for(;s.next();){const t=s.value,e=t.data;if(null!==e)for(let i=0;i<arguments.length;i++){const s=arguments[i];if(d.wt(s)&&this.dN(e,s)){n.add(t);break}}}return n.iterator}dN(t,e){for(const i in e){const n=t[i],s=e[i];if(Array.isArray(s)){if(!Array.isArray(n))return!1;const t=n,e=s;if(t.length<e.length)return!1;for(let i=0;i<t.length;i++){const n=t[i],s=e[i];if(void 0!==s&&!this.dT(n,s))return!1}}else if(!this.dT(n,s))return!1}return!0}dT(t,e){if("function"==typeof e){if(!e(t))return!1}else if(e instanceof RegExp){if(!t||!e.test(t.toString()))return!1}else if(d.wt(t)&&d.wt(e)){if(!this.dN(t,e))return!1}else if(t!==e)return!1;return!0}doModelDataChanged(t){if(t.model===this.diagram.model&&this.diagram.G){this.diagram.G=!1;try{const e=t.change;""===t.modelChange&&2===e&&this.Ny(t.object,t.propertyName)}finally{this.diagram.G=!0}}}doModelChanged(t){if(!this.k)return;const e=this.k;if(t.model!==e.model)return;const i=t.change;if(e.uR(t),e.G){e.G=!1;try{const n=t.modelChange;if(""!==n)if(2===i){if("nodeCategory"===n){const e=t.object,i=this.findPartForData(e),n=t.newValue;null!==i&&"string"==typeof n&&(i.category=n)}else if("nodeDataArray"===n){const e=t.oldValue;this.fN(e);const i=t.newValue;this.Sy(i)}e.isModified=!0}else if(3===i){const i=t.newValue;"nodeDataArray"===n&&d.wt(i)&&this.aT(i),e.isModified=!0}else if(4===i){const i=t.oldValue;"nodeDataArray"===n&&d.wt(i)&&this.S1(i),e.isModified=!0}else 1===i&&("SourceChanged"===n?null!==t.object?this.Ny(t.object,t.propertyName):(this.updateAllRelationshipsFromData(),this.updateAllTargetBindings()):"ModelDisplaced"===n&&this.rebuildParts());else if(2===i){const i=t.propertyName,n=t.object;n===e.model?("nodeKeyProperty"===i||"nodeCategoryProperty"===i)&&(e.undoManager.isUndoingRedoing||this.rebuildParts()):this.Ny(n,i),e.isModified=!0}else(3===i||4===i)&&(this.MO(t),e.isModified=!0)}finally{e.G=!0}}}updateAllTargetBindings(t){void 0===t&&(t="");let e=this.parts.iterator;for(;e.next();)e.value.updateTargetBindings(t);for(e=this.nodes.iterator;e.next();)e.value.updateTargetBindings(t);for(e=this.links.iterator;e.next();)e.value.updateTargetBindings(t)}updateAllThemeBindings(){let t=this.parts.iterator;for(;t.next();)t.value.Vo();for(t=this.nodes.iterator;t.next();)t.value.Vo();for(t=this.links.iterator;t.next();)t.value.Vo()}updateAllRelationshipsFromData(){const t=this.k.model,e=new k,i=t.nodeDataArray;for(let o=0;o<i.length;o++){const t=i[o];e.add(t)}const n=[];this.nodes.each((t=>{null!==t.data&&!e.contains(t.data)&&n.push(t.data)})),this.parts.each((t=>{null!==t.data&&!e.contains(t.data)&&n.push(t.data)})),n.forEach((e=>t.gT(e,!1)));for(let o=0;o<i.length;o++){const e=i[o];null===this.findPartForData(e)&&t.mT(e,!1)}this.pT();let s=this.parts.iterator;for(;s.next();)s.value.updateRelationshipsFromData();for(s=this.nodes.iterator;s.next();)s.value.updateRelationshipsFromData();for(s=this.links.iterator;s.next();)s.value.updateRelationshipsFromData()}pT(){}updateRelationshipsFromData(t){}Ny(t,e){if("string"==typeof e){const i=this.findPartForData(t);if(null!==i)i.updateTargetBindings(e);else{const i=this.SO(t);if(null!==i){for(let t=0;t<i.length;t++)i[t].updateTargetBindings(e);d.it(i)}}t===this.diagram.model.modelData&&this.updateAllTargetBindings(e)}}SO(t){let e=null;const i=this.Va.iterator;for(;i.next();){const n=i.value;for(let i=0;i<n.length;i++){const s=n[i].findItemPanelForData(t);null!==s&&(null===e&&(e=d.rt()),e.push(s))}if(null!==e)break}return e}MO(t){const e=t.object,i=3===t.change,n=i?t.newParam:t.oldParam,s=i?t.newValue:t.oldValue,o=this.Va.getValue(e);if(Array.isArray(o))for(let r=0;r<o.length;r++){const t=o[r];i?t.qb(s,n,!0):t.uv(n)}}bS(t,e){null!==e&&t.$r((t=>e.xL(t)));const i=t.ph;if(Array.isArray(i)){const e=this.Va.getValue(i);if(null===e){const e=[];e.push(t),this.Va.add(i,e)}else{for(let i=0;i<e.length;i++)if(e[i]===t)return;e.push(t)}}}kS(t,e){t.$r((t=>e.gR(t)));const i=t.ph;if(Array.isArray(i)){const e=this.Va.getValue(i);if(null!==e)for(let n=0;n<e.length;n++)if(e[n]===t)return e.splice(n,1),void(0===e.length&&this.Va.remove(i))}}copyParts(t,e,i){void 0===i&&(i=!1);const n=new L;if(Array.isArray(t))for(let o=0;o<t.length;o++)this.N1(t[o],e,n,i);else{const s=t.iterator;for(;s.next();)this.N1(s.value,e,n,i)}if(null!==e){const t=e.model,i=e.c0().dragsLink,s=new k,o=new L,r=n.iterator;for(;r.next();){const a=r.value;if(a instanceof De)!i&&(null===a.fromNode||null===a.toNode)&&s.add(a);else if(a instanceof Ce&&null!==a.data)if(t.Hu()){const i=a,s=r.key,l=s.findTreeParentNode();if(null!==l){const r=n.getValue(l);if(null!==r){t.setParentKeyForNodeData(i.data,t.getKeyForNodeData(r.data));const n=e.findLinkForData(i.data),a=s.findTreeParentLink();null!==a&&null!==n&&o.add(a,n)}else t.setParentKeyForNodeData(i.data,void 0)}}else if(t.ju()){const i=a,s=r.key,l=t.isRelatedKeysPathTo?s.findNodesOutOf():s.findNodesInto();for(;l.next();){const r=l.value,a=n.getValue(r);if(null!==a){t.addRelatedKeyForNodeData(i.data,a.key);const n=e.partManager.findLinkForData(i.data,a.key),l=this.findLinkForData(s.data,r.key);null!==l&&null!==n&&o.add(l,n)}else t.removeRelatedKeyForNodeData(i.data,r.key)}}}if(s.count>0&&e.removeParts(s,!1),o.count>0){const t=o.iterator;for(;t.next();){const e=t.key,i=t.value;n.add(e,i)}}}if(null!==e&&null!==this.k){const t=e.model,i=t.afterCopyFunction;if(null!==i){const e=new L;n.each((t=>{null!==t.key.data&&e.add(t.key.data,t.value.data)}));const s=this.k.model;i(e,t,s)}}const s=n.iterator;for(;s.next();)s.value.updateTargetBindings();return n}N1(t,e,i,n){if(null===t||n&&!t.canCopy())return null;if(i.contains(t))return i.getValue(t);const s=this.gN(t,e);if(!(s instanceof ke))return null;if(s.isSelected=!1,s.isHighlighted=!1,i.add(t,s),t instanceof Ce){const o=t.linksConnected;for(;o.next();){const e=o.value;if(e.fromNode===t){const t=i.getValue(e);null!==t&&(t.fromNode=s)}if(e.toNode===t){const t=i.getValue(e);null!==t&&(t.toNode=s)}}if(t instanceof Ve&&s instanceof Ve){const o=t.memberParts;for(;o.next();){const t=o.value,r=this.N1(t,e,i,n);r instanceof De||null!==r&&(r.containingGroup=s)}}}else if(t instanceof De&&s instanceof De){const o=t.fromNode;if(null!==o){const t=i.getValue(o);null!==t&&(s.fromNode=t)}const r=t.toNode;if(null!==r){const t=i.getValue(r);null!==t&&(s.toNode=t)}const a=t.labelNodes;for(;a.next();){const t=a.value,o=this.N1(t,e,i,n);null!==o&&o instanceof Ce&&(o.labeledLink=s)}}return s}gN(t,e){let i=null;const n=t.data;if(null!==n&&null!==e){const s=e.model;if(!(t instanceof De)){const t=s.copyNodeData(n);d.wt(t)&&(s.addNodeData(t),i=e.findPartForData(t))}}else if(t.hi(),i=t.copy(),null!==i){const t=this.k;if(null!==e)e.add(i);else if(null!==n&&null!==t&&null!==t.commandHandler&&t.commandHandler.copiesClipboardData){const e=t.model;let s=null;i instanceof De||(s=e.copyNodeData(n)),d.wt(s)&&(i.data=s)}}return i}get nodes(){return this.Qd}get links(){return this.Ws}get parts(){return this.At}get diagram(){return this.k}get addsToTemporaryLayer(){return this.My}set addsToTemporaryLayer(t){this.My=t}get preservesRebuildLocations(){return this.cN}set preservesRebuildLocations(t){this.cN=t}}y(qe,"cT",!1),y(qe,"fT",!1),y(qe,"uT",!1);var We=(t=>(t[t.OneWay=1]="OneWay",t[t.TwoWay=2]="TwoWay",t))(We||{});class $e{constructor(t,e,i,n){y(this,"n",void 0),y(this,"mN",void 0),y(this,"Ua",void 0),y(this,"Sf",void 0),y(this,"Sh",void 0),y(this,"Nf",void 0),y(this,"Cf",void 0),y(this,"Lf",void 0),y(this,"A1",void 0),y(this,"Se",void 0),y(this,"md",void 0),y(this,"af",void 0),k.Yi(this),void 0===t?t="":d.i(t,"string",$e,"constructor:targetprop"),void 0===e?e=t:d.i(e,"string",$e,"constructor:sourceprop"),void 0===i?i=null:null!==i&&d.i(i,"function",$e,"constructor:conv"),this.mN=-1,this.Se=null,this.Ua=t,this.md=0,this.af=0,this.Sf=null,this.Sh=e,this.Nf=i,void 0===n?(this.Cf=1,this.Lf=null):(this.Cf=2,this.Lf=n),this.A1=new k,this.n=2}copy(){const t=new this.constructor;return this.cloneProtected(t),t}cloneProtected(t){t.Ua=this.Ua,t.md=this.md,t.af=this.af,t.Sf=this.Sf,t.Sh=this.Sh,t.Nf=this.Nf,t.Cf=this.Cf,t.Lf=this.Lf,t.n=-2&this.n}static parseEnum(t,e){return d.i(t,"function",$e,"parseEnum:ctor"),i=>{let n=parseInt(i);return isNaN(n)&&(n=d.Eh(t,i),null===n)?e:n}}li(t){t in We?this.mode=t:d.ar(this,t)}static toString(t){return d.toString(t)}toString(){return"Binding("+this.targetProperty+":"+this.sourceProperty+(-1!==this.targetId?" "+this.targetId:"")+" "+We[this.mode]+")"}g(){return this.n=1|this.n,this}lt(){return this.n=-2&this.n,this}get targetId(){return this.mN}set targetId(t){this.h&&d.D(this),d.i(t,"number",$e,"targetId"),this.mN=t}get targetProperty(){return this.Ua}set targetProperty(t){this.h&&d.D(this),d.i(t,"string",$e,"targetProperty"),this.Ua=t}get sourceProperty(){return this.Sh}set sourceProperty(t){this.h&&d.D(this),d.i(t,"string",$e,"sourceProperty"),this.Sh=t}get h(){return 0!==(1&this.n)}get isToData(){return 0!==(2&this.n)}get isToObject(){return 0!==(4&this.n)}get isToModel(){return 0!==(8&this.n)}get isToTheme(){return 0!==(16&this.n)}get pN(){return this.isToTheme&&!(this.isToData||this.isToObject||this.isToModel)}Qu(){return!1}get sourceName(){return this.Sf}set sourceName(t){this.h&&d.D(this),null!==t&&d.i(t,"string",$e,"sourceName"),this.Sf=t,this.n=null!==t?-3&this.n|4:2|this.n}get converter(){return this.Nf}set converter(t){this.h&&d.D(this),null!==t&&d.i(t,"function",$e,"converter"),this.Nf=t}get backConverter(){return this.Lf}set backConverter(t){this.h&&d.D(this),null!==t&&d.i(t,"function",$e,"backConverter"),this.Lf=t}get mode(){return this.Cf}set mode(t){this.h&&d.D(this),this.isToTheme&&2===t&&d.o("Theme Bindings cannot be TwoWay."),this.Cf=t}makeTwoWay(t){return this.isToTheme&&d.o("Theme Bindings cannot be TwoWay."),this.mode=2,t&&(d.i(t,"function",$e,"makeTwoWay"),this.backConverter=t),this}ofObject(t){return this.h&&d.D(this),void 0===t&&(t=""),this.sourceName=t,this}ofModel(){return this.h&&d.D(this),this.n=-3&this.n&-5|8,this.Sf=null,this}qL(t,e){const i=this.sourceName;let n=null;return n=null===i||""===i?t:"/"===i?e.part:"."===i?e:".."===i?e.panel:t.findObject(i),n}check(t){const e=this.Ua,i=this.Sh,n=this.Nf;(this.Qu()&&null===n&&null===this.Nh&&""===e||null===n&&""===e)&&d.ri("Binding error: target property is the empty string: "+this.toString()),this.Qu()&&this.pN&&""===i&&null===n&&null===this.Nh&&d.ri("Binding error: theme bindings require a source property when not using a converter: "+this.toString()),t&&"string"==typeof e&&("function"!=typeof t.setAttribute&&e.length>0&&"_"!==e[0]&&!d.fw(t,e)?d.ri("Binding error: undefined target property: "+e+" on "+t.toString()):"name"===e&&t instanceof Kt&&d.ri("Binding error: cannot modify GraphObject.name on "+t.toString()))}updateTarget(t,e,i){var n,s,o;const r=this.Sh;if(void 0!==i&&""!==r&&r!==i)return;const a=this.Ua,l=this.Nf;let h=e;if(""!==r&&!this.pN&&(h=Ze.vt(e,r)),void 0===h)return;const u=null!==(n=null===(s=t.diagram)||void 0===s?void 0:s.themeManager)&&void 0!==n?n:null===(o=t.panel)||void 0===o||null===(o=o.diagram)||void 0===o?void 0:o.themeManager;if(null===l){if(""!==a){if(this.Qu()&&(h=this.PT(u,h,t,a),void 0===h))return;Ze.ht(t,a,h)}}else try{if(""!==a){let e=l(h,t);if(this.Qu()&&(e=this.PT(u,e,t,a),void 0===e))return;Ze.ht(t,a,e)}else l(h,t)}catch{}}updateSource(t,e,i,n){if(2!==this.Cf)return;const s=this.Ua;if(void 0!==i&&s!==i)return;const o=this.Sh,r=this.Lf;let a=t;if(""!==s&&(a=Ze.vt(t,s)),void 0!==a&&!this.A1.contains(t))try{this.A1.add(t);const i=null!==n?n.diagram:null,s=null!==i?i.model:null;if(null===r){if(""!==o)null!==s?s.setDataProperty(e,o,a):Ze.ht(e,o,a);else if(null!==s&&null!==n&&n.itemIndex>=0&&null!==n.panel&&Array.isArray(n.panel.itemArray)){const t=n.itemIndex,e=n.panel.itemArray;s.removeArrayItem(e,t),s.insertArrayItem(e,t,a)}}else try{if(""!==o){const t=r(a,e,s);null!==s?s.setDataProperty(e,o,t):Ze.ht(e,o,t)}else{const t=r(a,e,s);if(void 0!==t&&null!==s&&null!==n&&n.itemIndex>=0&&null!==n.panel&&Array.isArray(n.panel.itemArray)){const e=n.itemIndex,i=n.panel.itemArray;s.removeArrayItem(i,e),s.insertArrayItem(i,e,t)}}}catch{}}finally{this.A1.remove(t)}}}y($e,"OneWay",1),y($e,"TwoWay",2);class Je extends $e{constructor(t,e,i,n,s){super(t,e,n),y(this,"Ly",void 0),y(this,"Nh",void 0),y(this,"Ba",void 0),null==i&&(i=""),void 0===s&&(s=null),this.Ly=i,this.Nh=s,this.Ba=null,this.n=16}cloneProtected(t){super.cloneProtected(t),t.Ly=this.Ly,t.Nh=this.Nh,t.Ba=this.Ba}Qu(){return!0}get themeSource(){return this.Ly}set themeSource(t){this.h&&d.D(this),null!==t&&d.i(t,"string",Je,"themeSource"),this.Ly=t,this.Ba=null,this.n=null!==t?16|this.n:-17&this.n}get themeConverter(){return this.Nh}set themeConverter(t){this.h&&d.D(this),null!==t&&d.i(t,"function",Je,"themeConverter"),this.Nh=t}ofData(){return this.h&&d.D(this),this.n=2|this.n,this.Sf=null,this}PT(t,e,i,n){if(!t||(this.pN&&(e=this.Sh),!e&&0!==e))return;let s=this.themeSource;null!==this.Ba?s=this.Ba:"string"==typeof s&&s.includes(".")&&(this.Ba=s.split("."),s=this.Ba);let o=t.findValue(e,s,n);return void 0===o&&d.ri("Theme warning: ".concat(e," could not be found when setting target property ").concat(n,".")),"function"==typeof this.Nh&&(o=this.Nh(o,i)),o}}class Ze{constructor(t,e){if(y(this,"St",void 0),y(this,"ig",void 0),y(this,"Io",void 0),y(this,"T1",void 0),y(this,"ve",void 0),y(this,"Af",void 0),y(this,"Tf",void 0),y(this,"eg",void 0),y(this,"sg",void 0),y(this,"ng",void 0),y(this,"og",void 0),y(this,"za",void 0),y(this,"nr",void 0),y(this,"D1",void 0),y(this,"Oo",void 0),y(this,"F1",void 0),y(this,"ti",void 0),y(this,"Ch",void 0),y(this,"rg",new k),y(this,"lg",new k),y(this,"Ay",void 0),y(this,"AT",',\n  "insertedNodeKeys": '),y(this,"NO",',\n  "modifiedNodeData": '),y(this,"TT",',\n  "removedNodeKeys": '),y(this,"Xa",null),k.Yi(this),this.St="",this.ig="",this.Io=!1,this.T1={},this.ve=[],this.ti=new L,this.Ch="key",this.Af=null,this.Tf=null,this.eg=!1,this.sg=!1,this.ng=!1,this.og=null,this.za="category",this.nr=new L,this.Ay=100,this.D1=new x,this.Oo=!1,this.F1=null,this.undoManager=new q,void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:e=t),e){Object.assign(this,e);const t=e.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){t.St=this.St,t.ig=this.ig,t.Io=this.Io,t.Ch=this.Ch,t.Af=this.Af,t.Tf=this.Tf,t.eg=this.eg,t.sg=this.sg,t.ng=this.ng,t.Ay=this.Ay,t.og=this.og,t.za=this.za}copy(){const t=new this.constructor;return this.cloneProtected(t),t}clear(){this.ve=[],this.ti.clear(),this.nr.clear(),this.undoManager.clear()}toString(t){if(void 0===t&&(t=0),t>1)return this.toJson();{let e=(""!==this.name?this.name:"")+" Model";if(t>0){e+="\n node data:";const t=this.nodeDataArray,i=t.length;for(let n=0;n<i;n++){const i=t[n];e+=" "+this.getKeyForNodeData(i)+":"+d.toString(i)}}return e}}toIncrementalData(t){1!==t.change&&d.o("Model.toIncrementalData argument is not a Transaction ChangedEvent:"+t.toString());const e=t.object;if(!t.isTransactionFinished||!(e instanceof H))return null;this.MT(e);const i=this.yN(e,"FinishedUndo"===t.propertyName);return this.Xa=null,i}yN(t,e){const i=this;let n=!1;const s=new k,o=new k,r=new k,a=this.Xa;t.changes.each((t=>{if(t.model===i)if("nodeDataArray"===t.modelChange)3===t.change?s.add(t.newValue):4===t.change&&r.add(t.oldValue);else if(i.containsNodeData(t.object))o.add(t.object);else if(2!==t.change||i.modelData!==t.object&&"modelData"!==t.propertyName){if(null!==t.object)if(a&&a.contains(t.object))a.get(t.object).each((t=>{i.containsNodeData(t)&&o.add(t)}));else{if(t.object instanceof Ze||i.Ta()&&i.containsLinkData(t.object))return;i.ST(t.object).each((t=>{o.add(t)}))}}else n=!0}));const l=this.lg;l.clear(),s.each((t=>{l.add(i.getKeyForNodeData(t)),e||o.add(t)}));const h=this.rg;h.clear(),r.each((t=>{h.add(i.getKeyForNodeData(t)),e&&o.add(t)}));const u=i.cloneDeep(o.toArray());let c=null;return n&&(null===c&&(c={}),c.modelData=this.cloneDeep(this.modelData)),l.count>0&&(null===c&&(c={}),e?c.removedNodeKeys=l.toArray():c.insertedNodeKeys=l.toArray()),u.length>0&&(null===c&&(c={}),c.modifiedNodeData=u),h.count>0&&(null===c&&(c={}),e?c.insertedNodeKeys=h.toArray():c.removedNodeKeys=h.toArray()),h.clear(),l.clear(),c}cloneDeep(t){return this.hg(t,!0)}hg(t,e,i,n,s){if(!d.wt(t))return t;s||(s=[]);const o=Object.isExtensible(t);if(i||(i=new L),o){const e=i.get(t);if(e)return e}else{n||(n=new L);const e=n.iterator;for(;e.next();){const n=e.key;if(e.value===t){const t=i.get(n);if(t)return t}}}function r(e,r){if(o)void 0===e.__gohashid&&s.push(e),i.set(e,r);else{const e=k.su++;i.set(e,r),n.set(e,t)}}let a;if(Array.isArray(t)){a=[],r(t,a);for(let e=0;e<t.length;e++){const o=t[e];a.push(this.hg(o,!1,i,n,s))}}else if(t instanceof T||t instanceof A||t instanceof D||t instanceof F||t instanceof O)a=t.copy(),r(t,a);else{if(t instanceof Qt||t instanceof z)return t;if(t instanceof x)a=(new x).addAll(this.hg(t.toArray(),!1,i,n,s)),r(t,a);else if(t instanceof k)a=(new k).addAll(this.hg(t.toArray(),!1,i,n,s)),r(t,a);else if(t instanceof L)a=(new L).addAll(this.hg(t.toArray(),!1,i,n,s)),r(t,a);else if(t instanceof Date)a=new Date(t.getTime()),r(t,a);else if(t instanceof RegExp)a=new RegExp(t),r(t,a),a.lastIndex=t.lastIndex;else if("function"==typeof t.copy)a=t.copy(),r(t,a);else{a={},r(t,a);for(const e in t){if("__gohashid"===e)continue;const o=t[e];a[e]=this.hg(o,!1,i,n,s)}}}return e&&s.forEach((t=>{delete t.__gohashid})),a}Oe(t){return JSON.stringify(t).replace(/[\u007F-\uFFFF]/g,(t=>{const e="0000"+t.charCodeAt(0).toString(16);return"\\u"+e.substring(e.length-4)}))}ag(){let t="";return""!==this.name&&(t+=',\n  "name": '+this.Oe(this.name)),""!==this.dataFormat&&(t+=',\n  "dataFormat": '+this.Oe(this.dataFormat)),this.isReadOnly&&(t+=',\n  "isReadOnly": '+this.isReadOnly),"key"!==this.nodeKeyProperty&&"string"==typeof this.nodeKeyProperty&&(t+=',\n  "nodeKeyProperty": '+this.Oe(this.nodeKeyProperty)),this.copiesArrays&&(t+=',\n  "copiesArrays": true'),this.copiesArrayObjects&&(t+=',\n  "copiesArrayObjects": true'),this.copiesKey&&(t+=',\n  "copiesKey": true'),100!==this.pointsDigits&&(t+=',\n  "pointsDigits": '+this.pointsDigits.toString()),"category"!==this.nodeCategoryProperty&&"string"==typeof this.nodeCategoryProperty&&(t+=',\n  "nodeCategoryProperty": '+this.Oe(this.nodeCategoryProperty)),t}Ty(t){t.name&&(this.name=t.name),t.dataFormat&&(this.dataFormat=t.dataFormat),t.isReadOnly&&(this.isReadOnly=!0),t.nodeKeyProperty&&(this.nodeKeyProperty=t.nodeKeyProperty),t.copiesArrays&&(this.copiesArrays=!0),t.copiesArrayObjects&&(this.copiesArrayObjects=!0),void 0!==t.copiesKey&&(this.copiesKey=t.copiesKey),void 0!==t.pointsDigits&&(this.pointsDigits=parseInt(t.pointsDigits)),t.nodeCategoryProperty&&(this.nodeCategoryProperty=t.nodeCategoryProperty)}NT(){const t=this.modelData;return',\n  "modelData": '+this.CT(t)}LT(t){const e=t.modelData;d.wt(e)&&(this.replaceJsonObjects(e),this.modelData=e)}wN(){const t=this.modelData;let e=!1;for(const n in t)if(!this.R1(t,n,t[n])){e=!0;break}let i="";return e&&(i=this.NT()),i+',\n  "nodeDataArray": '+this.Lh(this.nodeDataArray,!0)}xN(t){this.LT(t);const e=t.nodeDataArray;Array.isArray(e)&&(this.replaceJsonObjects(e),this.nodeDataArray=e)}bN(t,e,i){if(t===e)return!0;if(typeof t!=typeof e||"function"==typeof t||"function"==typeof e)return!1;if(Array.isArray(t)&&Array.isArray(e)){if(i.getValue(t)===e)return!0;if(i.add(t,e),t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!this.bN(t[n],e[n],i))return!1;return!0}if(d.wt(t)&&d.wt(e)){if(i.getValue(t)===e)return!0;i.add(t,e);for(const n in t){const s=t[n];if(this.R1(t,n,s))continue;const o=e[n];if(void 0===o||!this.bN(s,o,i))return!1}for(const n in e){const s=e[n];if(this.R1(e,n,s))continue;const o=t[n];if(void 0===o||!this.bN(o,s,i))return!1}return!0}return!1}MT(t){let e=this.Xa;const i=(t,i)=>{const n=i.part;if(!n)return;const s=n.data;if(t===s)return;let o=e.get(t);null===o?(o=new k,o.add(s),e.add(t,o)):o.add(s)};null===e&&(e=new L,t.changes.each((t=>{if(null!==t.diagram){const e=t.change;if(2===e){const e=t.object.panel;if(e){const t=e.data;t&&i(t,e)}}else if(3===e||4===e){const e=t.object,n=e.itemArray;n&&i(n,e)}}})),this.Xa=e)}ST(t){const e=new k;for(let i=0;i<this.nodeDataArray.length;i++){const n=this.nodeDataArray[i];this.v1(t,n,n,e)}return e}v1(t,e,i,n){if(Array.isArray(e))for(let s=0;s<e.length;s++){const o=e[s];if(o===t)return n.add(i),!0;if(this.v1(t,o,i,n))return!0}else if(d.wt(e)&&Object.getPrototypeOf(e)===Object.prototype)for(const s in e){const o=e[s];if(o===t)return n.add(i),!0;if(this.v1(t,o,i,n))return!0}return!1}kN(t,e){const i=this;let n=!1;const s=new k,o=new k,r=new k,a=this.Xa;t.changes.each((t=>{if(t.model===i)if("nodeDataArray"===t.modelChange)3===t.change?s.add(t.newValue):4===t.change&&r.add(t.oldValue);else if(i.containsNodeData(t.object))o.add(t.object);else if(2!==t.change||i.modelData!==t.object&&"modelData"!==t.propertyName){if(null!==t.object)if(a&&a.contains(t.object))a.get(t.object).each((t=>{i.containsNodeData(t)&&o.add(t)}));else{if(t.object instanceof Ze||i.Ta()&&i.containsLinkData(t.object))return;i.ST(t.object).each((t=>{o.add(t)}))}}else n=!0}));const l=this.lg;l.clear(),s.each((t=>{l.add(i.getKeyForNodeData(t)),e||o.add(t)}));const h=this.rg;h.clear(),r.each((t=>{h.add(i.getKeyForNodeData(t)),e&&o.add(t)}));let u="";return n&&(u+=this.NT()),l.count>0&&(u+=(e?this.TT:this.AT)+this.Lh(l.toArray(),!0)),o.count>0&&(u+=this.NO+this.Lh(o.toArray(),!0)),h.count>0&&(u+=(e?this.AT:this.TT)+this.Lh(h.toArray(),!0)),h.clear(),l.clear(),u}Dy(t){(void 0!==t.name&&t.name!==this.name||void 0!==t.dataFormat&&t.dataFormat!==this.dataFormat||void 0!==t.isReadOnly&&t.isReadOnly!==this.isReadOnly||void 0!==t.nodeKeyProperty&&t.nodeKeyProperty!==this.nodeKeyProperty||void 0!==t.copiesArrays&&t.copiesArrays!==this.copiesArrays||void 0!==t.copiesArrayObjects&&t.copiesArrayObjects!==this.copiesArrayObjects||void 0!==t.copiesKey&&t.copiesKey!==this.copiesKey||void 0!==t.nodeCategoryProperty&&t.nodeCategoryProperty!==this.nodeCategoryProperty)&&d.o("applyIncrementalJson cannot change Model properties"),this.LT(t);const e=t.insertedNodeKeys,i=t.modifiedNodeData,n=new L;if(Array.isArray(i))for(let o=0;o<i.length;o++){const t=i[o],e=this.getKeyForNodeData(t);null!=e&&n.set(e,t)}if(Array.isArray(e)){const t=e.length;for(let i=0;i<t;i++){const t=e[i];let s=this.findNodeDataForKey(t);if(null===s){s=n.get(t)||this.copyNodeData({}),this.setKeyForNodeData(s,t),this.addNodeData(s)}}}if(Array.isArray(i)){const t=i.length;for(let e=0;e<t;e++){const t=i[e],n=this.getKeyForNodeData(t),s=this.findNodeDataForKey(n);if(null!==s){for(const e in t)"__gohashid"===e||e===this.nodeKeyProperty||(this.uc()||this.ju())&&e===this.nodeIsGroupProperty||this.setDataProperty(s,e,t[e]);this.cg(t,s)}}}const s=t.removedNodeKeys;if(Array.isArray(s)){const t=s.length;for(let e=0;e<t;e++){const t=s[e],i=this.findNodeDataForKey(t);null!==i&&this.removeNodeData(i)}}}toIncrementalJson(t,e){1!==t.change&&d.o("Model.toIncrementalJson argument is not a Transaction ChangedEvent:"+t.toString());const i=t.object;if(!t.isTransactionFinished||!(i instanceof H))return'{ "incremental": 0 }';void 0===e&&(e=d.nn(this)),this.MT(i);const n=this.kN(i,"FinishedUndo"===t.propertyName);return this.Xa=null,"2"===e?'{ "incremental": 2'+n+"}":'{ "class": '+this.Oe(e)+', "incremental": 1'+this.ag()+n+"}"}toIncrementalJSON(t,e){return this.toIncrementalJson(t,e)}toJson(t){return void 0===t&&(t=d.nn(this)),'{ "class": '+this.Oe(t)+this.ag()+this.wN()+"}"}toJSON(t){return this.toJson(t)}applyIncrementalJson(t){let e=null;if("string"==typeof t)try{e=c.JSON.parse(t)}catch{}else"object"==typeof t?e=t:d.o("Unable to modify a Model from: "+t);const i=e.incremental;"number"!=typeof i&&d.o("Unable to apply non-incremental changes to Model: "+t),0!==i&&(this.startTransaction("applyIncrementalJson"),this.Dy(e),this.commitTransaction("applyIncrementalJson"))}applyIncrementalJSON(t){return this.applyIncrementalJson(t)}static fromJson(t,e){void 0===e&&(e=null);let i=null;if("string"==typeof t)try{i=c.JSON.parse(t)}catch{}else"object"==typeof t?i=t:d.o("Unable to construct a Model from: "+t);if(null===e){const t=Ze.CO(i);null===t||t instanceof Ze?e=t:d.o("Unable to construct a Model of declared class: "+i.class)}return null===e&&(e=Ze.constructGraphLinksModel()),e.Ty(i),e.xN(i),e}static fromJSON(t,e){return this.fromJson(t,e)}static constructGraphLinksModel(){return new Ze}static CO(t){let e=null,i=t.class;if("string"==typeof i)try{let t=null;0===i.indexOf("go.")?(i=i.substring(3),t=Ze.O1(i)):(t=Ze.O1(i),null===t&&(t=c[i])),"function"==typeof t&&(e=new t)}catch{}return e}replaceJsonObjects(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++){const e=t[i];d.wt(e)&&(t[i]=this.replaceJsonObjects(e))}}else if(d.wt(t)){for(const e in t){const i=t[e];if(d.wt(i)){const n=this.replaceJsonObjects(i);if(t[e]=n,"points"===e&&Array.isArray(n)){let i=n.length%2===0;for(let t=0;t<n.length;t++)if("number"!=typeof n[t]){i=!1;break}if(i){const i=new x;for(let t=0;t<n.length/2;t++)i.add(new T(n[2*t],n[2*t+1]));i.g(),t[e]=i}}}}return this.LO(t)}return t}writeJsonValue(t){return void 0===t?"undefined":null===t?"null":!0===t?"true":!1===t?"false":"string"==typeof t?this.Oe(t):"number"==typeof t?t===1/0?"9e9999":t===-1/0?"-9e9999":isNaN(t)?'{"class":"NaN"}':t.toString():t instanceof Date?'{"class":"Date", "value":"'+t.toJSON()+'"}':t instanceof Number?this.writeJsonValue(t.valueOf()):Array.isArray(t)?this.Lh(t):d.wt(t)?this.CT(t):"function"==typeof t?"null":t.toString()}Lh(t,e){void 0===e&&(e=!1);const i=t.length;if(i<=0)return"[]";const n=new f;n.add("["),e&&i>1&&n.add("\n");for(let s=0;s<i;s++){const i=t[s];void 0!==i&&(s>0&&(n.add(","),e&&n.add("\n")),n.add(this.writeJsonValue(i)))}return e&&i>1&&n.add("\n"),n.add("]"),n.toString()}R1(t,e,i){return void 0===i||"__gohashid"===e||"_"===e[0]||"function"==typeof i}Xi(t){return isNaN(t)?"NaN":t===1/0?"9e9999":t===-1/0?"-9e9999":t}CT(t){const e=t;if(e instanceof T)t={class:"go.Point",x:this.Xi(e.x),y:this.Xi(e.y)};else if(e instanceof A)t={class:"go.Size",width:this.Xi(e.width),height:this.Xi(e.height)};else if(e instanceof D)t={class:"go.Rect",x:this.Xi(e.x),y:this.Xi(e.y),width:this.Xi(e.width),height:this.Xi(e.height)};else if(e instanceof F)t={class:"go.Margin",top:this.Xi(e.top),right:this.Xi(e.right),bottom:this.Xi(e.bottom),left:this.Xi(e.left)};else if(e instanceof O)t=e.isSpot()?{class:"go.Spot",x:this.Xi(e.x),y:this.Xi(e.y),offsetX:this.Xi(e.offsetX),offsetY:this.Xi(e.offsetY)}:{class:"go.Spot",enum:e.toString()};else if(e instanceof Qt){if(t={class:"go.Brush",type:$t[e.type]},1===e.type?t.color=e.color:(2===e.type||3===e.type)&&(t.start=e.start,t.end=e.end,3===e.type&&(0!==e.startRadius&&(t.startRadius=this.Xi(e.startRadius)),isNaN(e.endRadius)||(t.endRadius=this.Xi(e.endRadius)))),null!==e.colorStops){const i={},n=e.colorStops.iterator;for(;n.next();){const t=n.key,e=n.value;i[t]=e}t.colorStops=i}}else if(e instanceof z)t={class:"go.Geometry",type:I[e.type]},0!==e.startX&&(t.startX=this.Xi(e.startX)),0!==e.startY&&(t.startY=this.Xi(e.startY)),0!==e.endX&&(t.endX=this.Xi(e.endX)),0!==e.endY&&(t.endY=this.Xi(e.endY)),e.spot1.equals(O.TopLeft)||(t.spot1=e.spot1),e.spot2.equals(O.BottomRight)||(t.spot2=e.spot2),4===e.type&&(t.path=z.stringify(e));else if(null!==Ze.O1(d.nn(e)))return d.ri("ERROR: trying to convert a GraphObject or Diagram or Model or Tool or Layout or UndoManager or other unknown data type into JSON text: "+e.toString()),"{}";let i="{",n=!0;for(const s in t){const e=Ze.vt(t,s);if(!this.R1(t,s,e))if(n?n=!1:i+=",",i+=this.Oe(s)+":","points"===s&&e instanceof x){let t="[";const n=e.iterator;for(;n.next();){const e=n.value;t.length>1&&(t+=","),t+=this.DT(e.x),t+=",",t+=this.DT(e.y)}t+="]",i+=t}else i+=this.writeJsonValue(e)}return i+="}",i}DT(t){if(t===1/0)return"9e9999";if(t===-1/0)return"-9e9999";if(isNaN(t))return"0";const e=this.pointsDigits;return e>16?t.toString():t.toFixed(e)}get pointsDigits(){return this.Ay}set pointsDigits(t){t<0?t=0:t>100&&(t=100),this.Ay=t}Ki(t){return"number"==typeof t?t:"NaN"===t?NaN:"9e9999"===t?1/0:"-9e9999"===t?-1/0:parseFloat(t)}LO(t){if("object"!=typeof t)return t;let e=t.class||"";if("string"!=typeof e||""===e)return t;if("NaN"===e)return NaN;if("Date"===e)return new Date(t.value);if(0!==e.indexOf("go."))return t;e=e.substring(3);let i=t;if("Point"===e)i=new T(this.Ki(t.x),this.Ki(t.y));else if("Size"===e)i=new A(this.Ki(t.width),this.Ki(t.height));else if("Rect"===e)i=new D(this.Ki(t.x),this.Ki(t.y),this.Ki(t.width),this.Ki(t.height));else if("Margin"===e)i=new F(this.Ki(t.top),this.Ki(t.right),this.Ki(t.bottom),this.Ki(t.left));else if("Spot"===e)i="string"==typeof t.enum?O.parse(t.enum):new O(this.Ki(t.x),this.Ki(t.y),this.Ki(t.offsetX),this.Ki(t.offsetY));else if("Brush"===e){var n;const e=new Qt;e.type=null!==(n=d.Eh($t,t.type))&&void 0!==n?n:1,"string"==typeof t.color&&(e.color=t.color),t.start instanceof O&&(e.start=t.start),t.end instanceof O&&(e.end=t.end),"number"==typeof t.startRadius&&(e.startRadius=this.Ki(t.startRadius)),"number"==typeof t.endRadius&&(e.endRadius=this.Ki(t.endRadius));const s=t.colorStops;if(d.wt(s))for(const t in s){const i=parseFloat(t);e.addColorStop(i,s[t])}i=e}else if("Geometry"===e){var s;let e=null;e="string"==typeof t.path?z.parse(t.path):new z,e.type=null!==(s=d.Eh(I,t.type))&&void 0!==s?s:1,"number"==typeof t.startX&&(e.startX=this.Ki(t.startX)),"number"==typeof t.startY&&(e.startY=this.Ki(t.startY)),"number"==typeof t.endX&&(e.endX=this.Ki(t.endX)),"number"==typeof t.endY&&(e.endY=this.Ki(t.endY)),t.spot1 instanceof O&&(e.spot1=t.spot1),t.spot2 instanceof O&&(e.spot2=t.spot2),i=e}else if("EnumValue"===e){let e=t.classType;0===e.indexOf("go.")&&(e=e.substring(3));const n=Ze.O1(e);"function"==typeof n&&(i=d.Eh(n,t.name))}return i}get name(){return this.St}set name(t){const e=this.St;e!==t&&(d.i(t,"string",Ze,"name"),this.St=t,this.t("name",e,t))}get dataFormat(){return this.ig}set dataFormat(t){const e=this.ig;e!==t&&(d.i(t,"string",Ze,"dataFormat"),this.ig=t,this.t("dataFormat",e,t))}get isReadOnly(){return this.Io}set isReadOnly(t){const e=this.Io;e!==t&&(d.i(t,"boolean",Ze,"isReadOnly"),this.Io=t,this.t("isReadOnly",e,t))}get modelData(){return this.T1}set modelData(t){const e=this.T1;e!==t&&(d.i(t,"object",Ze,"modelData"),this.T1=t,this.t("modelData",e,t),this.updateTargetBindings(t))}addChangedListener(t){return d.i(t,"function",Ze,"addChangedListener:listener"),this.D1.add(t),this}removeChangedListener(t){d.i(t,"function",Ze,"removeChangedListener:listener"),this.D1.remove(t)}Iw(t){this.skipsUndoManager||this.undoManager.handleChanged(t);const e=this.D1,i=e.length;for(let n=0;n<i;n++)e.elt(n)(t)}raiseChangedEvent(t,e,i,n,s,o,r){this.Et("",t,e,i,n,s,o,r)}raiseChanged(t,e,i,n,s){this.Et("",2,t,this,e,i,n,s)}t(t,e,i,n,s){this.Et("",2,t,this,e,i,n,s)}raiseDataChanged(t,e,i,n,s,o){this.Et("",2,e,t,i,n,s,o)}Et(t,e,i,n,s,o,r,a){void 0===r&&(r=null),void 0===a&&(a=null);const l=new _;l.model=this,l.change=e,l.modelChange=t,l.propertyName=i,l.object=n,l.oldValue=s,l.oldParam=r,l.newValue=o,l.newParam=a,this.Iw(l)}get undoManager(){return this.F1}set undoManager(t){const e=this.F1;e!==t&&(null!==e&&e.removeModel(this),this.F1=t,null!==t&&t.addModel(this))}get skipsUndoManager(){return this.Oo}set skipsUndoManager(t){d.i(t,"boolean",Ze,"skipsUndoManager"),this.Oo=t}changeState(t,e){if(null!==t&&t.model===this)if(2===t.change){const i=t.object,n=t.propertyName,s=t.getValue(e);if(n===this.nodeKeyProperty&&this.containsNodeData(i)){const n=t.getValue(!e);void 0!==n&&this.ti.remove(n),void 0!==s&&this.ti.add(s,i)}Ze.ht(i,n,s)}else if(3===t.change){const i=t.newParam;if("nodeDataArray"===t.modelChange){const n=t.newValue;if(d.wt(n)&&"number"==typeof i){const t=this.getKeyForNodeData(n);e?(this.ve[i]===n&&d._a(this.ve,i),void 0!==t&&this.ti.remove(t)):(this.ve[i]!==n&&d.eu(this.ve,i,n),void 0!==t&&this.ti.add(t,n))}}else if(""===t.modelChange){let n=t.object;if(n&&!Array.isArray(n)&&t.propertyName&&(n=Ze.vt(t.object,t.propertyName)),Array.isArray(n)&&"number"==typeof i){const s=t.newValue;e?d._a(n,i):d.eu(n,i,s)}}else d.o("unknown ChangeType.Insert modelChange: "+t.toString())}else if(4===t.change){const i=t.oldParam;if("nodeDataArray"===t.modelChange){const n=t.oldValue;if(d.wt(n)&&"number"==typeof i){const t=this.getKeyForNodeData(n);e?(this.ve[i]!==n&&d.eu(this.ve,i,n),void 0!==t&&this.ti.add(t,n)):(this.ve[i]===n&&d._a(this.ve,i),void 0!==t&&this.ti.remove(t))}}else if(""===t.modelChange){let n=t.object;if(n&&!Array.isArray(n)&&t.propertyName&&(n=Ze.vt(t.object,t.propertyName)),Array.isArray(n)&&"number"==typeof i){const s=t.oldValue;e?d.eu(n,i,s):d._a(n,i)}}else d.o("unknown ChangeType.Remove modelChange: "+t.toString())}else 1===t.change||d.o("unknown ChangedEvent: "+t.toString())}startTransaction(t){return this.undoManager.startTransaction(t)}commitTransaction(t){return this.undoManager.commitTransaction(t)}rollbackTransaction(){return this.undoManager.rollbackTransaction()}commit(t,e){let i=e;void 0===i&&(i="");const n=this.skipsUndoManager;null===i&&(this.skipsUndoManager=!0,i=""),this.undoManager.startTransaction(i);let s=!1;try{t(this),s=!0}finally{s?this.undoManager.commitTransaction(i):this.undoManager.rollbackTransaction(),this.skipsUndoManager=n}}updateTargetBindings(t,e){void 0===e&&(e=""),this.Et("SourceChanged",1,e,t,null,null)}get nodeKeyProperty(){return this.Ch}set nodeKeyProperty(t){const e=this.Ch;e!==t&&(this.Dn(t,Ze,"nodeKeyProperty"),""===t&&d.o("Model.nodeKeyProperty may not be the empty string"),this.ti.count>0&&d.o("Cannot set Model.nodeKeyProperty when there is existing node data"),this.Ch=t,this.t("nodeKeyProperty",e,t))}Dn(t,e,i){"string"!=typeof t&&"function"!=typeof t&&d.ke(t,"string or function",e,i)}getKeyForNodeData(t){if(null===t)return;const e=this.Ch;if(""===e)return;const i=Ze.vt(t,e);if(void 0!==i){if(this.isKeyType(i))return i;d.o("Key value for node data "+t+" is not a number or a string: "+i)}}setKeyForNodeData(t,e){if((null==e||!this.isKeyType(e))&&d.ke(e,"number or string",Ze,"setKeyForNodeData:key"),null===t)return;const i=this.Ch;if(""===i)return;if(!this.containsNodeData(t))return void Ze.ht(t,i,e);const n=Ze.vt(t,i);if(n!==e){if(null!==this.findNodeDataForKey(e))return;Ze.ht(t,i,e),void 0!==n&&this.ti.remove(n),this.ti.add(e,t),this.Et("nodeKey",2,i,t,n,e),"string"==typeof i&&this.updateTargetBindings(t,i),this.Fy(n,e)}}get makeUniqueKeyFunction(){return this.Af}set makeUniqueKeyFunction(t){const e=this.Af;e!==t&&(null!==t&&d.i(t,"function",Ze,"makeUniqueKeyFunction"),this.Af=t,this.t("makeUniqueKeyFunction",e,t))}isKeyType(t){return"number"==typeof t||"string"==typeof t}containsNodeData(t){const e=this.getKeyForNodeData(t);return void 0!==e&&this.ti.getValue(e)===t}findNodeDataForKey(t){return null===t&&d.o("Model.findNodeDataForKey:key must not be null"),void 0!==t&&this.isKeyType(t)?this.ti.getValue(t):null}get nodeDataArray(){return this.ve}set nodeDataArray(t){const e=this.ve;if(e!==t){this.ti.clear(),this.PN();const i=t.length;for(let e=0;e<i;e++){const i=t[e];d.wt(i)||d.o("Model.nodeDataArray must only contain Objects, not: "+i)}this.ve=t;const n=new x;for(let e=0;e<i;e++){const i=t[e],s=this.getKeyForNodeData(i);void 0===s||null!==this.ti.getValue(s)?n.add(i):this.ti.add(s,i)}const s=n.iterator;for(;s.next();){const t=s.value;this.makeNodeDataKeyUnique(t);const e=this.getKeyForNodeData(t);void 0!==e&&this.ti.add(e,t)}this.Et("nodeDataArray",2,"nodeDataArray",this,e,t);for(let e=0;e<i;e++){const i=t[e];this.fg(i),this.ug(i)}}}makeNodeDataKeyUnique(t){if(null===t)return;const e=this.Ch;if(""===e)return;let i=this.getKeyForNodeData(t);if(void 0!==i&&!this.ti.contains(i))return;const n=this.Af;if(null===n||(i=n(this,t),null==i||this.ti.contains(i))){if("string"==typeof i){let n=2;for(;this.ti.contains(i+n);)n++;Ze.ht(t,e,i+n)}else if(void 0===i||"number"==typeof i){let i=-this.ti.count-1;for(;this.ti.contains(i);)i--;Ze.ht(t,e,i)}}else Ze.ht(t,e,i)}addNodeData(t){null!==t&&(this.containsNodeData(t)||this.mT(t,!0))}mT(t,e){let i=this.getKeyForNodeData(t);if(void 0===i)this.makeNodeDataKeyUnique(t),i=this.getKeyForNodeData(t);else{if(this.ti.getValue(i)===t)return;this.makeNodeDataKeyUnique(t),i=this.getKeyForNodeData(t)}void 0===i&&d.o("Model.makeNodeDataKeyUnique failed on "+t+".  Data not added to Model."),this.ti.add(i,t);let n=null;e&&(n=this.ve.length,d.eu(this.ve,n,t)),this.Et("nodeDataArray",3,"nodeDataArray",this,null,t,null,n),this.fg(t),this.ug(t)}addNodeDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.addNodeData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.addNodeData(t)}}}removeNodeData(t){null!==t&&this.gT(t,!0)}gT(t,e){const i=this.getKeyForNodeData(t);void 0!==i&&this.ti.remove(i);let n=null;if(e){if(n=this.ve.indexOf(t),n<0)return;d._a(this.ve,n)}this.Et("nodeDataArray",4,"nodeDataArray",this,t,null,n,null),this.Ry(t)}removeNodeDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.removeNodeData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.removeNodeData(t)}}}mergeNodeDataArray(t){if(t!==this.nodeDataArray&&Array.isArray(t)){const e=this.rg;e.clear(),e.addAll(this.ti.iteratorKeys);const i=this.lg;i.clear();const n=t.length;for(let o=0;o<n;o++){const e=t[o],n=this.getKeyForNodeData(e);if(void 0!==n){i.add(n);const t=this.findNodeDataForKey(n);if(t===e)continue;if(null!==t)this.assignAllDataProperties(t,e),this.cg(e,t);else{const t=this.cloneDeep(e);this.setKeyForNodeData(t,n),this.addNodeData(t)}}else{const t=this.cloneDeep(e);this.addNodeData(t),i.add(this.getKeyForNodeData(t))}}const s=e.iterator;for(;s.next();){const t=s.value;if(!i.contains(t)){const e=this.findNodeDataForKey(t);e&&this.removeNodeData(e)}}e.clear(),i.clear()}}Fy(t,e){if(void 0===e)return;const i=this.Cy(t);i instanceof k&&this.nr.add(e,i)}PN(){}fg(t){}ug(t){}Ry(t){}Zs(t,e){if(void 0===t)return;let i=this.nr.getValue(t);null===i&&(i=new k,this.nr.add(t,i)),i.add(e)}$s(t,e){if(void 0===t)return;const i=this.nr.getValue(t);i instanceof k&&(null==e?this.nr.remove(t):(i.remove(e),0===i.count&&this.nr.remove(t)))}Cy(t){if(void 0===t)return null;const e=this.nr.getValue(t);return e instanceof k?e:null}mE(t){void 0===t?this.nr.clear():this.nr.remove(t)}get copyNodeDataFunction(){return this.Tf}set copyNodeDataFunction(t){const e=this.Tf;e!==t&&(null!==t&&d.i(t,"function",Ze,"copyNodeDataFunction"),this.Tf=t,this.t("copyNodeDataFunction",e,t))}get copiesArrays(){return this.eg}set copiesArrays(t){const e=this.eg;e!==t&&(null!==t&&d.i(t,"boolean",Ze,"copiesArrays"),this.eg=t,this.t("copiesArrays",e,t))}get copiesArrayObjects(){return this.sg}set copiesArrayObjects(t){const e=this.sg;e!==t&&(null!==t&&d.i(t,"boolean",Ze,"copiesArrayObjects"),this.sg=t,this.t("copiesArrayObjects",e,t))}get copiesKey(){return this.ng}set copiesKey(t){const e=this.ng;e!==t&&(null!==t&&d.i(t,"boolean",Ze,"copiesKey"),this.ng=t,this.t("copiesKey",e,t))}copyNodeData(t){if(null===t)return null;let e=null;const i=this.Tf;return e=null!==i?i(t,this):this.I1(t,!0),d.wt(e),e}I1(t,e){if(this.copiesArrays&&Array.isArray(t)){const e=t,i=[];for(let t=0;t<e.length;t++){const n=e[t],s=this.I1(n,this.copiesArrayObjects);i.push(s)}return i}if(e&&d.wt(t)){const e=t,i=e.constructor,n=i?new i:{},s=this.copiesKey||"string"!=typeof this.nodeKeyProperty?null:this.nodeKeyProperty;for(const t in e){if("__gohashid"===t){n.__gohashid=void 0;continue}if(t===s){n[s]=void 0;continue}const i=Ze.vt(e,t);if(this.AO(e,t,i))Ze.ht(n,t,i);else{const e=this.I1(i,!1);Ze.ht(n,t,e)}}return n}return t instanceof T||t instanceof A||t instanceof D||t instanceof O||t instanceof F?t.copy():t}get afterCopyFunction(){return this.og}set afterCopyFunction(t){const e=this.og;e!==t&&(null!==t&&d.i(t,"function",Ze,"afterCopyFunction"),this.og=t,this.t("afterCopyFunction",e,t))}AO(t,e,i){const n=d.nn(i);return"GraphObject"===n||"Diagram"===n||"Layer"===n||"RowColumnDefinition"===n||"AnimationManager"===n||"Tool"===n||"CommandHandler"===n||"Layout"===n||"InputEvent"===n||"DiagramEvent"===n||(i instanceof Ze||i instanceof q||i instanceof H||i instanceof _)}setDataProperty(t,e,i){if(this.containsNodeData(t)){if(e===this.nodeKeyProperty)return void this.setKeyForNodeData(t,i);if(e===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,i)}else!Ze.FT&&t instanceof Kt&&(Ze.FT=!0,d.ri('Model.setDataProperty is modifying a GraphObject, "'+t.toString()+'"'),d.ri("  Is that really your intent?"));const n=Ze.vt(t,e);n!==i&&(Ze.ht(t,e,i),this.raiseDataChanged(t,e,n,i))}set(t,e,i){this.setDataProperty(t,e,i)}assignAllDataProperties(t,e){if(!e)return;const i=this.containsNodeData(t);for(const n in e)"__gohashid"!==n&&(i&&n===this.nodeKeyProperty||this.setDataProperty(t,n,e[n]))}addArrayItem(t,e){this.insertArrayItem(t,-1,e)}insertArrayItem(t,e,i){e<0&&(e=t.length),d.eu(t,e,i),this.Et("",3,"",t,null,i,null,e)}removeArrayItem(t,e){void 0===e&&(e=-1),t===this.ve&&d.o("Model.removeArrayItem should not be called on the Model.nodeDataArray"),-1===e&&(e=t.length-1);const i=t[e];d._a(t,e),this.Et("",4,"",t,i,null,e,null)}get nodeCategoryProperty(){return this.za}set nodeCategoryProperty(t){const e=this.za;e!==t&&(this.Dn(t,Ze,"nodeCategoryProperty"),this.za=t,this.t("nodeCategoryProperty",e,t))}getCategoryForNodeData(t){if(null===t)return"";const e=this.za;if(""===e)return"";const i=Ze.vt(t,e);return void 0===i?"":"string"==typeof i?i:void d.o("getCategoryForNodeData found a non-string category for "+t+": "+i)}setCategoryForNodeData(t,e){if(d.i(e,"string",Ze,"setCategoryForNodeData:cat"),null===t)return;const i=this.za;if(""===i)return;if(!this.containsNodeData(t))return void Ze.ht(t,i,e);let n=Ze.vt(t,i);void 0===n&&(n=""),n!==e&&(Ze.ht(t,i,e),this.Et("nodeCategory",2,i,t,n,e))}cg(t,e){this.setCategoryForNodeData(e,this.getCategoryForNodeData(t))}get type(){return"Model"}Hu(){return!1}uc(){return!1}ju(){return!1}Ta(){return!1}zw(){return!1}Gc(){return!1}static initDiagramModel(){return new Ze}static O1(t){return Ze.classMap[t]?Ze.classMap[t]:void 0!==c.go&&c.go[t]?c.go[t]:null}static registerClass(t,e){Ze.classMap[e]=t}static vt(t,e){if(!t||!e)return null;let i;try{"function"==typeof e?i=e(t):"function"==typeof t.getAttribute?(i=t.getAttribute(e),null===i&&(i=void 0)):i=t[e]}catch{}return i}static ht(t,e,i){if(t&&e)try{"function"==typeof e?e(t,i):"function"==typeof t.setAttribute?t.setAttribute(e,i):t[e]=i}catch{}}}u=Ze,y(Ze,"FT",!1),y(Ze,"classMap",{}),u.registerClass(Qt,"Brush"),u.registerClass(_,"ChangedEvent"),u.registerClass(z,"Geometry"),u.registerClass(F,"Margin"),u.registerClass(ie,"Panel"),u.registerClass(T,"Point"),u.registerClass(D,"Rect"),u.registerClass(A,"Size"),u.registerClass(O,"Spot"),u.registerClass(H,"Transaction"),u.registerClass(q,"UndoManager"),Ze.fromJSON=Ze.fromJson=Ze.fromJson;class Qe extends Ze{constructor(t,e,i){if(super(),y(this,"Qe",void 0),y(this,"or",void 0),y(this,"ui",void 0),y(this,"Ah",void 0),y(this,"Df",void 0),y(this,"Ff",void 0),y(this,"Dl",void 0),y(this,"xo",void 0),y(this,"bo",void 0),y(this,"Ka",void 0),y(this,"Ya",void 0),y(this,"Ga",void 0),y(this,"Qs",void 0),y(this,"Rf",void 0),y(this,"Fn",void 0),y(this,"dg",void 0),y(this,"vT",',\n  "insertedLinkKeys": '),y(this,"TO",',\n  "modifiedLinkData": '),y(this,"OT",',\n  "removedLinkKeys": '),this.Qe=[],this.or=new k,this.ui=new L,this.Ah="",this.Df=null,this.Ff=null,this.Dl=null,this.xo="from",this.bo="to",this.Ka="",this.Ya="",this.Ga="category",this.Qs="",this.Rf="isGroup",this.Fn="group",this.dg=!1,void 0!==e&&(this.linkDataArray=e),void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:i=t),i){Object.assign(this,i);const t=i.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){super.cloneProtected(t),t.Ah=this.Ah,t.Df=this.Df,t.Ff=this.Ff,t.xo=this.xo,t.bo=this.bo,t.Ka=this.Ka,t.Ya=this.Ya,t.Ga=this.Ga,t.Qs=this.Qs,t.Rf=this.Rf,t.Fn=this.Fn,t.dg=this.dg}clear(){super.clear(),this.Qe=[],this.ui.clear(),this.or.clear()}toString(t){if(void 0===t&&(t=0),t>=2)return this.toJson();{let e=(""!==this.name?this.name:"")+" GraphLinksModel";if(t>0){e+="\n node data:";let t=this.nodeDataArray,i=t.length,n=0;for(n=0;n<i;n++){const i=t[n];e+=" "+this.getKeyForNodeData(i)+":"+$e.toString(i)}for(e+="\n link data:",t=this.linkDataArray,i=t.length,n=0;n<i;n++){const i=t[n];e+=" "+this.Re(i,!0)+"--\x3e"+this.Re(i,!1)}}return e}}yN(t,e){if(""===this.linkKeyProperty){const t=this.skipsUndoManager;this.skipsUndoManager=!0,this.linkKeyProperty="key",this.skipsUndoManager=t}let i=super.yN(t,e);const n=this,s=new k,o=new k,r=new k,a=this.Xa;t.changes.each((t=>{if(t.model===n)if("linkDataArray"===t.modelChange)3===t.change?s.add(t.newValue):4===t.change&&r.add(t.oldValue);else if(n.containsLinkData(t.object))o.add(t.object);else if(null!==t.object)if(null!==t.object&&a&&a.contains(t.object))a.get(t.object).each((t=>{n.containsLinkData(t)&&o.add(t)}));else{if(t.object instanceof Ze||n.containsNodeData(t.object))return;n.RT(t.object).each((t=>o.add(t)))}}));const l=this.lg;l.clear(),s.each((t=>{l.add(n.getKeyForLinkData(t)),e||o.add(t)}));const h=this.rg;h.clear(),r.each((t=>{h.add(n.getKeyForLinkData(t)),e&&o.add(t)}));const u=n.cloneDeep(o.toArray());return l.count>0&&(null===i&&(i={}),e?i.removedLinkKeys=l.toArray():i.insertedLinkKeys=l.toArray()),u.length>0&&(null===i&&(i={}),i.modifiedLinkData=u),h.count>0&&(null===i&&(i={}),e?i.insertedLinkKeys=h.toArray():i.removedLinkKeys=h.toArray()),h.clear(),l.clear(),i}ag(){const t=super.ag();let e="";return"category"!==this.linkCategoryProperty&&"string"==typeof this.linkCategoryProperty&&(e+=',\n  "linkCategoryProperty": '+this.Oe(this.linkCategoryProperty)),""!==this.linkKeyProperty&&"string"==typeof this.linkKeyProperty&&(e+=',\n  "linkKeyProperty": '+this.Oe(this.linkKeyProperty)),"from"!==this.linkFromKeyProperty&&"string"==typeof this.linkFromKeyProperty&&(e+=',\n  "linkFromKeyProperty": '+this.Oe(this.linkFromKeyProperty)),"to"!==this.linkToKeyProperty&&"string"==typeof this.linkToKeyProperty&&(e+=',\n  "linkToKeyProperty": '+this.Oe(this.linkToKeyProperty)),""!==this.linkFromPortIdProperty&&"string"==typeof this.linkFromPortIdProperty&&(e+=',\n  "linkFromPortIdProperty": '+this.Oe(this.linkFromPortIdProperty)),""!==this.linkToPortIdProperty&&"string"==typeof this.linkToPortIdProperty&&(e+=',\n  "linkToPortIdProperty": '+this.Oe(this.linkToPortIdProperty)),""!==this.linkLabelKeysProperty&&"string"==typeof this.linkLabelKeysProperty&&(e+=',\n  "linkLabelKeysProperty": '+this.Oe(this.linkLabelKeysProperty)),"isGroup"!==this.nodeIsGroupProperty&&"string"==typeof this.nodeIsGroupProperty&&(e+=',\n  "nodeIsGroupProperty": '+this.Oe(this.nodeIsGroupProperty)),"group"!==this.nodeGroupKeyProperty&&"string"==typeof this.nodeGroupKeyProperty&&(e+=',\n  "nodeGroupKeyProperty": '+this.Oe(this.nodeGroupKeyProperty)),t+e}Ty(t){super.Ty(t),t.linkKeyProperty&&(this.linkKeyProperty=t.linkKeyProperty),t.linkFromKeyProperty&&(this.linkFromKeyProperty=t.linkFromKeyProperty),t.linkToKeyProperty&&(this.linkToKeyProperty=t.linkToKeyProperty),t.linkFromPortIdProperty&&(this.linkFromPortIdProperty=t.linkFromPortIdProperty),t.linkToPortIdProperty&&(this.linkToPortIdProperty=t.linkToPortIdProperty),t.linkCategoryProperty&&(this.linkCategoryProperty=t.linkCategoryProperty),t.linkLabelKeysProperty&&(this.linkLabelKeysProperty=t.linkLabelKeysProperty),t.nodeIsGroupProperty&&(this.nodeIsGroupProperty=t.nodeIsGroupProperty),t.nodeGroupKeyProperty&&(this.nodeGroupKeyProperty=t.nodeGroupKeyProperty)}wN(){return super.wN()+(',\n  "linkDataArray": '+this.Lh(this.linkDataArray,!0))}xN(t){super.xN(t);const e=t.linkDataArray;Array.isArray(e)&&(this.replaceJsonObjects(e),this.linkDataArray=e)}RT(t){const e=new k;for(let i=0;i<this.linkDataArray.length;i++){const n=this.linkDataArray[i];this.v1(t,n,n,e)}return e}kN(t,e){if(""===this.linkKeyProperty){const t=this.skipsUndoManager;this.skipsUndoManager=!0,this.linkKeyProperty="key",this.skipsUndoManager=t}const i=super.kN(t,e),n=this,s=new k,o=new k,r=new k,a=this.Xa;t.changes.each((t=>{if(t.model===n)if("linkDataArray"===t.modelChange)3===t.change?s.add(t.newValue):4===t.change&&r.add(t.oldValue);else if(n.containsLinkData(t.object))o.add(t.object);else if(null!==t.object)if(null!==t.object&&a&&a.contains(t.object))a.get(t.object).each((t=>{n.containsLinkData(t)&&o.add(t)}));else{if(t.object instanceof Ze||n.containsNodeData(t.object))return;n.RT(t.object).each((t=>o.add(t)))}}));const l=this.lg;l.clear(),s.each((t=>{l.add(n.getKeyForLinkData(t)),e||o.add(t)}));const h=this.rg;h.clear(),r.each((t=>{h.add(n.getKeyForLinkData(t)),e&&o.add(t)}));let u=i;return l.count>0&&(u+=(e?this.OT:this.vT)+this.Lh(l.toArray(),!0)),o.count>0&&(u+=this.TO+this.Lh(o.toArray(),!0)),h.count>0&&(u+=(e?this.vT:this.OT)+this.Lh(h.toArray(),!0)),h.clear(),l.clear(),u}Dy(t){(void 0!==t.linkCategoryProperty&&t.linkCategoryProperty!==this.linkCategoryProperty||void 0!==t.linkKeyProperty&&t.linkKeyProperty!==this.linkKeyProperty||void 0!==t.linkFromKeyProperty&&t.linkFromKeyProperty!==this.linkFromKeyProperty||void 0!==t.linkToKeyProperty&&t.linkToKeyProperty!==this.linkToKeyProperty||void 0!==t.linkFromPortIdProperty&&t.linkFromPortIdProperty!==this.linkFromPortIdProperty||void 0!==t.linkToPortIdProperty&&t.linkToPortIdProperty!==this.linkToPortIdProperty||void 0!==t.linkLabelKeysProperty&&t.linkLabelKeysProperty!==this.linkLabelKeysProperty||void 0!==t.nodeIsGroupProperty&&t.nodeIsGroupProperty!==this.nodeIsGroupProperty||void 0!==t.nodeGroupKeyProperty&&t.nodeGroupKeyProperty!==this.nodeGroupKeyProperty)&&d.o("applyIncrementalJson cannot change Model properties"),super.Dy(t);const e=t.insertedLinkKeys;if(Array.isArray(e)){const t=e.length;for(let i=0;i<t;i++){const t=e[i];let n=this.findLinkDataForKey(t);null===n&&(n=this.copyLinkData({}),this.setKeyForLinkData(n,t),this.addLinkData(n))}}const i=t.modifiedLinkData;if(Array.isArray(i)){const t=i.length;for(let e=0;e<t;e++){const t=i[e],n=this.getKeyForLinkData(t),s=this.findLinkDataForKey(n);if(null!==s){for(const e in t)"__gohashid"===e||e===this.linkKeyProperty||this.setDataProperty(s,e,t[e]);this.IT(t,s)}}}const n=t.removedLinkKeys;if(Array.isArray(n)){const t=n.length;for(let e=0;e<t;e++){const t=n[e],i=this.findLinkDataForKey(t);null!==i&&this.removeLinkData(i)}}}changeState(t,e){if(null!==t&&t.model===this){if(2===t.change){const i=t.object,n=t.propertyName;if(n===this.linkKeyProperty&&this.containsLinkData(i)){const s=t.getValue(e),o=t.getValue(!e);return void 0!==o&&this.ui.remove(o),void 0!==s&&this.ui.add(s,i),void Ze.ht(i,n,s)}}else if(3===t.change){let i=t.newParam;if("linkDataArray"===t.modelChange){const n=t.newValue;if(d.wt(n)&&"number"==typeof i){const t=this.getKeyForLinkData(n);e?(this.or.remove(n),this.Qe[i]===n&&this.Qe.splice(i,1),void 0!==t&&this.ui.remove(t)):(this.or.add(n),this.Qe[i]!==n&&this.Qe.splice(i,0,n),void 0!==t&&this.ui.add(t,n))}return}if("linkLabelKeys"===t.modelChange){const n=this.getLabelKeysForLinkData(t.object);return void(Array.isArray(n)&&"number"==typeof i&&(e?(i=n.indexOf(t.newValue),i>=0&&n.splice(i,1)):n.indexOf(t.newValue)<0&&n.splice(i,0,t.newValue)))}}else if(4===t.change){let i=t.oldParam;if("linkDataArray"===t.modelChange){const n=t.oldValue;if(d.wt(n)&&"number"==typeof i){const t=this.getKeyForLinkData(n);e?(this.or.add(n),this.Qe[i]!==n&&this.Qe.splice(i,0,n),void 0!==t&&this.ui.add(t,n)):(this.or.remove(n),this.Qe[i]===n&&this.Qe.splice(i,1),void 0!==t&&this.ui.remove(t))}return}if("linkLabelKeys"===t.modelChange){const n=this.getLabelKeysForLinkData(t.object);return void(Array.isArray(n)&&"number"==typeof i&&(e?n.indexOf(t.newValue)<0&&n.splice(i,0,t.newValue):(i=n.indexOf(t.newValue),i>=0&&n.splice(i,1))))}}super.changeState(t,e)}}get archetypeNodeData(){return this.Dl}set archetypeNodeData(t){const e=this.Dl;e!==t&&(null!==t&&d.i(t,"object",Qe,"archetypeNodeData"),this.Dl=t,this.t("archetypeNodeData",e,t))}MN(t){if(void 0===t)return;const e=this.Dl;if(null!==e){let i=this.findNodeDataForKey(t);null===i&&(i=this.copyNodeData(e),Ze.ht(i,this.nodeKeyProperty,t),this.addNodeData(i))}return t}get linkFromKeyProperty(){return this.xo}set linkFromKeyProperty(t){const e=this.xo;e!==t&&(this.Dn(t,Qe,"linkFromKeyProperty"),this.xo=t,this.t("linkFromKeyProperty",e,t))}getFromKeyForLinkData(t){return this.Re(t,!0)}setFromKeyForLinkData(t,e){this._d(t,e,!0)}get linkToKeyProperty(){return this.bo}set linkToKeyProperty(t){const e=this.bo;e!==t&&(this.Dn(t,Qe,"linkToKeyProperty"),this.bo=t,this.t("linkToKeyProperty",e,t))}getToKeyForLinkData(t){return this.Re(t,!1)}setToKeyForLinkData(t,e){this._d(t,e,!1)}Re(t,e){if(null===t)return;const i=e?this.xo:this.bo;if(""===i)return;const n=Ze.vt(t,i);if(void 0!==n){if(this.isKeyType(n))return n;d.o((e?"FromKey":"ToKey")+" value for link data "+t+" is not a number or a string: "+n)}}_d(t,e,i){if(null===e&&(e=void 0),void 0!==e&&!this.isKeyType(e)&&d.ke(e,"number or string",Qe,i?"setFromKeyForLinkData:key":"setToKeyForLinkData:key"),null===t)return;const n=i?this.xo:this.bo;if(""===n)return;if(e=this.MN(e),!this.containsLinkData(t))return void Ze.ht(t,n,e);const s=Ze.vt(t,n);s!==e&&(this.$s(s,t),Ze.ht(t,n,e),null===this.findNodeDataForKey(e)&&this.Zs(e,t),this.Et(i?"linkFromKey":"linkToKey",2,n,t,s,e),"string"==typeof n&&this.updateTargetBindings(t,n))}get linkFromPortIdProperty(){return this.Ka}set linkFromPortIdProperty(t){const e=this.Ka;e!==t&&(this.Dn(t,Qe,"linkFromPortIdProperty"),this.Ka=t,this.t("linkFromPortIdProperty",e,t))}getFromPortIdForLinkData(t){return this.C1(t,!0)}setFromPortIdForLinkData(t,e){this.tg(t,e,!0)}get linkToPortIdProperty(){return this.Ya}set linkToPortIdProperty(t){const e=this.Ya;e!==t&&(this.Dn(t,Qe,"linkToPortIdProperty"),this.Ya=t,this.t("linkToPortIdProperty",e,t))}getToPortIdForLinkData(t){return this.C1(t,!1)}setToPortIdForLinkData(t,e){this.tg(t,e,!1)}C1(t,e){if(null===t)return"";const i=e?this.Ka:this.Ya;if(""===i)return"";const n=Ze.vt(t,i);return void 0===n?"":n}tg(t,e,i){if(d.i(e,"string",Qe,i?"setFromPortIdForLinkData:portname":"setToPortIdForLinkData:portname"),null===t)return;const n=i?this.Ka:this.Ya;if(""===n)return;if(!this.containsLinkData(t))return void Ze.ht(t,n,e);let s=Ze.vt(t,n);void 0===s&&(s=""),s!==e&&(Ze.ht(t,n,e),this.Et(i?"linkFromPortId":"linkToPortId",2,n,t,s,e),"string"==typeof n&&this.updateTargetBindings(t,n))}get linkLabelKeysProperty(){return this.Qs}set linkLabelKeysProperty(t){const e=this.Qs;e!==t&&(this.Dn(t,Qe,"linkLabelKeysProperty"),this.Qs=t,this.t("linkLabelKeysProperty",e,t))}getLabelKeysForLinkData(t){if(null===t)return Qe.EmptyArray;const e=this.Qs;if(""===e)return Qe.EmptyArray;const i=Ze.vt(t,e);return void 0===i?Qe.EmptyArray:i}setLabelKeysForLinkData(t,e){if(null===t)return;const i=this.Qs;if(""===i)return;if(!this.containsLinkData(t))return void Ze.ht(t,i,e);let n=Ze.vt(t,i);if(void 0===n&&(n=Qe.EmptyArray),n!==e){if(Array.isArray(n)){const e=n.length;for(let i=0;i<e;i++){const e=n[i];this.$s(e,t)}}Ze.ht(t,i,e);const s=e.length;for(let i=0;i<s;i++){const n=e[i];null===this.findNodeDataForKey(n)&&this.Zs(n,t)}this.Et("linkLabelKeys",2,i,t,n,e),"string"==typeof i&&this.updateTargetBindings(t,i)}}addLabelKeyForLinkData(t,e){if(null==e||(this.isKeyType(e)||d.ke(e,"number or string",Qe,"addLabelKeyForLinkData:key"),null===t))return;const i=this.Qs;if(""===i)return;const n=Ze.vt(t,i);if(void 0===n){const i=[];i.push(e),this.setLabelKeysForLinkData(t,i)}else if(Array.isArray(n)){let s=n.indexOf(e);if(s>=0)return;s=n.length,n.push(e),this.containsLinkData(t)&&(null===this.findNodeDataForKey(e)&&this.Zs(e,t),this.Et("linkLabelKeys",3,i,t,null,e,null,s))}else d.o(i+" property is not an Array; cannot addLabelKeyForLinkData: "+t)}removeLabelKeyForLinkData(t,e){if(null==e||(this.isKeyType(e)||d.ke(e,"number or string",Qe,"removeLabelKeyForLinkData:key"),null===t))return;const i=this.Qs;if(""===i)return;const n=Ze.vt(t,i);if(Array.isArray(n)){const s=n.indexOf(e);if(s<0)return;n.splice(s,1),this.containsLinkData(t)&&(this.$s(e,t),this.Et("linkLabelKeys",4,i,t,e,null,s,null))}else void 0!==n&&d.o(i+" property is not an Array; cannot removeLabelKeyforLinkData: "+t)}get linkDataArray(){return this.Qe}set linkDataArray(t){const e=this.Qe;if(e!==t){this.ui.clear();const i=t.length;for(let e=0;e<i;e++){const i=t[e];d.wt(i)||d.o("GraphLinksModel.linkDataArray must only contain Objects, not: "+i)}if(this.Qe=t,""!==this.linkKeyProperty){const e=new x;for(let s=0;s<i;s++){const i=t[s],n=this.getKeyForLinkData(i);void 0===n||null!==this.ui.getValue(n)?e.add(i):this.ui.add(n,i)}const n=e.iterator;for(;n.next();){const t=n.value;this.makeLinkDataKeyUnique(t);const e=this.getKeyForLinkData(t);void 0!==e&&this.ui.add(e,t)}}const n=new k;for(let e=0;e<i;e++){const i=t[e];n.add(i)}this.or=n,this.Et("linkDataArray",2,"linkDataArray",this,e,t);for(let e=0;e<i;e++){const i=t[e];this.SN(i)}}}get linkKeyProperty(){return this.Ah}set linkKeyProperty(t){const e=this.Ah;if(e!==t){this.Dn(t,Qe,"linkKeyProperty"),this.Ah=t,this.ui.clear();const i=this.linkDataArray.length;for(let t=0;t<i;t++){const e=this.linkDataArray[t];let i=this.getKeyForLinkData(e);void 0===i&&(this.makeLinkDataKeyUnique(e),i=this.getKeyForLinkData(e)),void 0!==i&&this.ui.add(i,e)}this.t("linkKeyProperty",e,t)}}getKeyForLinkData(t){if(null===t)return;const e=this.Ah;if(""===e)return;const i=Ze.vt(t,e);if(void 0!==i){if(this.isKeyType(i))return i;d.o("Key value for link data "+t+" is not a number or a string: "+i)}}setKeyForLinkData(t,e){if((null==e||!this.isKeyType(e))&&d.ke(e,"number or string",Qe,"setKeyForLinkData:key"),null===t)return;const i=this.Ah;if(""===i)return;if(!this.containsLinkData(t))return void Ze.ht(t,i,e);const n=Ze.vt(t,i);if(n!==e){if(null!==this.findLinkDataForKey(e))return;Ze.ht(t,i,e),void 0!==n&&this.ui.remove(n),this.ui.add(e,t),this.Et("linkKey",2,i,t,n,e),"string"==typeof i&&this.updateTargetBindings(t,i)}}get makeUniqueLinkKeyFunction(){return this.Df}set makeUniqueLinkKeyFunction(t){const e=this.Df;e!==t&&(null!==t&&d.i(t,"function",Qe,"makeUniqueLinkKeyFunction"),this.Df=t,this.t("makeUniqueLinkKeyFunction",e,t))}findLinkDataForKey(t){return null===t&&d.o("GraphLinksModel.findLinkDataForKey:key must not be null"),void 0!==t&&this.isKeyType(t)?this.ui.getValue(t):null}makeLinkDataKeyUnique(t){if(null===t)return;const e=this.Ah;if(""===e)return;let i=this.getKeyForLinkData(t);if(void 0!==i&&!this.ui.contains(i))return;const n=this.Df;if(null===n||(i=n(this,t),null==i||this.ui.contains(i))){if("string"==typeof i){let n=2;for(;this.ui.contains(i+n);)n++;Ze.ht(t,e,i+n)}else if(void 0===i||"number"==typeof i){let i=-this.ui.count-1;for(;this.ui.contains(i);)i--;Ze.ht(t,e,i)}}else Ze.ht(t,e,i)}containsLinkData(t){return null!==t&&this.or.contains(t)}addLinkData(t){null!==t&&(this.containsLinkData(t)||this.kT(t,!0))}kT(t,e){if(""!==this.linkKeyProperty){let e=this.getKeyForLinkData(t);if(void 0===e)this.makeLinkDataKeyUnique(t),e=this.getKeyForLinkData(t);else{if(this.ui.getValue(e)===t)return;this.makeLinkDataKeyUnique(t),e=this.getKeyForLinkData(t)}void 0===e&&d.o("GraphLinksModel.makeLinkDataKeyUnique failed on "+t+". Data not added to model."),this.ui.add(e,t)}this.or.add(t);let i=null;e&&(i=this.Qe.length,this.Qe.splice(i,0,t)),this.Et("linkDataArray",3,"linkDataArray",this,null,t,null,i),this.SN(t)}addLinkDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.addLinkData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.addLinkData(t)}}}removeLinkData(t){null!==t&&this.bT(t,!0)}bT(t,e){this.or.remove(t);const i=this.getKeyForLinkData(t);void 0!==i&&this.ui.remove(i);let n=null;if(e){if(n=this.Qe.indexOf(t),n<0)return;this.Qe.splice(n,1)}this.Et("linkDataArray",4,"linkDataArray",this,t,null,n,null),this.DO(t)}removeLinkDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.removeLinkData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.removeLinkData(t)}}}mergeLinkDataArray(t){if(""===this.linkKeyProperty&&d.o("GraphLinksModel.linkKeyProperty must not be an empty string for .mergeLinkDataArray() to succeed."),t!==this.linkDataArray&&Array.isArray(t)){const e=this.rg;e.clear(),e.addAll(this.ui.iteratorKeys);const i=this.lg;i.clear();const n=t.length;for(let o=0;o<n;o++){const e=t[o],n=this.getKeyForLinkData(e);if(void 0!==n){i.add(n);const t=this.findLinkDataForKey(n);if(t===e)continue;if(null!==t)this.assignAllDataProperties(t,e),this.IT(e,t);else{const t=this.cloneDeep(e);this.setKeyForLinkData(t,n),this.addLinkData(t)}}else{const t=this.cloneDeep(e);this.addLinkData(t),i.add(this.getKeyForLinkData(t))}}const s=e.iterator;for(;s.next();){const t=s.value;if(!i.contains(t)){const e=this.findLinkDataForKey(t);e&&this.removeLinkData(e)}}e.clear(),i.clear()}}SN(t){let e=this.Re(t,!0);e=this.MN(e),null===this.findNodeDataForKey(e)&&this.Zs(e,t),e=this.Re(t,!1),e=this.MN(e),null===this.findNodeDataForKey(e)&&this.Zs(e,t);const i=this.getLabelKeysForLinkData(t);if(Array.isArray(i)){const n=i.length;for(let s=0;s<n;s++)e=i[s],null===this.findNodeDataForKey(e)&&this.Zs(e,t)}}DO(t){let e=this.Re(t,!0);this.$s(e,t),e=this.Re(t,!1),this.$s(e,t);const i=this.getLabelKeysForLinkData(t);if(Array.isArray(i)){const n=i.length;for(let s=0;s<n;s++)e=i[s],this.$s(e,t)}}get copyLinkDataFunction(){return this.Ff}set copyLinkDataFunction(t){const e=this.Ff;e!==t&&(null!==t&&d.i(t,"function",Qe,"copyLinkDataFunction"),this.Ff=t,this.t("copyLinkDataFunction",e,t))}copyLinkData(t){if(null===t)return null;let e=null;const i=this.Ff;return e=null!==i?i(t,this):this.I1(t,!0),d.wt(e)&&(""!==this.xo&&Ze.ht(e,this.xo,void 0),""!==this.bo&&Ze.ht(e,this.bo,void 0),""!==this.Qs&&Ze.ht(e,this.Qs,[])),e}get nodeIsGroupProperty(){return this.Rf}set nodeIsGroupProperty(t){const e=this.Rf;e!==t&&(this.Dn(t,Qe,"nodeIsGroupProperty"),this.Rf=t,this.t("nodeIsGroupProperty",e,t))}isGroupForNodeData(t){if(null===t)return!1;const e=this.Rf;return""!==e&&!!Ze.vt(t,e)}isGroupForData(t){return this.isGroupForNodeData(t)}get nodeGroupKeyProperty(){return this.Fn}set nodeGroupKeyProperty(t){const e=this.Fn;e!==t&&(this.Dn(t,Qe,"nodeGroupKeyProperty"),this.Fn=t,this.t("nodeGroupKeyProperty",e,t))}get copiesGroupKeyOfNodeData(){return this.dg}set copiesGroupKeyOfNodeData(t){this.dg!==t&&(d.i(t,"boolean",Qe,"copiesGroupKeyOfNodeData"),this.dg=t)}getGroupKeyForNodeData(t){if(null===t)return;const e=this.Fn;if(""===e)return;const i=Ze.vt(t,e);if(void 0!==i){if(this.isKeyType(i))return i;d.o("GroupKey value for node data "+t+" is not a number or a string: "+i)}}getGroupForData(t){return this.getGroupKeyForNodeData(t)}setGroupKeyForNodeData(t,e){if(null===e&&(e=void 0),void 0!==e&&!this.isKeyType(e)&&d.ke(e,"number or string",Qe,"setGroupKeyForNodeData:key"),null===t)return;const i=this.Fn;if(""===i)return;if(!this.containsNodeData(t))return void Ze.ht(t,i,e);const n=Ze.vt(t,i);n!==e&&(this.$s(n,t),Ze.ht(t,i,e),null===this.findNodeDataForKey(e)&&this.Zs(e,t),this.Et("nodeGroupKey",2,i,t,n,e),"string"==typeof i&&this.updateTargetBindings(t,i))}setGroupForData(t,e){this.setGroupKeyForNodeData(t,e)}copyNodeData(t){if(null===t)return null;const e=super.copyNodeData(t);return!this.copiesGroupKeyOfNodeData&&""!==this.Fn&&void 0!==Ze.vt(e,this.Fn)&&Ze.ht(e,this.Fn,void 0),e}setDataProperty(t,e,i){if(this.containsNodeData(t)){if(e===this.nodeKeyProperty)return void this.setKeyForNodeData(t,i);if(e===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,i);if(e===this.nodeGroupKeyProperty)return void this.setGroupKeyForNodeData(t,i)}else if(this.containsLinkData(t)){if(e===this.linkFromKeyProperty)return void this._d(t,i,!0);if(e===this.linkToKeyProperty)return void this._d(t,i,!1);if(e===this.linkFromPortIdProperty)return void this.tg(t,i,!0);if(e===this.linkToPortIdProperty)return void this.tg(t,i,!1);if(e===this.linkKeyProperty)return void this.setKeyForLinkData(t,i);if(e===this.linkCategoryProperty)return void this.setCategoryForLinkData(t,i);if(e===this.linkLabelKeysProperty)return void this.setLabelKeysForLinkData(t,i)}const n=Ze.vt(t,e);n!==i&&(Ze.ht(t,e,i),this.raiseDataChanged(t,e,n,i))}assignAllDataProperties(t,e){if(!e)return;const i=this.containsNodeData(t),n=this.containsLinkData(t);for(const s in e)if("__gohashid"!==s&&(!i||s!==this.nodeKeyProperty)){if(i&&s===this.nodeIsGroupProperty&&Ze.vt(t,s)===e[s])continue;if(n&&s===this.linkKeyProperty)continue;this.setDataProperty(t,s,e[s])}}Fy(t,e){super.Fy(t,e);const i=this.ti.iterator;for(;i.next();){const n=i.value;this.NN(n,t,e)}const n=this.or.iterator;for(;n.next();){const i=n.value;this.FO(i,t,e)}}NN(t,e,i){if(this.getGroupKeyForNodeData(t)===e){const n=this.Fn;Ze.ht(t,n,i),this.Et("nodeGroupKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}}FO(t,e,i){if(this.Re(t,!0)===e){const n=this.xo;Ze.ht(t,n,i),this.Et("linkFromKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}if(this.Re(t,!1)===e){const n=this.bo;Ze.ht(t,n,i),this.Et("linkToKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}const n=this.getLabelKeysForLinkData(t);if(Array.isArray(n)){const s=n.length,o=this.Qs;for(let r=0;r<s;r++)n[r]===e&&(n[r]=i,this.Et("linkLabelKeys",3,o,t,e,i,r,r))}}PN(){super.PN();const t=this.linkDataArray,e=t.length;for(let i=0;i<e;i++){const e=t[i];this.SN(e)}}fg(t){super.fg(t);const e=this.getKeyForNodeData(t),i=this.Cy(e);if(null!==i){const t=d.rt(),n=i.iterator;for(;n.next();){const i=n.value;if(this.containsNodeData(i)){if(this.getGroupKeyForNodeData(i)===e){const n=this.Fn;this.Et("nodeGroupKey",2,n,i,e,e),"string"==typeof n&&this.updateTargetBindings(i,n),t.push(i)}}else{if(this.Re(i,!0)===e){const n=this.xo;this.Et("linkFromKey",2,n,i,e,e),"string"==typeof n&&this.updateTargetBindings(i,n),t.push(i)}if(this.Re(i,!1)===e){const n=this.bo;this.Et("linkToKey",2,n,i,e,e),"string"==typeof n&&this.updateTargetBindings(i,n),t.push(i)}const n=this.getLabelKeysForLinkData(i);if(Array.isArray(n)){const s=n.length,o=this.Qs;for(let r=0;r<s;r++)n[r]===e&&(this.Et("linkLabelKeys",3,o,i,e,e,r,r),t.push(i))}}}for(let i=0;i<t.length;i++)this.$s(e,t[i]);d.it(t)}}ug(t){super.ug(t);const e=this.getGroupKeyForNodeData(t);null===this.findNodeDataForKey(e)&&this.Zs(e,t)}Ry(t){super.Ry(t);const e=this.getGroupKeyForNodeData(t);this.$s(e,t)}get linkCategoryProperty(){return this.Ga}set linkCategoryProperty(t){const e=this.Ga;e!==t&&(this.Dn(t,Qe,"linkCategoryProperty"),this.Ga=t,this.t("linkCategoryProperty",e,t))}getCategoryForLinkData(t){if(null===t)return"";const e=this.Ga;if(""===e)return"";const i=Ze.vt(t,e);return void 0===i?"":"string"==typeof i?i:void d.o("getCategoryForLinkData found a non-string category for "+t+": "+i)}getLinkCategoryForData(t){return this.getCategoryForLinkData(t)}setCategoryForLinkData(t,e){if(d.i(e,"string",Qe,"setCategoryForLinkData:cat"),null===t)return;const i=this.Ga;if(""===i)return;if(!this.containsLinkData(t))return void Ze.ht(t,i,e);let n=Ze.vt(t,i);void 0===n&&(n=""),n!==e&&(Ze.ht(t,i,e),this.Et("linkCategory",2,i,t,n,e),"string"==typeof i&&this.updateTargetBindings(t,i))}setLinkCategoryForData(t,e){this.setCategoryForLinkData(t,e)}cg(t,e){super.cg(t,e),this.setGroupKeyForNodeData(e,this.getGroupKeyForNodeData(t))}IT(t,e){this.setCategoryForLinkData(e,this.getCategoryForLinkData(t)),this.setFromKeyForLinkData(e,this.getFromKeyForLinkData(t)),this.setToKeyForLinkData(e,this.getToKeyForLinkData(t)),this.setLabelKeysForLinkData(e,this.getLabelKeysForLinkData(t)),this.setFromPortIdForLinkData(e,this.getFromPortIdForLinkData(t)),this.setToPortIdForLinkData(e,this.getToPortIdForLinkData(t))}get type(){return"GraphLinksModel"}uc(){return!0}Ta(){return!0}zw(){return!0}Gc(){return!0}}y(Qe,"EmptyArray",Object.freeze([])),Ze.registerClass(Qe,"GraphLinksModel"),Ze.constructGraphLinksModel=Ze.constructGraphLinksModel=()=>new Qe,Ze.initDiagramModel=Ze.initDiagramModel=()=>new Qe;class ti extends Ze{constructor(t,e){if(super(),y(this,"Rn",void 0),y(this,"gg",void 0),y(this,"Ha",void 0),this.Rn="parent",this.gg=!1,this.Ha="parentLinkCategory",void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:e=t),e){Object.assign(this,e);const t=e.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){super.cloneProtected(t),t.Rn=this.Rn,t.gg=this.gg,t.Ha=this.Ha}toString(t){if(void 0===t&&(t=0),t>=2)return this.toJson();{let e=(""!==this.name?this.name:"")+" TreeModel";if(t>0){e+="\n node data:";const t=this.nodeDataArray,i=t.length;for(let n=0;n<i;n++){const i=t[n];e+=" "+this.getKeyForNodeData(i)+":"+$e.toString(i)}}return e}}ag(){const t=super.ag();let e="";return"parent"!==this.nodeParentKeyProperty&&"string"==typeof this.nodeParentKeyProperty&&(e+=',\n  "nodeParentKeyProperty": '+this.Oe(this.nodeParentKeyProperty)),t+e}Ty(t){super.Ty(t),t.nodeParentKeyProperty&&(this.nodeParentKeyProperty=t.nodeParentKeyProperty)}Dy(t){void 0!==t.nodeParentKeyProperty&&t.nodeParentKeyProperty!==this.nodeParentKeyProperty&&d.o("applyIncrementalJson cannot change Model properties"),super.Dy(t)}maybeEnsureLinkReference(t){return t}get nodeParentKeyProperty(){return this.Rn}set nodeParentKeyProperty(t){const e=this.Rn;e!==t&&(this.Dn(t,ti,"nodeParentKeyProperty"),this.Rn=t,this.t("nodeParentKeyProperty",e,t))}get copiesParentKeyOfNodeData(){return this.gg}set copiesParentKeyOfNodeData(t){this.gg!==t&&(d.i(t,"boolean",ti,"copiesParentKeyOfNodeData"),this.gg=t)}getParentKeyForNodeData(t){if(null===t)return;const e=this.Rn;if(""===e)return;const i=Ze.vt(t,e);if(void 0!==i){if(this.isKeyType(i))return i;d.o("ParentKey value for node data "+t+" is not a number or a string: "+i)}}setParentKeyForNodeData(t,e){if(null===e&&(e=void 0),void 0!==e&&!this.isKeyType(e)&&d.ke(e,"number or string",ti,"setParentKeyForNodeData:key"),null===t)return;const i=this.Rn;if(""===i)return;if(e=this.maybeEnsureLinkReference(e),!this.containsNodeData(t))return void Ze.ht(t,i,e);const n=Ze.vt(t,i);n!==e&&(this.$s(n,t),Ze.ht(t,i,e),null===this.findNodeDataForKey(e)&&this.Zs(e,t),this.Et("nodeParentKey",2,i,t,n,e),"string"==typeof i&&this.updateTargetBindings(t,i))}get parentLinkCategoryProperty(){return this.Ha}set parentLinkCategoryProperty(t){const e=this.Ha;e!==t&&(this.Dn(t,ti,"parentLinkCategoryProperty"),this.Ha=t,this.t("parentLinkCategoryProperty",e,t))}get linkCategoryProperty(){return this.parentLinkCategoryProperty}set linkCategoryProperty(t){this.parentLinkCategoryProperty=t}getParentLinkCategoryForNodeData(t){if(null===t)return"";const e=this.Ha;if(""===e)return"";const i=Ze.vt(t,e);return void 0===i?"":"string"==typeof i?i:void d.o("getParentLinkCategoryForNodeData found a non-string category for "+t+": "+i)}getLinkCategoryForData(t){return this.getParentLinkCategoryForNodeData(t)}setParentLinkCategoryForNodeData(t,e){if(d.i(e,"string",ti,"setParentLinkCategoryForNodeData:cat"),null===t)return;const i=this.Ha;if(""===i)return;if(!this.containsNodeData(t))return void Ze.ht(t,i,e);let n=Ze.vt(t,i);void 0===n&&(n=""),n!==e&&(Ze.ht(t,i,e),this.Et("parentLinkCategory",2,i,t,n,e),"string"==typeof i&&this.updateTargetBindings(t,i))}setLinkCategoryForData(t,e){this.setParentLinkCategoryForNodeData(t,e)}copyNodeData(t){if(null===t)return null;const e=super.copyNodeData(t);return!this.copiesParentKeyOfNodeData&&""!==this.Rn&&void 0!==Ze.vt(e,this.Rn)&&Ze.ht(e,this.Rn,void 0),e}setDataProperty(t,e,i){if(this.containsNodeData(t)){if(e===this.nodeKeyProperty)return void this.setKeyForNodeData(t,i);if(e===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,i);if(e===this.nodeParentKeyProperty)return void this.setParentKeyForNodeData(t,i)}const n=Ze.vt(t,e);n!==i&&(Ze.ht(t,e,i),this.raiseDataChanged(t,e,n,i))}Fy(t,e){super.Fy(t,e);const i=this.ti.iterator;for(;i.next();){const n=i.value;this.NN(n,t,e)}}NN(t,e,i){if(this.getParentKeyForNodeData(t)===e){const n=this.Rn;Ze.ht(t,n,i),this.Et("nodeParentKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}}fg(t){super.fg(t);const e=this.getKeyForNodeData(t),i=this.Cy(e);if(null!==i){const t=d.rt(),n=i.iterator;for(;n.next();){const i=n.value;if(this.containsNodeData(i)&&this.getParentKeyForNodeData(i)===e){const n=this.Rn;this.Et("nodeParentKey",2,n,i,e,e),"string"==typeof n&&this.updateTargetBindings(i,n),t.push(i)}}for(let i=0;i<t.length;i++)this.$s(e,t[i]);d.it(t)}}ug(t){super.ug(t);let e=this.getParentKeyForNodeData(t);e=this.maybeEnsureLinkReference(e),null===this.findNodeDataForKey(e)&&this.Zs(e,t)}Ry(t){super.Ry(t);const e=this.getParentKeyForNodeData(t);this.$s(e,t)}cg(t,e){super.cg(t,e),this.setParentLinkCategoryForNodeData(e,this.getParentLinkCategoryForNodeData(t)),this.setParentKeyForNodeData(e,this.getParentKeyForNodeData(t))}get type(){return"TreeModel"}Hu(){return!0}zw(){return!0}}Ze.registerClass(ti,"TreeModel");var ei=(t=>(t[t.ConstantSpacing=0]="ConstantSpacing",t[t.ConstantDistance=1]="ConstantDistance",t[t.ConstantAngle=2]="ConstantAngle",t[t.Packed=3]="Packed",t))(ei||{}),ii=(t=>(t[t.Clockwise=10]="Clockwise",t[t.Counterclockwise=11]="Counterclockwise",t[t.BidirectionalLeft=12]="BidirectionalLeft",t[t.BidirectionalRight=13]="BidirectionalRight",t))(ii||{}),ni=(t=>(t[t.Forwards=20]="Forwards",t[t.Reverse=21]="Reverse",t[t.Ascending=22]="Ascending",t[t.Descending=23]="Descending",t[t.Optimized=24]="Optimized",t))(ni||{}),si=(t=>(t[t.Pythagorean=30]="Pythagorean",t[t.Circular=31]="Circular",t))(si||{});class oi extends je{constructor(t){super(),y(this,"ce",void 0),y(this,"vf",void 0),y(this,"E1",void 0),y(this,"mg",void 0),y(this,"V1",void 0),y(this,"Th",void 0),y(this,"CN",void 0),y(this,"LN",void 0),y(this,"AN",void 0),y(this,"Ms",void 0),y(this,"vy",void 0),y(this,"Oy",void 0),y(this,"ja",void 0),y(this,"Iy",void 0),y(this,"ET",void 0),y(this,"pg",void 0),y(this,"yg",void 0),y(this,"wg",void 0),y(this,"Of",void 0),y(this,"zi",void 0),y(this,"S",void 0),y(this,"xe",void 0),y(this,"be",void 0),y(this,"Tn",void 0),y(this,"xg",void 0),this.ce=0,this.vf=0,this.E1=0,this.mg=360,this.V1=0,this.Th=0,this.CN=new T,this.LN=30,this.AN=0,this.Ms=0,this.vy=0,this.Oy=new ri,this.ja=0,this.Iy=0,this.ET=600,this.pg=NaN,this.yg=1,this.wg=0,this.Of=360,this.zi=0,this.S=10,this.xe=24,this.be=Ke.standardComparer,this.Tn=6,this.xg=30,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.pg=this.pg,t.yg=this.yg,t.wg=this.wg,t.Of=this.Of,t.zi=this.zi,t.S=this.S,t.xe=this.xe,t.be=this.be,t.Tn=this.Tn,t.xg=this.xg}li(t){t in ni?this.sorting=t:t in ii?this.direction=t:t in ei?this.arrangement=t:t in si?this.nodeDiameterFormula=t:super.li(t)}createNetwork(){return new ai(this)}RO(t,e,i){t=this.vO(t);let n=this.V1,s=this.LN,o=this.ce,r=this.vf,a=this.E1,l=this.mg,h=this.Th,u=this.AN,c=this.Ms,d=this.vy;if(n=this.arrangement,s=this.nodeDiameterFormula,o=this.radius,(!isFinite(o)||o<=0)&&(o=NaN),r=this.aspectRatio,(!isFinite(r)||r<=0)&&(r=1),a=this.startAngle,isFinite(a)||(a=0),l=this.sweepAngle,(!isFinite(l)||l>360||l<1)&&(l=360),h=this.spacing,isFinite(h)||(h=NaN),3===n&&31===s?n=0:3===n&&31!==s&&(s=31,n=this.arrangement),(12===this.direction||13===this.direction)&&24!==this.sorting){for(let n=0;!(n>=t.length||(e.add(t.elt(n)),n+1>=t.length));n+=2)i.add(t.elt(n+1));12===this.direction?(3===this.arrangement&&e.reverse(),(t=new x).addAll(e),t.addAll(i)):(3===this.arrangement&&i.reverse(),(t=new x).addAll(i),t.addAll(e))}const f=t.length;u=0;let g=0;for(let m=0;m<t.length;m++){const e=a+l*g*(10===this.direction?1:-1)/f;let i=t.elt(m).diameter;isNaN(i)&&(i=t.elt(m).Dh(e)),l<360&&(0===m||m===t.length-1)&&(i/=2),u+=i,g++}if(isNaN(o)||3===n){if(isNaN(h)&&(h=6),0!==n&&3!==n){let e=-1/0;for(let i=0;i<f;i++){const n=t.elt(i),s=t.elt(i===f-1?0:i+1);isNaN(n.diameter)&&n.Dh(0),isNaN(s.diameter)&&s.Dh(0),e=Math.max(e,(n.diameter+s.diameter)/2)}if(d=e+h,2===n){const t=(e+h)/(2*Math.PI/f);r>1?(o=t,c=o*r):(c=t,o=c)}else o=this.U1(d*(l>=360?f:f-1),r,a*Math.PI/180,l*Math.PI/180)}else o=this.U1(u+(l>=360?f:f-1)*(3!==n?h:1.6*h),r,a*Math.PI/180,l*Math.PI/180);c=o*r}else{c=o*r;const e=this.TN(o,c,a*Math.PI/180,l*Math.PI/180);if(isNaN(h))0===n&&(h=(e-u)/(l>=360?f:f-1));else if(0===n){const t=(e-u)/(l>=360?f:f-1);t<h?(o=this.U1(u+h*(l>=360?f:f-1),r,a*Math.PI/180,l*Math.PI/180),c=o*r):h=t}else{let i=-1/0;for(let e=0;e<f;e++){const n=t.elt(e),s=t.elt(e===f-1?0:e+1);isNaN(n.diameter)&&n.Dh(0),isNaN(s.diameter)&&s.Dh(0),i=Math.max(i,(n.diameter+s.diameter)/2)}const n=i+h,s=this.U1(n*(l>=360?f:f-1),r,a*Math.PI/180,l*Math.PI/180);s>o?(o=s,c=o*r,d=n):d=e/(l>=360?f:f-1)}}return this.V1=n,this.LN=s,this.ce=o,this.vf=r,this.E1=a,this.mg=l,this.Th=h,this.AN=u,this.Ms=c,this.vy=d,t}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const e=this.network.vertexes;if(e.count<=1){if(1===e.count){const t=e.first();t.centerX=0,t.centerY=0}return this.updateParts(),this.network=null,void(this.isValidLayout=!0)}let i=new x;i.addAll(e.iterator);const n=new x,s=new x;i=this.RO(i,n,s);const o=this.V1,r=this.ce,a=this.E1,l=this.mg,h=this.Th,u=this.Ms,c=this.vy;if(12!==this.direction&&13!==this.direction||3!==o)if(12===this.direction||13===this.direction){let t=0;switch(o){case 1:t=180*this.B1(r,u,a,c)/Math.PI;break;case 0:{let e=0,i=0;const o=n.first();null!==o&&(e=o.Dh(Math.PI/2));const l=s.first();null!==l&&(i=l.Dh(Math.PI/2)),t=180*this.B1(r,u,a,h+(e+i)/2)/Math.PI;break}case 2:t=l/i.length}if(12===this.direction){switch(o){case 1:this.Ey(n,l/2,a,11);break;case 0:this.Vy(n,l/2,a,11);break;case 2:this.Uy(n,l/2,a,11)}switch(o){case 1:this.Ey(s,l/2,a+t,10);break;case 0:this.Vy(s,l/2,a+t,10);break;case 2:this.Uy(s,l/2,a+t,10)}}else{switch(o){case 1:this.Ey(s,l/2,a,11);break;case 0:this.Vy(s,l/2,a,11);break;case 2:this.Uy(s,l/2,a,11)}switch(o){case 1:this.Ey(n,l/2,a+t,10);break;case 0:this.Vy(n,l/2,a+t,10);break;case 2:this.Uy(n,l/2,a+t,10)}}}else switch(o){case 1:this.Ey(i,l,a,this.direction);break;case 0:this.Vy(i,l,a,this.direction);break;case 2:this.Uy(i,l,a,this.direction);break;case 3:this.VT(i,l,a,this.direction)}else this.VT(i,l,a-l/2,10);this.updateParts(),this.network=null,this.isValidLayout=!0}Uy(t,e,i,n){const s=this.mg,o=this.ce,r=this.Ms,a=i*Math.PI/180,l=e*Math.PI/180,h=t.length;for(let u=0;u<h;u++){const e=a+(10===n?u*l/(s>=360?h:h-1):-u*l/h),i=t.elt(u),c=o*Math.tan(e)/r,d=Math.sqrt((o*o+r*r*c*c)/(1+c*c));i.centerX=d*Math.cos(e),i.centerY=d*Math.sin(e),i.actualAngle=180*e/Math.PI}}Vy(t,e,i,n){const s=this.ce,o=this.Ms,r=this.Th;let a=i*Math.PI/180;const l=t.length;for(let h=0;h<l;h++){const e=t.elt(h),i=t.elt(h===l-1?0:h+1),u=s*Math.cos(a),c=o*Math.sin(a);e.centerX=u,e.centerY=c,e.actualAngle=180*a/Math.PI,isNaN(e.diameter)&&e.Dh(0),isNaN(i.diameter)&&i.Dh(0);const d=(e.diameter+i.diameter)/2,f=this.B1(s,o,10===n?a:-a,d+r);a+=10===n?f:-f}}Ey(t,e,i,n){const s=this.ce,o=this.Ms,r=this.vy;let a=i*Math.PI/180;const l=t.length;for(let h=0;h<l;h++){const e=t.elt(h);e.centerX=s*Math.cos(a),e.centerY=o*Math.sin(a),e.actualAngle=180*a/Math.PI;const i=this.B1(s,o,10===n?a:-a,r);a+=10===n?i:-i}}VT(t,e,i,n){let s=this.Iy;const o=this.mg;if(this.ja=0,this.Oy=new ri,e<360){for(s=i+(10===n?o:-o);s<0;)s+=360;s%=360,s>180&&(s-=360),s*=Math.PI/180,this.Iy=s,this.UT(t,e,i,n)}else this.BT(t,e,i,n);this.Oy.commit(t)}BT(t,e,i,n){const s=this.ce,o=this.Ms,r=this.Th,a=this.vf;let l=s*Math.cos(i*Math.PI/180),h=o*Math.sin(i*Math.PI/180);const u=t.toArray();if(3===u.length)return u[0].centerX=s,u[0].centerY=0,u[1].centerX=u[0].centerX-u[0].width/2-u[1].width/2-r,u[1].y=u[0].y,u[2].centerX=(u[0].centerX+u[1].centerX)/2,void(u[2].y=u[0].y-u[2].height-r);if(4===u.length)return u[0].centerX=s,u[0].centerY=0,u[2].centerX=-u[0].centerX,u[2].centerY=u[0].centerY,u[1].centerX=0,u[1].y=Math.min(u[0].y,u[2].y)-u[1].height-r,u[3].centerX=0,void(u[3].y=Math.max(u[0].y+u[0].height+r,u[2].y+u[2].height+r));const c=T.l();for(let x=0;x<u.length&&(u[x].centerX=l,u[x].centerY=h,!(x>=u.length-1));x++)this.zT(l,h,u,x,n,c)||this.XT(l,h,u,x,n,c),l=c.x,h=c.y;if(T.s(c),this.ja++,this.ja>23)return;const d=u[0].centerX,f=u[0].centerY,g=u[u.length-1].centerX,m=u[u.length-1].centerY;let p=Math.abs(d-g)-((u[0].width+u[u.length-1].width)/2+r);const y=Math.abs(f-m)-((u[0].height+u[u.length-1].height)/2+r);let v=0;if(Math.abs(y)<1){const t=Math.abs(d-g),e=(u[0].width+u[u.length-1].width)/2;t<e&&(v=0),p=t-e}else v=y>0?y:Math.abs(p)<1?0:p;let b=!1;b=Math.abs(g)>Math.abs(m)?g>0!=f>m:m>0!=d<g,b=10===n?b:!b,b&&(v=-Math.abs(v),v=Math.min(v,-u[u.length-1].width),v=Math.min(v,-u[u.length-1].height)),this.Oy.OO(v,u),Math.abs(v)>1&&(this.ja<8?this.ce-=v/(2*Math.PI):u.length<5&&v>10?this.ce/=2:this.ce-=v>0?1.7:-2.3,this.Ms=this.ce*a,this.BT(t,e,i,n))}UT(t,e,i,n){const s=this.ce,o=this.Ms,r=this.vf;let a=s*Math.cos(i*Math.PI/180),l=o*Math.sin(i*Math.PI/180);const h=T.l(),u=t.toArray();for(let g=0;g<u.length&&(u[g].centerX=a,u[g].centerY=l,!(g>=u.length-1));g++)this.zT(a,l,u,g,n,h)||this.XT(a,l,u,g,n,h),a=h.x,l=h.y;if(T.s(h),this.ja++,this.ja>23)return;const c=Math.atan2(l,a);let d=10===n?this.Iy-c:c-this.Iy;d=Math.abs(d)<Math.abs(d-2*Math.PI)?d:d-2*Math.PI;const f=d*(s+o)/2;this.Oy.IO(f,u),Math.abs(f)>1&&(this.ja<8?this.ce-=f/(2*Math.PI):this.ce-=f>0?1.7:-2.3,this.Ms=this.ce*r,this.UT(t,e,i,n))}zT(t,e,i,n,s,o){const r=this.Th,a=this.ce,l=this.Ms;let h=0,u=0;const c=(i[n].width+i[n+1].width)/2+r;let d=!1;if(e>=0!=(10===s)){if(h=t+c,h>a){if(h=t-c,h<-a)return o.x=h,o.y=u,!1;d=!0}}else if(h=t-c,h<-a){if(h=t+c,h>a)return o.x=h,o.y=u,!1;d=!0}return u=Math.sqrt(1-Math.min(1,h*h/(a*a)))*l,e<0!==d&&(u=-u),Math.abs(e-u)>(i[n].height+i[n+1].height)/2?(o.x=h,o.y=u,!1):(o.x=h,o.y=u,!0)}XT(t,e,i,n,s,o){const r=this.Th,a=this.ce,l=this.Ms;let h=0,u=0;const c=(i[n].height+i[n+1].height)/2+r;let d=!1;if(t>=0!=(10===s)){if(u=e-c,u<-l){if(u=e+c,u>l)return o.x=h,o.y=u,!1;d=!0}}else if(u=e+c,u>l){if(u=e-c,u<-l)return o.x=h,o.y=u,!1;d=!0}return h=Math.sqrt(1-Math.min(1,u*u/(l*l)))*a,t<0!==d&&(h=-h),Math.abs(t-h)>(i[n].width+i[n+1].width)/2?(o.x=h,o.y=u,!1):(o.x=h,o.y=u,!0)}commitLayout(){this.commitNodes(),this.isRouting&&this.commitLinks()}commitNodes(){const t=null!==this.group&&this.group.hasPlaceholder(),e=t?this.group.location.copy():null;let i=this.actualCenter;t?i=new T(0,0):(i.x=this.arrangementOrigin.x+this.ce,i.y=this.arrangementOrigin.y+this.Ms);const n=this.network.vertexes.iterator;for(;n.next();){const t=n.value;t.x+=i.x,t.y+=i.y,t.commit()}if(t){this.group.ensureBounds();const t=this.group.position.copy(),i=this.group.location.copy(),n=e.subtract(i.subtract(t));this.group.move(n),this.CN=n.subtract(t)}}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}TN(t,e,i,n){const s=this.ET;if(Math.abs(this.vf-1)<.001)return void 0!==i&&void 0!==n?n*t:2*Math.PI*t;const o=t>e?Math.sqrt(t*t-e*e)/t:Math.sqrt(e*e-t*t)/e;let r=0,a=0;a=void 0!==i&&void 0!==n?n/(s+1):Math.PI/(2*(s+1));let l=0;for(let h=0;h<=s;h++){l=void 0!==i&&void 0!==n?i+h*n/s:h*Math.PI/(2*s);const t=Math.sin(l);r+=Math.sqrt(1-o*o*t*t)*a}return void 0!==i&&void 0!==n?(t>e?t:e)*r:4*(t>e?t:e)*r}U1(t,e,i,n){let s=0;return s=void 0!==i&&void 0!==n?this.TN(1,e,i,n):this.TN(1,e),t/s}B1(t,e,i,n){if(Math.abs(this.vf-1)<.001)return n/t;const s=t>e?Math.sqrt(t*t-e*e)/t:Math.sqrt(e*e-t*t)/e;let o=0;const r=2*Math.PI/(700*this.network.vertexes.count);t>e&&(i+=Math.PI/2);for(let a=0;;a++){const l=i+a*r,h=Math.sin(l);if(o+=(t>e?t:e)*Math.sqrt(1-s*s*h*h)*r,o>=n)return a*r}}vO(t){switch(this.sorting){case 20:break;case 21:t.reverse();break;case 22:t.sort(this.comparer);break;case 23:t.sort(this.comparer),t.reverse();break;case 24:return this.EO(this.VO(t));default:d.o("Invalid sorting type.")}return t}VO(t){const e=[];for(let n=0;n<t.length;n++)e.push(0);const i=new x;for(let n=0;n<t.length;n++){let s=-1,o=-1;if(0===n)for(let e=0;e<t.length;e++){const i=t.elt(e).edgesCount;i>s&&(s=i,o=e)}else for(let i=0;i<t.length;i++){const t=e[i];t>s&&(s=t,o=i)}i.add(t.elt(o)),e[o]=-1;const r=t.elt(o);let a=0;const l=r.sourceEdges;for(;l.next();){const i=l.value.fromVertex;a=t.indexOf(i),!(a<0)&&e[a]>=0&&e[a]++}const h=r.destinationEdges;for(;h.next();){const i=h.value.toVertex;a=t.indexOf(i),!(a<0)&&e[a]>=0&&e[a]++}}return i}EO(t){const e=[];for(let c=0;c<t.length;c++){const i=t.elt(c);e[c]=[];let n=0;const s=i.destinationEdges;for(;s.next();){const i=s.value.toVertex;n=t.indexOf(i),n!==c&&e[c].indexOf(n)<0&&e[c].push(n)}const o=i.sourceEdges;for(;o.next();){const i=o.value.fromVertex;n=t.indexOf(i),n!==c&&e[c].indexOf(n)<0&&e[c].push(n)}}const i=[];for(let c=0;c<e.length;c++)i[c]=0;const n=[],s=[],o=[],r=[],a=new x;let l=0;for(let c=0;c<e.length;c++){const h=e[c].length;if(1===h){r.push(c);continue}if(0===h){a.add(t.elt(c));continue}if(0===l){n.push(c),l++;continue}let u=1/0,d=1/0,f=-1;const g=[];for(let t=0;t<n.length;t++)e[n[t]].indexOf(n[t===n.length-1?0:t+1])<0&&g.push(t===n.length-1?0:t+1);if(0===g.length)for(let t=0;t<n.length;t++)g.push(t);for(let t=0;t<g.length;t++){const r=g[t],a=this.UO(e[c],s,o,i,r,n);let l=0;for(let t=0;t<e[c].length;t++){const i=e[c][t],s=n.indexOf(i);if(s>=0){const t=Math.abs(r-(s>=r?s+1:s));l+=t<n.length+1-t?t:n.length+1-t}}for(let t=0;t<s.length;t++){let e=i[s[t]],a=i[o[t]];if(e>=r&&e++,a>=r&&a++,e>a){const t=a;a=e,e=t}a-e<(n.length+2)/2==(e<r&&r<=a)&&l++}(a<u||a===u&&l<d)&&(u=a,d=l,f=r)}n.splice(f,0,c);for(let t=0;t<n.length;t++)i[n[t]]=t;for(let t=0;t<e[c].length;t++){const i=e[c][t];n.indexOf(i)>=0&&(s.push(c),o.push(i))}l++}let h=!1;const u=n.length;for(;;){h=!0;for(let t=0;t<r.length;t++){const i=r[t],s=e[i][0],o=n.indexOf(s);if(o>=0){let a=0;for(let t=0;t<e[s].length;t++){const i=e[s][t],r=n.indexOf(i);if(r<0||r===o)continue;const l=r>o?r-o:o-r;a+=r<o!=l>u-l?1:-1}n.splice(a<0?o:o+1,0,i),r.splice(t,1),t--}else h=!1}if(h)break;n.push(r[0]),r.splice(0,1)}for(let c=0;c<n.length;c++){const e=n[c];a.add(t.elt(e))}return a}UO(t,e,i,n,s,o){let r=0;for(let a=0;a<e.length;a++){const l=e[a],h=i[a],u=n[l],c=n[h];let d=0,f=0;if(u<c?(d=u,f=c):(d=c,f=u),d<s&&s<=f)for(let e=0;e<t.length;e++){const i=t[e];o.indexOf(i)<0||d<n[i]&&n[i]<f||d===n[i]||f===n[i]||r++}else for(let e=0;e<t.length;e++){const i=t[e];o.indexOf(i)<0||!(d<n[i]&&n[i]<f)||d===n[i]||f===n[i]||r++}}return r}get radius(){return this.pg}set radius(t){this.pg!==t&&(d.i(t,"number",oi,"radius"),(t>0||isNaN(t))&&(this.pg=t,this.invalidateLayout()))}get aspectRatio(){return this.yg}set aspectRatio(t){this.yg!==t&&(d.i(t,"number",oi,"aspectRatio"),t>0&&(this.yg=t,this.invalidateLayout()))}get startAngle(){return this.wg}set startAngle(t){this.wg!==t&&(d.i(t,"number",oi,"startAngle"),this.wg=t,this.invalidateLayout())}get sweepAngle(){return this.Of}set sweepAngle(t){this.Of!==t&&(d.i(t,"number",oi,"sweepAngle"),this.Of=t>0&&t<=360?t:360,this.invalidateLayout())}get arrangement(){return this.zi}set arrangement(t){this.zi!==t&&(3===t||0===t||1===t||2===t)&&(this.zi=t,this.invalidateLayout())}get direction(){return this.S}set direction(t){this.S!==t&&(10===t||11===t||12===t||13===t)&&(this.S=t,this.invalidateLayout())}get sorting(){return this.xe}set sorting(t){this.xe!==t&&(this.xe=t,this.invalidateLayout())}get comparer(){return this.be}set comparer(t){this.be!==t&&(d.i(t,"function",oi,"comparer"),this.be=t,this.invalidateLayout())}get spacing(){return this.Tn}set spacing(t){this.Tn!==t&&(d.i(t,"number",oi,"spacing"),this.Tn=t,this.invalidateLayout())}get nodeDiameterFormula(){return this.xg}set nodeDiameterFormula(t){this.xg!==t&&(30===t||31===t)&&(this.xg=t,this.invalidateLayout())}get actualXRadius(){return this.ce}get actualYRadius(){return this.Ms}get actualSpacing(){return this.Th}get actualCenter(){return this.CN}}y(oi,"ConstantSpacing",0),y(oi,"ConstantDistance",1),y(oi,"ConstantAngle",2),y(oi,"Packed",3),y(oi,"Clockwise",10),y(oi,"Counterclockwise",11),y(oi,"BidirectionalLeft",12),y(oi,"BidirectionalRight",13),y(oi,"Forwards",20),y(oi,"Reverse",21),y(oi,"Ascending",22),y(oi,"Descending",23),y(oi,"Optimized",24),y(oi,"Pythagorean",30),y(oi,"Circular",31);class ri{constructor(){y(this,"If",void 0),y(this,"qa",void 0),y(this,"Ef",void 0),this.If=-1/0,this.qa=null,this.Ef=null}OO(t,e){if(t>0&&this.If<0||Math.abs(t)<Math.abs(this.If)&&!(t<0&&this.If>0)){this.If=t,this.qa=[],this.Ef=[];for(let t=0;t<e.length;t++)this.qa[t]=e[t].bounds.x,this.Ef[t]=e[t].bounds.y}}IO(t,e){if(Math.abs(t)<Math.abs(this.If)){this.If=t,this.qa=[],this.Ef=[];for(let t=0;t<e.length;t++)this.qa[t]=e[t].bounds.x,this.Ef[t]=e[t].bounds.y}}commit(t){if(null!==this.qa&&null!==this.Ef)for(let e=0;e<this.qa.length;e++){const i=t.elt(e);i.x=this.qa[e],i.y=this.Ef[e]}}}class ai extends Ue{constructor(t){super(t)}createVertex(){return new li(this)}createEdge(){return new hi(this)}}class li extends Ke{constructor(t){super(t),y(this,"ko",void 0),y(this,"z1",void 0),this.ko=NaN,this.z1=NaN}Dh(t){const e=this.network;if(null===e)return NaN;const i=e.layout;if(null===i)return NaN;if(3===i.arrangement){if(31===i.nodeDiameterFormula)return this.ko=Math.max(this.width,this.height),this.ko;{const e=Math.abs(Math.sin(t)),i=Math.abs(Math.cos(t));return 0===e?this.width:0===i?this.height:(this.ko=Math.min(this.height/e,this.width/i),this.ko)}}return 31===i.nodeDiameterFormula?(this.ko=Math.max(this.width,this.height),this.ko):(this.ko=Math.sqrt(this.width*this.width+this.height*this.height),this.ko)}get diameter(){return this.ko}set diameter(t){this.ko!==t&&(d.i(t,"number",li,"diameter"),this.ko=t)}get actualAngle(){return this.z1}set actualAngle(t){this.z1!==t&&(d.i(t,"number",li,"actualAngle"),this.z1=t)}}class hi extends Ge{constructor(t){super(t)}}class ui extends je{constructor(t){super(),y(this,"By",void 0),y(this,"Fh",void 0),y(this,"Ss",void 0),y(this,"bg",void 0),y(this,"vn",void 0),y(this,"Ie",void 0),y(this,"kg",void 0),y(this,"Pg",void 0),y(this,"Mg",void 0),y(this,"Vf",void 0),y(this,"Sg",void 0),y(this,"Ng",void 0),y(this,"Uf",void 0),y(this,"Bf",void 0),y(this,"zf",void 0),y(this,"Xf",void 0),y(this,"Cg",void 0),y(this,"Lg",void 0),y(this,"Kf",void 0),y(this,"Wa",void 0),this.By=0,this.Fh=0,this.Ss=new A(100,100).g(),this.bg=!1,this.vn=!0,this.Ie=!1,this.kg=100,this.Pg=300,this.Mg=1,this.Vf=1e3,this.Sg=10,this.Ng=Math,this.Uf=.05,this.Bf=50,this.zf=150,this.Xf=0,this.Cg=10,this.Lg=5,this.Kf=NaN,this.Wa=10,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Ss.a(this.Ss),t.bg=this.bg,t.vn=this.vn,t.Ie=this.Ie,t.kg=this.kg,t.Pg=this.Pg,t.Mg=this.Mg,t.Vf=this.Vf,t.Sg=this.Sg,t.Ng=this.Ng,t.Uf=this.Uf,t.Bf=this.Bf,t.zf=this.zf,t.Xf=this.Xf,t.Cg=this.Cg,t.Lg=this.Lg,t.Kf=this.Kf,t.Wa=this.Wa}createNetwork(){return new ci(this)}doLayout(t){this.network=this.makeNetwork(t);let e=this.network.vertexes.iterator;const i=this.maxIterations;if(this.network.vertexes.count>0){for(this.network.deleteSelfEdges(),e=this.network.vertexes.iterator;e.next();){const t=e.value;t.charge=this.electricalCharge(t),t.mass=this.gravitationalMass(t)}const t=this.network.edges.iterator;for(;t.next();){const e=t.value;e.stiffness=this.springStiffness(e),e.length=this.springLength(e)}if(this.DN(),this.Fh=0,this.needsPrelayout()){const t=this.network,e=t.splitIntoSubNetworks(!1);let i=e.iterator;for(;i.next();){const t=i.value;this.doConnectedSubnetLayout(t)}for(i=e.iterator,this.BO(i,t),i=e.iterator;i.next();){const e=i.value,n=e.vertexes.iterator;for(;n.next();){const e=n.value;t.addVertex(e)}const s=e.edges.iterator;for(;s.next();){const e=s.value;t.addEdge(e)}}}else this.KT(this.network,this.maxIterations);this.updateParts()}this.maxIterations=i,this.isValidLayout=!0}needsPrelayout(){if(this.network.vertexes.count<3)return!1;let t=0,e=0;const i=this.network.vertexes.first().bounds,n=this.network.vertexes.iterator;for(;n.next();){const s=n.value,o=s.bounds;if(isNaN(s.x)||isNaN(s.y)||o.intersectsRect(i)&&(t++,t>2))return!0;if(e>10)return!1;e++}return!1}doConnectedSubnetLayout(t){let e=t.vertexes.iterator;for(;e.next();){const t=e.value;t.hierarchicalVertexes.add(t)}let i=t,n=this.Kf;if(isNaN(n)&&(n=t.edges.count/t.vertexes.count),n<t.vertexes.count)for(;i.vertexes.count>Math.max(100,Math.sqrt(n*t.vertexes.count));)i=this.coarsenNetwork(i);let s=0;e=i.vertexes.iterator;let o=this.randomNumberGenerator;for(null===o&&(this.randomNumberGenerator=o=new gi(0));e.next();){e.value.idInCluster=s++;const t=10*(o.random()-.5),i=10*(o.random()-.5);e.value.x=t,e.value.y=i;const n=e.value.hierarchicalVertexes.iterator;for(;n.next();)n.value.x=t,n.value.y=i}const r=this.computePairwiseDistances(i);this.zO(i,r,this.maxPrelayoutIterations,t.vertexes.count),this.KT(t,this.maxIterations)}computePairwiseDistances(t){const e=t.vertexes.count,i=new Array(e);for(let r=0;r<e;r++)i[r]=new Array(e).fill(-1),i[r][r]=0;const n=t.vertexes.iterator;let s=new Map,o=[];for(;n.next();){const t=n.value;for(o=[t],s=new Map,s.set(t.idInCluster,0);o.length>0;){const t=o.shift(),e=t.vertexes.iterator;for(;e.next();){const i=e.value;s.has(i.idInCluster)||(s.set(i.idInCluster,s.get(t.idInCluster)+1),o.push(i))}}for(let n=0;n<e;n++){const e=Math.min(i[t.idInCluster][n],i[n][t.idInCluster]),o=s.get(n);(e<0||o<e)&&(i[t.idInCluster][n]=o,i[n][t.idInCluster]=o)}}return i}coarsenNetwork(t){const e=this.createNetwork(),i=new Map;let n=0,s=t.vertexes.iterator;for(;s.next();)s.value.idInCluster=n++;for(s=t.vertexes.iterator;s.next();){const t=s.value;if(i.has(t.idInCluster))continue;let n=Number.MAX_SAFE_INTEGER,o=null;const r=t.vertexes.iterator;for(;r.next();){const t=r.value;i.has(t.idInCluster)||t.hierarchicalVertexes.length<n&&(n=t.hierarchicalVertexes.length,o=t)}const a=e.createVertex();a.hierarchicalVertexes.addAll(t.hierarchicalVertexes),null!=o&&a.hierarchicalVertexes.addAll(o.hierarchicalVertexes),i.set(t.idInCluster,a),null!=o&&i.set(o.idInCluster,a),e.addVertex(a)}const o=t.edges.iterator;for(;o.next();){const t=o.value,n=i.get(t.fromVertex.idInCluster),s=i.get(t.toVertex.idInCluster);if(n===s)continue;const r=e.createEdge();r.fromVertex=n,r.toVertex=s,e.addEdge(r)}return e}Sw(t,e){let i=!0;const n=t.vertexes.iterator;for(;n.next();){const t=n.value;i?(i=!1,e.set(t.bounds)):e.unionRect(t.bounds)}return e}BO(t,e){const i=this.arrangementSpacing,n=t.count;let s=!0,o=0,r=0;const a=d.rt();for(let c=0;c<n+e.vertexes.count+2;c++)a[c]=null;let l=0;t.reset();const h=D.l();let u;for(;t.next();){const e=t.value;if(this.Sw(e,h),s)s=!1,o=h.x+h.width/2,r=h.y+h.height/2,a[0]=new T(h.x+h.width+i.width,h.y),a[1]=new T(h.x,h.y+h.height+i.height),l=2;else{const t=this.YT(a,l,o,r,h.width,h.height,i),n=a[t],s=new T(n.x+h.width+i.width,n.y),c=new T(n.x,n.y+h.height+i.height);t+1<l&&a.splice(t+1,0,null),a[t]=s,a[t+1]=c,l++;const d=n.x-h.x,f=n.y-h.y;for(u=e.vertexes.iterator;u.next();){const t=u.value;t.centerX+=d,t.centerY+=f}}}for(D.s(h),u=e.vertexes.iterator;u.next();){const t=u.value,e=t.bounds;if(l<2){o=e.x+e.width/2,r=e.y+e.height/2,a[0]=new T(e.x+e.width+i.width,e.y),a[1]=new T(e.x,e.y+e.height+i.height),l=2;continue}const n=this.YT(a,l,o,r,e.width,e.height,i),s=a[n],h=new T(s.x+e.width+i.width,s.y),c=new T(s.x,s.y+e.height+i.height);n+1<l&&a.splice(n+1,0,null),a[n]=h,a[n+1]=c,l++,t.centerX=s.x+t.width/2,t.centerY=s.y+t.height/2}d.it(a)}YT(t,e,i,n,s,o,r){let a=9e19,l=-1;t:for(let h=0;h<e;h++){const u=t[h],c=u.x-i,d=u.y-n,f=c*c+d*d;if(f<a){for(let e=h-1;e>=0;e--)if(t[e].y>u.y&&t[e].x-u.x<s+r.width)continue t;for(let i=h+1;i<e;i++)if(t[i].x>u.x&&t[i].y-u.y<o+r.height)continue t;l=h,a=f}}return l}DN(){if(!this.comments)return;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;this.addComments(e)}}addComments(t){const e=t.node;if(null!==e){const i=e.findNodesConnected();for(;i.next();){const e=i.value;if("Comment"!==e.category||!e.isVisible())continue;let n=this.network.findVertex(e);null===n&&(n=this.network.addNode(e)),n.charge=this.defaultCommentElectricalCharge;let s=null;const o=n.destinationEdges;for(;o.next();){const e=o.value;if(e.toVertex===t){s=e;break}}if(null===s){const e=n.sourceEdges;for(;e.next();){const i=e.value;if(i.fromVertex===t){s=i;break}}}null===s&&(s=this.network.linkVertexes(t,n,null)),s.length=this.defaultCommentSpringLength}}}FN(t,e){const i=t.bounds,n=i.x,s=i.y,o=i.width,r=i.height,a=e.bounds,l=a.x,h=a.y,u=a.width,c=a.height;if(n+o<l){if(s>h+c){const t=n+o-l,e=s-h-c;return E.xw(t*t+e*e)}if(s+r<h){const t=n+o-l,e=s+r-h;return E.xw(t*t+e*e)}return l-(n+o)}if(n>l+u){if(s>h+c){const t=n-l-u,e=s-h-c;return E.xw(t*t+e*e)}if(s+r<h){const t=n-l-u,e=s+r-h;return E.xw(t*t+e*e)}return n-(l+u)}return s>h+c?s-(h+c):s+r<h?h-(s+r):.1}KT(t,e){const i=this.Fh+e;for(;this.Fh<i&&(this.Fh++,this.XO(t)););}XO(t){const e=t.vertexes.toArray();if(e.length<=0)return!1;const i=e[0];i.forceX=0,i.forceY=0;let n=i.centerX,s=n,o=i.centerY,r=o;for(let g=1;g<e.length;g++){const t=e[g];t.forceX=0,t.forceY=0;const i=t.centerX,a=t.centerY;n=Math.min(n,i),s=Math.max(s,i),o=Math.min(o,a),r=Math.max(r,a)}const a=s-n>r-o;a?e.sort(((t,e)=>null===t||null===e||t===e?0:t.centerX-e.centerX)):e.sort(((t,e)=>null===t||null===e||t===e?0:t.centerY-e.centerY));const l=this.Vf;let h=0,u=0,c=0;for(let g=0;g<e.length;g++){const t=e[g],i=t.bounds,n=t.focus,s=i.x+n.x,o=i.y+n.y;u=t.charge*this.electricalFieldX(s,o),c=t.charge*this.electricalFieldY(s,o),u+=t.mass*this.gravitationalFieldX(s,o),c+=t.mass*this.gravitationalFieldY(s,o),t.forceX+=u,t.forceY+=c;for(let r=g+1;r<e.length;r++){const i=e[r];if(!this.shouldInteract(t,i)||r===g)continue;const n=i.bounds,d=i.focus,f=n.x+d.x,m=n.y+d.y;if(s-f>l||f-s>l){if(a)break;continue}if(o-m>l||m-o>l){if(!a)break;continue}const p=this.FN(t,i),y=2*t.charge,v=2*i.charge;if(p>1)h=y*v/(p*p),u=h*(s-f)/p,c=h*(o-m)/p;else{let e=this.randomNumberGenerator;null===e&&(this.randomNumberGenerator=e=new gi(0));const n=e.random(),r=e.random();if(s>f)u=Math.abs(i.bounds.right-t.bounds.x),u=y*v*(1+u)*n;else if(s<f)u=Math.abs(i.bounds.x-t.bounds.right),u=-y*v*(1+u)*n;else{const e=Math.max(i.width,t.width);u=y*v*((1+e)*n-e/2)}if(o>m)c=Math.abs(i.bounds.bottom-t.bounds.y),c=y*v*(1+c)*r;else if(s<f)c=Math.abs(i.bounds.y-t.bounds.bottom),c=-y*v*(1+c)*r;else{const e=Math.max(i.height,t.height);c=y*v*((1+e)*r-e/2)}}t.forceX+=u,t.forceY+=c,i.forceX-=u,i.forceY-=c}}const d=t.edges.iterator;for(;d.next();){const t=d.value,e=t.fromVertex,i=t.toVertex,n=e.bounds,s=e.focus,o=n.x+s.x,r=n.y+s.y,a=i.bounds,l=i.focus,f=a.x+l.x,g=a.y+l.y,m=this.FN(e,i);m>1&&(h=.1*t.stiffness*(m-t.length),u=.5*h*(e.width+i.height)*(o-f)/m,c=.5*h*(e.width+i.height)*(r-g)/m),e.forceX-=u,e.forceY-=c,i.forceX+=u,i.forceY+=c}let f=0;for(let g=0;g<e.length;g++){const t=e[g];this.isFixed(t)?this.moveFixedVertex(t):f=Math.max(f,this.moveVertex(t)||0)}return f>this.epsilonDistance*this.epsilonDistance}zO(t,e,i,n){const s=this.Fh+i,o=Math.sqrt(n);this.By=this.Wa*t.vertexes.count;const r=t.vertexes.toArray();let a=0,l=0,h=0;for(;this.Fh<s;){this.Fh++,l=a,a=0;for(let t=0;t<r.length;t++){r[t].forceX=0,r[t].forceY=0;for(let n=0;n<r.length;n++){if(t===n)continue;const i=this.FN(r[t],r[n]),s=e[r[t].idInCluster][r[n].idInCluster],a=(i-this.Wa*o*s)/i;r[t].forceX+=a*(r[n].x-r[t].x),r[t].forceY+=a*(r[n].y-r[t].y)}const i=Math.sqrt(r[t].forceX*r[t].forceX+r[t].forceY*r[t].forceY);if(i>0){r[t].forceX=this.By*r[t].forceX/i,r[t].forceY=this.By*r[t].forceY/i,r[t].x+=r[t].forceX,r[t].y+=r[t].forceY;const e=r[t].hierarchicalVertexes.iterator;for(;e.next();){const i=e.value;i.centerX+=r[t].forceX,i.centerY+=r[t].forceY}}a+=i*i}if(a>=l){if(h++,h>=5)break}else h=0;this.By*=.95}}moveVertex(t){let e=t.forceX,i=t.forceY;const n=this.moveLimit;return e<-n?e=-n:e>n&&(e=n),i<-n?i=-n:i>n&&(i=n),t.centerX+=e,t.centerY+=i,e*e+i*i}shouldInteract(t,e){return!0}moveFixedVertex(t){}commitLayout(){this.zy(),this.commitNodes(),this.isRouting&&this.commitLinks()}zy(){if(!this.setsPortSpots)return;const t=this.network.edges.iterator;for(;t.next();){const e=t.value.link;null!==e&&(e.fromSpot=O.Default,e.toSpot=O.Default)}}commitNodes(){let t=0,e=0;if(this.arrangesToOrigin){const i=D.l();this.Sw(this.network,i);const n=this.arrangementOrigin;t=n.x-i.x,e=n.y-i.y,D.s(i)}const i=D.l(),n=this.network.vertexes.iterator;for(;n.next();){const s=n.value;(0!==t||0!==e)&&(i.a(s.bounds),i.x+=t,i.y+=e,s.bounds=i),s.commit()}D.s(i)}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}springStiffness(t){const e=t.stiffness;return isNaN(e)?this.Uf:e}springLength(t){const e=t.length;return isNaN(e)?this.Bf:e}electricalCharge(t){const e=t.charge;return isNaN(e)?this.zf:e}electricalFieldX(t,e){return 0}electricalFieldY(t,e){return 0}gravitationalMass(t){const e=t.mass;return isNaN(e)?this.Xf:e}gravitationalFieldX(t,e){return 0}gravitationalFieldY(t,e){return 0}isFixed(t){return t.isFixed}get currentIteration(){return this.Fh}get arrangementSpacing(){return this.Ss}set arrangementSpacing(t){this.Ss.equals(t)||(this.Ss.a(t),this.invalidateLayout())}get arrangesToOrigin(){return this.bg}set arrangesToOrigin(t){this.bg!==t&&(d.i(t,"boolean",ui,"arrangesToOrigin"),this.bg=t,this.invalidateLayout())}get setsPortSpots(){return this.vn}set setsPortSpots(t){this.vn!==t&&(d.i(t,"boolean",ui,"setsPortSpots"),this.vn=t,this.invalidateLayout())}get comments(){return this.Ie}set comments(t){this.Ie!==t&&(d.i(t,"boolean",ui,"comments"),this.Ie=t,this.invalidateLayout())}get maxPrelayoutIterations(){return this.kg}set maxPrelayoutIterations(t){this.kg!==t&&(d.i(t,"number",ui,"maxPrelayoutIterations"),t>=0&&(this.kg=t,this.invalidateLayout()))}get maxIterations(){return this.Pg}set maxIterations(t){this.Pg!==t&&(d.i(t,"number",ui,"maxIterations"),t>=0&&(this.Pg=t,this.invalidateLayout()))}get epsilonDistance(){return this.Mg}set epsilonDistance(t){this.Mg!==t&&(d.i(t,"number",ui,"epsilonDistance"),t>0&&(this.Mg=t,this.invalidateLayout()))}get infinityDistance(){return this.Vf}set infinityDistance(t){this.Vf!==t&&(d.i(t,"number",ui,"infinityDistance"),t>1&&(this.Vf=t,this.invalidateLayout()))}get moveLimit(){return this.Sg}set moveLimit(t){this.Sg!==t&&(d.i(t,"number",ui,"moveLimit"),this.Sg=t,this.invalidateLayout())}get randomNumberGenerator(){return this.Ng}set randomNumberGenerator(t){this.Ng!==t&&(null!==t&&"function"!=typeof t.random&&d.o('ForceDirectedLayout.randomNumberGenerator must have a "random()" function on it: '+t),this.Ng=t)}get defaultSpringStiffness(){return this.Uf}set defaultSpringStiffness(t){this.Uf!==t&&(d.i(t,"number",ui,"defaultSpringStiffness"),this.Uf=t,this.invalidateLayout())}get defaultSpringLength(){return this.Bf}set defaultSpringLength(t){this.Bf!==t&&(d.i(t,"number",ui,"defaultSpringLength"),this.Bf=t,this.invalidateLayout())}get defaultElectricalCharge(){return this.zf}set defaultElectricalCharge(t){this.zf!==t&&(d.i(t,"number",ui,"defaultElectricalCharge"),this.zf=t,this.invalidateLayout())}get defaultGravitationalMass(){return this.Xf}set defaultGravitationalMass(t){this.Xf!==t&&(d.i(t,"number",ui,"defaultGravitationalMass"),this.Xf=t,this.invalidateLayout())}get defaultCommentSpringLength(){return this.Cg}set defaultCommentSpringLength(t){this.Cg!==t&&(d.i(t,"number",ui,"defaultCommentSpringLength"),this.Cg=t,this.invalidateLayout())}get defaultCommentElectricalCharge(){return this.Lg}set defaultCommentElectricalCharge(t){this.Lg!==t&&(d.i(t,"number",ui,"defaultCommentElectricalCharge"),this.Lg=t,this.invalidateLayout())}get prelayoutQuality(){return this.Kf}set prelayoutQuality(t){this.Kf!==t&&(d.i(t,"number",ui,"prelayoutQuality"),this.Kf=t,this.invalidateLayout())}get prelayoutSpread(){return this.Wa}set prelayoutSpread(t){this.Wa!==t&&(d.i(t,"number",ui,"prelayoutSpread"),this.Wa=t,this.invalidateLayout())}}class ci extends Ue{constructor(t){super(t)}createVertex(){return new di(this)}createEdge(){return new fi(this)}}class di extends Ke{constructor(t){super(t),y(this,"X1",void 0),y(this,"K1",void 0),y(this,"Y1",void 0),y(this,"G1",void 0),y(this,"H1",void 0),y(this,"hierarchicalVertexes",void 0),y(this,"idInCluster",void 0),this.X1=!1,this.K1=NaN,this.Y1=NaN,this.G1=0,this.H1=0,this.hierarchicalVertexes=new x,this.idInCluster=-1}get isFixed(){return this.X1}set isFixed(t){this.X1!==t&&(d.i(t,"boolean",di,"isFixed"),this.X1=t)}get charge(){return this.K1}set charge(t){this.K1!==t&&(d.i(t,"number",di,"charge"),this.K1=t)}get mass(){return this.Y1}set mass(t){this.Y1!==t&&(d.i(t,"number",di,"mass"),this.Y1=t)}get forceX(){return this.G1}set forceX(t){this.G1!==t&&(d.i(t,"number",di,"forceX"),this.G1=t)}get forceY(){return this.H1}set forceY(t){this.H1!==t&&(d.i(t,"number",di,"forceY"),this.H1=t)}}class fi extends Ge{constructor(t){super(t),y(this,"j1",void 0),y(this,"q1",void 0),this.j1=NaN,this.q1=NaN}get stiffness(){return this.j1}set stiffness(t){this.j1!==t&&(d.i(t,"number",fi,"stiffness"),this.j1=t)}get length(){return this.q1}set length(t){this.q1!==t&&(d.i(t,"number",fi,"length"),this.q1=t)}}class gi{constructor(t){y(this,"I",void 0),y(this,"R",void 0),y(this,"Q",void 0),y(this,"M",void 0),y(this,"A",void 0),y(this,"seed",void 0),void 0===t&&(t=42),this.seed=t,this.A=48271,this.M=2147483647,this.Q=this.M/this.A,this.R=this.M%this.A,this.I=1/this.M,this.random()}random(){const t=this.seed/this.Q,e=this.seed%this.Q,i=this.A*e-this.R*t;return this.seed=i>0?i:i+this.M,this.seed*this.I}}var mi=(t=>(t[t.DepthFirst=0]="DepthFirst",t[t.Greedy=1]="Greedy",t[t.FromLayers=2]="FromLayers",t))(mi||{}),pi=(t=>(t[t.OptimalLinkLength=10]="OptimalLinkLength",t[t.LongestPathSink=11]="LongestPathSink",t[t.LongestPathSource=12]="LongestPathSource",t))(pi||{}),yi=(t=>(t[t.DepthFirstOut=20]="DepthFirstOut",t[t.DepthFirstIn=21]="DepthFirstIn",t[t.Naive=22]="Naive",t))(yi||{}),vi=(t=>(t[t.None=30]="None",t[t.Less=31]="Less",t[t.More=32]="More",t))(vi||{}),bi=(t=>(t[t.None=0]="None",t[t.Expand=1]="Expand",t[t.Straighten=2]="Straighten",t[t.Median=4]="Median",t[t.MaybeExpand=8]="MaybeExpand",t[t.All=15]="All",t))(bi||{}),xi=(t=>(t[t.None=0]="None",t[t.UpperLeft=1]="UpperLeft",t[t.UpperRight=2]="UpperRight",t[t.LowerLeft=4]="LowerLeft",t[t.LowerRight=8]="LowerRight",t[t.All=15]="All",t))(xi||{});class wi extends je{constructor(t){super(),y(this,"Ns",void 0),y(this,"Ji",void 0),y(this,"S",void 0),y(this,"Yf",void 0),y(this,"Gf",void 0),y(this,"Hf",void 0),y(this,"Ja",void 0),y(this,"jf",void 0),y(this,"rr",void 0),y(this,"qf",void 0),y(this,"vn",void 0),y(this,"Mt",void 0),y(this,"Xy",void 0),y(this,"Kt",void 0),y(this,"Ag",void 0),y(this,"Cs",void 0),y(this,"di",void 0),y(this,"_s",void 0),y(this,"Ls",void 0),y(this,"As",void 0),y(this,"Ut",void 0),y(this,"Tg",void 0),y(this,"$a",void 0),y(this,"Dg",void 0),y(this,"tn",void 0),y(this,"Wf",void 0),y(this,"lr",void 0),y(this,"On",void 0),y(this,"In",void 0),y(this,"RN",void 0),this.Ns=25,this.Ji=25,this.S=0,this.Yf=0,this.Gf=10,this.Hf=20,this.Ja=4,this.jf=31,this.rr=15,this.qf=10,this.vn=!0,this.Mt=-1,this.Xy=-1,this.Kt=-1,this.Ag=0,this.Cs=0,this.di=null,this._s=null,this.Ls=null,this.As=null,this.Ut=null,this.Tg=0,this.$a=null,this.Dg=null,this.tn=0,this.Wf=null,this.lr=new T,this.On=[],this.On.length=100,this.In=15,this.RN=0,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Ns=this.Ns,t.Ji=this.Ji,t.S=this.S,t.Yf=this.Yf,t.Gf=this.Gf,t.Hf=this.Hf,t.Ja=this.Ja,t.jf=this.jf,t.rr=this.rr,t.qf=this.qf,t.vn=this.vn,t.In=this.In}li(t){t in vi?this.aggressiveOption=t:t in mi?this.cycleRemoveOption=t:t in yi?this.initializeOption=t:t in pi?this.layeringOption=t:super.li(t)}createNetwork(){return new ki(this)}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin),this.KO(),this.network.vertexes.count>0&&(this.network.deleteSelfEdges(),2!==this.cycleRemoveOption&&this.removeCycles(),this.YO(),2===this.cycleRemoveOption&&this.removeCycles(),this.GO(),this.HO(),this.jO(),this.reduceCrossings(),this.straightenAndPack(),this.updateParts()),this.network=null,this.isValidLayout=!0}linkMinLength(t){return 1}linkLengthWeight(t){return 1}linkStraightenWeight(t){const e=t.fromVertex.node||t.fromVertex.data,i=t.toVertex.node||t.toVertex.data;return null===e&&null===i?8:null===e||null===i?4:1}nodeMinLayerSpace(t,e){return null===t.node&&null===t.data?0:90===this.S||270===this.S?e?t.focus.y+10:t.bounds.height-t.focus.y+10:e?t.focus.x+10:t.bounds.width-t.focus.x+10}nodeMinColumnSpace(t,e){if(null===t.node&&null===t.data)return 0;const i=e?t.W1:t.J1;if(null!==i)return i;const n=this.S;return 90===n||270===n?e?t.W1=t.focus.x/this.Ji+1|0:t.J1=(t.bounds.width-t.focus.x)/this.Ji+1|0:e?t.W1=t.focus.y/this.Ji+1|0:t.J1=(t.bounds.height-t.focus.y)/this.Ji+1|0}$i(){null===this.$a&&(this.$a=[]);let t=0;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;this.$a[t]=i.layer,t++,this.$a[t]=i.column,t++,this.$a[t]=i.index,t++}return this.$a}_e(t){let e=0;const i=this.network.vertexes.iterator;for(;i.next();){const n=i.value;n.layer=t[e],e++,n.column=t[e],e++,n.index=t[e],e++}}GT(t,e){const i=this.Rh(t),n=this.di[t];(null===this.Dg||this.Dg.length<n*n)&&(this.Dg=[]);const s=this.Dg;for(let o=0;o<n;o++){let r=0;const a=i[o],l=a.near;let h=0;null!==l&&l!==a&&l.layer===a.layer&&(r+=Math.max(0,Math.abs(l.index-a.index)-1));let u,c,d,f,g,m=0,p=0,y=0,v=0,b=0,x=0,w=0,k=0;if(e>=0)for(u=i[o].yo,m=0;m<u.length;m++)if(c=u[m],c.valid&&c.fromVertex.layer!==t)for(p=c.fromVertex.index,y=c.portToPos,v=c.portFromPos,b=m+1;b<u.length;b++)f=u[b],f.valid&&f.fromVertex.layer!==t&&(x=f.fromVertex.index,w=f.portToPos,k=f.portFromPos,y<w&&(p>x||p===x&&v>k)&&r++,w<y&&(x>p||x===p&&k>v)&&r++);if(e<=0)for(u=i[o].sr,m=0;m<u.length;m++)if(c=u[m],c.valid&&c.toVertex.layer!==t)for(p=c.toVertex.index,y=c.portToPos,v=c.portFromPos,b=m+1;b<u.length;b++)f=u[b],f.valid&&f.toVertex.layer!==t&&(x=f.toVertex.index,w=f.portToPos,k=f.portFromPos,v<k&&(p>x||p===x&&y>w)&&r++,k<v&&(x>p||x===p&&w>y)&&r++);for(s[o*n+o]=r,h=o+1;h<n;h++){let r=0,a=0;if(e>=0)for(d=i[o].yo,g=i[h].yo,m=0;m<d.length;m++)if(c=d[m],c.valid&&c.fromVertex.layer!==t)for(p=c.fromVertex.index,y=c.portToPos,v=c.portFromPos,b=0;b<g.length;b++)f=g[b],f.valid&&f.fromVertex.layer!==t&&(x=f.fromVertex.index,w=f.portToPos,k=f.portFromPos,(p<x||p===x&&v<k)&&a++,(x<p||x===p&&k<v)&&r++);if(e<=0)for(d=i[o].sr,g=i[h].sr,m=0;m<d.length;m++)if(c=d[m],c.valid&&c.toVertex.layer!==t)for(p=c.toVertex.index,y=c.portToPos,v=c.portFromPos,b=0;b<g.length;b++)f=g[b],f.valid&&f.toVertex.layer!==t&&(x=f.toVertex.index,w=f.portToPos,k=f.portFromPos,(p<x||p===x&&y<w)&&a++,(x<p||x===p&&w<y)&&r++);s[o*n+h]=r,s[h*n+o]=a}}return this.vh(t,i),s}countCrossings(){let t=0;for(let e=0;e<=this.Mt;e++){const i=this.GT(e,1),n=this.di[e];for(let e=0;e<n;e++)for(let s=e;s<n;s++)t+=i[e*n+s]}return t}qO(t,e,i){const n=this.Rh(t),s=this.di[t];let o=0;for(let r=0;r<s;r++){let s=null;e<=0&&(s=n[r].yo);let a=null;e>=0&&(a=n[r].sr);let l,h=0,u=0;if(null!==s)for(let e=0;e<s.length;e++)l=s[e],l.valid&&l.fromVertex.layer!==t&&(h=l.fromVertex.column+l.portFromColOffset,u=l.toVertex.column+l.portToColOffset,o+=i?Math.abs(h-u)*this.linkStraightenWeight(l):Math.abs(h-u));if(null!==a)for(let e=0;e<a.length;e++)l=a[e],l.valid&&l.toVertex.layer!==t&&(h=l.fromVertex.column+l.portFromColOffset,u=l.toVertex.column+l.portToColOffset,o+=i?(Math.abs(h-u)+1)*this.linkStraightenWeight(l):Math.abs(h-u))}return this.vh(t,n),o}$1(t){let e=0;for(let i=0;i<=this.Mt;i++)e+=this.qO(i,1,t);return e}Ky(){let t=1/0;this.Kt=-1;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;t=Math.min(t,i.column-this.nodeMinColumnSpace(i,!0)),this.Kt=Math.max(this.Kt,i.column+this.nodeMinColumnSpace(i,!1))}for(e.reset();e.next();){e.value.column-=t}this.Kt-=t}Yy(t,e){const i=this.Rh(t),n=this.di[t],s=[];for(let o=0;o<n;o++){const n=i[o];let r=null;e<=0&&(r=n.yo);let a=null;e>=0&&(a=n.sr);let l=0,h=0;const u=n.near;let c;if(null!==u&&u.layer===n.layer&&(l+=u.column-1,h++),null!==r)for(let e=0;e<r.length;e++){c=r[e];const i=c.fromVertex;c.valid&&!c.rev&&i.layer!==t&&(l+=i.column,h++)}if(null!==a)for(let e=0;e<a.length;e++){c=a[e];const i=c.toVertex;c.valid&&!c.rev&&i.layer!==t&&(l+=i.column,h++)}s[o]=0===h?-1:l/h}return this.vh(t,i),s}HT(t,e){const i=this.Rh(t),n=this.di[t],s=[];for(let o=0;o<n;o++){const n=i[o];let r=null;e<=0&&(r=n.yo);let a=null;e>=0&&(a=n.sr);let l=0;const h=[],u=n.near;let c;if(null!==u&&u.layer===n.layer&&(h[l]=u.column-1,l++),null!==r)for(let e=0;e<r.length;e++){c=r[e];const i=c.fromVertex;c.valid&&!c.rev&&i.layer!==t&&(h[l]=i.column+c.portFromColOffset,l++)}if(null!==a)for(let e=0;e<a.length;e++){c=a[e];const i=c.toVertex;c.valid&&!c.rev&&i.layer!==t&&(h[l]=i.column+c.portToColOffset,l++)}if(0===l)s[o]=-1;else{h.sort(((t,e)=>t-e));const t=l>>1;s[o]=1&l?h[t]:h[t-1]+h[t]>>1}}return this.vh(t,i),s}Gy(t,e,i,n,s){if(t.component===i){t.component=e;let o=0,r=0;if(n){const a=t.destinationEdges;for(;a.next();){const l=a.value,h=l.toVertex;o=t.layer-h.layer,r=this.linkMinLength(l),o===r&&this.Gy(h,e,i,n,s)}}if(s){const a=t.sourceEdges;for(;a.next();){const l=a.value,h=l.fromVertex;o=h.layer-t.layer,r=this.linkMinLength(l),o===r&&this.Gy(h,e,i,n,s)}}}}vN(t,e,i,n,s){if(t.component===i){if(t.component=e,n){const o=t.destinationEdges;for(;o.next();){const t=o.value.toVertex;this.vN(t,e,i,n,s)}}if(s){const o=t.sourceEdges;for(;o.next();){const t=o.value.fromVertex;this.vN(t,e,i,n,s)}}}}removeCycles(){const t=this.network.edges.iterator;for(;t.next();){t.value.rev=!1}switch(this.Yf){default:case 1:this.WO();break;case 0:this.JO();break;case 2:this.$O()}}$O(){const t=this.network,e=t.vertexes.iterator;let i=1/0;for(;e.next();){const t=e.value;i=Math.min(i,t.layer)}if(i<1/0){if(i<0)for(e.reset();e.next();){e.value.layer-=i}const n=[];for(e.reset();e.next();){const t=e.value,i=n[t.layer];void 0===i?n[t.layer]=[t]:i.push(t)}let s=0;for(let t=0;t<n.length;t++){const e=n[t];if(e&&0!==e.length){if(t>0)for(let t=0;t<e.length;t++){e[t].layer-=s}}else s++}const o=t.edges.iterator;for(;o.next();){const e=o.value,i=e.fromVertex,n=e.toVertex;i.layer<n.layer&&(t.reverseEdge(e),e.rev=!0)}}}WO(){const t=this.network;let e=0,i=t.vertexes.count-1;const n=[];n.length=i+1;const s=t.vertexes.iterator;for(;s.next();){s.value.Zi=!0}for(;null!==this.ZO(t);){let s;for(s=this.jT(t);null!==s;)n[i]=s,i--,s.Zi=!1,s=this.jT(t);for(s=this.qT(t);null!==s;)n[e]=s,e++,s.Zi=!1,s=this.qT(t);s=this.QO(t),null!==s&&(n[e]=s,e++,s.Zi=!1)}for(let r=0;r<t.vertexes.count;r++)n[r].index=r;const o=t.edges.iterator;for(;o.next();){const e=o.value,i=e.fromVertex,n=e.toVertex;i.index>n.index&&(t.reverseEdge(e),e.rev=!0)}}ZO(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t.Zi)return t}return null}jT(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t.Zi){let e=!0;const i=t.destinationEdges;for(;i.next();)if(i.value.toVertex.Zi){e=!1;break}if(e)return t}}return null}qT(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t.Zi){let e=!0;const i=t.sourceEdges;for(;i.next();)if(i.value.fromVertex.Zi){e=!1;break}if(e)return t}}return null}QO(t){let e=null,i=0;const n=this.network.vertexes.iterator;for(;n.next();){const t=n.value;if(t.Zi){let n=0;const s=t.destinationEdges;for(;s.next();)s.value.toVertex.Zi&&n++;let o=0;const r=t.sourceEdges;for(;r.next();)r.value.fromVertex.Zi&&o++;(null===e||i<n-o)&&(e=t,i=n-o)}}return e}JO(){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;e.Jf=-1,e.jn=-1}const e=this.network.edges.iterator;for(;e.next();){e.value.forest=!1}for(this.Tg=0,t.reset();t.next();){const e=t.value;0===e.sourceEdges.count&&this.ON(e)}for(t.reset();t.next();){const e=t.value;-1===e.Jf&&this.ON(e)}for(e.reset();e.next();){const t=e.value;if(!t.forest){const e=t.fromVertex,i=e.Jf,n=e.jn,s=t.toVertex,o=s.Jf,r=s.jn;o<i&&n<r&&(this.network.reverseEdge(t),t.rev=!0)}}}ON(t){t.Jf=this.Tg,this.Tg++;const e=t.destinationEdges;for(;e.next();){const t=e.value,i=t.toVertex;-1===i.Jf&&(t.forest=!0,this.ON(i))}t.jn=this.Tg,this.Tg++}YO(){const t=this.network.vertexes.iterator;for(;t.next();){t.value.layer=-1}for(this.Mt=-1,this.assignLayers(),t.reset();t.next();){const e=t.value;this.Mt=Math.max(this.Mt,e.layer)}}assignLayers(){switch(this.Gf){case 11:this.WT();break;case 12:this._O();break;default:this.tI()}}WT(){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=this.JT(e);this.Mt=Math.max(i,this.Mt)}}JT(t){let e=0;if(-1===t.layer){const i=t.destinationEdges;for(;i.next();){const t=i.value,n=t.toVertex,s=this.linkMinLength(t);e=Math.max(e,this.JT(n)+s)}t.layer=e}else e=t.layer;return e}_O(){let t=0;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;t=this.$T(i),this.Mt=Math.max(t,this.Mt)}for(e.reset();e.next();){const t=e.value;t.layer=this.Mt-t.layer}}$T(t){let e=0;if(-1===t.layer){const i=t.sourceEdges;for(;i.next();){const t=i.value,n=t.fromVertex,s=this.linkMinLength(t);e=Math.max(e,this.$T(n)+s)}t.layer=e}else e=t.layer;return e}tI(){this.WT();const t=this.network.vertexes.iterator;for(;t.next();){t.value.Zi=!1}for(t.reset();t.next();){const e=t.value;0===e.sourceEdges.count&&this.ZT(e)}let e=1/0;for(t.reset();t.next();){const i=t.value;e=Math.min(e,i.layer)}for(this.Mt=-1,t.reset();t.next();){const i=t.value;i.layer-=e,this.Mt=Math.max(this.Mt,i.layer)}}ZT(t){if(!t.Zi){t.Zi=!0;const e=t.destinationEdges;for(;e.next();){const t=e.value.toVertex;this.ZT(t)}this.iI(t),this.eI(t)}}iI(t){const e=this.network.vertexes.iterator;for(;e.next();){e.value.component=-1}const i=t.yo;let n=i.length;for(let s=0;s<n;s++){const t=i[s],e=t.fromVertex,n=t.toVertex,o=this.linkMinLength(t);e.layer-n.layer>o&&this.Gy(e,0,-1,!0,!1)}for(this.Gy(t,1,-1,!0,!0);0!==t.component;){let i=0,s=1/0,o=0,r=null;const a=this.network.vertexes.iterator;for(;a.next();){const t=a.value;if(1===t.component){let e=0,a=!1;const l=t.yo;n=l.length;for(let o=0;o<n;o++){const n=l[o],r=n.fromVertex;if(e+=this.linkLengthWeight(n),1!==r.component){i+=this.linkLengthWeight(n);const e=r.layer-t.layer,o=this.linkMinLength(n);s=Math.min(s,e-o)}}const h=t.sr;n=h.length;for(let t=0;t<n;t++){const n=h[t],s=n.toVertex;e-=this.linkLengthWeight(n),1!==s.component?i-=this.linkLengthWeight(n):a=!0}(null===r||e<o)&&!a&&(r=t,o=e)}}if(i>0){for(e.reset();e.next();){const t=e.value;1===t.component&&(t.layer+=s)}t.component=0}else r.component=0}}eI(t){const e=this.network.vertexes.iterator;for(;e.next();){e.value.component=-1}for(this.Gy(t,1,-1,!0,!1);0!==t.component;){let i=0,n=1/0,s=0,o=null;const r=this.network.vertexes.iterator;for(;r.next();){const t=r.value;if(1===t.component){let e=0,r=!1;const a=t.yo;let l=a.length;for(let t=0;t<l;t++){const n=a[t],s=n.fromVertex;e+=this.linkLengthWeight(n),1!==s.component?i+=this.linkLengthWeight(n):r=!0}const h=t.sr;l=h.length;for(let s=0;s<l;s++){const o=h[s],r=o.toVertex;if(e-=this.linkLengthWeight(o),1!==r.component){i-=this.linkLengthWeight(o);const e=t.layer-r.layer,s=this.linkMinLength(o);n=Math.min(n,e-s)}}(null===o||e>s)&&!r&&(o=t,s=e)}}if(i<0){for(e.reset();e.next();){const t=e.value;1===t.component&&(t.layer-=n)}t.component=0}else o.component=0}}GO(){const t=this.network,e=[],i=t.edges.iterator;for(;i.next();){const t=i.value;t.valid=!1,e.push(t)}for(let n=0;n<e.length;n++){const i=e[n];let s=i.fromVertex;const o=i.toVertex;if(i.valid||(null===s.node&&null===s.data||null===o.node&&null===o.data)&&s.layer===o.layer)continue;let r=0,a=0,l=0,h=0;if(null!==i.link){const t=i.link;if(null===t)continue;const e=s.node,n=o.node;if(null===e||null===n)continue;let u=t.fromNode,c=t.toNode,d=t.fromPort;for(;null!==d&&!d.isVisibleObject();)d=d.panel;let f=t.toPort;for(;null!==f&&!f.isVisibleObject();)f=f.panel;if(i.rev){const t=u,e=d;u=c,d=f,c=t,f=e}const g=s.focus,m=o.focus,p=i.rev?o.bounds:s.bounds,y=T.l();e!==u?p.isReal()&&u.isVisible()?u.actualBounds.isReal()?(u.getRelativePoint(d,O.Center,y),y.x+=u.actualBounds.x-p.x,y.y+=u.actualBounds.y-p.y):(u.getRelativePoint(d,O.Center,y),y.isReal()||y.a(g)):y.a(g):p.isReal()?(u.getRelativePoint(d,O.Center,y),y.isReal()||y.a(g)):y.a(g);const v=i.rev?s.bounds:o.bounds,b=T.l();n!==c?v.isReal()&&c.isVisible()?c.actualBounds.isReal()?(c.getRelativePoint(f,O.Center,b),b.x+=c.actualBounds.x-v.x,b.y+=c.actualBounds.y-v.y):(c.getRelativePoint(f,O.Center,b),b.isReal()||b.a(m)):b.a(m):v.isReal()?(c.getRelativePoint(f,O.Center,b),b.isReal()||b.a(m)):b.a(m),90===this.S||270===this.S?(r=Math.round((y.x-g.x)/this.Ji),l=y.x,a=Math.round((b.x-m.x)/this.Ji),h=b.x):(r=Math.round((y.y-g.y)/this.Ji),l=y.y,a=Math.round((b.y-m.y)/this.Ji),h=b.y),T.s(y),T.s(b),i.portFromColOffset=r,i.portFromPos=l,i.portToColOffset=a,i.portToPos=h}else i.portFromColOffset=0,i.portFromPos=0,i.portToColOffset=0,i.portToPos=0;let u=s.layer;const c=o.layer,d=this.sI(i),f=1===d||3===d,g=2===d||3===d;let m,p,y,v=null;g&&(v=this.nI(s,o),y=1,p=t.createVertex(),p.node=null,p.Z1=1,p.layer=u,p.near=s,t.addVertex(p),m=t.linkVertexes(s,p,i.link),m.valid=!1,m.rev=i.rev,m.portFromColOffset=r,m.portToColOffset=0,m.portFromPos=l,m.portToPos=0,s=p);let b=1;if(f&&b--,u-c>b&&u>0){for(i.valid=!1,p=t.createVertex(),p.node=null,p.Z1=2,p.layer=u-1,v&&y<v.length&&p.layer===v[y].layer&&(p.near=v[y++]),t.addVertex(p),m=t.linkVertexes(s,p,i.link),m.valid=!0,m.rev=i.rev,m.portFromColOffset=g?0:r,m.portToColOffset=0,m.portFromPos=g?0:l,m.portToPos=0,s=p,u--;u-c>b&&u>0;)p=t.createVertex(),p.node=null,p.Z1=3,p.layer=u-1,v&&y<v.length&&p.layer===v[y].layer&&(p.near=v[y++]),t.addVertex(p),m=t.linkVertexes(s,p,i.link),m.valid=!0,m.rev=i.rev,m.portFromColOffset=0,m.portToColOffset=0,m.portFromPos=0,m.portToPos=0,s=p,u--;m=t.linkVertexes(p,o,i.link),m.valid=!f,f&&(p.near=o),m.rev=i.rev,m.portFromColOffset=0,m.portToColOffset=a,m.portFromPos=0,m.portToPos=h}else i.valid=!0}}sI(t){let e=0;const i=t.link;if(null!==i){const n=i.fromPort,s=i.toPort;if(null!==n&&null!==s){const o=i.fromNode,r=i.toNode;if(null!==o&&null!==r){const a=this.Q1(!0),l=this.Q1(!1),h=this.setsPortSpots?a:i.computeSpot(!0,n),u=this.setsPortSpots?l:i.computeSpot(!1,s),c=i.isOrthogonal;if(h.isSide()&&h.includesSide(l)&&u.isSide()&&u.includesSide(a))return 0;const d=i.getLinkPoint(o,n,h,!0,c,r,s,T.l()),f=i.getLinkDirection(o,n,d,h,!0,c,r,s);T.s(d),(!h.isNone()&&f===this.QT(t,!0)||this.setsPortSpots&&null!==o&&1===o.ports.count&&t.rev)&&(e+=1);const g=i.getLinkPoint(r,s,u,!1,c,o,n,T.l()),m=i.getLinkDirection(r,s,g,u,!1,c,o,n);T.s(g),(!u.isNone()&&m===this.QT(t,!1)||this.setsPortSpots&&null!==r&&1===r.ports.count&&t.rev)&&(e+=2)}}}return e}QT(t,e){return 90===this.S?e&&!t.rev||!e&&t.rev?270:90:180===this.S?e&&!t.rev||!e&&t.rev?0:180:270===this.S?e&&!t.rev||!e&&t.rev?90:270:e&&!t.rev||!e&&t.rev?180:0}nI(t,e){const i=[];return i.push(e),this._T(t,i)?i.reverse():[]}_T(t,e){const i=e[e.length-1].sourceEdges.iterator;for(;i.next();){const n=i.value;if(n.rev||!n.valid)continue;const s=n.fromVertex;if(e.push(s),s===t||this._T(t,e))return!0;e.pop()}return!1}HO(){const t=this.di=[];for(let i=0;i<=this.Mt;i++)t[i]=0;const e=this.network.vertexes.iterator;for(;e.next();){e.value.index=-1}this.initializeIndices(),this.Xy=-1,this.Ag=0,this.Cs=0;for(let i=0;i<=this.Mt;i++)t[i]>t[this.Cs]&&(this.Xy=t[i]-1,this.Cs=i),t[i]<t[this.Ag]&&(this.Ag=i);this.Wf=[];for(let i=0;i<t.length;i++)this.Wf[i]=[];for(e.reset();e.next();){const t=e.value,i=t.layer;this.Wf[i][t.index]=t}}initializeIndices(){switch(this.Hf){default:case 22:this.oI();break;case 20:this.rI();break;case 21:this.lI()}}oI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(e.reset();e.next();){const i=e.value;if(i.near)continue;const n=i.layer;if(i.index=this.di[n],this.di[n]++,!t)continue;const s=t.get(i);Array.isArray(s)&&s.forEach((t=>{t.index=this.di[n],this.di[n]++}))}}rI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(let i=this.Mt;i>=0;i--)for(e.reset();e.next();){const n=e.value;n.layer===i&&-1===n.index&&this.tD(n,t)}}tD(t,e){if(t.near)return;const i=t.layer;if(t.index=this.di[i],this.di[i]++,e){const n=e.get(t);Array.isArray(n)&&n.forEach((t=>{t.index=this.di[i],this.di[i]++}))}const n=t.sr;let s=!0;for(;s;){s=!1;for(let t=0;t<n.length-1;t++){const e=n[t],i=n[t+1];e.portFromColOffset>i.portFromColOffset&&(s=!0,n[t]=i,n[t+1]=e)}}for(let o=0;o<n.length;o++){const t=n[o];if(t.valid){const i=t.toVertex;-1===i.index&&this.tD(i,e)}}}lI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(let i=0;i<=this.Mt;i++)for(e.reset();e.next();){const n=e.value;n.layer===i&&-1===n.index&&this.iD(n,t)}}iD(t,e){if(t.near)return;const i=t.layer;if(t.index=this.di[i],this.di[i]++,e){const n=e.get(t);Array.isArray(n)&&n.forEach((t=>{t.index=this.di[i],this.di[i]++}))}const n=t.yo;let s,o,r=!0,a=0;for(;r;)for(r=!1,a=0;a<n.length-1;a++){const t=n[a],e=n[a+1];t.portToColOffset>e.portToColOffset&&(r=!0,n[a]=e,n[a+1]=t)}for(a=0;a<n.length;a++)o=n[a],o.valid&&(s=o.fromVertex,-1===s.index&&this.iD(s,e))}jO(){this.Kt=-1;for(let t=0;t<=this.Mt;t++){const e=this.Rh(t);let i=0;const n=this.di[t];for(let t=0;t<n;t++){const n=e[t];i+=this.nodeMinColumnSpace(n,!0),n.column=i,i+=1,i+=this.nodeMinColumnSpace(n,!1)}this.Kt=Math.max(this.Kt,i-1),this.vh(t,e)}}reduceCrossings(){let t=this.countCrossings(),e=this.$i(),i=0,n=0,s=0;for(i=0;i<this.Ja;i++){for(n=0;n<=this.Mt;n++)this._1(n,1),this.as(n,1,!1,1);for(s=this.countCrossings(),s<t&&(t=s,e=this.$i()),n=this.Mt;n>=0;n--)this._1(n,-1),this.as(n,-1,!1,-1);s=this.countCrossings(),s<t&&(t=s,e=this.$i())}for(this._e(e),i=0;i<this.Ja;i++){for(n=0;n<=this.Mt;n++)this._1(n,0),this.as(n,0,!1,0);for(s=this.countCrossings(),s<t&&(t=s,e=this.$i()),n=this.Mt;n>=0;n--)this._1(n,0),this.as(n,0,!1,0);s=this.countCrossings(),s<t&&(t=s,e=this.$i())}this._e(e);let o=!1,r=0,a=0,l=0,h=0;switch(this.jf){case 30:break;case 32:for(l=t+1;(h=this.countCrossings())<l;)for(l=h,r=this.Mt;r>=0;r--)for(a=0;a<=r;a++){for(o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,-1,!1,-1)||o;for(s=this.countCrossings(),s>=t?this._e(e):(t=s,e=this.$i()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,1,!1,1)||o;for(s=this.countCrossings(),s>=t?this._e(e):(t=s,e=this.$i()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,1,!1,1)||o;for(s>=t?this._e(e):(t=s,e=this.$i()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,-1,!1,-1)||o;for(s>=t?this._e(e):(t=s,e=this.$i()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,0,!1,0)||o;for(s>=t?this._e(e):(t=s,e=this.$i()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,0,!1,0)||o;s>=t?this._e(e):(t=s,e=this.$i())}break;default:for(r=this.Mt,a=0,l=t+1;(h=this.countCrossings())<l;){for(l=h,o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,-1,!1,-1)||o;for(s=this.countCrossings(),s>=t?this._e(e):(t=s,e=this.$i()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,1,!1,1)||o;for(s=this.countCrossings(),s>=t?this._e(e):(t=s,e=this.$i()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,1,!1,1)||o;for(s>=t?this._e(e):(t=s,e=this.$i()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,-1,!1,-1)||o;for(s>=t?this._e(e):(t=s,e=this.$i()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,0,!1,0)||o;for(s>=t?this._e(e):(t=s,e=this.$i()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,0,!1,0)||o;s>=t?this._e(e):(t=s,e=this.$i())}}this._e(e)}_1(t,e){let i=0,n=!1;const s=this.Rh(t),o=this.di[t],r=this.HT(t,e),a=this.Yy(t,e);for(i=0;i<o;i++)-1===a[i]&&(a[i]=s[i].column),-1===r[i]&&(r[i]=s[i].column);let l,h=!0;for(;h;)for(h=!1,i=0;i<o-1;i++)if(r[i+1]<r[i]||r[i+1]===r[i]&&a[i+1]<a[i]){n=!0,h=!0;const t=r[i];r[i]=r[i+1],r[i+1]=t;const e=a[i];a[i]=a[i+1],a[i+1]=e,l=s[i],s[i]=s[i+1],s[i+1]=l}let u=0;for(i=0;i<o;i++)l=s[i],l.index=i,u+=this.nodeMinColumnSpace(l,!0),l.column=u,u+=1,u+=this.nodeMinColumnSpace(l,!1);return this.vh(t,s),n}as(t,e,i,n){const s=this.Rh(t),o=this.di[t],r=this.GT(t,e);let a,l,h=0;if(!i||n>0)for(a=[],h=0;h<o;h++)a[h]=-1;else a=this.Yy(t,-1);if(!i||n<0)for(l=[],h=0;h<o;h++)l[h]=-1;else l=this.Yy(t,1);let u=!1,c=!0;for(;c;)for(c=!1,h=0;h<o-1;h++){const e=r[s[h].index*o+s[h+1].index],d=r[s[h+1].index*o+s[h].index];let f=0,g=0;const m=s[h].column,p=s[h+1].column,y=this.nodeMinColumnSpace(s[h],!0),v=this.nodeMinColumnSpace(s[h],!1),b=m-y+this.nodeMinColumnSpace(s[h+1],!0),x=p-v+this.nodeMinColumnSpace(s[h+1],!1);let w,k,S=0,P=0,M=0,C=0,N=0,L=0,T=0,A=0,D=0;const F=s[h].sourceEdges.iterator;if(i&&n<=0)for(;F.next();){const e=F.value;w=e.fromVertex,e.valid&&w.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,L=w.column,S+=(Math.abs(m+N-(L+C))+1)*M,P+=(Math.abs(x+N-(L+C))+1)*M)}for(F.reset();F.next();){const e=F.value;if(w=e.fromVertex,e.valid&&w.layer===t){for(A=0;A<s.length&&s[A]!==w;)A++;A<h&&(f+=2*(h-A),g+=2*(h+1-A)),A===h+1&&(f+=1),A>h+1&&(f+=4*(A-h),g+=4*(A-(h+1)))}}const O=s[h].destinationEdges.iterator;if(i&&n>=0)for(;O.next();){const e=O.value;k=e.toVertex,e.valid&&k.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,T=k.column,S+=(Math.abs(m+C-(T+N))+1)*M,P+=(Math.abs(x+C-(T+N))+1)*M)}for(O.reset();O.next();){const e=O.value;if(k=e.toVertex,e.valid&&k.layer===t){for(D=0;D<s.length&&s[D]!==k;)D++;D===h+1&&(g+=1)}}const R=s[h+1].sourceEdges.iterator;if(i&&n<=0)for(;R.next();){const e=R.value;w=e.fromVertex,e.valid&&w.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,L=w.column,S+=(Math.abs(p+N-(L+C))+1)*M,P+=(Math.abs(b+N-(L+C))+1)*M)}for(R.reset();R.next();){const e=R.value;if(w=e.fromVertex,e.valid&&w.layer===t){for(A=0;A<s.length&&s[A]!==w;)A++;A<h&&(f+=2*(h+1-A),g+=2*(h-A)),A===h&&(g+=1),A>h+1&&(f+=4*(A-(h+1)),g+=4*(A-h))}}const E=s[h+1].destinationEdges.iterator;if(i&&n>=0)for(;E.next();){const e=E.value;k=e.toVertex,e.valid&&k.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,T=k.column,S+=(Math.abs(p+C-(T+N))+1)*M,P+=(Math.abs(b+C-(T+N))+1)*M)}for(E.reset();E.next();){const e=E.value;if(k=e.toVertex,e.valid&&k.layer===t){for(D=0;D<s.length&&s[D]!==k;)D++;D===h&&(f+=1)}}let B=0,I=0;const V=a[s[h].index],z=l[s[h].index],j=a[s[h+1].index],U=l[s[h+1].index];if(-1!==V&&(B+=Math.abs(V-m),I+=Math.abs(V-x)),-1!==z&&(B+=Math.abs(z-m),I+=Math.abs(z-x)),-1!==j&&(B+=Math.abs(j-p),I+=Math.abs(j-b)),-1!==U&&(B+=Math.abs(U-p),I+=Math.abs(U-b)),g<f-.5||g===f&&d<e-.5||g===f&&d===e&&P<S-.5||g===f&&d===e&&P===S&&I<B-.5){u=!0,c=!0,s[h].column=x,s[h+1].column=b;const t=s[h];s[h]=s[h+1],s[h+1]=t}}for(h=0;h<o;h++)s[h].index=h;return this.vh(t,s),u}straightenAndPack(){if(0!==this.In)return void this.hI();let t=0,e=!1,i=0!==(1&this.rr);const n=0!==(8&this.rr);if(this.network.edges.count>1e3&&n&&(i=!1),i){const e=[];let i=0;for(i=0;i<=this.Mt;i++)e[i]=0;let n=0;const s=this.network.vertexes.iterator;for(;s.next();){const i=s.value;t=i.layer,n=i.column;const o=this.nodeMinColumnSpace(i,!1);e[t]=Math.max(e[t],n+o)}const o=8;for(s.reset();s.next();){const i=s.value;t=i.layer,n=i.column,i.column=((this.Kt-e[t])*o>>1)+n*o}this.Kt*=o}if(2&this.rr){e=!0;let i=0;for(;e&&i<this.qf;){for(e=!1,t=this.Cs+1;t<=this.Mt;t++)e=this.Fg(t,1)||e;for(t=this.Cs-1;t>=0;t--)e=this.Fg(t,-1)||e;e=this.Fg(this.Cs,0)||e,i++}}if(4&this.rr){for(t=this.Cs+1;t<=this.Mt;t++)this.IN(t,1);for(t=this.Cs-1;t>=0;t--)this.IN(t,-1);this.IN(this.Cs,0)}if(i&&(this.eD(-1),this.eD(1)),2&this.rr){e=!0;let i=0;for(;e&&i<this.qf;){for(e=!1,e=this.Fg(this.Cs,0)||e,t=this.Cs+1;t<=this.Mt;t++)e=this.Fg(t,0)||e;for(t=this.Cs-1;t>=0;t--)e=this.Fg(t,0)||e;i++}}}Fg(t,e){let i=!1;for(;this.aI(t,e);)i=!0;return i}aI(t,e){let i=0;const n=this.Rh(t),s=this.di[t],o=this.Yy(t,-1);if(e>0)for(i=0;i<s;i++)o[i]=-1;const r=this.Yy(t,1);if(e<0)for(i=0;i<s;i++)r[i]=-1;let a=!1,l=!0;for(;l;)for(l=!1,i=0;i<s;i++){const h=n[i].column,u=this.nodeMinColumnSpace(n[i],!0),c=this.nodeMinColumnSpace(n[i],!1);let d=0;d=i-1<0||h-n[i-1].column-1>u+this.nodeMinColumnSpace(n[i-1],!1)?h-1:h;let f=0;f=i+1>=s||n[i+1].column-h-1>c+this.nodeMinColumnSpace(n[i+1],!0)?h+1:h;let g=0,m=0,p=0,y=0,v=0,b=0;if(e<=0){const e=n[i].sourceEdges.iterator;for(;e.next();){const i=e.value,n=i.fromVertex;if(i.valid&&n.layer!==t){y=this.linkStraightenWeight(i),v=i.portFromColOffset,b=i.portToColOffset;const t=n.column;g+=(Math.abs(h+b-(t+v))+1)*y,m+=(Math.abs(d+b-(t+v))+1)*y,p+=(Math.abs(f+b-(t+v))+1)*y}}}if(e>=0){const e=n[i].destinationEdges.iterator;for(;e.next();){const i=e.value,n=i.toVertex;if(i.valid&&n.layer!==t){y=this.linkStraightenWeight(i),v=i.portFromColOffset,b=i.portToColOffset;const t=n.column;g+=(Math.abs(h+v-(t+b))+1)*y,m+=(Math.abs(d+v-(t+b))+1)*y,p+=(Math.abs(f+v-(t+b))+1)*y}}}let x=0,w=0,k=0;const S=o[n[i].index],P=r[n[i].index];-1!==S&&(x+=Math.abs(S-h),w+=Math.abs(S-d),k+=Math.abs(S-f)),-1!==P&&(x+=Math.abs(P-h),w+=Math.abs(P-d),k+=Math.abs(P-f)),m<g||m===g&&w<x?(a=!0,l=!0,n[i].column=d):(p<g||p===g&&k<x)&&(a=!0,l=!0,n[i].column=f)}return this.vh(t,n),this.Ky(),a}IN(t,e){let i=0;const n=this.Rh(t),s=this.di[t],o=this.HT(t,e),r=[];for(i=0;i<s;i++)r[i]=o[i];let a=!1,l=!0;for(;l;)for(l=!1,i=0;i<s;i++){const t=n[i].column,e=this.nodeMinColumnSpace(n[i],!0),o=this.nodeMinColumnSpace(n[i],!1);let h=0,u=0,c=0,d=0,f=0;-1===r[i]?0===i&&i===s-1?h=t:0===i?(u=n[i+1].column,h=u-t===o+this.nodeMinColumnSpace(n[i+1],!0)?t-1:t):i===s-1?(c=n[i-1].column,h=t-c===e+this.nodeMinColumnSpace(n[i-1],!1)?t+1:t):(c=n[i-1].column,f=c+this.nodeMinColumnSpace(n[i-1],!1)+e+1,u=n[i+1].column,d=u-this.nodeMinColumnSpace(n[i+1],!0)-o-1,h=(f+d)/2|0):0===i&&i===s-1?h=r[i]:0===i?(u=n[i+1].column,d=u-this.nodeMinColumnSpace(n[i+1],!0)-o-1,h=Math.min(r[i],d)):i===s-1?(c=n[i-1].column,f=c+this.nodeMinColumnSpace(n[i-1],!1)+e+1,h=Math.max(r[i],f)):(c=n[i-1].column,f=c+this.nodeMinColumnSpace(n[i-1],!1)+e+1,u=n[i+1].column,d=u-this.nodeMinColumnSpace(n[i+1],!0)-o-1,f<r[i]&&r[i]<d?h=r[i]:f>=r[i]?h=f:d<=r[i]&&(h=d)),h!==t&&(a=!0,l=!0,n[i].column=h)}return this.vh(t,n),this.Ky(),a}cI(){for(let t=0;t<=this.Kt;t++)for(;this.fI(t,1););this.Ky()}fI(t,e){let i=!0;const n=this.network.vertexes.iterator;for(;n.next();){const e=n.value,s=this.nodeMinColumnSpace(e,!0),o=this.nodeMinColumnSpace(e,!1);if(e.column-s<=t&&e.column+o>=t){i=!1;break}}let s=!1;if(i){if(e>0)for(n.reset();n.next();){const e=n.value;e.column>t&&(e.column-=1,s=!0)}if(e<0)for(n.reset();n.next();){const e=n.value;e.column<t&&(e.column+=1,s=!0)}}return s}uI(){this.cI();for(let t=0;t<this.Kt;t++)for(;this.dI(t,1););this.Ky()}dI(t,e){let i=t;e>0&&(i=t+1),e<0&&(i=t-1);let n=0;const s=[],o=[];for(n=0;n<=this.Mt;n++)s[n]=!1,o[n]=!1;const r=this.network.vertexes.iterator;for(;r.next();){const e=r.value,n=e.column-this.nodeMinColumnSpace(e,!0),a=e.column+this.nodeMinColumnSpace(e,!1);n<=t&&a>=t&&(s[e.layer]=!0),n<=i&&a>=i&&(o[e.layer]=!0)}let a=!0,l=!1;for(n=0;n<=this.Mt;n++)a=a&&!(s[n]&&o[n]);if(a){if(e>0)for(r.reset();r.next();){const e=r.value;e.column>t&&(e.column-=1,l=!0)}if(e<0)for(r.reset();r.next();){const e=r.value;e.column<t&&(e.column+=1,l=!0)}}return l}eD(t){this.uI();let e,i=0,n=0,s=0,o=0;if(t>0)for(i=0;i<=this.Kt;i++)for(e=this.$i(),n=this.$1(!0),s=n+1;n<s;)s=n,this.sD(i,1),o=this.$1(!0),o>n?this._e(e):o<n&&(n=o,e=this.$i());if(t<0)for(i=this.Kt;i>=0;i--)for(e=this.$i(),n=this.$1(!0),s=n+1;n<s;)s=n,this.sD(i,-1),o=this.$1(!0),o>n?this._e(e):o<n&&(n=o,e=this.$i());this.Ky()}sD(t,e){this.tn=0;const i=this.network.vertexes.iterator;for(;i.next();){i.value.component=-1}if(e>0)for(i.reset();i.next();){const e=i.value;e.column-this.nodeMinColumnSpace(e,!0)<=t&&(e.component=this.tn)}if(e<0)for(i.reset();i.next();){const e=i.value;e.column+this.nodeMinColumnSpace(e,!1)>=t&&(e.component=this.tn)}for(this.tn++,i.reset();i.next();){const t=i.value;-1===t.component&&(this.vN(t,this.tn,-1,!0,!0),this.tn++)}let n=0;const s=[];for(n=0;n<this.tn*this.tn;n++)s[n]=!1;const o=[];for(n=0;n<(this.Mt+1)*(this.Kt+1);n++)o[n]=-1;for(i.reset();i.next();){const t=i.value,e=t.layer,n=Math.max(0,t.column-this.nodeMinColumnSpace(t,!0)),s=Math.min(this.Kt,t.column+this.nodeMinColumnSpace(t,!1));for(let i=n;i<=s;i++)o[e*(this.Kt+1)+i]=t.component}for(let u=0;u<=this.Mt;u++){if(e>0)for(let t=0;t<this.Kt;t++)-1!==o[u*(this.Kt+1)+t]&&-1!==o[u*(this.Kt+1)+t+1]&&o[u*(this.Kt+1)+t]!==o[u*(this.Kt+1)+t+1]&&(s[o[u*(this.Kt+1)+t]*this.tn+o[u*(this.Kt+1)+t+1]]=!0);if(e<0)for(let t=this.Kt;t>0;t--)-1!==o[u*(this.Kt+1)+t]&&-1!==o[u*(this.Kt+1)+t-1]&&o[u*(this.Kt+1)+t]!==o[u*(this.Kt+1)+t-1]&&(s[o[u*(this.Kt+1)+t]*this.tn+o[u*(this.Kt+1)+t-1]]=!0)}const r=[];for(n=0;n<this.tn;n++)r[n]=!0;const a=[];a.push(0);let l=0;for(;0!==a.length;)if(l=a[a.length-1],a.pop(),r[l])for(r[l]=!1,n=0;n<this.tn;n++)s[l*this.tn+n]&&a.splice(0,0,n);let h=!1;if(e>0)for(i.reset();i.next();){const t=i.value;r[t.component]&&(t.column-=1,h=!0)}if(e<0)for(i.reset();i.next();){const t=i.value;r[t.component]&&(t.column+=1,h=!0)}return h}hI(){const t=d.rt(),e=this.Wf.length;for(let d=0;d<=e;d++)t[d]=[];const i=this.network.vertexes.iterator;for(;i.next();){const n=i.value;t[e-n.layer][n.index]=n}const n=new k;this.gI(t,n);let s=null,o=null,r=null,a=null;const l=0!==(1&this.In),h=0!==(2&this.In),u=0!==(4&this.In),c=0!==(8&this.In);l&&(this.rl(t,n,!0),s=this.tk(t,!0,!1)),t.reverse(),u&&(this.rl(t,n,!1),r=this.tk(t,!1,!1));for(const d of t)d.reverse();c&&(this.rl(t,n,!1),a=this.tk(t,!1,!0)),t.reverse(),h&&(this.rl(t,n,!0),o=this.tk(t,!0,!0)),d.it(t),this.mI(s,o,r,a),this.network.vertexes.each((t=>{const e=t,i=d.rt();l&&i.push(s.get(e)),h&&i.push(o.get(e)),u&&i.push(r.get(e)),c&&i.push(a.get(e)),i.sort(((t,e)=>t-e));const n=i.length,f=Math.floor((n-1)/2),g=Math.ceil((n-1)/2),m=(i[f]+i[g])/2;d.it(i),e.fe=m}))}gI(t,e){const i=t.length;for(let n=1;n<i-1;n++){let i=0,s=0;const o=t[n],r=t[n+1];for(let t=0;s<r.length;t++){const n=r[t],a=this.pI(n);if(t===r.length-1||a){let l=o.length-1;for(a&&(l=n.getProperSourceVertexes()[0].index);s<=t;){const t=r[s].getProperSourceEdges();for(const n of t){const t=n.fromVertex.index;(t<i||t>l)&&e.add(n)}s++}i=l}}}}pI(t){if(null===t.node){const e=t.getProperSourceVertexes();if(e.length>0)return null===e[0].node}return!1}rl(t,e,i){this.yI(t);for(const n of t){let t=-1;for(const s of n){const n=i?s.getProperSourceVertexes():s.getProperDestinationVertexes(),o=n.length;if(o>0){n.sort(((t,e)=>t.Oh-e.Oh));const r=(o-1)/2;for(let o=Math.floor(r),a=Math.ceil(r);o<=a;o++)if(s.En===s){const r=n[o];let a;a=i?r.getDestinationEdge(s):s.getDestinationEdge(r),!e.contains(a)&&t<r.Oh&&(r.En=s,s.Za=r.Za,s.En=r.Za,t=r.Oh)}}}}}yI(t){for(let e=0;e<t.length;e++){const i=t[e];for(let t=0;t<i.length;t++){const n=i[t];n.Za=n,n.En=n,n.nD=e,n.Oh=t}}}tk(t,e,i){const n=90===this.S||270===this.S;for(const o of t)for(const t of o)t.ts=t,t.$f=1/0,t.fe=NaN,t.Vn=0;this.wI(t,e,i);for(const o of t)for(const e of o)e.Za===e&&this.oD(e,t);for(let o=0;o<t.length;o++){if(t[o].length<=0)continue;const e=t[o][0];if(e.ts===e){e.ts.$f===1/0&&(e.ts.$f=0);let i,s=o,r=0;do{for(i=t[s][r];i.En!==i.Za;)if(i=i.En,s++,i.Oh>0){const e=this.rD(i,t),s=n?e.width:e.height,o=i.ts.$f+i.fe+i.Vn-(e.fe+e.Vn+s+this.columnSpacing);e.ts.$f=Math.min(e.ts.$f,o)}r=i.Oh+1}while(s<t.length&&r<t[s].length&&i.ts===t[s][r].ts)}}const s=new L;for(const o of t)for(const t of o){t.fe=t.fe+t.ts.$f+t.Vn;const e=n?t.width:t.height;s.add(t,i?-t.fe-e:t.fe)}return s}wI(t,e,i){const n=90===this.S||270===this.S;for(const s of t)for(const t of s)if(t.Za===t){let s=0,o=t;for(;o.En!==t;){const t=o.En,r=n?o.width:o.height,a=n?t.width:t.height;let l,h,u,c;e?(u=o.getDestinationEdge(t),l=u.portFromPos,h=u.portToPos,null!==u.link&&(o.node&&o.node!==u.link.fromNode&&(l=n?o.focusX:o.focusY),t.node&&t.node!==u.link.toNode&&(h=n?t.focusX:t.focusY)),c=i?o.Vn+(r-l)-(a-h):o.Vn+l-h):(u=t.getDestinationEdge(o),l=u.portToPos,h=u.portFromPos,null!==u.link&&(o.node&&o.node!==u.link.toNode&&(l=n?o.focusX:o.focusY),t.node&&t.node!==u.link.fromNode&&(h=n?t.focusX:t.focusY)),c=i?o.Vn+(r-l)-(a-h):o.Vn+l-h),t.Vn=c,s=Math.min(s,c),o=o.En}o=t;do{o.Vn=o.Vn-s,o=o.En}while(o!==t)}}oD(t,e){if(!isNaN(t.fe))return;t.fe=0;let i=t;do{if(i.Oh>0){const n=this.rD(i,e),s=n.Za;this.oD(s,e),t.ts===t&&(t.ts=s.ts);const o=90===this.S||270===this.S?n.width:n.height;if(t.ts===s.ts){const e=s.fe+n.Vn+o-i.Vn+this.columnSpacing;t.fe=Math.max(t.fe,e)}}i=i.En}while(i!==t);for(;i.En!==t;)i=i.En,i.fe=t.fe,i.ts=t.ts}rD(t,e){const i=t.nD,n=t.Oh;return n<1&&d.o("Could not determine previous vertex in layer"),e[i][n-1]}mI(){let t=-1;const e=d.rt(),i=d.rt();let n=1/0;for(let s=0;s<4;s++){if(!(s<0||arguments.length<=s?void 0:arguments[s]))continue;const o=this.xI(s<0||arguments.length<=s?void 0:arguments[s],e,i,s);o<n&&(t=s,n=o)}for(let s=0;s<4;s++){const n=s<0||arguments.length<=s?void 0:arguments[s];if(!n)continue;const o=0===s||2===s?e[t]-e[s]:i[t]-i[s];0!==o&&n.each((t=>{n.set(t.key,t.value+o)}))}d.it(e),d.it(i)}xI(t,e,i,n){if(!t||0===t.count)return e[n]=0,i[n]=0,1/0;let s=1/0,o=-1/0;return t.each((t=>{const e=t.key,i=t.value,n=90===this.S||270===this.S?e.width:e.height;i<s&&(s=i),i+n>o&&(o=i+n)})),e[n]=s,i[n]=o,o-s}commitLayout(){this.zy(),this.commitNodes(),this.EN(),this.isRouting&&this.commitLinks()}zy(){if(!this.setsPortSpots)return;const t=this.Q1(!0),e=this.Q1(!1),i=this.network.edges.iterator;for(;i.next();){const n=i.value.link;null!==n&&(n.fromSpot=t,n.toSpot=e)}}Q1(t){return 270===this.S?t?O.MiddleTop:O.MiddleBottom:90===this.S?t?O.MiddleBottom:O.MiddleTop:180===this.S?t?O.MiddleLeft:O.MiddleRight:t?O.MiddleRight:O.MiddleLeft}commitNodes(){this._s=[],this.Ls=[],this.As=[],this.Ut=[];for(let f=0;f<=this.Mt;f++)this._s[f]=0,this.Ls[f]=0,this.As[f]=0,this.Ut[f]=0;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=e.layer;this._s[i]=Math.max(this._s[i],this.nodeMinLayerSpace(e,!0)),this.Ls[i]=Math.max(this.Ls[i],this.nodeMinLayerSpace(e,!1))}let e=0;const i=this.Ns;for(let f=0;f<=this.Mt;f++){let t=i;this._s[f]+this.Ls[f]<=0&&(t=0),f>0&&(e+=t/2),90===this.S||0===this.S?(e+=this.Ls[f],this.As[f]=e,e+=this._s[f]):(e+=this._s[f],this.As[f]=e,e+=this.Ls[f]),f<this.Mt&&(e+=t/2),this.Ut[f]=e}const n=e,s=this.arrangementOrigin;for(let f=0;f<=this.Mt;f++)270===this.S?this.As[f]=s.y+this.As[f]:90===this.S?(this.As[f]=s.y+n-this.As[f],this.Ut[f]=n-this.Ut[f]):180===this.S?this.As[f]=s.x+this.As[f]:(this.As[f]=s.x+n-this.As[f],this.Ut[f]=n-this.Ut[f]);const o=0!==this.In;t.reset();const r=270===this.S||90===this.S;let a=1/0,l=1/0,h=1/0,u=-1/0;for(;t.next();){const e=t.value,i=e.layer,n=0|e.column;let c=0,d=0;r?(c=s.x+this.Ji*n,d=this.As[i]):(c=this.As[i],d=s.y+this.Ji*n),e.centerX=c,e.centerY=d,o&&isFinite(e.fe)&&(r?e.node?e.x=s.x+e.fe:e.centerX=s.x+e.fe:e.node?e.y=s.y+e.fe:e.centerY=s.y+e.fe),a=Math.min(e.x,a),l=Math.min(e.y,l),r?(h=a,u=Math.max(u,e.bounds.right)):(h=l,u=Math.max(u,e.bounds.bottom))}this.RN=u-h;const c=s.x-a,d=s.y-l;for(this.lr=new T(o&&r?0:c,o&&!r?0:d),t.reset();t.next();){const e=t.value;e.x+=c,e.y+=d,e.commit()}}EN(){let t=0;const e=this.Ns;for(let s=0;s<=this.Mt;s++)t+=this._s[s],t+=this.Ls[s];t+=this.Mt*e;const i=[],n=0!==this.In?this.RN:this.Ji*this.Kt;for(let s=this.maxLayer;s>=0;s--)270===this.S?0===s?i.push(new D(0,0,n,Math.abs(this.Ut[0]))):i.push(new D(0,this.Ut[s-1],n,Math.abs(this.Ut[s-1]-this.Ut[s]))):90===this.S?0===s?i.push(new D(0,this.Ut[0],n,Math.abs(this.Ut[0]-t))):i.push(new D(0,this.Ut[s],n,Math.abs(this.Ut[s-1]-this.Ut[s]))):180===this.S?0===s?i.push(new D(0,0,Math.abs(this.Ut[0]),n)):i.push(new D(this.Ut[s-1],0,Math.abs(this.Ut[s-1]-this.Ut[s]),n)):0===s?i.push(new D(this.Ut[0],0,Math.abs(this.Ut[0]-t),n)):i.push(new D(this.Ut[s],0,Math.abs(this.Ut[s-1]-this.Ut[s]),n));this.commitLayers(i,this.lr)}commitLayers(t,e){}commitLinks(){const t=this.network.edges.iterator;let e;for(;t.next();)e=t.value.link,null!==e&&(e.startRoute(),e.clearPoints(),e.commitRoute());for(t.reset();t.next();)e=t.value.link,null!==e&&e.updateRoute();for(t.reset();t.next();){const i=t.value;if(e=i.link,null===e||0===e.pointsCount)continue;e.startRoute();const n=e;let s=n.fromNode,o=n.toNode,r=n.fromPort,a=n.toPort;if(null!==s){const t=s.findVisibleNode();null!==t&&t!==s&&(s=t,r=t.port)}if(null!==o){const t=o.findVisibleNode();null!==t&&t!==o&&(o=t,a=t.port)}const l=e.computeSpot(!0,r),h=e.computeSpot(!1,a);let u=i.fromVertex,c=i.toVertex;if(i.valid){if(9===e.curve&&4===e.pointsCount)if(u.column===c.column&&0===this.alignOption){const t=e.getLinkPoint(s,r,l,!0,!1,o,a),i=e.getLinkPoint(o,a,h,!1,!1,s,r);t.isReal()||t.set(s.actualBounds.center),i.isReal()||i.set(o.actualBounds.center),e.clearPoints(),e.addPointAt(t.x,t.y),e.addPointAt((2*t.x+i.x)/3,(2*t.y+i.y)/3),e.addPointAt((t.x+2*i.x)/3,(t.y+2*i.y)/3),e.addPointAt(i.x,i.y)}else{let t=!1,i=!1;if(null!==r&&l===O.None&&(t=!0),null!==a&&h===O.None&&(i=!0),t||i){let n=null;t&&(n=e.getLinkPointFromPoint(s,r,r.getDocumentPoint(O.Center),e.getPoint(3),!0),n.isReal()||n.set(s.actualBounds.center),e.setPointAt(0,n.x,n.y));let l=null;if(i&&(l=e.getLinkPointFromPoint(o,a,a.getDocumentPoint(O.Center),e.getPoint(0),!1),l.isReal()||l.set(o.actualBounds.center),e.setPointAt(3,l.x,l.y)),n){const t=e.getPoint(2);e.setPointAt(1,(2*n.x+t.x)/3,(2*n.y+t.y)/3)}if(l){const t=e.getPoint(1);e.setPointAt(2,(2*l.x+t.x)/3,(2*l.y+t.y)/3)}}}e.commitRoute();continue}if(u.layer===c.layer){e.commitRoute();continue}let d=!1,f=!1;const g=this.Ns;let m=0,p=e.firstPickIndex+1;if(e.isOrthogonal)f=!0,m=e.pointsCount,m>4&&e.points.removeRange(2,m-3);else if(9===e.curve)d=!0,m=e.pointsCount,m>4&&e.points.removeRange(2,m-3),4===m&&(p=2);else{m=e.pointsCount;const t=l===O.None,i=h===O.None;m>2&&t&&i?e.points.removeRange(1,m-2):m>3&&t&&!i?e.points.removeRange(1,m-3):m>3&&!t&&i?e.points.removeRange(2,m-2):m>4&&!t&&!i&&e.points.removeRange(2,m-3)}let y,v,b=0,x=0,w=0,k=0,S=0,P=0,M=0;if(i.rev){let t=0;for(;null!==c&&u!==c;){y=null,v=null;const n=c.sourceEdges.iterator;for(;n.next();){const t=n.value;if(t.link===i.link&&(y=t.fromVertex,v=t.toVertex,null===y.node))break}if(null===y)break;if(y!==u)if(b=e.getPoint(p-1).x,x=e.getPoint(p-1).y,w=y.centerX,k=y.centerY,f)180===this.S||0===this.S?p===e.firstPickIndex+1?(e.insertPointAt(p++,b,x),e.insertPointAt(p++,b,k)):(null!==v?v.centerY:x)!==k&&(S=this.Ut[y.layer-1]+this.lr.x,e.insertPointAt(p++,S,x),e.insertPointAt(p++,S,k)):p===e.firstPickIndex+1?(e.insertPointAt(p++,b,x),e.insertPointAt(p++,w,x)):(null!==v?v.centerX:b)!==w&&(S=this.Ut[y.layer-1]+this.lr.y,e.insertPointAt(p++,b,S),e.insertPointAt(p++,w,S));else if(p===e.firstPickIndex+1)if(P=Math.max(10,this._s[c.layer]),M=Math.max(10,this.Ls[c.layer]),d)180===this.S?w<=c.bounds.x?(t=c.bounds.x,e.insertPointAt(p++,t-P,k),e.insertPointAt(p++,t,k),e.insertPointAt(p++,t+M,k)):(e.insertPointAt(p++,w-P,k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w+M,k)):90===this.S?k>=c.bounds.bottom?(t=c.bounds.y+c.bounds.height,e.insertPointAt(p++,w,t+M),e.insertPointAt(p++,w,t),e.insertPointAt(p++,w,t-P)):(e.insertPointAt(p++,w,k+M),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,k-P)):270===this.S?k<=c.bounds.y?(t=c.bounds.y,e.insertPointAt(p++,w,t-P),e.insertPointAt(p++,w,t),e.insertPointAt(p++,w,t+M)):(e.insertPointAt(p++,w,k-P),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,k+M)):0===this.S&&(w>=c.bounds.right?(t=c.bounds.x+c.bounds.width,e.insertPointAt(p++,t+M,k),e.insertPointAt(p++,t,k),e.insertPointAt(p++,t-P,k)):(e.insertPointAt(p++,w+M,k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w-P,k)));else{e.insertPointAt(p++,b,x);let t=0;180===this.S||0===this.S?((180===this.S?w>=c.bounds.right:w<=c.bounds.x)&&(t=(0===this.S?-P:M)/2),e.insertPointAt(p++,b+t,k)):((270===this.S?k>=c.bounds.bottom:k<=c.bounds.y)&&(t=(90===this.S?-P:M)/2),e.insertPointAt(p++,w,x+t)),e.insertPointAt(p++,w,k)}else P=Math.max(10,this._s[y.layer]),M=Math.max(10,this.Ls[y.layer]),d?180===this.S?(e.insertPointAt(p++,w-P-g,k),e.insertPointAt(p++,Math.min(w-P+g/2,w),k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,Math.max(w+M-g/2,w),k),e.insertPointAt(p++,w+M+g,k)):90===this.S?(e.insertPointAt(p++,w,k+M+g),e.insertPointAt(p++,w,Math.max(k+M-g/2,k)),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,Math.min(k-P+g/2,k)),e.insertPointAt(p++,w,k-P-g)):270===this.S?(e.insertPointAt(p++,w,k-P-g),e.insertPointAt(p++,w,Math.min(k-P+g/2,k)),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,Math.max(k+M-g/2,k)),e.insertPointAt(p++,w,k+M+g)):(e.insertPointAt(p++,w+M+g,k),e.insertPointAt(p++,Math.max(w+M-g/2,w),k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,Math.min(w-P+g/2,w),k),e.insertPointAt(p++,w-P-g,k)):(180===this.S||90===this.S||this.S,e.insertPointAt(p++,w,k));c=y}if(null===a||l!==O.None||f)if(b=e.getPoint(p-1).x,x=e.getPoint(p-1).y,w=e.getPoint(p).x,k=e.getPoint(p).y,f){const i=this.Ls[u.layer];let n=0;180===this.S||0===this.S?(n=x,n>=u.bounds.y&&n<=u.bounds.bottom&&(180===this.S?w>=u.bounds.x:w<=u.bounds.right)&&(t=u.centerX+(180===this.S?-i:i),n=n<u.bounds.y+u.bounds.height/2?u.bounds.y-this.Ji/2:u.bounds.bottom+this.Ji/2,e.insertPointAt(p++,t,x),e.insertPointAt(p++,t,n)),e.insertPointAt(p++,w,n),e.insertPointAt(p++,w,k)):(n=b,n>=u.bounds.x&&n<=u.bounds.right&&(270===this.S?k>=u.bounds.y:k<=u.bounds.bottom)&&(t=u.centerY+(270===this.S?-i:i),n=n<u.bounds.x+u.bounds.width/2?u.bounds.x-this.Ji/2:u.bounds.right+this.Ji/2,e.insertPointAt(p++,b,t),e.insertPointAt(p++,n,t)),e.insertPointAt(p++,n,k),e.insertPointAt(p++,w,k))}else if(d)P=Math.max(10,this._s[u.layer]),M=Math.max(10,this.Ls[u.layer]),180===this.S&&w>=u.bounds.x?(t=u.bounds.x+u.bounds.width,e.setPointAt(p-2,t,x),e.setPointAt(p-1,t+M,x)):90===this.S&&k<=u.bounds.bottom?(t=u.bounds.y,e.setPointAt(p-2,b,t),e.setPointAt(p-1,b,t-P)):270===this.S&&k>=u.bounds.y?(t=u.bounds.y+u.bounds.height,e.setPointAt(p-2,b,t),e.setPointAt(p-1,b,t+M)):0===this.S&&w<=u.bounds.right&&(t=u.bounds.x,e.setPointAt(p-2,t,x),e.setPointAt(p-1,t-P,x));else{P=Math.max(10,this._s[u.layer]),M=Math.max(10,this.Ls[u.layer]);let t=0;180===this.S||0===this.S?((180===this.S?w<=u.bounds.x:w>=u.bounds.right)&&(t=(0===this.S?M:-P)/2),e.insertPointAt(p++,w+t,x)):((270===this.S?k<=u.bounds.y:k>=u.bounds.bottom)&&(t=(90===this.S?M:-P)/2),e.insertPointAt(p++,b,k+t)),e.insertPointAt(p++,w,k)}}else{for(;null!==u&&u!==c;){y=null,v=null;const t=u.destinationEdges.iterator;for(;t.next();){const e=t.value;if(e.link===i.link&&(y=e.toVertex,v=e.fromVertex,null!==v.node&&(v=null),null===y.node))break}if(null===y)break;y!==c&&(b=e.getPoint(p-1).x,x=e.getPoint(p-1).y,w=y.centerX,k=y.centerY,f?180===this.S||0===this.S?(null!==v?v.centerY:x)!==k&&(S=this.Ut[y.layer]+this.lr.x,p===e.firstPickIndex+1&&(S=0===this.S?Math.max(S,b):Math.min(S,b)),e.insertPointAt(p++,S,x),e.insertPointAt(p++,S,k)):(null!==v?v.centerX:b)!==w&&(S=this.Ut[y.layer]+this.lr.y,p===e.firstPickIndex+1&&(S=90===this.S?Math.max(S,x):Math.min(S,x)),e.insertPointAt(p++,b,S),e.insertPointAt(p++,w,S)):(P=Math.max(10,this._s[y.layer]),M=Math.max(10,this.Ls[y.layer]),d?180===this.S?(e.insertPointAt(p++,w+M+g,k),e.insertPointAt(p++,Math.max(w+M-g/2,w),k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,Math.min(w-P+g/2,w),k),e.insertPointAt(p++,w-P-g,k)):90===this.S?(e.insertPointAt(p++,w,k-P-g),e.insertPointAt(p++,w,Math.min(k-P+g/2,k)),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,Math.max(k+M-g/2,k)),e.insertPointAt(p++,w,k+M+g)):270===this.S?(e.insertPointAt(p++,w,k+M+g),e.insertPointAt(p++,w,Math.max(k+M-g/2,k)),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,Math.min(k-P+g/2,k)),e.insertPointAt(p++,w,k-P-g)):(e.insertPointAt(p++,w-P-g,k),e.insertPointAt(p++,Math.min(w-P+g/2,w),k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,w,k),e.insertPointAt(p++,Math.max(w+M-g/2,w),k),e.insertPointAt(p++,w+M+g,k)):180===this.S?(e.insertPointAt(p++,w+M,k),e.insertPointAt(p++,w-P,k)):90===this.S?(e.insertPointAt(p++,w,k-P),e.insertPointAt(p++,w,k+M)):270===this.S?(e.insertPointAt(p++,w,k+M),e.insertPointAt(p++,w,k-P)):(e.insertPointAt(p++,w-P,k),e.insertPointAt(p++,w+M,k)))),u=y}f&&(b=e.getPoint(p-1).x,x=e.getPoint(p-1).y,w=e.getPoint(p).x,k=e.getPoint(p).y,180===this.S||0===this.S?x!==k&&(S=0===this.S?Math.min(Math.max((w+b)/2,this.Ut[c.layer]+this.lr.x),w):Math.max(Math.min((w+b)/2,this.Ut[c.layer]+this.lr.x),w),e.insertPointAt(p++,S,x),e.insertPointAt(p++,S,k)):b!==w&&(S=90===this.S?Math.min(Math.max((k+x)/2,this.Ut[c.layer]+this.lr.y),k):Math.max(Math.min((k+x)/2,this.Ut[c.layer]+this.lr.y),k),e.insertPointAt(p++,b,S),e.insertPointAt(p++,w,S)))}if(null!==n&&d&&e.pointsCount>=4){if(null!==r){const t=l===O.None?e.getLinkPointFromPoint(s,r,r.getDocumentPoint(O.Center),e.getPoint(3),!0):e.getPoint(0);if(l===O.None){const i=e.getPoint(2),n=e.getPoint(3);90===this.direction||270===this.direction?(e.setPointAt(1,(t.x+i.x)/2,i.y),e.setPointAt(2,n.x,(i.y+n.y)/2)):(e.setPointAt(1,i.x,(t.y+i.y)/2),e.setPointAt(2,(i.x+n.x)/2,n.y))}t.isReal()||t.set(s.actualBounds.center),e.setPointAt(0,t.x,t.y)}if(null!==a){const t=h===O.None?e.getLinkPointFromPoint(o,a,a.getDocumentPoint(O.Center),e.getPoint(e.pointsCount-4),!1):e.getPoint(e.pointsCount-1);if(h===O.None){const i=e.getPoint(e.pointsCount-3),n=e.getPoint(e.pointsCount-4);90===this.direction||270===this.direction?(e.setPointAt(e.pointsCount-2,(t.x+i.x)/2,i.y),e.setPointAt(e.pointsCount-2,n.x,(i.y+n.y)/2)):(e.setPointAt(e.pointsCount-2,i.x,(t.y+i.y)/2),e.setPointAt(e.pointsCount-3,(i.x+n.x)/2,n.y))}t.isReal()||t.set(o.actualBounds.center),e.setPointAt(e.pointsCount-1,t.x,t.y)}}e.commitRoute(),i.commit()}}KO(){this.Xy=-1,this.Ag=0,this.Cs=0,this.$a=null,this.Dg=null,this.Wf=null;for(let t=0;t<this.On.length;t++)this.On[t]=null}Rh(t){let e;const i=this.di[t];if(i>=this.On.length){const t=[];for(let e=0;e<this.On.length;e++)t[e]=this.On[e];this.On=t}void 0===this.On[i]||null===this.On[i]?e=[]:(e=this.On[i],this.On[i]=null);const n=this.Wf[t];for(let s=0;s<n.length;s++){const t=n[s];e[t.index]=t}return e}vh(t,e){this.On[this.di[t]]=e}get layerSpacing(){return this.Ns}set layerSpacing(t){this.Ns!==t&&(d.i(t,"number",wi,"layerSpacing"),t>=0&&(this.Ns=t,this.invalidateLayout()))}get columnSpacing(){return this.Ji}set columnSpacing(t){this.Ji!==t&&(d.i(t,"number",wi,"columnSpacing"),t>0&&(this.Ji=t,this.invalidateLayout()))}get direction(){return this.S}set direction(t){this.S!==t&&(d.i(t,"number",wi,"direction"),0===t||90===t||180===t||270===t?(this.S=t,this.invalidateLayout()):d.o("LayeredDigraphLayout.direction must be 0, 90, 180, or 270"))}get cycleRemoveOption(){return this.Yf}set cycleRemoveOption(t){this.Yf!==t&&(1===t||0===t||2===t)&&(this.Yf=t,this.invalidateLayout())}get layeringOption(){return this.Gf}set layeringOption(t){this.Gf!==t&&(10===t||11===t||12===t)&&(this.Gf=t,this.invalidateLayout())}get initializeOption(){return this.Hf}set initializeOption(t){this.Hf!==t&&(20===t||21===t||22===t)&&(this.Hf=t,this.invalidateLayout())}get iterations(){return this.Ja}set iterations(t){this.Ja!==t&&t>=0&&(this.Ja=t,this.invalidateLayout())}get aggressiveOption(){return this.jf}set aggressiveOption(t){this.jf!==t&&(30===t||31===t||32===t)&&(this.jf=t,this.invalidateLayout())}get packOption(){return this.rr}set packOption(t){this.rr!==t&&(d.i(t,"number",wi,"packOption"),t>=0&&t<8&&(this.rr=t,this.invalidateLayout()))}get packIterations(){return this.qf}set packIterations(t){this.qf=t}get alignOption(){return this.In}set alignOption(t){this.In!==t&&(d.i(t,"number",wi,"align"),t>=0&&t<16&&(this.In=t,this.invalidateLayout()))}get setsPortSpots(){return this.vn}set setsPortSpots(t){this.vn!==t&&(d.i(t,"boolean",wi,"setsPortSpots"),this.vn=t,this.invalidateLayout())}get maxLayer(){return this.Mt}get maxIndex(){return this.Xy}get maxColumn(){return this.Kt}get minIndexLayer(){return this.Ag}get maxIndexLayer(){return this.Cs}}y(wi,"CycleDepthFirst",0),y(wi,"CycleGreedy",1),y(wi,"CycleFromLayers",2),y(wi,"LayerOptimalLinkLength",10),y(wi,"LayerLongestPathSink",11),y(wi,"LayerLongestPathSource",12),y(wi,"InitDepthFirstOut",20),y(wi,"InitDepthFirstIn",21),y(wi,"InitNaive",22),y(wi,"AggressiveNone",30),y(wi,"AggressiveLess",31),y(wi,"AggressiveMore",32),y(wi,"PackNone",0),y(wi,"PackExpand",1),y(wi,"PackStraighten",2),y(wi,"PackMedian",4),y(wi,"PackAll",15),y(wi,"AlignNone",0),y(wi,"AlignUpperLeft",1),y(wi,"AlignUpperRight",2),y(wi,"AlignLowerLeft",4),y(wi,"AlignLowerRight",8),y(wi,"AlignAll",15);class ki extends Ue{constructor(t){super(t)}createVertex(){return new Si(this)}createEdge(){return new Pi(this)}}class Si extends Ke{constructor(t){super(t),y(this,"$o",void 0),y(this,"zo",void 0),y(this,"Dt",void 0),y(this,"ik",void 0),y(this,"ek",void 0),y(this,"Zi",void 0),y(this,"Jf",void 0),y(this,"jn",void 0),y(this,"Z1",void 0),y(this,"W1",void 0),y(this,"J1",void 0),y(this,"Za",void 0),y(this,"En",void 0),y(this,"nD",void 0),y(this,"Oh",void 0),y(this,"ts",void 0),y(this,"$f",void 0),y(this,"fe",void 0),y(this,"Vn",void 0),y(this,"Hy",null),y(this,"jy",null),y(this,"qy",null),y(this,"Wy",null),this.$o=-1,this.zo=-1,this.Dt=-1,this.ik=NaN,this.ek=null,this.Zi=!1,this.Jf=NaN,this.jn=NaN,this.Z1=0,this.W1=null,this.J1=null}static lD(t,e){return t.index-e.index}getProperSourceEdges(){if(!this.qy){const t=[];for(const e of this.yo){const i=e;i.valid&&t.push(i)}this.qy=t}return this.qy}getProperDestinationEdges(){if(!this.Wy){const t=[];for(const e of this.sr){const i=e;i.valid&&t.push(i)}this.Wy=t}return this.Wy}getDestinationEdge(t){const e=this.getProperDestinationEdges();for(const i of e)if(i.toVertex===t)return i;d.o("Unable to find destination edge to given vertex")}getProperSourceVertexes(){if(!this.Hy){const t=[];for(const e of this.yo){const i=e;!i.valid||i.fromVertex.layer<=i.toVertex.layer||t.push(i.fromVertex)}t.sort(Si.lD),this.Hy=t}return this.Hy}getProperDestinationVertexes(){if(!this.jy){const t=[];for(const e of this.sr){const i=e;!i.valid||i.fromVertex.layer<=i.toVertex.layer||t.push(i.toVertex)}t.sort(Si.lD),this.jy=t}return this.jy}addSourceEdge(t){super.addSourceEdge(t),this.Hy=null,this.qy=null}deleteSourceEdge(t){super.deleteSourceEdge(t),this.Hy=null,this.qy=null}addDestinationEdge(t){super.addDestinationEdge(t),this.jy=null,this.Wy=null}deleteDestinationEdge(t){super.deleteDestinationEdge(t),this.jy=null,this.Wy=null}get layer(){return this.$o}set layer(t){this.$o!==t&&(d.i(t,"number",Si,"layer"),this.$o=t)}get column(){return this.zo}set column(t){this.zo!==t&&(d.i(t,"number",Si,"column"),this.zo=t)}get index(){return this.Dt}set index(t){this.Dt!==t&&(d.i(t,"number",Si,"index"),this.Dt=t)}get component(){return this.ik}set component(t){this.ik!==t&&(d.i(t,"number",Si,"component"),this.ik=t)}get near(){return this.ek}set near(t){this.ek!==t&&(this.ek=t)}}class Pi extends Ge{constructor(t){super(t),y(this,"Zi",void 0),y(this,"sk",void 0),y(this,"nk",void 0),y(this,"ok",void 0),y(this,"rk",void 0),y(this,"lk",void 0),y(this,"hk",void 0),this.Zi=!1,this.sk=!1,this.nk=!1,this.ok=NaN,this.rk=NaN,this.lk=0,this.hk=0}get fromVertex(){return this.$e}set fromVertex(t){this.$e!==t&&(this.$e=t)}get toVertex(){return this.Ze}set toVertex(t){this.Ze!==t&&(this.Ze=t)}get valid(){return this.Zi}set valid(t){this.Zi!==t&&(d.i(t,"boolean",Pi,"valid"),this.Zi=t)}get rev(){return this.sk}set rev(t){this.sk!==t&&(d.i(t,"boolean",Pi,"rev"),this.sk=t)}get forest(){return this.nk}set forest(t){this.nk!==t&&(d.i(t,"boolean",Pi,"forest"),this.nk=t)}get portFromPos(){return this.ok}set portFromPos(t){this.ok!==t&&(d.i(t,"number",Pi,"portFromPos"),this.ok=t)}get portToPos(){return this.rk}set portToPos(t){this.rk!==t&&(d.i(t,"number",Pi,"portToPos"),this.rk=t)}get portFromColOffset(){return this.lk}set portFromColOffset(t){this.lk!==t&&(d.i(t,"number",Pi,"portFromColOffset"),this.lk=t)}get portToColOffset(){return this.hk}set portToColOffset(t){this.hk!==t&&(d.i(t,"number",Pi,"portToColOffset"),this.hk=t)}}var Mi=(t=>(t[t.Default=0]="Default",t[t.Destination=1]="Destination",t[t.Source=2]="Source",t))(Mi||{}),Ci=(t=>(t[t.Forwards=10]="Forwards",t[t.Reverse=11]="Reverse",t[t.Ascending=12]="Ascending",t[t.Descending=13]="Descending",t))(Ci||{}),Ni=(t=>(t[t.CenterSubtrees=20]="CenterSubtrees",t[t.CenterChildren=21]="CenterChildren",t[t.Start=22]="Start",t[t.End=23]="End",t[t.Bus=24]="Bus",t[t.BusBranching=25]="BusBranching",t[t.TopLeftBus=26]="TopLeftBus",t[t.BottomRightBus=27]="BottomRightBus",t[t.Custom=28]="Custom",t))(Ni||{}),Li=(t=>(t[t.None=30]="None",t[t.Block=31]="Block",t))(Li||{}),Ti=(t=>(t[t.Layered=40]="Layered",t[t.LastParents=41]="LastParents",t[t.Alternating=42]="Alternating",t[t.RootOnly=43]="RootOnly",t))(Ti||{}),Ai=(t=>(t[t.Vertical=50]="Vertical",t[t.Horizontal=51]="Horizontal",t[t.FixedRoots=52]="FixedRoots",t))(Ai||{}),Di=(t=>(t[t.Individual=60]="Individual",t[t.Siblings=61]="Siblings",t[t.Uniform=62]="Uniform",t))(Di||{});class Fi extends je{constructor(t){super(),y(this,"Ri",void 0),y(this,"Di",void 0),y(this,"Zf",void 0),y(this,"Rg",void 0),y(this,"VN",void 0),y(this,"Ie",void 0),y(this,"zi",void 0),y(this,"Ss",void 0),y(this,"B",void 0),y(this,"z",void 0),y(this,"ak",void 0),y(this,"cs",void 0),this.Ri=new k,this.Di=0,this.cs=1,this.Zf=40,this.Rg=60,this.VN=[],this.Ie=!0,this.zi=50,this.Ss=new A(10,10).g();const e=new Oi(this);this.B=new Ri(e),this.z=new Ri(e),this.ak=[],t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Di=this.Di,t.Zf=this.Zf,t.Rg=this.Rg,t.Ie=this.Ie,t.zi=this.zi,t.Ss.a(this.Ss),t.B.copyInheritedPropertiesFrom(this.B),t.z.copyInheritedPropertiesFrom(this.z)}li(t){t in Ni?this.alignment=t:t in Ai?this.arrangement=t:t in Li?this.compaction=t:t in Mi?this.path=t:t in Ci?this.sorting=t:t in Ti?this.treeStyle=t:super.li(t)}createNetwork(){return new Oi(this)}makeNetwork(t){const e=this.createNetwork(),i=t=>{if(t instanceof Ce)return!t.isLinkLabel&&"Comment"!==t.category;if(t instanceof De){const e=t.fromNode;if(null===e||e.isLinkLabel||"Comment"===e.category)return!1;const i=t.toNode;return!(null===i||i.isLinkLabel||"Comment"===i.category)}return!1};return t instanceof Dt?(e.addParts(t.nodes,!0,i),e.addParts(t.links,!0,i)):t instanceof Ve?e.addParts(t.memberParts,!1,i):e.addParts(t.iterator,!1,i),e}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),52!==this.arrangement&&(this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin));let e=this.diagram;null===e&&t instanceof Dt&&(e=t),0===this.path&&null!==e?this.cs=e.isTreePathToChildren?1:2:this.cs=0===this.path?1:this.path,this.network.vertexes.count>0&&(this.NI(),this.CI(),this.LI(),this.AI(),this.DN(),this.TI(),this.arrangeTrees(),this.updateParts()),this.network=null,this.Ri=new k,this.isValidLayout=!0}NI(){this.network.deleteSelfEdges();const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;e.initialized=!1,e.level=0,e.parent=null,e.children=[]}if(this.Ri.count>0){const t=new k,e=this.Ri.iterator;for(;e.next();){const i=e.value;if(i instanceof Ce){const e=this.network.findVertex(i);null!==e&&t.add(e)}else i instanceof Ri&&t.add(i)}this.Ri=t}0===this.Ri.count&&this.findRoots();const e=this.Ri.copy().iterator;for(;e.next();){const t=e.value;t.initialized||(t.initialized=!0,this.UN(t))}let i=this.network.vertexes,n=null;for(;n=this.DI(i),n.count>0;){const t=this.hD(n);null!==t&&this.Ri.add(t),t.initialized=!0,this.UN(t),i=n}}DI(t){const e=new k,i=t.iterator;for(;i.next();){const t=i.value;t.initialized||e.add(t)}return e}findRoots(){const t=this.network.vertexes,e=t.iterator;for(;e.next();){const t=e.value;switch(this.cs){case 1:0===t.sourceEdges.count&&this.Ri.add(t);break;case 2:0===t.destinationEdges.count&&this.Ri.add(t);break;default:d.o("Unhandled path value "+this.cs.toString())}}if(0===this.Ri.count){const e=this.hD(t);null!==e&&this.Ri.add(e)}}hD(t){let e=999999,i=null;const n=t.iterator;for(;n.next();){const t=n.value;switch(this.cs){case 1:t.sourceEdges.count<e&&(e=t.sourceEdges.count,i=t);break;case 2:t.destinationEdges.count<e&&(e=t.destinationEdges.count,i=t);break;default:d.o("Unhandled path value "+this.cs.toString())}}return i}UN(t){if(null===t)return;switch(this.cs){case 1:if(t.destinationEdges.count>0){const e=new x,i=t.destinationVertexes;for(;i.next();){const n=i.value;this.aD(t,n)&&e.add(n)}e.count>0&&(t.children=e.toArray())}break;case 2:if(t.sourceEdges.count>0){const e=new x,i=t.sourceVertexes;for(;i.next();){const n=i.value;this.aD(t,n)&&e.add(n)}e.count>0&&(t.children=e.toArray())}break;default:d.o("Unhandled path value"+this.cs.toString())}const e=t.children,i=e.length;for(let n=0;n<i;n++){const i=e[n];i.initialized=!0,i.level=t.level+1,i.parent=t,this.Ri.remove(i)}for(let n=0;n<i;n++){const t=e[n];this.UN(t)}}aD(t,e){return!e.initialized||!(this.FI(e,t)||e.level>t.level)&&(this.RI(e.parent,e),!0)}FI(t,e){if(null===e)return!1;let i=e.parent;for(;null!==i&&i!==t;)i=i.parent;return i===t}RI(t,e){if(null===t||null===e)return;const i=t.children;let n=0;for(let s=0;s<i.length;s++)i[s]===e&&n++;if(n>0){const s=new Array(i.length-n);let o=0;for(let t=0;t<i.length;t++)i[t]!==e&&(s[o++]=i[t]);t.children=s}}CI(){const t=this.Ri.iterator;for(;t.next();){const e=t.value;e instanceof Ri&&this.cD(e)}}cD(t){if(null===t)return;this.initializeTreeVertexValues(t),25===t.alignment&&this.sortTreeVertexChildren(t);let e=0,i=t.childrenCount,n=0;const s=t.children,o=s.length;for(let r=0;r<o;r++){const t=s[r];this.cD(t),e+=t.descendantCount+1,i=Math.max(i,t.maxChildrenCount),n=Math.max(n,t.maxGenerationCount)}t.descendantCount=e,t.maxChildrenCount=i,t.maxGenerationCount=i>0?n+1:0}vI(t){switch(this.Zf){default:case 40:return null!==t.parent?t.parent:this.B;case 43:return null===t.parent?this.B:null===t.parent.parent?this.z:t.parent;case 42:return null!==t.parent?null!==t.parent.parent?t.parent.parent:this.z:this.B;case 41:{let e=!0;if(0===t.childrenCount)e=!1;else{const i=t.children,n=i.length;for(let t=0;t<n;t++)if(i[t].childrenCount>0){e=!1;break}}return e&&null!==t.parent?this.z:null!==t.parent?t.parent:this.B}}}initializeTreeVertexValues(t){const e=this.vI(t);if(t.copyInheritedPropertiesFrom(e),null!==t.parent&&25===t.parent.alignment){let e=t.angle;const i=t.parent.children;let n=0;for(;n<i.length&&t!==i[n];)n++;n%2===0?n!==i.length-1&&(e=90===e?180:180===e?270:270===e?180:270):e=90===e?0:180===e?90:270===e?0:90,t.angle=e}t.initialized=!0}LI(){const t=this.Ri.iterator;for(;t.next();){const e=t.value;e instanceof Ri&&this.fD(e)}}fD(t){if(null===t)return;this.assignTreeVertexValues(t);const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.fD(t)}}assignTreeVertexValues(t){}AI(){const t=this.Ri.iterator;for(;t.next();){const e=t.value;e instanceof Ri&&this.uD(e)}}uD(t){if(null===t)return;25!==t.alignment&&this.sortTreeVertexChildren(t);const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.uD(t)}}sortTreeVertexChildren(t){switch(t.sorting){default:case 10:break;case 11:t.children.reverse();break;case 12:t.children.sort(t.comparer);break;case 13:t.children.sort(t.comparer),t.children.reverse()}}DN(){if(!this.comments)return;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;this.addComments(e)}}addComments(t){const e=t.angle,i=t.parent;let n=0,s=21,o=!1;null!==i&&(n=i.angle,s=i.alignment,o=this.isBusAlignment(s));const r=90===e||270===e,a=90===n||270===n,l=0===t.childrenCount;let h=0,u=0,c=0;const d=t.commentSpacing;if(null!==t.node){const e=t.node.findNodesConnected();for(;e.next();){const i=e.value;if("Comment"!==i.category||!i.canLayout())continue;null===t.comments&&(t.comments=[]),t.comments.push(i),i.ensureBounds();const n=i.measuredBounds;r&&!l||!o&&!a&&l||o&&a&&l?(h=Math.max(h,n.width),u+=n.height+Math.abs(c)):(h+=n.width+Math.abs(c),u=Math.max(u,n.height)),c=d}}if(null!==t.comments){r&&!l||!o&&!a&&l||o&&a&&l?(h+=Math.abs(t.commentMargin),u=Math.max(0,u-t.height)):(u+=Math.abs(t.commentMargin),h=Math.max(0,h-t.width));const e=D.X(0,0,t.bounds.width+h,t.bounds.height+u);t.bounds=e,D.s(e)}}isBusAlignment(t){return 24===t||25===t||26===t||27===t}Jy(t){return 24===t||25===t}BN(t){const e=t.parent;if(null!==e){const i=e.alignment;if(this.isBusAlignment(i)){if(this.Jy(i)){const i=e.children;let n=0;for(;n<i.length&&t!==i[n];)n++;return n%2===0}return 26===i}}return!1}layoutComments(t){if(null!==t.comments){const e=t.node.measuredBounds,i=t.parent,n=t.angle;let s=0,o=21,r=!1;null!==i&&(s=i.angle,o=i.alignment,r=this.isBusAlignment(o));const a=90===n||270===n,l=90===s||270===s,h=0===t.childrenCount,u=this.BN(t);let c=0;const d=t.comments,f=d.length,g=T.l();for(let p=0;p<f;p++){const e=d[p],i=e.measuredBounds;if(a&&!h||!r&&!l&&h||r&&l&&h){if(s>135&&!r||l&&u)if(t.commentMargin>=0){g.e(t.bounds.x-t.commentMargin-i.width,t.bounds.y+c),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=O.MiddleLeft,t.toSpot=O.MiddleRight}}else{g.e(t.bounds.x+2*t.focus.x-t.commentMargin,t.bounds.y+c),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=O.MiddleRight,t.toSpot=O.MiddleLeft}}else if(t.commentMargin>=0){g.e(t.bounds.x+2*t.focus.x+t.commentMargin,t.bounds.y+c),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=O.MiddleRight,t.toSpot=O.MiddleLeft}}else{g.e(t.bounds.x+t.commentMargin-i.width,t.bounds.y+c),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=O.MiddleLeft,t.toSpot=O.MiddleRight}}t.commentSpacing>=0?c+=i.height+t.commentSpacing:c+=t.commentSpacing-i.height}else{if(s>135&&!r||!l&&u)if(t.commentMargin>=0){g.e(t.bounds.x+c,t.bounds.y-t.commentMargin-i.height),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=O.MiddleTop,t.toSpot=O.MiddleBottom}}else{g.e(t.bounds.x+c,t.bounds.y+2*t.focus.y-t.commentMargin),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=O.MiddleBottom,t.toSpot=O.MiddleTop}}else if(t.commentMargin>=0){g.e(t.bounds.x+c,t.bounds.y+2*t.focus.y+t.commentMargin),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=O.MiddleBottom,t.toSpot=O.MiddleTop}}else{g.e(t.bounds.x+c,t.bounds.y+t.commentMargin-i.height),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=O.MiddleTop,t.toSpot=O.MiddleBottom}}t.commentSpacing>=0?c+=i.width+t.commentSpacing:c+=t.commentSpacing-i.width}}T.s(g);const m=c-t.commentSpacing-(a?e.height:e.width);if(1===this.cs){const e=t.destinationEdges;for(;e.next();){const t=e.value.link;null!==t&&!t.isAvoiding&&(t.fromEndSegmentLength=m>0?m:NaN)}}else{const e=t.sourceEdges;for(;e.next();){const t=e.value.link;null!==t&&!t.isAvoiding&&(t.toEndSegmentLength=m>0?m:NaN)}}}}TI(){if(62===this.layerStyle){const t=[];let e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;let n=i.parent;null===n&&(n=i);const s=0===n.angle||180===n.angle;let o=t[i.level];void 0===o&&(o=0),t[i.level]=Math.max(o,s?i.width:i.height)}for(let i=0;i<t.length;i++)void 0===t[i]&&(t[i]=0);for(this.VN=t,e=this.network.vertexes.iterator;e.next();){const i=e.value;let n=i.parent;null===n&&(n=i),0===n.angle||180===n.angle?(180===n.angle&&(i.focusX+=t[i.level]-i.width),i.width=t[i.level]):(270===n.angle&&(i.focusY+=t[i.level]-i.height),i.height=t[i.level])}}else if(61===this.layerStyle){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=0===e.angle||180===e.angle;let n=-1;for(let t=0;t<e.children.length;t++){const s=e.children[t];n=Math.max(n,i?s.width:s.height)}if(n>=0)for(let t=0;t<e.children.length;t++){const s=e.children[t];i?(180===e.angle&&(s.focusX+=n-s.width),s.width=n):(270===e.angle&&(s.focusY+=n-s.height),s.height=n)}}}const t=this.Ri.iterator;for(;t.next();){const e=t.value;e instanceof Ri&&this.layoutTree(e)}}layoutTree(t){if(null===t)return;const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.layoutTree(t)}if(30===t.compaction)this.dD(t);else 25===t.alignment?this.dD(t):this.OI(t)}dD(t){if(0===t.childrenCount){let e=!1,i=0,n=21;null!==t.parent&&(i=t.parent.angle,n=t.parent.alignment,e=this.isBusAlignment(n));const s=this.BN(t);return t.V.e(0,0),t.mt.e(t.width,t.height),void(null===t.parent||null===t.comments||(180!==i&&270!==i||e)&&!s?t.nt.e(0,0):180===i&&!e||(90===i||270===i)&&s?t.nt.e(t.width-2*t.focus.x,0):t.nt.e(0,t.height-2*t.focus.y))}const e=this.orthoAngle(t),i=90===e||270===e;let n=0;const s=t.children,o=s.length;for(let D=0;D<o;D++){const t=s[D];n=Math.max(n,i?t.mt.width:t.mt.height)}const r=t.alignment,a=22===r,l=23===r,h=this.isBusAlignment(r),u=Math.max(0,t.breadthLimit),c=this.computeLayerSpacing(t),d=t.nodeSpacing,f=this.computeNodeIndent(t),g=a||l?0:f/2,m=t.rowSpacing;let p=0;(a||l||t.Qf||t._f&&1===t.maxGenerationCount)&&(p=Math.max(0,t.rowIndent));const y=t.width,v=t.height;let b=0,x=0,w=0,k=0,S=0,P=0,M=0,C=0,N=0,L=0;if(h&&!this.Jy(r)&&e>135&&s.reverse(),this.Jy(r))if(o>1)for(let D=0;D<o;D++){const t=s[D],e=t.mt;D%2===0&&D!==o-1?N=Math.max(N,(i?e.width:e.height)+this.computeBusNodeSpacing(t)-d):D%2!==0&&(L=Math.max(L,(i?e.width:e.height)+this.computeBusNodeSpacing(t)-d))}else 1===o&&(N=i?s[0].mt.width:s[0].mt.height);if(h)switch(r){case 24:case 25:let r;r=e<135?this.gD(t,s,N,L,b,x):this.mD(t,s,N,L,b,x),N=r.x,b=r.width,x=r.height;break;case 26:for(let t=0;t<o;t++){const e=s[t],o=e.mt,r=0===M?0:m;i?(e.V.e(n-o.width,S+r),b=Math.max(b,o.width),x=Math.max(x,S+r+o.height),S+=r+o.height):(e.V.e(k+r,n-o.height),b=Math.max(b,k+r+o.width),x=Math.max(x,o.height),k+=r+o.width),M++}break;case 27:for(let e=0;e<o;e++){const n=s[e],o=n.mt,r=0===M?0:m;i?(n.V.e(d/2+t.focus.x,S+r),b=Math.max(b,o.width),x=Math.max(x,S+r+o.height),S+=r+o.height):(n.V.e(k+r,d/2+t.focus.y),b=Math.max(b,k+r+o.width),x=Math.max(x,o.height),k+=r+o.width),M++}}else for(let D=0;D<o;D++){const o=s[D],a=o.mt;if(i){u>0&&M>0&&k+d+a.width>u&&(k<n&&this.Qa(t,r,n-k,0,C,D-1),P++,M=0,C=D,w=x,k=0,S=e>135?-x-m:x+m);const i=0===M?g:d;this.ck(o,0,S),o.V.e(k+i,S),b=Math.max(b,k+i+a.width),x=Math.max(x,w+(0===P?0:m)+a.height),k+=i+a.width}else{u>0&&M>0&&S+d+a.height>u&&(S<n&&this.Qa(t,r,0,n-S,C,D-1),P++,M=0,C=D,w=b,S=0,k=e>135?-b-m:b+m);const i=0===M?g:d;this.ck(o,k,0),o.V.e(k,S+i),x=Math.max(x,S+i+a.height),b=Math.max(b,w+(0===P?0:m)+a.width),S+=i+a.height}M++}P>0&&(i?(x+=Math.max(0,c),k<b&&this.Qa(t,r,b-k,0,C,o-1),p>0&&(l||this.tu(t,p,0,0,o-1),b+=p)):(b+=Math.max(0,c),S<x&&this.Qa(t,r,0,x-S,C,o-1),p>0&&(l||this.tu(t,0,p,0,o-1),x+=p)));let T=0,A=0;switch(r){case 20:i?T+=b/2-t.focus.x-f/2:A+=x/2-t.focus.y-f/2;break;default:case 21:if(P>0)i?T+=b/2-t.focus.x-f/2:A+=x/2-t.focus.y-f/2;else{const e=o;if(i){const i=s[0].V.x+s[0].nt.x;T+=i+(s[e-1].V.x+s[e-1].nt.x+2*s[e-1].focus.x-i)/2-t.focus.x-f/2}else{const i=s[0].V.y+s[0].nt.y;A+=i+(s[e-1].V.y+s[e-1].nt.y+2*s[e-1].focus.y-i)/2-t.focus.y-f/2}}break;case 22:i?(T-=f,b+=f):(A-=f,x+=f);break;case 23:i?(T+=b-t.width+f,b+=f):(A+=x-t.height+f,x+=f);break;case 24:case 25:i?T+=o>1?N+d/2-t.focus.x:s[0].focus.x-t.focus.x+s[0].nt.x:A+=o>1?N+d/2-t.focus.y:s[0].focus.y-t.focus.y+s[0].nt.y;break;case 26:i?T+=b+d/2-t.focus.x:A+=x+d/2-t.focus.y;break;case 27:break;case 28:const e=this.customAlignment(t,T,A,b,x);T=e[0],A=e[1],b=e[2],x=e[3]}for(let D=0;D<o;D++){const t=s[D];i?t.V.e(t.V.x+t.nt.x-T,t.V.y+(e>135?(h?-x:-t.mt.height)+t.nt.y-c:v+c+t.nt.y)):t.V.e(t.V.x+(e>135?(h?-b:-t.mt.width)+t.nt.x-c:y+c+t.nt.x),t.V.y+t.nt.y-A)}i?(b=this.zN(t,b,T),T<0&&(T=0),e>135&&(A+=x+c),x=Math.max(Math.max(x,v),x+v+c)):(e>135&&(T+=b+c),b=Math.max(Math.max(b,y),b+y+c),x=this.XN(t,x,A),A<0&&(A=0)),t.nt.e(T,A),t.mt.e(b,x)}customAlignment(t,e,i,n,s){return[e,i,n,s]}gD(t,e,i,n,s,o){const r=e.length;if(0===r)return new D(i,0,s,o);if(1===r){const t=e[0];return s=t.mt.width,o=t.mt.height,new D(i,0,s,o)}const a=t.nodeSpacing,l=t.rowSpacing,h=90===this.orthoAngle(t);let u=0,c=0,d=0;for(let m=0;m<r;m++){if(m%2!==0||r>1&&m===r-1)continue;const t=e[m],n=t.mt,f=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;t.V.e(i-(n.width+e),d+f),s=Math.max(s,n.width+e),o=Math.max(o,d+f+n.height),d+=f+n.height}else{const e=this.computeBusNodeSpacing(t)-a;t.V.e(c+f,i-(n.height+e)),o=Math.max(o,n.height+e),s=Math.max(s,c+f+n.width),c+=f+n.width}u++}u=0;const f=c,g=d;h?(c=i+a,d=0):(c=0,d=i+a);for(let m=0;m<r;m++){if(m%2===0)continue;const t=e[m],i=t.mt,n=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;t.V.e(c+e,d+n),s=Math.max(s,c+i.width+e),o=Math.max(o,d+n+i.height),d+=n+i.height}else{const e=this.computeBusNodeSpacing(t)-a;t.V.e(c+n,d+e),s=Math.max(s,c+n+i.width),o=Math.max(o,d+i.height+e),c+=n+i.width}u++}if(r>1&&r%2===1){const n=e[r-1],l=n.mt,u=this.computeBusLastRowSpacing(n,h?Math.max(Math.abs(g),Math.abs(d)):Math.max(Math.abs(f),Math.abs(c)));if(h){n.V.e(i+a/2-n.focus.x-n.nt.x,o+u);const e=i+a/2-n.focus.x-n.nt.x;s=Math.max(s,e+l.width),e<0&&(s-=e),o=Math.max(o,Math.max(g,d)+u+l.height),n.V.x<0&&(i=this.fk(t,n.V.x,!1,i,a))}else{n.V.e(s+u,i+a/2-n.focus.y-n.nt.y),s=Math.max(s,Math.max(f,c)+u+l.width);const e=i+a/2-n.focus.y-n.nt.y;o=Math.max(o,e+l.height),e<0&&(o-=e),n.V.y<0&&(i=this.fk(t,n.V.y,!0,i,a))}}return new D(i,0,s,o)}mD(t,e,i,n,s,o){const r=e.length;if(0===r)return new D(i,0,s,o);if(1===r){const t=e[0];return s=t.mt.width,o=t.mt.height,new D(i,0,s,o)}const a=t.nodeSpacing,l=t.rowSpacing,h=270===this.orthoAngle(t);let u=0,c=0,d=0;for(let m=0;m<r;m++){if(m%2!==0||r>1&&m===r-1)continue;const t=e[m],n=t.mt,f=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;d-=f+n.height,t.V.e(i-(n.width+e),d),s=Math.max(s,n.width+e),o=Math.max(o,Math.abs(d))}else{const e=this.computeBusNodeSpacing(t)-a;c-=f+n.width,t.V.e(c,i-(n.height+e)),o=Math.max(o,n.height+e),s=Math.max(s,Math.abs(c))}u++}u=0;const f=c,g=d;h?(c=i+a,d=0):(c=0,d=i+a);for(let m=0;m<r;m++){if(m%2===0)continue;const t=e[m],i=t.mt,n=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;d-=n+i.height,t.V.e(c+e,d),s=Math.max(s,c+i.width+e),o=Math.max(o,Math.abs(d))}else{const e=this.computeBusNodeSpacing(t)-a;c-=n+i.width,t.V.e(c,d+e),o=Math.max(o,d+i.height+e),s=Math.max(s,Math.abs(c))}u++}if(r>1&&r%2===1){const n=e[r-1],l=n.mt,u=this.computeBusLastRowSpacing(n,h?Math.max(Math.abs(g),Math.abs(d)):Math.max(Math.abs(f),Math.abs(c)));if(h){n.V.e(i+a/2-n.focus.x-n.nt.x,-o-l.height-u);const e=i+a/2-n.focus.x-n.nt.x;s=Math.max(s,e+l.width),e<0&&(s-=e),o=Math.max(o,Math.abs(Math.min(g,d))+u+l.height),n.V.x<0&&(i=this.fk(t,n.V.x,!1,i,a))}else{n.V.e(-s-l.width-u,i+a/2-n.focus.y-n.nt.y),s=Math.max(s,Math.abs(Math.min(f,c))+u+l.width);const e=i+a/2-n.focus.y-n.nt.y;o=Math.max(o,e+l.height),e<0&&(o-=e),n.V.y<0&&(i=this.fk(t,n.V.y,!0,i,a))}}for(let m=0;m<r;m++){const t=e[m];h?t.V.e(t.V.x,t.V.y+o):t.V.e(t.V.x+s,t.V.y)}return new D(i,0,s,o)}computeBusNodeSpacing(t){return null===t.parent?0:t.parent.nodeSpacing}computeBusLastRowSpacing(t,e){return null===t.parent?0:t.parent.rowSpacing}fk(t,e,i,n,s){const o=t.children,r=o.length;for(let l=0;l<r;l++)i?o[l].V.e(o[l].V.x,o[l].V.y-e):o[l].V.e(o[l].V.x-e,o[l].V.y);const a=o[r-1];return Math.max(n,i?a.nt.y+a.focus.y-s/2:a.nt.x+a.focus.x-s/2)}zN(t,e,i){switch(t.alignment){case 21:case 20:let n=e;return i+t.width>n&&(n=i+t.width),i<0&&(n-=i),n;case 22:return t.width>e?t.width:e;case 23:return 2*t.focus.x>e?t.width:e+t.width-2*t.focus.x;case 24:case 25:const s=Math.min(0,i),o=Math.max(e,i+t.width);return Math.max(t.width,o-s);case 26:return t.width-t.focus.x+t.nodeSpacing/2+e;case 27:return Math.max(t.width,t.focus.x+t.nodeSpacing/2+e);default:return e}}XN(t,e,i){switch(t.alignment){case 21:case 20:let n=e;return i+t.height>n&&(n=i+t.height),i<0&&(n-=i),n;case 22:return t.height>e?t.height:e;case 23:return 2*t.focus.y>e?t.height:e+t.height-2*t.focus.y;case 24:case 25:const s=Math.min(0,i),o=Math.max(e,i+t.height);return Math.max(t.height,o-s);case 26:return t.height-t.focus.y+t.nodeSpacing/2+e;case 27:return Math.max(t.height,t.focus.y+t.nodeSpacing/2+e);default:return e}}KN(t,e,i){switch(t){case 20:case 21:e/=2,i/=2;break;case 22:e=0,i=0;break;case 23:break;default:d.o("Unhandled alignment value "+t.toString())}return new T(e,i)}Qa(t,e,i,n,s,o){const r=this.KN(e,i,n);this.tu(t,r.x,r.y,s,o)}tu(t,e,i,n,s){if(0===e&&0===i)return;const o=t.children;for(let r=n;r<=s;r++){const t=o[r].V;t.x+=e,t.y+=i}}ck(t,e,i){const n=t.parent;switch(this.cs){case 1:{const s=t.sourceEdges;for(;s.next();){const t=s.value;t.fromVertex===n&&t.relativePoint.e(e,i)}break}case 2:{const s=t.destinationEdges;for(;s.next();){const t=s.value;t.toVertex===n&&t.relativePoint.e(e,i)}break}default:d.o("Unhandled path value "+this.cs.toString())}}OI(t){if(0===t.childrenCount){const e=t.parent;let i=!1,n=0,s=21;null!==e&&(n=e.angle,s=e.alignment,i=this.isBusAlignment(s));const o=this.BN(t);return t.V.e(0,0),t.mt.e(t.width,t.height),null===t.parent||null===t.comments||(180!==n&&270!==n||i)&&!o?t.nt.e(0,0):180===n&&!i||(90===n||270===n)&&o?t.nt.e(t.width-2*t.focus.x,0):t.nt.e(0,t.height-2*t.focus.y),t.vg=null,void(t.Og=null)}const e=this.orthoAngle(t),i=90===e||270===e;let n=0;const s=t.children,o=s.length;for(let d=0;d<o;d++){const t=s[d];n=Math.max(n,i?t.mt.width:t.mt.height)}const r=t.alignment,a=22===r,l=23===r,h=this.isBusAlignment(r),u=Math.max(0,t.breadthLimit),c=this.computeLayerSpacing(t),f=t.nodeSpacing,g=this.computeNodeIndent(t),m=t.rowSpacing;let p=0;(a||l||t.Qf||t._f&&1===t.maxGenerationCount)&&(p=Math.max(0,t.rowIndent));const y=t.width,v=t.height;let b=0,x=0,w=0,k=null,S=null,P=0,M=0,C=0,N=0,L=0,T=0,A=0,D=0,F=0;if(h&&!this.Jy(r)&&e>135&&s.reverse(),this.Jy(r))if(o>1)for(let d=0;d<o;d++)d%2===0&&d!==o-1?D=Math.max(D,i?s[d].mt.width:s[d].mt.height):d%2!==0&&(F=Math.max(F,i?s[d].mt.width:s[d].mt.height));else 1===o&&(D=i?s[0].mt.width:s[0].mt.height);if(h){switch(r){case 24:let r;r=e<135?this.gD(t,s,D,F,b,x):this.mD(t,s,D,F,b,x),D=r.x,b=r.width,x=r.height;break;case 26:for(let t=0;t<o;t++){const e=s[t],o=e.mt,r=0===T?0:m;i?(e.V.e(n-o.width,N+r),b=Math.max(b,o.width),x=Math.max(x,N+r+o.height),N+=r+o.height):(e.V.e(C+r,n-o.height),b=Math.max(b,C+r+o.width),x=Math.max(x,o.height),C+=r+o.width),T++}break;case 27:for(let e=0;e<o;e++){const n=s[e],o=n.mt,r=0===T?0:m;i?(n.V.e(f/2+t.focus.x,N+r),b=Math.max(b,o.width),x=Math.max(x,N+r+o.height),N+=r+o.height):(n.V.e(C+r,f/2+t.focus.y),b=Math.max(b,C+r+o.width),x=Math.max(x,o.height),C+=r+o.width),T++}}k=this.ue(2),S=this.ue(2),i?(k[0].e(0,0),k[1].e(0,x),S[0].e(b,0),S[1].e(b,x)):(k[0].e(0,0),k[1].e(b,0),S[0].e(0,x),S[1].e(b,x))}else for(let z=0;z<o;z++){const o=s[z],a=o.mt;if(i){u>0&&T>0&&C+f+a.width>u&&(C<n&&this.Qa(t,r,n-C,0,A,z-1),L++,T=0,A=z,w=x,C=0,N=e>135?-x-m:x+m),this.ck(o,0,N);let i=0;if(0===T)k=o.vg,S=o.Og,P=a.width,M=a.height,(null===k||null===S||e!==this.orthoAngle(o))&&(k=this.ue(2),S=this.ue(2),k[0].e(0,0),k[1].e(0,M),S[0].e(P,0),S[1].e(P,M));else{const e=d.rt(),n=this.pD(t,o,k,S,P,M,e);i=n.x,k=e[0],S=e[1],P=n.width,M=n.height,d.it(e),C<a.width&&i<0&&(this.tu(t,-i,0,A,z-1),this.uk(k,-i,0),this.uk(S,-i,0),i=0)}o.V.e(i,N),b=Math.max(b,P),x=Math.max(x,w+(0===L?0:m)+a.height),C=P}else{u>0&&T>0&&N+f+a.height>u&&(N<n&&this.Qa(t,r,0,n-N,A,z-1),L++,T=0,A=z,w=b,N=0,C=e>135?-b-m:b+m),this.ck(o,C,0);let i=0;if(0===T)k=o.vg,S=o.Og,P=a.width,M=a.height,(null===k||null===S||e!==this.orthoAngle(o))&&(k=this.ue(2),S=this.ue(2),k[0].e(0,0),k[1].e(P,0),S[0].e(0,M),S[1].e(P,M));else{const e=d.rt(),n=this.pD(t,o,k,S,P,M,e);i=n.x,k=e[0],S=e[1],P=n.width,M=n.height,d.it(e),N<a.height&&i<0&&(this.tu(t,0,-i,A,z-1),this.uk(k,0,-i),this.uk(S,0,-i),i=0)}o.V.e(C,i),x=Math.max(x,M),b=Math.max(b,w+(0===L?0:m)+a.width),N=M}T++}L>0&&(i?(x+=Math.max(0,c),C<b&&this.Qa(t,r,b-C,0,A,o-1),p>0&&(l||this.tu(t,p,0,0,o-1),b+=p)):(b+=Math.max(0,c),N<x&&this.Qa(t,r,0,x-N,A,o-1),p>0&&(l||this.tu(t,0,p,0,o-1),x+=p)));let O=0,R=0;switch(r){case 20:i?O+=b/2-t.focus.x-g/2:R+=x/2-t.focus.y-g/2;break;default:case 21:if(L>0)i?O+=b/2-t.focus.x-g/2:R+=x/2-t.focus.y-g/2;else{const e=o;if(i){const i=s[0].V.x+s[0].nt.x;O+=i+(s[e-1].V.x+s[e-1].nt.x+2*s[e-1].focus.x-i)/2-t.focus.x-g/2}else{const i=s[0].V.y+s[0].nt.y;R+=i+(s[e-1].V.y+s[e-1].nt.y+2*s[e-1].focus.y-i)/2-t.focus.y-g/2}}break;case 22:i?(O-=g,b+=g):(R-=g,x+=g);break;case 23:i?(O+=b-t.width+g,b+=g):(R+=x-t.height+g,x+=g);break;case 24:i?O+=o>1?D+f/2-t.focus.x:s[0].focus.x-t.focus.x+s[0].nt.x:R+=o>1?D+f/2-t.focus.y:s[0].focus.y-t.focus.y+s[0].nt.y;break;case 26:i?O+=b+f/2-t.focus.x:R+=x+f/2-t.focus.y;break;case 27:break;case 28:const e=this.customAlignment(t,O,R,b,x);O=e[0],R=e[1],b=e[2],x=e[3]}for(let d=0;d<o;d++){const t=s[d];i?t.V.e(t.V.x+t.nt.x-O,t.V.y+(e>135?(h?-x:-t.mt.height)+t.nt.y-c:v+c+t.nt.y)):t.V.e(t.V.x+(e>135?(h?-b:-t.mt.width)+t.nt.x-c:y+c+t.nt.x),t.V.y+t.nt.y-R)}let E,B,I=0,V=0;if(h)i?(b=this.zN(t,b,O),O<0&&(O=0),e>135&&(R+=x+c),x+=v+c,27===r&&(I+=f/2+t.focus.x),V+=v+c):(e>135&&(O+=b+c),b+=y+c,x=this.XN(t,x,R),R<0&&(R=0),27===r&&(V+=f/2+t.focus.y),I+=y+c);else if(i){if(null===t.comments){if(y>b){const t=this.KN(r,y-b,0);I=t.x,V=t.y,b=y,O=0}}else b=this.zN(t,b,O);O<0&&(I-=O,O=0),e>135&&(R+=x+c),x=Math.max(Math.max(x,v),x+v+c),V+=v+c}else{if(e>135&&(O+=b+c),b=Math.max(Math.max(b,y),b+y+c),null===t.comments){if(v>x){const t=this.KN(r,0,v-x);I=t.x,V=t.y,x=v,R=0}}else x=this.XN(t,x,R);R<0&&(V-=R,R=0),I+=y+c}if(L>0)E=this.ue(4),B=this.ue(4),i?(E[2].e(0,v+c),E[3].e(E[2].x,x),B[2].e(b,E[2].y),B[3].e(B[2].x,E[3].y)):(E[2].e(y+c,0),E[3].e(b,E[2].y),B[2].e(E[2].x,x),B[3].e(E[3].x,B[2].y));else{E=this.ue(k.length+2),B=this.ue(S.length+2);for(let t=0;t<k.length;t++){const e=k[t];E[t+2].e(e.x+I,e.y+V)}for(let t=0;t<S.length;t++){const e=S[t];B[t+2].e(e.x+I,e.y+V)}}i?(E[0].e(O,0),E[1].e(E[0].x,v),E[2].y<E[1].y&&(E[2].x>E[0].x?E[2].a(E[1]):E[1].a(E[2])),E[3].y<E[2].y&&(E[3].x>E[0].x?E[3].a(E[2]):E[2].a(E[3])),B[0].e(O+y,0),B[1].e(B[0].x,v),B[2].y<B[1].y&&(B[2].x<B[0].x?B[2].a(B[1]):B[1].a(B[2])),B[3].y<B[2].y&&(B[3].x<B[0].x?B[3].a(B[2]):B[2].a(B[3])),E[2].y-=c/2,B[2].y-=c/2):(E[0].e(0,R),E[1].e(y,E[0].y),E[2].x<E[1].x&&(E[2].y>E[0].y?E[2].a(E[1]):E[1].a(E[2])),E[3].x<E[2].x&&(E[3].y>E[0].y?E[3].a(E[2]):E[2].a(E[3])),B[0].e(0,R+v),B[1].e(y,B[0].y),B[2].x<B[1].x&&(B[2].y<B[0].y?B[2].a(B[1]):B[1].a(B[2])),B[3].x<B[2].x&&(B[3].y<B[0].y?B[3].a(B[2]):B[2].a(B[3])),E[2].x-=c/2,B[2].x-=c/2),this.en(k),this.en(S),t.vg=E,t.Og=B,t.nt.e(O,R),t.mt.e(b,x)}uk(t,e,i){for(let n=0;n<t.length;n++){const s=t[n];s.x+=e,s.y+=i}}pD(t,e,i,n,s,o,r){const a=this.orthoAngle(t),l=90===a||270===a,h=t.nodeSpacing,u=i,c=n,d=s,f=o;let g=e.vg,m=e.Og;const p=e.mt,y=l?Math.max(f,p.height):Math.max(d,p.width);if((null===g||a!==this.orthoAngle(e))&&(g=this.ue(2),m=this.ue(2),l?(g[0].e(0,0),g[1].e(0,p.height),m[0].e(p.width,0),m[1].e(m[0].x,g[1].y)):(g[0].e(0,0),g[1].e(p.width,0),m[0].e(0,p.height),m[1].e(g[1].x,m[0].y))),l){const t=d;let e=t-this.II(c,g,t);return e+=h,i=this.EI(u,g,e),n=this.VI(c,m,e),s=Math.max(0,e)+p.width,o=y,this.en(u),this.en(g),this.en(c),this.en(m),r[0]=i,r[1]=n,new D(e,0,s,o)}{const t=f;let e=t-this.UI(c,g,t);return e+=h,i=this.BI(u,g,e),n=this.zI(c,m,e),s=y,o=Math.max(0,e)+p.height,this.en(u),this.en(g),this.en(c),this.en(m),r[0]=i,r[1]=n,new D(e,0,s,o)}}BI(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ue(t.length+e.length);let s=0,o=0,r=0;for(;o<e.length&&e[o].x<t[0].x;){const t=e[o++];n[r++].e(t.x,t.y+i)}for(;s<t.length;){const e=t[s++];n[r++].e(e.x,e.y)}const a=t[t.length-1].x;for(;o<e.length&&e[o].x<=a;)o++;for(;o<e.length&&e[o].x>a;){const t=e[o++];n[r++].e(t.x,t.y+i)}const l=this.ue(r);for(s=0;s<r;s++)l[s].a(n[s]);return this.en(n),l}EI(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ue(t.length+e.length);let s=0,o=0,r=0;for(;o<e.length&&e[o].y<t[0].y;){const t=e[o++];n[r++].e(t.x+i,t.y)}for(;s<t.length;){const e=t[s++];n[r++].e(e.x,e.y)}const a=t[t.length-1].y;for(;o<e.length&&e[o].y<=a;)o++;for(;o<e.length&&e[o].y>a;){const t=e[o++];n[r++].e(t.x+i,t.y)}const l=this.ue(r);for(s=0;s<r;s++)l[s].a(n[s]);return this.en(n),l}zI(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ue(t.length+e.length);let s=0,o=0,r=0;for(;s<t.length&&t[s].x<e[0].x;){const e=t[s++];n[r++].e(e.x,e.y)}for(;o<e.length;){const t=e[o++];n[r++].e(t.x,t.y+i)}const a=e[e.length-1].x;for(;s<t.length&&t[s].x<=a;)s++;for(;s<t.length&&t[s].x>a;){const e=t[s++];n[r++].e(e.x,e.y)}const l=this.ue(r);for(s=0;s<r;s++)l[s].a(n[s]);return this.en(n),l}VI(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ue(t.length+e.length);let s=0,o=0,r=0;for(;s<t.length&&t[s].y<e[0].y;){const e=t[s++];n[r++].e(e.x,e.y)}for(;o<e.length;){const t=e[o++];n[r++].e(t.x+i,t.y)}const a=e[e.length-1].y;for(;s<t.length&&t[s].y<=a;)s++;for(;s<t.length&&t[s].y>a;){const e=t[s++];n[r++].e(e.x,e.y)}const l=this.ue(r);for(s=0;s<r;s++)l[s].a(n[s]);return this.en(n),l}UI(t,e,i){let n=9999999;if(null===t||t.length<2||null===e||e.length<2)return n;let s=0,o=0;for(;s<t.length&&o<e.length;){const r=t[s],a=e[o],l=a.x;let h=a.y;h+=i;let u=r;s+1<t.length&&(u=t[s+1]);let c=a,d=c.x,f=c.y;o+1<e.length&&(c=e[o+1],d=c.x,f=c.y,f+=i);let g=n;r.x===l?g=h-r.y:r.x>l&&r.x<d?g=h+(r.x-l)/(d-l)*(f-h)-r.y:l>r.x&&l<u.x&&(g=h-(r.y+(l-r.x)/(u.x-r.x)*(u.y-r.y))),g<n&&(n=g),u.x<=r.x?s++:d<=l?o++:(u.x<=d&&s++,d<=u.x&&o++)}return n}II(t,e,i){let n=9999999;if(null===t||t.length<2||null===e||e.length<2)return n;let s=0,o=0;for(;s<t.length&&o<e.length;){const r=t[s],a=e[o];let l=a.x;const h=a.y;l+=i;let u=r;s+1<t.length&&(u=t[s+1]);let c=a,d=c.x,f=c.y;o+1<e.length&&(c=e[o+1],d=c.x,f=c.y,d+=i);let g=n;r.y===h?g=l-r.x:r.y>h&&r.y<f?g=l+(r.y-h)/(f-h)*(d-l)-r.x:h>r.y&&h<u.y&&(g=l-(r.x+(h-r.y)/(u.y-r.y)*(u.x-r.x))),g<n&&(n=g),u.y<=r.y?s++:f<=h?o++:(u.y<=f&&s++,f<=u.y&&o++)}return n}ue(t){const e=this.ak[t];if(void 0!==e){const t=e.pop();if(void 0!==t)return t}const i=[];for(let n=0;n<t;n++)i[n]=new T;return i}en(t){const e=t.length;let i=this.ak[e];void 0===i&&(i=[],this.ak[e]=i),i.push(t)}arrangeTrees(){if(52===this.zi){const t=this.Ri.iterator;for(;t.next();){const e=t.value;if(!(e instanceof Ri))continue;const i=e.node;if(null===i)continue;const n=i.position;let s=n.x,o=n.y;isFinite(s)||(s=0),isFinite(o)||(o=0),this.YN(e,s,o)}}else{const t=[],e=this.Ri.iterator;for(;e.next();){const i=e.value;i instanceof Ri&&t.push(i)}switch(this.sorting){default:case 10:break;case 11:t.reverse();break;case 12:t.sort(this.comparer);break;case 13:t.sort(this.comparer),t.reverse()}const i=this.arrangementOrigin;let n=i.x,s=i.y;for(let o=0;o<t.length;o++){const e=t[o];if(50===(this.YN(e,n+e.nt.x,s+e.nt.y),this.zi))s+=e.mt.height+this.Ss.height;else n+=e.mt.width+this.Ss.width}}}YN(t,e,i){if(null===t)return;t.x=e,t.y=i;const n=t.children,s=n.length;for(let o=0;o<s;o++){const t=n[o];this.YN(t,e+t.V.x,i+t.V.y)}}commitLayout(){this.zy(),this.commitNodes(),this.EN(),this.isRouting&&this.commitLinks()}commitNodes(){const t=this.network.vertexes.iterator;for(;t.next();)t.value.commit();for(t.reset();t.next();){const e=t.value;this.layoutComments(e)}}EN(){if(62!==this.layerStyle)return;const t=this.VN,e=[];let i=null;const n=this.network.vertexes.iterator;for(;n.next();){const t=n.value;null===i?i=t.bounds.copy():i.unionRect(t.bounds);let s=e[t.level];s=void 0===s?this.computeLayerSpacing(t):Math.max(s,this.computeLayerSpacing(t)),e[t.level]=s}for(let l=0;l<e.length;l++)void 0===e[l]&&(e[l]=0);let s;90===this.angle||270===this.angle?(i.inflate(this.nodeSpacing/2,this.layerSpacing),s=new T(-this.nodeSpacing/2,-this.layerSpacing/2)):(i.inflate(this.layerSpacing,this.nodeSpacing/2),s=new T(-this.layerSpacing/2,-this.nodeSpacing/2));const o=[],r=90===this.angle||270===this.angle?i.width:i.height;let a=0;if(180===this.angle||270===this.angle)for(let l=0;l<t.length;l++)a+=t[l]+e[l];for(let l=0;l<t.length;l++){const i=t[l]+e[l];270===this.angle?(a-=i,o.push(new D(0,a,r,i))):90===this.angle?(o.push(new D(0,a,r,i)),a+=i):180===this.angle?(a-=i,o.push(new D(a,0,i,r))):(o.push(new D(a,0,i,r)),a+=i)}this.commitLayers(o,s)}commitLayers(t,e){}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}zy(){const t=this.Ri.iterator;for(;t.next();){const e=t.value;e instanceof Ri&&this.yD(e)}}yD(t){if(null===t)return;this.setPortSpots(t);const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.yD(t)}}setPortSpots(t){const e=t.alignment;if(this.isBusAlignment(e))this.XI(t,e);else{const e=this.orthoAngle(t);if(1===this.cs){const i=t.destinationEdges;for(;i.next();){const n=i.value.link;if(null!==n){if(t.setsPortSpot)if(t.portSpot.isDefault())switch(e){case 0:n.fromSpot=O.MiddleRight;break;case 90:n.fromSpot=O.MiddleBottom;break;case 180:n.fromSpot=O.MiddleLeft;break;default:n.fromSpot=O.MiddleTop}else n.fromSpot=t.portSpot;if(t.setsChildPortSpot)if(t.childPortSpot.isDefault())switch(e){case 0:n.toSpot=O.MiddleLeft;break;case 90:n.toSpot=O.MiddleTop;break;case 180:n.toSpot=O.MiddleRight;break;default:n.toSpot=O.MiddleBottom}else n.toSpot=t.childPortSpot}}}else{const i=t.sourceEdges;for(;i.next();){const n=i.value.link;if(null!==n){if(t.setsPortSpot)if(t.portSpot.isDefault())switch(e){case 0:n.toSpot=O.MiddleRight;break;case 90:n.toSpot=O.MiddleBottom;break;case 180:n.toSpot=O.MiddleLeft;break;default:n.toSpot=O.MiddleTop}else n.toSpot=t.portSpot;if(t.setsChildPortSpot)if(t.childPortSpot.isDefault())switch(e){case 0:n.fromSpot=O.MiddleLeft;break;case 90:n.fromSpot=O.MiddleTop;break;case 180:n.fromSpot=O.MiddleRight;break;default:n.fromSpot=O.MiddleBottom}else n.fromSpot=t.childPortSpot}}}}}XI(t,e){const i=1===this.cs,n=this.orthoAngle(t);let s;switch(n){case 0:s=O.MiddleRight;break;case 90:s=O.MiddleBottom;break;case 180:s=O.MiddleLeft;break;default:s=O.MiddleTop}const o=t.children,r=o.length;switch(e){case 24:case 25:for(let e=0;e<r;e++){const a=o[e],l=(i?a.sourceEdges:a.destinationEdges).first();if(null===l)continue;const h=l.link;if(null!==h){let o=90===n||270===n?O.MiddleLeft:O.MiddleTop;if(1===r||e===r-1&&r%2===1)switch(n){case 0:o=O.MiddleLeft;break;case 90:o=O.MiddleTop;break;case 180:o=O.MiddleRight;break;default:o=O.MiddleBottom}else e%2===0&&(o=90===n||270===n?O.MiddleRight:O.MiddleBottom);i?(t.setsPortSpot&&(h.fromSpot=s),t.setsChildPortSpot&&(h.toSpot=o)):(t.setsPortSpot&&(h.fromSpot=o),t.setsChildPortSpot&&(h.toSpot=s))}}break;case 26:{const e=90===n||270===n?O.MiddleRight:O.MiddleBottom,o=i?t.destinationEdges:t.sourceEdges;for(;o.next();){const n=o.value.link;null!==n&&(i?(t.setsPortSpot&&(n.fromSpot=s),t.setsChildPortSpot&&(n.toSpot=e)):(t.setsPortSpot&&(n.fromSpot=e),t.setsChildPortSpot&&(n.toSpot=s)))}break}case 27:{const e=90===n||270===n?O.MiddleLeft:O.MiddleTop,o=i?t.destinationEdges:t.sourceEdges;for(;o.next();){const n=o.value.link;null!==n&&(i?(t.setsPortSpot&&(n.fromSpot=s),t.setsChildPortSpot&&(n.toSpot=e)):(t.setsPortSpot&&(n.fromSpot=e),t.setsChildPortSpot&&(n.toSpot=s)))}break}}}orthoAngle(t){const e=t.angle;return e<=45?0:e<=135?90:e<=225?180:e<=315?270:0}computeLayerSpacing(t){const e=this.orthoAngle(t),i=90===e||270===e;let n=t.layerSpacing;if(t.layerSpacingParentOverlap>0){const e=Math.min(1,t.layerSpacingParentOverlap);n-=i?t.height*e:t.width*e}return n<(i?-t.height:-t.width)&&(n=i?-t.height:-t.width),n}computeNodeIndent(t){const e=this.orthoAngle(t),i=90===e||270===e;let n=t.nodeIndent;if(t.nodeIndentPastParent>0){const e=Math.min(1,t.nodeIndentPastParent);n+=i?t.width*e:t.height*e}return n=Math.max(0,n),n}get roots(){return this.Ri}set roots(t){this.Ri!==t&&(this.Ri=t,this.invalidateLayout())}get path(){return this.Di}set path(t){this.Di!==t&&(this.Di=t,this.invalidateLayout())}get treeStyle(){return this.Zf}set treeStyle(t){this.Zf!==t&&(40===t||42===t||41===t||43===t)&&(this.Zf=t,this.invalidateLayout())}get layerStyle(){return this.Rg}set layerStyle(t){this.Rg!==t&&(60===t||61===t||62===t)&&(this.Rg=t,this.invalidateLayout())}get comments(){return this.Ie}set comments(t){this.Ie!==t&&(d.i(t,"boolean",Fi,"comments"),this.Ie=t,this.invalidateLayout())}get arrangement(){return this.zi}set arrangement(t){this.zi!==t&&(50===t||51===t||52===t)&&(this.zi=t,this.invalidateLayout())}get arrangementSpacing(){return this.Ss}set arrangementSpacing(t){this.Ss.equals(t)||(this.Ss.a(t),this.invalidateLayout())}get rootDefaults(){return this.B}set rootDefaults(t){this.B!==t&&(this.B=t,this.invalidateLayout())}get alternateDefaults(){return this.z}set alternateDefaults(t){this.z!==t&&(this.z=t,this.invalidateLayout())}get sorting(){return this.B.sorting}set sorting(t){this.B.sorting!==t&&(this.B.sorting=t,this.invalidateLayout())}get comparer(){return this.B.comparer}set comparer(t){this.B.comparer!==t&&(d.i(t,"function",Fi,"comparer"),this.B.comparer=t,this.invalidateLayout())}get angle(){return this.B.angle}set angle(t){this.B.angle!==t&&(d.i(t,"number",Fi,"angle"),0===t||90===t||180===t||270===t?(this.B.angle=t,this.invalidateLayout()):d.o("TreeLayout.angle must be 0, 90, 180, or 270"))}get alignment(){return this.B.alignment}set alignment(t){this.B.alignment!==t&&(this.B.alignment=t,this.invalidateLayout())}get nodeIndent(){return this.B.nodeIndent}set nodeIndent(t){this.B.nodeIndent!==t&&(d.i(t,"number",Fi,"nodeIndent"),t>=0&&(this.B.nodeIndent=t,this.invalidateLayout()))}get nodeIndentPastParent(){return this.B.nodeIndentPastParent}set nodeIndentPastParent(t){this.B.nodeIndentPastParent!==t&&(d.i(t,"number",Fi,"nodeIndentPastParent"),t>=0&&t<=1&&(this.B.nodeIndentPastParent=t,this.invalidateLayout()))}get nodeSpacing(){return this.B.nodeSpacing}set nodeSpacing(t){this.B.nodeSpacing!==t&&(d.i(t,"number",Fi,"nodeSpacing"),this.B.nodeSpacing=t,this.invalidateLayout())}get layerSpacing(){return this.B.layerSpacing}set layerSpacing(t){this.B.layerSpacing!==t&&(d.i(t,"number",Fi,"layerSpacing"),this.B.layerSpacing=t,this.invalidateLayout())}get layerSpacingParentOverlap(){return this.B.layerSpacingParentOverlap}set layerSpacingParentOverlap(t){this.B.layerSpacingParentOverlap!==t&&(d.i(t,"number",Fi,"layerSpacingParentOverlap"),t>=0&&t<=1&&(this.B.layerSpacingParentOverlap=t,this.invalidateLayout()))}get compaction(){return this.B.compaction}set compaction(t){this.B.compaction!==t&&(30===t||31===t)&&(this.B.compaction=t,this.invalidateLayout())}get breadthLimit(){return this.B.breadthLimit}set breadthLimit(t){this.B.breadthLimit!==t&&(d.i(t,"number",Fi,"breadthLimit"),t>=0&&(this.B.breadthLimit=t,this.invalidateLayout()))}get rowSpacing(){return this.B.rowSpacing}set rowSpacing(t){this.B.rowSpacing!==t&&(d.i(t,"number",Fi,"rowSpacing"),this.B.rowSpacing=t,this.invalidateLayout())}get rowIndent(){return this.B.rowIndent}set rowIndent(t){this.B.rowIndent!==t&&(d.i(t,"number",Fi,"rowIndent"),t>=0&&(this.B.rowIndent=t,this.invalidateLayout()))}get commentSpacing(){return this.B.commentSpacing}set commentSpacing(t){this.B.commentSpacing!==t&&(d.i(t,"number",Fi,"commentSpacing"),this.B.commentSpacing=t,this.invalidateLayout())}get commentMargin(){return this.B.commentMargin}set commentMargin(t){this.B.commentMargin!==t&&(d.i(t,"number",Fi,"commentMargin"),this.B.commentMargin=t,this.invalidateLayout())}get setsPortSpot(){return this.B.setsPortSpot}set setsPortSpot(t){this.B.setsPortSpot!==t&&(d.i(t,"boolean",Fi,"setsPortSpot"),this.B.setsPortSpot=t,this.invalidateLayout())}get portSpot(){return this.B.portSpot}set portSpot(t){this.B.portSpot.equals(t)||(this.B.portSpot=t,this.invalidateLayout())}get setsChildPortSpot(){return this.B.setsChildPortSpot}set setsChildPortSpot(t){this.B.setsChildPortSpot!==t&&(d.i(t,"boolean",Fi,"setsChildPortSpot"),this.B.setsChildPortSpot=t,this.invalidateLayout())}get childPortSpot(){return this.B.childPortSpot}set childPortSpot(t){this.B.childPortSpot.equals(t)||(this.B.childPortSpot=t,this.invalidateLayout())}get alternateSorting(){return this.z.sorting}set alternateSorting(t){this.z.sorting!==t&&(this.z.sorting=t,this.invalidateLayout())}get alternateComparer(){return this.z.comparer}set alternateComparer(t){this.z.comparer!==t&&(d.i(t,"function",Fi,"alternateComparer"),this.z.comparer=t,this.invalidateLayout())}get alternateAngle(){return this.z.angle}set alternateAngle(t){this.z.angle!==t&&(d.i(t,"number",Fi,"alternateAngle"),(0===t||90===t||180===t||270===t)&&(this.z.angle=t,this.invalidateLayout()))}get alternateAlignment(){return this.z.alignment}set alternateAlignment(t){this.z.alignment!==t&&(this.z.alignment=t,this.invalidateLayout())}get alternateNodeIndent(){return this.z.nodeIndent}set alternateNodeIndent(t){this.z.nodeIndent!==t&&(d.i(t,"number",Fi,"alternateNodeIndent"),t>=0&&(this.z.nodeIndent=t,this.invalidateLayout()))}get alternateNodeIndentPastParent(){return this.z.nodeIndentPastParent}set alternateNodeIndentPastParent(t){this.z.nodeIndentPastParent!==t&&(d.i(t,"number",Fi,"alternateNodeIndentPastParent"),t>=0&&t<=1&&(this.z.nodeIndentPastParent=t,this.invalidateLayout()))}get alternateNodeSpacing(){return this.z.nodeSpacing}set alternateNodeSpacing(t){this.z.nodeSpacing!==t&&(d.i(t,"number",Fi,"alternateNodeSpacing"),this.z.nodeSpacing=t,this.invalidateLayout())}get alternateLayerSpacing(){return this.z.layerSpacing}set alternateLayerSpacing(t){this.z.layerSpacing!==t&&(d.i(t,"number",Fi,"alternateLayerSpacing"),this.z.layerSpacing=t,this.invalidateLayout())}get alternateLayerSpacingParentOverlap(){return this.z.layerSpacingParentOverlap}set alternateLayerSpacingParentOverlap(t){this.z.layerSpacingParentOverlap!==t&&(d.i(t,"number",Fi,"alternateLayerSpacingParentOverlap"),t>=0&&t<=1&&(this.z.layerSpacingParentOverlap=t,this.invalidateLayout()))}get alternateCompaction(){return this.z.compaction}set alternateCompaction(t){this.z.compaction!==t&&(30===t||31===t)&&(this.z.compaction=t,this.invalidateLayout())}get alternateBreadthLimit(){return this.z.breadthLimit}set alternateBreadthLimit(t){this.z.breadthLimit!==t&&(d.i(t,"number",Fi,"alternateBreadthLimit"),t>=0&&(this.z.breadthLimit=t,this.invalidateLayout()))}get alternateRowSpacing(){return this.z.rowSpacing}set alternateRowSpacing(t){this.z.rowSpacing!==t&&(d.i(t,"number",Fi,"alternateRowSpacing"),this.z.rowSpacing=t,this.invalidateLayout())}get alternateRowIndent(){return this.z.rowIndent}set alternateRowIndent(t){this.z.rowIndent!==t&&(d.i(t,"number",Fi,"alternateRowIndent"),t>=0&&(this.z.rowIndent=t,this.invalidateLayout()))}get alternateCommentSpacing(){return this.z.commentSpacing}set alternateCommentSpacing(t){this.z.commentSpacing!==t&&(d.i(t,"number",Fi,"alternateCommentSpacing"),this.z.commentSpacing=t,this.invalidateLayout())}get alternateCommentMargin(){return this.z.commentMargin}set alternateCommentMargin(t){this.z.commentMargin!==t&&(d.i(t,"number",Fi,"alternateCommentMargin"),this.z.commentMargin=t,this.invalidateLayout())}get alternateSetsPortSpot(){return this.z.setsPortSpot}set alternateSetsPortSpot(t){this.z.setsPortSpot!==t&&(d.i(t,"boolean",Fi,"alternateSetsPortSpot"),this.z.setsPortSpot=t,this.invalidateLayout())}get alternatePortSpot(){return this.z.portSpot}set alternatePortSpot(t){this.z.portSpot.equals(t)||(this.z.portSpot=t,this.invalidateLayout())}get alternateSetsChildPortSpot(){return this.z.setsChildPortSpot}set alternateSetsChildPortSpot(t){this.z.setsChildPortSpot!==t&&(d.i(t,"boolean",Fi,"alternateSetsChildPortSpot"),this.z.setsChildPortSpot=t,this.invalidateLayout())}get alternateChildPortSpot(){return this.z.childPortSpot}set alternateChildPortSpot(t){this.z.childPortSpot.equals(t)||(this.z.childPortSpot=t,this.invalidateLayout())}}y(Fi,"PathDefault",0),y(Fi,"PathDestination",1),y(Fi,"PathSource",2),y(Fi,"SortingForwards",10),y(Fi,"SortingReverse",11),y(Fi,"SortingAscending",12),y(Fi,"SortingDescending",13),y(Fi,"AlignmentCenterSubtrees",20),y(Fi,"AlignmentCenterChildren",21),y(Fi,"AlignmentStart",22),y(Fi,"AlignmentEnd",23),y(Fi,"AlignmentBus",24),y(Fi,"AlignmentBusBranching",25),y(Fi,"AlignmentTopLeftBus",26),y(Fi,"AlignmentBottomRightBus",27),y(Fi,"CompactionNone",30),y(Fi,"CompactionBlock",31),y(Fi,"StyleLayered",40),y(Fi,"StyleLastParents",41),y(Fi,"StyleAlternating",42),y(Fi,"StyleRootOnly",43),y(Fi,"ArrangementVertical",50),y(Fi,"ArrangementHorizontal",51),y(Fi,"ArrangementFixedRoots",52),y(Fi,"LayerIndividual",60),y(Fi,"LayerSiblings",61),y(Fi,"LayerUniform",62);class Oi extends Ue{constructor(t){super(t)}createVertex(){return new Ri(this)}createEdge(){return new Ei(this)}}class Ri extends Ke{constructor(t){super(t),y(this,"V",void 0),y(this,"mt",void 0),y(this,"nt",void 0),y(this,"dk",void 0),y(this,"gk",void 0),y(this,"mk",void 0),y(this,"pk",void 0),y(this,"yk",void 0),y(this,"wk",void 0),y(this,"xk",void 0),y(this,"Ie",void 0),y(this,"wD",void 0),y(this,"Qf",void 0),y(this,"_f",void 0),y(this,"vg",void 0),y(this,"Og",void 0),y(this,"xe",void 0),y(this,"be",void 0),y(this,"Xt",void 0),y(this,"oi",void 0),y(this,"$y",void 0),y(this,"Zy",void 0),y(this,"Qy",void 0),y(this,"Ns",void 0),y(this,"_y",void 0),y(this,"tw",void 0),y(this,"iw",void 0),y(this,"ew",void 0),y(this,"sw",void 0),y(this,"nw",void 0),y(this,"ow",void 0),y(this,"rw",void 0),y(this,"lw",void 0),y(this,"hw",void 0),y(this,"aw",void 0),this.dk=!1,this.gk=null,this.mk=[],this.pk=0,this.yk=0,this.wk=0,this.xk=0,this.Ie=null,this.V=new T(0,0),this.mt=new A(0,0),this.nt=new T(0,0),this.wD=!1,this.Qf=!1,this._f=!1,this.vg=null,this.Og=null,this.xe=10,this.be=Ke.standardComparer,this.Xt=0,this.oi=21,this.$y=0,this.Zy=0,this.Qy=20,this.Ns=50,this._y=0,this.tw=31,this.iw=0,this.ew=25,this.sw=10,this.nw=10,this.ow=20,this.rw=!0,this.lw=O.Default,this.hw=!0,this.aw=O.Default}copyInheritedPropertiesFrom(t){null!==t&&(this.xe=t.sorting,this.be=t.comparer,this.Xt=t.angle,this.oi=t.alignment,this.$y=t.nodeIndent,this.Zy=t.nodeIndentPastParent,this.Qy=t.nodeSpacing,this.Ns=t.layerSpacing,this._y=t.layerSpacingParentOverlap,this.tw=t.compaction,this.iw=t.breadthLimit,this.ew=t.rowSpacing,this.sw=t.rowIndent,this.nw=t.commentSpacing,this.ow=t.commentMargin,this.rw=t.setsPortSpot,this.lw=t.portSpot,this.hw=t.setsChildPortSpot,this.aw=t.childPortSpot)}get initialized(){return this.dk}set initialized(t){this.dk!==t&&(d.i(t,"boolean",Ri,"initialized"),this.dk=t)}get parent(){return this.gk}set parent(t){this.gk!==t&&(this.gk=t)}get children(){return this.mk}set children(t){if(this.mk!==t){if(null!==t&&!Array.isArray(t)&&d.ke(t,"Array",Ri,"children:value"),null!==t){const e=t.length;for(let i=0;i<e;i++){t[i]}}this.mk=t}}get level(){return this.pk}set level(t){this.pk!==t&&(d.i(t,"number",Ri,"level"),this.pk=t)}get descendantCount(){return this.yk}set descendantCount(t){this.yk!==t&&(d.i(t,"number",Ri,"descendantCount"),this.yk=t)}get maxChildrenCount(){return this.wk}set maxChildrenCount(t){this.wk!==t&&(d.i(t,"number",Ri,"maxChildrenCount"),this.wk=t)}get maxGenerationCount(){return this.xk}set maxGenerationCount(t){this.xk!==t&&(d.i(t,"number",Ri,"maxGenerationCount"),this.xk=t)}get comments(){return this.Ie}set comments(t){if(this.Ie!==t){if(null!==t&&!Array.isArray(t)&&d.ke(t,"Array",Ri,"comments:value"),null!==t){const e=t.length;for(let i=0;i<e;i++){t[i]}}this.Ie=t}}get sorting(){return this.xe}set sorting(t){this.xe!==t&&(this.xe=t)}get comparer(){return this.be}set comparer(t){this.be!==t&&(d.i(t,"function",Ri,"comparer"),this.be=t)}get angle(){return this.Xt}set angle(t){this.Xt!==t&&(d.i(t,"number",Ri,"angle"),this.Xt=t)}get alignment(){return this.oi}set alignment(t){this.oi!==t&&(this.oi=t)}get nodeIndent(){return this.$y}set nodeIndent(t){this.$y!==t&&(d.i(t,"number",Ri,"nodeIndent"),this.$y=t)}get nodeIndentPastParent(){return this.Zy}set nodeIndentPastParent(t){this.Zy!==t&&(d.i(t,"number",Ri,"nodeIndentPastParent"),this.Zy=t)}get nodeSpacing(){return this.Qy}set nodeSpacing(t){this.Qy!==t&&(d.i(t,"number",Ri,"nodeSpacing"),this.Qy=t)}get layerSpacing(){return this.Ns}set layerSpacing(t){this.Ns!==t&&(d.i(t,"number",Ri,"layerSpacing"),this.Ns=t)}get layerSpacingParentOverlap(){return this._y}set layerSpacingParentOverlap(t){this._y!==t&&(d.i(t,"number",Ri,"layerSpacingParentOverlap"),this._y=t)}get compaction(){return this.tw}set compaction(t){this.tw!==t&&(this.tw=t)}get breadthLimit(){return this.iw}set breadthLimit(t){this.iw!==t&&(d.i(t,"number",Ri,"breadthLimit"),this.iw=t)}get rowSpacing(){return this.ew}set rowSpacing(t){this.ew!==t&&(d.i(t,"number",Ri,"rowSpacing"),this.ew=t)}get rowIndent(){return this.sw}set rowIndent(t){this.sw!==t&&(d.i(t,"number",Ri,"rowIndent"),this.sw=t)}get commentSpacing(){return this.nw}set commentSpacing(t){this.nw!==t&&(d.i(t,"number",Ri,"commentSpacing"),this.nw=t)}get commentMargin(){return this.ow}set commentMargin(t){this.ow!==t&&(d.i(t,"number",Ri,"commentMargin"),this.ow=t)}get setsPortSpot(){return this.rw}set setsPortSpot(t){this.rw!==t&&(d.i(t,"boolean",Ri,"setsPortSpot"),this.rw=t)}get portSpot(){return this.lw}set portSpot(t){this.lw.equals(t)||(this.lw=t)}get setsChildPortSpot(){return this.hw}set setsChildPortSpot(t){this.hw!==t&&(d.i(t,"boolean",Ri,"setsChildPortSpot"),this.hw=t)}get childPortSpot(){return this.aw}set childPortSpot(t){this.aw.equals(t)||(this.aw=t)}get childrenCount(){return this.children.length}get relativePosition(){return this.V}set relativePosition(t){this.V.set(t)}get subtreeSize(){return this.mt}set subtreeSize(t){this.mt.set(t)}get subtreeOffset(){return this.nt}set subtreeOffset(t){this.nt.set(t)}}class Ei extends Ge{constructor(t){super(t),y(this,"bk",void 0),this.bk=new T(0,0)}commit(){const t=this.link;if(null===t||t.isAvoiding)return;const e=this.network.layout;let i=null,n=null;switch(e.cs){case 1:i=this.fromVertex,n=this.toVertex;break;case 2:i=this.toVertex,n=this.fromVertex;break;default:d.o("Unhandled path value "+e.cs.toString())}if(null===i||null===n)return;const s=this.bk;if(0===s.x&&0===s.y&&!i.wD)return void this.KI(i,n);const o=i.bounds,r=e.orthoAngle(i),a=e.computeLayerSpacing(i),l=i.rowSpacing;t.updateRoute();const h=9===t.curve,u=t.isOrthogonal;let c,f,g=0;if(t.startRoute(),u||h){for(g=2;t.pointsCount>4;)t.removePoint(2);c=t.getPoint(1),f=t.getPoint(2)}else{for(g=1;t.pointsCount>3;)t.removePoint(1);c=t.getPoint(0),f=t.getPoint(t.pointsCount-1)}const m=t.getPoint(t.pointsCount-1);let p=0;0===r?(23===i.alignment?(p=o.bottom+s.y,0===s.y&&c.y>m.y+i.rowIndent&&(p=Math.min(p,Math.max(c.y,p-e.computeNodeIndent(i))))):22===i.alignment?(p=o.top+s.y,0===s.y&&c.y<m.y-i.rowIndent&&(p=Math.max(p,Math.min(c.y,p+e.computeNodeIndent(i))))):p=i.Qf||i._f&&1===i.maxGenerationCount?o.top-i.nt.y+s.y:o.y+o.height/2+s.y,h?(t.insertPointAt(g,c.x,p),g++,t.insertPointAt(g,o.right+a,p),g++,t.insertPointAt(g,o.right+a+(s.x-l)/3,p),g++,t.insertPointAt(g,o.right+a+2*(s.x-l)/3,p),g++,t.insertPointAt(g,o.right+a+(s.x-l),p),g++,t.insertPointAt(g,f.x,p),g++):(u&&(t.insertPointAt(g,o.right+a/2,c.y),g++),t.insertPointAt(g,o.right+a/2,p),g++,t.insertPointAt(g,o.right+a+s.x-(u?l/2:l),p),g++,u&&(t.insertPointAt(g,t.getPoint(g-1).x,f.y),g++))):90===r?(23===i.alignment?(p=o.right+s.x,0===s.x&&c.x>m.x+i.rowIndent&&(p=Math.min(p,Math.max(c.x,p-e.computeNodeIndent(i))))):22===i.alignment?(p=o.left+s.x,0===s.x&&c.x<m.x-i.rowIndent&&(p=Math.max(p,Math.min(c.x,p+e.computeNodeIndent(i))))):p=i.Qf||i._f&&1===i.maxGenerationCount?o.left-i.nt.x+s.x:o.x+o.width/2+s.x,h?(t.insertPointAt(g,p,c.y),g++,t.insertPointAt(g,p,o.bottom+a),g++,t.insertPointAt(g,p,o.bottom+a+(s.y-l)/3),g++,t.insertPointAt(g,p,o.bottom+a+2*(s.y-l)/3),g++,t.insertPointAt(g,p,o.bottom+a+(s.y-l)),g++,t.insertPointAt(g,p,f.y),g++):(u&&(t.insertPointAt(g,c.x,o.bottom+a/2),g++),t.insertPointAt(g,p,o.bottom+a/2),g++,t.insertPointAt(g,p,o.bottom+a+s.y-(u?l/2:l)),g++,u&&(t.insertPointAt(g,f.x,t.getPoint(g-1).y),g++))):180===r?(23===i.alignment?(p=o.bottom+s.y,0===s.y&&c.y>m.y+i.rowIndent&&(p=Math.min(p,Math.max(c.y,p-e.computeNodeIndent(i))))):22===i.alignment?(p=o.top+s.y,0===s.y&&c.y<m.y-i.rowIndent&&(p=Math.max(p,Math.min(c.y,p+e.computeNodeIndent(i))))):p=i.Qf||i._f&&1===i.maxGenerationCount?o.top-i.nt.y+s.y:o.y+o.height/2+s.y,h?(t.insertPointAt(g,c.x,p),g++,t.insertPointAt(g,o.left-a,p),g++,t.insertPointAt(g,o.left-a+(s.x+l)/3,p),g++,t.insertPointAt(g,o.left-a+2*(s.x+l)/3,p),g++,t.insertPointAt(g,o.left-a+(s.x+l),p),g++,t.insertPointAt(g,f.x,p),g++):(u&&(t.insertPointAt(g,o.left-a/2,c.y),g++),t.insertPointAt(g,o.left-a/2,p),g++,t.insertPointAt(g,o.left-a+s.x+(u?l/2:l),p),g++,u&&(t.insertPointAt(g,t.getPoint(g-1).x,f.y),g++))):270===r?(23===i.alignment?(p=o.right+s.x,0===s.x&&c.x>m.x+i.rowIndent&&(p=Math.min(p,Math.max(c.x,p-e.computeNodeIndent(i))))):22===i.alignment?(p=o.left+s.x,0===s.x&&c.x<m.x-i.rowIndent&&(p=Math.max(p,Math.min(c.x,p+e.computeNodeIndent(i))))):p=i.Qf||i._f&&1===i.maxGenerationCount?o.left-i.nt.x+s.x:o.x+o.width/2+s.x,h?(t.insertPointAt(g,p,c.y),g++,t.insertPointAt(g,p,o.top-a),g++,t.insertPointAt(g,p,o.top-a+(s.y+l)/3),g++,t.insertPointAt(g,p,o.top-a+2*(s.y+l)/3),g++,t.insertPointAt(g,p,o.top-a+(s.y+l)),g++,t.insertPointAt(g,p,f.y),g++):(u&&(t.insertPointAt(g,c.x,o.top-a/2),g++),t.insertPointAt(g,p,o.top-a/2),g++,t.insertPointAt(g,p,o.top-a+s.y+(u?l/2:l)),g++,u&&(t.insertPointAt(g,f.x,t.getPoint(g-1).y),g++))):d.o("Invalid angle "+r),t.commitRoute()}KI(t,e){const i=this.link,n=this.network.layout,s=n.orthoAngle(t);if(s===n.orthoAngle(e))return;const o=n.computeLayerSpacing(t),r=t.bounds,a=e.bounds;if(0===s&&a.left-r.right<o+1||90===s&&a.top-r.bottom<o+1||180===s&&r.left-a.right<o+1||270===s&&r.top-a.bottom<o+1)return;i.updateRoute();const l=9===i.curve,h=i.isOrthogonal,u=this.fromVertex,c=n.isBusAlignment(u.alignment);if(i.startRoute(),0===s){const t=r.right+o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).y;i.setPointAt(1,t-20,i.getPoint(1).y),i.insertPointAt(2,t-20,e),i.insertPointAt(3,t,e),i.insertPointAt(4,t+20,e),i.setPointAt(5,i.getPoint(5).x,e)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,t,i.getPoint(2).y),i.setPointAt(3,t,i.getPoint(3).y)):4===i.pointsCount?i.insertPointAt(2,t,i.getPoint(2).y):3===i.pointsCount?i.setPointAt(1,t,i.getPoint(2).y):2===i.pointsCount&&i.insertPointAt(1,t,i.getPoint(1).y)}else if(90===s){const t=r.bottom+o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).x;i.setPointAt(1,i.getPoint(1).x,t-20),i.insertPointAt(2,e,t-20),i.insertPointAt(3,e,t),i.insertPointAt(4,e,t+20),i.setPointAt(5,e,i.getPoint(5).y)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,i.getPoint(2).x,t),i.setPointAt(3,i.getPoint(3).x,t)):4===i.pointsCount?i.insertPointAt(2,i.getPoint(2).x,t):3===i.pointsCount?i.setPointAt(1,i.getPoint(2).x,t):2===i.pointsCount&&i.insertPointAt(1,i.getPoint(1).x,t)}else if(180===s){const t=r.left-o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).y;i.setPointAt(1,t+20,i.getPoint(1).y),i.insertPointAt(2,t+20,e),i.insertPointAt(3,t,e),i.insertPointAt(4,t-20,e),i.setPointAt(5,i.getPoint(5).x,e)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,t,i.getPoint(2).y),i.setPointAt(3,t,i.getPoint(3).y)):4===i.pointsCount?i.insertPointAt(2,t,i.getPoint(2).y):3===i.pointsCount?i.setPointAt(1,t,i.getPoint(2).y):2===i.pointsCount&&i.insertPointAt(1,t,i.getPoint(1).y)}else if(270===s){const t=r.top-o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).x;i.setPointAt(1,i.getPoint(1).x,t+20),i.insertPointAt(2,e,t+20),i.insertPointAt(3,e,t),i.insertPointAt(4,e,t-20),i.setPointAt(5,e,i.getPoint(5).y)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,i.getPoint(2).x,t),i.setPointAt(3,i.getPoint(3).x,t)):4===i.pointsCount?i.insertPointAt(2,i.getPoint(2).x,t):3===i.pointsCount?i.setPointAt(1,i.getPoint(2).x,t):2===i.pointsCount&&i.insertPointAt(1,i.getPoint(1).x,t)}i.commitRoute()}get fromVertex(){return this.$e}set fromVertex(t){this.$e!==t&&(this.$e=t)}get toVertex(){return this.Ze}set toVertex(t){this.Ze!==t&&(this.Ze=t)}get relativePoint(){return this.bk}set relativePoint(t){this.bk.set(t)}}class Bi{constructor(){}}y(Bi,"Light",{colors:{text:"#0a0a0a",comment:"#ca8a04",link:"#0a0a0a",group:"#a3a3a344",outline:"#a3a3a3",selection:"#0ea5e9",div:"#fff",gridMinor:"#e5e5e5",gridMajor:"#a3a3a3",overviewBox:"#c026d3",tempLink:"#2563eb",tempPort:"#c026d3",adornmentFill:"#0ea5e9",adornmentStroke:"#1e40af",dragSelect:"#c026d3"},fonts:{normal:"10pt sans-serif",bold:"bold 12pt sans-serif"},numbers:{group:1,selection:3},margins:{group:new F(5)},arrowheads:{toArrow:"Standard"}}),y(Bi,"Dark",{colors:{text:"#f5f5f5",comment:"#facc15",link:"#f5f5f5",group:"#a3a3a388",outline:"#a3a3a3",selection:"#38bdf8",div:"#171717",gridMinor:"#262626",gridMajor:"#404040",overviewBox:"#e879f9",tempLink:"#60a5fa",tempPort:"#e879f9",adornmentFill:"#38bdf8",adornmentStroke:"#2563eb",dragSelect:"#e879f9"},fonts:{normal:"10pt sans-serif",bold:"bold 12pt sans-serif"},numbers:{group:1,selection:3},margins:{group:new F(5)},arrowheads:{toArrow:"Standard"}});class Ii{constructor(t){y(this,"ns",new Set),y(this,"iu",new L),y(this,"kk","light"),y(this,"Pk","light"),y(this,"Mk",!1),y(this,"Ig","light"),y(this,"xD",(t=>{const e=t.matches?"dark":"light";e!==this.Ig&&(this.Ig=e,"system"===this.Pk&&this.cw())})),t&&Object.assign(this,t),null!==t&&void 0!==t&&t.themeMap||(this.iu.set("light",{colors:{...Bi.Light.colors},fonts:{...Bi.Light.fonts},numbers:{...Bi.Light.numbers},margins:{...Bi.Light.margins},arrowheads:{...Bi.Light.arrowheads}}),this.iu.set("dark",{colors:{...Bi.Dark.colors},fonts:{...Bi.Dark.fonts},numbers:{...Bi.Dark.numbers},margins:{...Bi.Dark.margins},arrowheads:{...Bi.Dark.arrowheads}})),c.matchMedia&&(this.Ig=c.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}get themeMap(){return this.iu}set themeMap(t){this.iu!==t&&(this.iu=t,this.cw())}get defaultTheme(){return this.kk}set defaultTheme(t){this.kk!==t&&(d.i(t,"string",Ii,"defaultTheme"),this.kk=t,this.cw())}get currentTheme(){return this.Pk}set currentTheme(t){this.Pk!==t&&(d.i(t,"string",Ii,"currentTheme"),this.Pk=t,this.cw())}get changesDivBackground(){return this.Mk}set changesDivBackground(t){if(this.Mk!==t&&(this.Mk=t,t))for(const e of this.ns)e.setDivBackground(this.findValue("div","","fill")),e.v("ThemeChanged",this)}get preferredColorScheme(){return this.Ig}addDiagram(t){return this.ns.add(t),this.GN(t),this}removeDiagram(t){return this.ns.delete(t),this.GN(t),this}UF(){var t;0===this.ns.size&&c.matchMedia&&(null===(t=c.matchMedia("(prefers-color-scheme: dark)"))||void 0===t||t.addEventListener("change",this.xD))}BF(){var t;0===this.ns.size&&c.matchMedia&&(null===(t=c.matchMedia("(prefers-color-scheme: dark)"))||void 0===t||t.removeEventListener("change",this.xD))}set(t,e){""===t&&(t=this.kk),"system"===t&&(t=this.Ig);let i=this.iu.get(t);return i=i?this.bD(i,e):e,this.iu.set(t,i),this.cw(),this}findValue(t,e,i){return this.getValue(this.findTheme(this.currentTheme),t,e,i)||this.getValue(this.findTheme(this.defaultTheme),t,e,i)}getValue(t,e,i,n){if(!t)return;null==i&&(i="");let s=t;const o=t=>{if(void 0===s||""===t)return;if("number"==typeof t||!Array.isArray(t)&&!t.includes("."))return s[t];const e=Array.isArray(t)?t:t.split(".");for(let i=0;i<e.length;i++){const t=e[i];if(""!==t&&(s=s[t],void 0===s))return}return s},r=()=>{if(""===i||(s=o(i),void 0!==s))return s=Array.isArray(s)&&"number"==typeof e?s[e%s.length]:o(e),s};if(s=r(),void 0===s&&"string"==typeof n&&n.length>0){var a;let e=null===(a=t.targetPropertyMap)||void 0===a?void 0:a.get(n);if(e?s=t[e]:(e=Ii.YI.get(n),s=e?t[e]:t.colors),s=r(),void 0!==s)return s}return s}findTheme(t){return this.themeMap.get("system"===t?this.Ig:t)}GN(t){const e=t.skipsUndoManager;t.skipsUndoManager=!0,t.updateAllThemeBindings(),this.Mk&&t.setDivBackground(this.findValue("div","","fill")),t.skipsUndoManager=e,t.v("ThemeChanged",this)}cw(){for(const t of this.ns)this.GN(t)}bD(t,e){for(const n in e)if(d.fw(e,n))try{var i;e[n].constructor===Object?t[n]=this.bD(null!==(i=t[n])&&void 0!==i?i:{},e[n]):t[n]=e[n]}catch{delete t[n]}return t}}y(Ii,"YI",new Map([["background","colors"],["defaultColumnSeparatorStroke","colors"],["defaultRowSeparatorStroke","colors"],["shadowColor","colors"],["fill","colors"],["stroke","colors"],["font","fonts"],["angle","numbers"],["fromEndSegmentLength","numbers"],["fromShortLength","numbers"],["height","numbers"],["opacity","numbers"],["scale","numbers"],["toEndSegmentLength","numbers"],["toShortLength","numbers"],["width","numbers"],["defaultColumnSeparatorStrokeWidth","numbers"],["defaultRowSeparatorStrokeWidth","numbers"],["shadowBlur","numbers"],["corner","numbers"],["curviness","numbers"],["smoothness","numbers"],["parameter1","numbers"],["parameter2","numbers"],["strokeWidth","numbers"],["strokeDashOffset","numbers"],["maxLines","numbers"],["spacingAbove","numbers"],["spacingBelow","numbers"],["position","points"],["shadowOffset","points"],["desiredSize","sizes"],["maxSize","sizes"],["minSize","sizes"],["margin","margins"],["defaultSeparatorPadding","margins"],["padding","margins"],["alignment","spots"],["alignmentFocus","spots"],["fromSpot","spots"],["toSpot","spots"],["defaultAlignment","spots"],["spot1","spots"],["spot2","spots"],["verticalAlignment","spots"],["imageAlignment","spots"],["fromArrow","arrowheads"],["toArrow","arrowheads"]]));class Vi{constructor(){y(this,"St",void 0),y(this,"k",void 0),y(this,"Oi",void 0),y(this,"ml",void 0),this.k=Dt.ym(),this.St="",this.Oi=!0,this.ml=!0}get name(){return this.St}set name(t){this.St=t}get isEnabled(){return this.Oi}set isEnabled(t){this.Oi=t}get isRealtime(){return this.ml}set isRealtime(t){this.ml=t}get diagram(){return this.k}set diagram(t){this.k!==t&&(this.k=t,t.Ml=!0,t.requestUpdate())}invalidateRouter(){null!==this.k&&(this.k.Ml=!0,this.k.requestUpdate())}canRoute(t){if(!this.isEnabled)return!1;const e=this.diagram;return!(e&&(!this.isRealtime&&e.pu||e.animationManager.isTicking))}routeLinks(t,e){}toString(){return""!==this.name?this.name+" Router":d.nn(this.constructor)}}class zi extends Vi{constructor(t){super(),this.name="AvoidsNodes",t&&Object.assign(this,t)}routeLinks(t,e){const i=e instanceof Dt?null:e,n=t.iterator;for(;n.next();){const t=n.value;if(!t.isAvoiding||e&&t.containingGroup!==i||null===t.toNode||null===t.fromNode||t.pointsCount<4)continue;t.startRoute();const s=t.pointsCount,o=t.getPoint(1),r=t.getPoint(s-2),a=t.fromNode.actualBounds.copy();a.inflate(De.va,De.va),a.unionPoint(t.getPoint(0));const l=t.toNode.actualBounds.copy();l.inflate(De.va,De.va),l.unionPoint(t.getPoint(s-1));const h=t.diagram.getPositions(!0,t.containingGroup,null);this.GI(t,a,l,h)&&this.HI(t,o,t._2,r,t.tN,a,l),t.commitRoute()}}GI(t,e,i,n){const s=t.diagram,o=t.pointsCount;if(null===s||t.fromNode===t.toNode||t.layer.isTemporary||e.containsPoint(t.getPoint(o-1))&&!t.toNode.isMemberOf(t.fromNode)||i.containsPoint(t.getPoint(0))&&!t.fromNode.isMemberOf(t.toNode)||!t.isOrthogonal)return!1;if(17===t.segmentIndex)return!0;const r=t.getPoint(1),a=t.getPoint(o-2),l=t.getPoint(2);if(!n.isUnoccupied(Math.min(r.x,l.x),Math.min(r.y,l.y),Math.abs(r.x-l.x),Math.abs(r.y-l.y)))return!0;for(let u=2;u<o-3;u++){const e=t.getPoint(u),i=t.getPoint(u+1);if(!n.isUnoccupied(Math.min(e.x,i.x),Math.min(e.y,i.y),Math.abs(e.x-i.x),Math.abs(e.y-i.y)))return!0}const h=t.getPoint(o-3);return!n.isUnoccupied(Math.min(h.x,a.x),Math.min(h.y,a.y),Math.abs(h.x-a.x),Math.abs(h.y-a.y))}HI(t,e,i,n,s,o,r){const a=t.diagram,l=a.getPositions(!0,t.containingGroup,null),h=e,u=n;let c=null,d=null;if(a.isVirtualized){const o=l.bounds.copy(),r=t.getPoint(2),a=t.getPoint(t.pointsCount-3);o.inflate(-l.cellWidth,-l.cellHeight);const h=T.l();l.zd(e.x,e.y)||(E.xl(o.x,o.y,o.x+o.width,o.y+o.height,e.x,e.y,r.x,r.y,h)?(c=e=h.copy(),i=h.directionPoint(r)):E.xl(o.x,o.y,o.x+o.width,o.y+o.height,r.x,r.y,a.x,a.y,h)?(c=e=h.copy(),i=h.directionPoint(a)):E.xl(o.x,o.y,o.x+o.width,o.y+o.height,a.x,a.y,n.x,n.y,h)&&(c=e=h.copy(),i=h.directionPoint(n))),l.zd(n.x,n.y)||(E.xl(o.x,o.y,o.x+o.width,o.y+o.height,n.x,n.y,a.x,a.y,h)?(d=n=h.copy(),s=a.directionPoint(h)):E.xl(o.x,o.y,o.x+o.width,o.y+o.height,a.x,a.y,r.x,r.y,h)?(d=n=h.copy(),s=r.directionPoint(h)):E.xl(o.x,o.y,o.x+o.width,o.y+o.height,r.x,r.y,e.x,e.y,h)&&(d=n=h.copy(),s=e.directionPoint(h))),T.s(h)}const f=o.copy().unionRect(r);f.inflate(l.cellWidth*l.Xc,l.cellHeight*l.Xc),l.iT(e,i,n,s,f,!0);let g=l.Wi(n.x,n.y);if(!l.by&&g>=Oe.Bd&&(l.EL(),f.inflate(l.cellWidth*l.DS,l.cellHeight*l.FS),l.iT(e,i,n,s,f,!1),g=l.Wi(n.x,n.y)),!l.by&&g<Oe.Bd&&!l.hO(n.x,n.y)){t.points.removeRange(2,t.pointsCount-3),this.Ud(t,l,n.x,n.y,s,!0);const o=0,r=90,a=180,f=270,g=t.getPoint(2);if(t.pointsCount<4)i===o||i===a?(g.x=e.x,g.y=n.y):(g.x=n.x,g.y=e.y),t.setPointAt(2,g.x,g.y),t.insertPointAt(3,g.x,g.y);else{const n=t.getPoint(3);if(i===o||i===a)if(E.u(g.x,n.x)){const s=i===o?Math.max(g.x,e.x):Math.min(g.x,e.x);t.setPointAt(2,s,e.y),t.setPointAt(3,s,n.y)}else E.u(g.y,n.y)?(Math.abs(e.y-g.y)<=l.cellHeight/2&&(t.setPointAt(2,g.x,e.y),t.setPointAt(3,n.x,e.y)),t.insertPointAt(2,g.x,e.y)):t.setPointAt(2,e.x,g.y);else if(i===r||i===f)if(E.u(g.y,n.y)){const s=i===r?Math.max(g.y,e.y):Math.min(g.y,e.y);t.setPointAt(2,e.x,s),t.setPointAt(3,n.x,s)}else E.u(g.x,n.x)?(Math.abs(e.x-g.x)<=l.cellWidth/2&&(t.setPointAt(2,e.x,g.y),t.setPointAt(3,e.x,n.y)),t.insertPointAt(2,e.x,g.y)):t.setPointAt(2,g.x,e.y)}if(null!==c){const e=t.getPoint(1),n=t.getPoint(2);e.x!==n.x&&e.y!==n.y?i===o||i===a?t.insertPointAt(2,e.x,n.y):t.insertPointAt(2,n.x,e.y):i===o||i===a?t.insertPointAt(2,h.x,c.y):t.insertPointAt(2,c.x,h.y)}null!==d&&(s===o||s===a?t.insertPointAt(t.pointsCount-2,u.x,d.y):t.insertPointAt(t.pointsCount-2,d.x,u.y))}}Ud(t,e,i,n,s,o){const r=e.cellWidth,a=e.cellHeight;let l=e.Wi(i,n),h=i,u=n,c=h,d=u;for(0===s?c+=r:90===s?d+=a:180===s?c-=r:d-=a,t.sN&&l>Oe.uo&&e.Wi(c,d)!==l-1&&(e.Wi(h-r,u)===l-1?(s=180,c=h-r,d=u):e.Wi(h+r,u)===l-1?(s=0,c=h+r,d=u):e.Wi(h,u-a)===l-1?(s=270,c=h,d=u-a):e.Wi(h,u+a)===l-1&&(s=90,c=h,d=u+a));l>Oe.uo&&e.Wi(c,d)===l-1;)h=c,u=d,0===s?c+=r:90===s?d+=a:180===s?c-=r:d-=a,l-=1;if(o?l>Oe.uo&&(180===s||0===s?h=Math.floor(h/r)*r+r/2:(90===s||270===s)&&(u=Math.floor(u/a)*a+a/2)):(h=Math.floor(h/r)*r+r/2,u=Math.floor(u/a)*a+a/2),l>Oe.uo){let i=s,n=h,o=u;if(0===s?(i=90,o+=a):90===s?(i=180,n-=r):180===s?(i=270,o-=a):270===s&&(i=0,n+=r),e.Wi(n,o)===l-1)this.Ud(t,e,n,o,i,!1);else{let n=h,o=u;0===s?(i=270,o-=a):90===s?(i=0,n+=r):180===s?(i=90,o+=a):270===s&&(i=180,n-=r),e.Wi(n,o)===l-1&&this.Ud(t,e,n,o,i,!1)}}t.insertPointAt(t.pointsCount-2,h,u)}}Z.prototype.initializeStandardTools=function(){this.$t("Action",new ht,this.mouseDownTools),this.$t("Relinking",new nt,this.mouseDownTools),this.$t("LinkReshaping",new ot,this.mouseDownTools),this.$t("Rotating",new at,this.mouseDownTools),this.$t("Resizing",new rt,this.mouseDownTools),this.$t("Linking",new it,this.mouseMoveTools),this.$t("Dragging",new Q,this.mouseMoveTools),this.$t("DragSelecting",new ct,this.mouseMoveTools),this.$t("Panning",new dt,this.mouseMoveTools),this.$t("ContextMenu",new mt,this.mouseUpTools),this.$t("TextEditing",new bt,this.mouseUpTools),this.$t("ClickCreating",new ut,this.mouseUpTools),this.$t("ClickSelecting",new lt,this.mouseUpTools)},Dt.fS("GraphLinksModel",class extends qe{SS(){const t=this.diagram.model;this.Sy(t.nodeDataArray),this.yT(t.linkDataArray)}Sy(t){super.Sy(t,!1);const e=this.links.iterator;for(;e.next();)e.value.Ad();this.diagram.xb(!1)}yT(t){t.forEach((t=>{this.wT(t)})),this.diagram.xb(!1)}wT(t){if(null==t||this.diagram.undoManager.isUndoingRedoing||this.pl.contains(t))return null;const e=this.getLinkCategoryForData(t),i=this.findLinkTemplateForCategory(e);if(null!==i){i.hi();const n=i.copy();if(null!==n){const i=this.diagram.ge;this.diagram.ge=!0,n.Wo=e,n.Qt=t;const s=this.diagram.model,o=s.C1(t,!0);""!==o&&(n.fromPortId=o);const r=s.Re(t,!0);if(void 0!==r){const t=this.findNodeForKey(r);t instanceof Ce&&(n.fromNode=t)}const a=s.C1(t,!1);""!==a&&(n.toPortId=a);const l=s.Re(t,!1);if(void 0!==l){const t=this.findNodeForKey(l);t instanceof Ce&&(n.toNode=t)}const h=s.getLabelKeysForLinkData(t);return Array.isArray(h)&&h.forEach((t=>{const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=n)})),this.My&&(n.cl="Tool"),this.diagram.add(n),n.Qt=null,n.data=t,this.diagram.ge=i,n}}return null}hT(){const t=this.diagram.model;this.xT(t.linkDataArray),this.fN(t.nodeDataArray)}xT(t){t.forEach((t=>{this.S1(t)}))}getLinkCategoryForData(t){return this.diagram.model.getCategoryForLinkData(t)}setLinkCategoryForData(t,e){return this.diagram.model.setCategoryForLinkData(t,e)}setFromNodeForLink(t,e){const i=this.diagram.model,n=null!==e?e.data:null;i.setFromKeyForLinkData(t.data,i.getKeyForNodeData(n))}setToNodeForLink(t,e){const i=this.diagram.model,n=null!==e?e.data:null;i.setToKeyForLinkData(t.data,i.getKeyForNodeData(n))}eN(t){this.diagram.model.removeLinkData(t.data)}findPartForKey(t){const e=super.findPartForKey(t);if(null===e){const e=this.diagram.model.findLinkDataForKey(t);if(null!==e)return this.pl.getValue(e)}return e}findLinkForKey(t){if(null==t)return null;const e=this.diagram.model.findLinkDataForKey(t);return null!==e?this.pl.getValue(e):null}doModelChanged(t){if(super.doModelChanged(t),!this.diagram)return;const e=this.diagram;if(t.model!==e.model)return;const i=t.change;if(e.G){e.G=!1;try{const n=t.modelChange;if(""!==n){if(2===i){if("linkFromKey"===n){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue,n=this.findNodeForKey(e);i.fromNode=n}}else if("linkToKey"===n){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue,n=this.findNodeForKey(e);i.toNode=n}}else if("linkFromPortId"===n){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue;"string"==typeof e&&(i.fromPortId=e)}}else if("linkToPortId"===n){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue;"string"==typeof e&&(i.toPortId=e)}}else if("nodeGroupKey"===n){const e=t.object,i=this.findPartForData(e);if(null!==i){const e=t.newValue;if(void 0!==e){const t=this.findNodeForKey(e);i.containingGroup=t instanceof Ve?t:null}else i.containingGroup=null}}else if("linkLabelKeys"===n){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.oldValue,n=t.newValue;Array.isArray(e)&&e.forEach((t=>{if(n.indexOf(t)>=0)return;const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=null)})),Array.isArray(n)&&n.forEach((t=>{const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=i)}))}}else if("linkCategory"===n){const e=t.object,i=this.findLinkForData(e),n=t.newValue;null!==i&&"string"==typeof n&&(i.category=n)}else if("linkDataArray"===n){const e=t.oldValue;this.xT(e);const i=t.newValue;this.yT(i)}e.isModified=!0}else if(3===i){const i=t.newValue;if("linkDataArray"===n&&"object"==typeof i&&null!==i)this.wT(i);else if("linkLabelKeys"===n&&t.model.isKeyType(i)){const e=t.object,n=this.findLinkForData(e),s=this.findNodeForKey(i);null!==n&&null!==s&&(s.labeledLink=n)}e.isModified=!0}else if(4===i){const i=t.oldValue;if("linkDataArray"===n&&"object"==typeof i&&null!==i)this.S1(i);else if("linkLabelKeys"===n&&t.model.isKeyType(i)){const t=this.findNodeForKey(i);null!==t&&(t.labeledLink=null)}e.isModified=!0}}else if(2===i){const i=t.propertyName,n=t.object;n===e.model&&("linkFromKeyProperty"===i||"linkToKeyProperty"===i||"linkFromPortIdProperty"===i||"linkToPortIdProperty"===i||"linkLabelKeysProperty"===i||"nodeIsGroupProperty"===i||"nodeGroupKeyProperty"===i||"linkCategoryProperty"===i)&&(e.undoManager.isUndoingRedoing||this.rebuildParts()),e.isModified=!0}}finally{e.G=!0}}}pT(){const t=this.diagram.model,e=new k,i=t.linkDataArray;i.forEach((t=>{e.add(t)}));const n=[];this.links.each((t=>{null!==t.data&&!e.contains(t.data)&&n.push(t.data)})),n.forEach((e=>{t.bT(e,!1)})),i.forEach((e=>{null===this.findLinkForData(e)&&t.kT(e,!1)}))}updateRelationshipsFromData(t){const e=t.data;if(null===e)return;const i=t.diagram;if(null===i)return;const n=i.model;if(t instanceof De){let s=n.Re(e,!0),o=i.findNodeForKey(s);t.fromNode=o,s=n.Re(e,!1),o=i.findNodeForKey(s),t.toNode=o;const r=n.getLabelKeysForLinkData(e);if(r.length>0||t.labelNodes.count>0){if(1===r.length&&1===t.labelNodes.count){const e=r[0],i=t.labelNodes.first();if(n.getKeyForNodeData(i.data)===e)return}const e=(new k).addAll(r),s=new k;t.labelNodes.each((t=>{if(null!==t.data){const e=n.getKeyForNodeData(t.data);void 0!==e&&s.add(e)}}));const o=s.copy();o.removeAll(e);const a=e.copy();if(a.removeAll(s),o.count>0||a.count>0){const e=t;o.each((t=>{const n=i.findNodeForKey(t);null!==n&&n.labeledLink===e&&(n.labeledLink=null)})),a.each((t=>{const n=i.findNodeForKey(t);null!==n&&n.labeledLink!==e&&(n.labeledLink=e)}))}}}else if(!(t instanceof Pe)){const s=n.getGroupKeyForNodeData(e),o=i.findPartForKey(s);(null===o||o instanceof Ve)&&(t.containingGroup=o)}}M1(t){const e=this.diagram.model,i=e.getKeyForNodeData(t);if(void 0!==i){const n=e.Cy(i),s=this.findPartForData(t);if(null!==n&&null!==s){const t=n.iterator;for(;t.next();){const n=t.value;if(e.containsNodeData(n)){if(s instanceof Ve&&e.getGroupKeyForNodeData(n)===i){const t=this.findPartForData(n);null!==t&&(t.containingGroup=s)}}else{const t=this.findLinkForData(n);if(null!==t&&s instanceof Ce){e.Re(n,!0)===i&&(t.fromNode=s),e.Re(n,!1)===i&&(t.toNode=s);const o=e.getLabelKeysForLinkData(n);Array.isArray(o)&&o.some((e=>e===i&&(s.labeledLink=t,!0)))}}}e.$s(i)}const o=e.getGroupKeyForNodeData(t);if(void 0!==o){const t=this.findNodeForKey(o);t instanceof Ve&&(s.containingGroup=t)}}}uN(t){const e=this.diagram.model;if(t instanceof Ce){const i=e.getKeyForNodeData(t.data);if(void 0!==i){const n=t.linksConnected;for(;n.next();){const t=n.value;e.Zs(i,t.data)}if(t.isLinkLabel){const n=t.labeledLink;null!==n&&e.Zs(i,n.data)}if(t instanceof Ve){const n=t.memberParts;for(;n.next();){const t=n.value.data;e.containsNodeData(t)&&e.Zs(i,t)}}}}}gN(t,e){let i=super.gN(t,e);if(t instanceof De){const n=t.data;if(null!==n&&null!==e){const t=e.model,s=t.copyLinkData(n);"object"==typeof s&&null!==s&&(t.addLinkData(s),i=e.findLinkForData(s))}else if(null!==i){const t=this.diagram;if(null!==n&&null!==t&&null!==t.commandHandler&&t.commandHandler.copiesClipboardData){const e=t.model.copyLinkData(n);"object"==typeof e&&null!==e&&(i.data=e)}}}return i}insertLink(t,e,i,n){const s=this.diagram,o=s.model,r=s.toolManager.findTool("Linking");let a="";null!==t&&(null===e&&(e=t),a=e.portId,null===a&&(a=""));let l="";null!==i&&(null===n&&(n=i),l=n.portId,null===l&&(l=""));const h=r.archetypeLinkData;if(h instanceof De){h.hi();const e=h.copy();if(null!==e){e.fromNode=t,e.fromPortId=a,e.toNode=i,e.toPortId=l,s.add(e);const n=r.archetypeLabelNodeData;if(n instanceof Ce){n.hi();const t=n.copy();null!==t&&(t.labeledLink=e,s.add(t))}return e}}else if(null!==h){const e=o.copyLinkData(h);if("object"==typeof e&&null!==e){null!==t&&o._d(e,o.getKeyForNodeData(t.data),!0),o.tg(e,a,!0),null!==i&&o._d(e,o.getKeyForNodeData(i.data),!1),o.tg(e,l,!1),o.addLinkData(e);const n=r.archetypeLabelNodeData;if(null!==n&&!(n instanceof Ce)){const t=o.copyNodeData(n);if("object"==typeof t&&null!==t){o.addNodeData(t);const i=o.getKeyForNodeData(t);void 0!==i&&o.addLabelKeyForLinkData(e,i)}}return s.findLinkForData(e)}}return null}}),Dt.fS("TreeModel",class extends qe{constructor(){super(...arguments),y(this,"Mh",null)}L1(t,e){if(null===t||null===e||null!==e.findTreeParentLink())return null;const i=this.diagram.toolManager.findTool("Linking");let n=t,s=e;if(this.diagram.isTreePathToChildren){if(null!==i&&i.xu(n,s,null,!0))return null}else if(n=e,s=t,null!==i&&i.xu(n,s,null,!0))return null;const o=this.getLinkCategoryForData(e.data),r=this.findLinkTemplateForCategory(o);if(null!==r){r.hi();const t=r.copy();if(null!==t){const i=this.diagram.ge;return this.diagram.ge=!0,t.Wo=o,t.Qt=e.data,t.fromNode=n,t.toNode=s,this.diagram.add(t),t.Qt=null,t.data=e.data,this.diagram.ge=i,t}}return null}getLinkCategoryForData(t){return this.diagram.model.getParentLinkCategoryForNodeData(t)}setLinkCategoryForData(t,e){this.diagram.model.setParentLinkCategoryForNodeData(t,e)}setFromNodeForLink(t,e,i){const n=this.diagram.model;void 0===i&&(i=null);const s=null!==e?e.data:null;if(this.diagram.isTreePathToChildren)n.setParentKeyForNodeData(t.data,n.getKeyForNodeData(s));else{const e=this.Mh;this.Mh=t,null!==i&&n.setParentKeyForNodeData(i.data,void 0);const o=null!==t.toNode?t.toNode.data:null;n.setParentKeyForNodeData(s,n.getKeyForNodeData(o)),this.Mh=e}}setToNodeForLink(t,e,i){const n=this.diagram.model;void 0===i&&(i=null);const s=null!==e?e.data:null;if(this.diagram.isTreePathToChildren){const e=this.Mh;this.Mh=t,null!==i&&n.setParentKeyForNodeData(i.data,void 0);const o=null!==t.fromNode?t.fromNode.data:null;n.setParentKeyForNodeData(s,n.getKeyForNodeData(o)),this.Mh=e}else n.setParentKeyForNodeData(t.data,n.getKeyForNodeData(s))}eN(t){this.diagram.model.setParentKeyForNodeData(t.data,void 0)}findLinkForKey(t){if(null==t)return null;const e=this.diagram.model.findNodeDataForKey(t);return null!==e?this.pl.getValue(e):null}doModelChanged(t){if(super.doModelChanged(t),!this.diagram)return;const e=this.diagram;if(t.model!==e.model)return;const i=t.change;if(e.G){e.G=!1;try{const n=t.modelChange;if(""!==n){if(2===i){if("nodeParentKey"===n){const i=t.object,n=t.newValue,s=this.findNodeForKey(n),o=this.findNodeForData(i);if(null!==this.Mh)null!==s&&(this.Mh.data=i,this.Mh.category=this.getLinkCategoryForData(i));else if(null!==o){const t=o.findTreeParentLink();null!==t?null===s?e.remove(t):e.isTreePathToChildren?t.fromNode=s:t.toNode=s:this.L1(s,o)}}else if("parentLinkCategory"===n){const e=t.object,i=this.findNodeForData(e),n=t.newValue;if(null!==i&&"string"==typeof n){const t=i.findTreeParentLink();null!==t&&(t.category=n)}}e.isModified=!0}}else if(2===i){const i=t.propertyName,n=t.object;n===e.model&&"nodeParentKeyProperty"===i&&(e.undoManager.isUndoingRedoing||this.rebuildParts()),e.isModified=!0}}finally{e.G=!0}}}updateRelationshipsFromData(t){const e=t.data;if(null===e)return;const i=t.diagram;if(null===i)return;const n=i.model;if(t instanceof Ce){const s=n.getParentKeyForNodeData(e),o=i.findNodeForKey(s);if(o!==t.findTreeParentNode()){const e=t.findTreeParentLink();null!==o?null!==e?i.isTreePathToChildren?e.fromNode=o:e.toNode=o:this.L1(o,t):null!==e&&i.PS(e,!1)}}}Ny(t,e){if(super.Ny(t,e),"string"==typeof e&&null!==this.findPartForData(t)){const i=this.findLinkForData(t);null!==i&&i.updateTargetBindings(e)}}M1(t){const e=this.diagram.model,i=e.getKeyForNodeData(t);if(void 0!==i){const n=e.Cy(i),s=this.findPartForData(t);if(null!==n&&null!==s){const t=n.iterator;for(;t.next();){const n=t.value;if(e.containsNodeData(n)&&s instanceof Ce&&e.getParentKeyForNodeData(n)===i){const t=this.findNodeForData(n);this.L1(s,t)}}e.$s(i)}const o=e.getParentKeyForNodeData(t);if(void 0!==o&&s instanceof Ce){const t=this.findNodeForKey(o);this.L1(t,s)}}}uN(t){const e=this.diagram.model;if(t instanceof Ce){const i=e.getKeyForNodeData(t.data),n=this.findLinkForData(t.data);if(null!==n){n.isSelected=!1,n.isHighlighted=!1;const t=n.layer;if(null!==t){const e=t.ie(-1,n,!1);e>=0&&this.diagram.raiseChangedEvent(4,"parts",t,n,null,e,null);const i=n.layerChanged;null!==i&&i(n,t,null)}}const s=this.diagram.isTreePathToChildren,o=t.linksConnected;for(;o.next();){const t=o.value,n=(s?t.toNode:t.fromNode).data;e.containsNodeData(n)&&e.Zs(i,n)}}}insertLink(t,e,i,n){const s=this.diagram.model;let o=t,r=i;if(this.diagram.isTreePathToChildren||(o=i,r=t),null!==o&&null!==r){const t=o.data,e=r.data;return s.setParentKeyForNodeData(e,s.getKeyForNodeData(t)),r.findTreeParentLink()}return null}});const ji=c.go,Ui={get version(){return Dt.version},Group:Ve,List:x,Set:k,Map:L,Point:T,Size:A,Rect:D,Margin:F,Spot:O,Geometry:z,PathFigure:j,PathSegment:K,InputEvent:G,DiagramEvent:X,ChangedEvent:_,Model:Ze,GraphLinksModel:Qe,TreeModel:ti,Binding:$e,ThemeBinding:Je,Transaction:H,UndoManager:q,CommandHandler:Vt,Tool:W,DraggingTool:Q,DraggingInfo:Ot,DraggingOptions:Et,LinkingBaseTool:tt,LinkingTool:it,RelinkingTool:nt,LinkReshapingTool:ot,ResizingTool:rt,RotatingTool:at,ClickSelectingTool:lt,ActionTool:ht,ClickCreatingTool:ut,HTMLInfo:ft,ContextMenuTool:mt,DragSelectingTool:ct,PanningTool:dt,TextEditingTool:bt,ToolManager:Z,Animation:kt,AnimationManager:wt,AnimationTrigger:Mt,Layer:Ct,Diagram:Dt,Palette:class extends Dt{constructor(t,e){return"string"==typeof t||c.Element&&t instanceof Element?super(t):(super(),e=t),this.YL(),e&&this.setProperties(e),this}YL(){this.allowDragOut=!0,this.allowMove=!1,this.isReadOnly=!0,this.contentAlignment=O.TopCenter,this.layout=new He}setupRouters(){}reset(){super.reset(),this.YL()}},Overview:Bt,Brush:Qt,GraphObject:Kt,Panel:ie,RowColumnDefinition:ae,Shape:le,TextBlock:fe,Picture:ye,Part:ke,Adornment:Pe,Node:Ce,Link:De,Placeholder:ze,Layout:je,LayoutNetwork:Ue,LayoutVertex:Ke,LayoutEdge:Ge,GridLayout:He,PanelLayout:te,CircularLayout:oi,CircularNetwork:ai,CircularVertex:li,CircularEdge:hi,ForceDirectedLayout:ui,ForceDirectedNetwork:ci,ForceDirectedVertex:di,ForceDirectedEdge:fi,LayeredDigraphLayout:wi,LayeredDigraphNetwork:ki,LayeredDigraphVertex:Si,LayeredDigraphEdge:Pi,TreeLayout:Fi,TreeNetwork:Oi,TreeVertex:Ri,TreeEdge:Ei,Themes:Bi,ThemeManager:Ii,Router:Vi,AnimationStyle:xt,AutoScale:Nt,CycleMode:Lt,Flip:Ut,TextFormat:de,ImageStretch:pe,LayoutConditions:we,LinkAdjusting:Le,Curve:Ae,Routing:Te,Orientation:jt,TextOverflow:ce,PortSpreading:Me,ScrollMode:Tt,CollapsePolicy:At,Sizing:re,TriggerStart:Pt,Stretch:zt,ViewboxStretch:ee,Wrap:ue,BrushType:$t,ColorSpace:Jt,GeometryStretch:V,GeometryType:I,SegmentType:U,BindingMode:We,ChangeType:Y,CircularArrangement:ei,CircularDirection:ii,CircularNodeDiameterFormula:si,CircularSorting:ni,GridAlignment:Xe,GridArrangement:Ye,GridSorting:_e,LayeredDigraphAggressive:vi,LayeredDigraphAlign:xi,LayeredDigraphCycleRemove:mi,LayeredDigraphInit:yi,LayeredDigraphLayering:pi,LayeredDigraphPack:bi,TreeAlignment:Ni,TreeArrangement:Ai,TreeCompaction:Li,TreeLayerStyle:Di,TreePath:Mi,TreeSorting:Ci,TreeStyle:Ti,GestureMode:J,LinkingDirection:et,ReshapingBehavior:st,TextEditingAccept:pt,TextEditingStarting:yt,TextEditingState:vt,WheelMode:$};"object"==typeof ji&&ji.version&&d.ri("WARNING: a `go` object on the root object is already defined.  "+("Debug"in ji?"debug ":"")+"version: "+ji.version+", replaced with version: "+Ui.version),Dt.prototype.go=Ui,c.go=Ui}();"undefined"!==typeof global?global.go:self.go;const v="undefined"!==typeof global?global.go:self.go,b=(v.Group,v.List,v.Set,v.Map,v.Point,v.Size,v.Rect,v.Margin,v.Spot),x=(v.Geometry,v.PathFigure,v.PathSegment,v.InputEvent,v.DiagramEvent,v.ChangedEvent,v.Model,v.GraphLinksModel),w=(v.TreeModel,v.Binding),k=(v.ThemeBinding,v.Transaction,v.UndoManager,v.CommandHandler,v.Tool,v.DraggingTool,v.DraggingInfo,v.DraggingOptions,v.LinkingBaseTool,v.LinkingTool,v.RelinkingTool,v.LinkReshapingTool,v.ResizingTool,v.RotatingTool,v.ClickSelectingTool,v.ActionTool,v.ClickCreatingTool,v.HTMLInfo,v.ContextMenuTool,v.DragSelectingTool,v.PanningTool,v.TextEditingTool,v.ToolManager,v.Animation,v.AnimationManager,v.AnimationTrigger,v.Layer,v.Diagram),S=(v.Palette,v.Overview),P=(v.Brush,v.GraphObject),M=(v.Panel,v.RowColumnDefinition,v.Shape),C=v.TextBlock,N=(v.Picture,v.Part,v.Adornment,v.Node),L=v.Link,T=(v.Placeholder,v.Layout,v.LayoutNetwork,v.LayoutVertex,v.LayoutEdge,v.GridLayout,v.PanelLayout,v.CircularLayout,v.CircularNetwork,v.CircularVertex,v.CircularEdge,v.ForceDirectedLayout,v.ForceDirectedNetwork,v.ForceDirectedVertex,v.ForceDirectedEdge,v.LayeredDigraphLayout,v.LayeredDigraphNetwork,v.LayeredDigraphVertex,v.LayeredDigraphEdge,v.TreeLayout),A=(v.TreeNetwork,v.TreeVertex,v.TreeEdge,v.Themes,v.ThemeManager,v.Router,v.version,v.AnimationStyle,v.AutoScale),D=v.Curve,F=(v.CycleMode,v.Flip,v.ImageStretch,v.LayoutConditions,v.LinkAdjusting),O=(v.Orientation,v.PortSpreading,v.Routing,v.ScrollMode,v.CollapsePolicy,v.Sizing,v.TriggerStart,v.Stretch,v.TextFormat,v.TextOverflow,v.ViewboxStretch,v.Wrap,v.BrushType,v.ColorSpace,v.GeometryStretch,v.GeometryType,v.SegmentType,v.BindingMode,v.ChangeType,v.CircularArrangement,v.CircularDirection,v.CircularNodeDiameterFormula,v.CircularSorting,v.GridAlignment,v.GridArrangement,v.GridSorting,v.LayeredDigraphAggressive,v.LayeredDigraphAlign,v.LayeredDigraphCycleRemove,v.LayeredDigraphInit,v.LayeredDigraphLayering,v.LayeredDigraphPack,v.TreeAlignment),R=(v.TreeArrangement,v.TreeCompaction,v.TreeLayerStyle,v.TreePath,v.TreeSorting,v.TreeStyle,v.GestureMode,v.LinkingDirection,v.ReshapingBehavior,v.TextEditingAccept,v.TextEditingStarting,v.TextEditingState,v.WheelMode);var E=function(t,e){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},E(t,e)};function B(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}E(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}Object.create;Object.create;var I=function(e){function i(i){var n=e.call(this,i)||this;return n.wasCleared=!1,n.modelChangedListener=null,n.divRef=t.createRef(),n}return B(i,e),i.prototype.getDiagram=function(){return null===this.divRef.current?null:k.fromDiv(this.divRef.current)},i.prototype.clear=function(){var t=this.getDiagram();null!==t&&(t.clear(),this.wasCleared=!0)},i.prototype.componentDidMount=function(){var t=this;if(null!==this.divRef.current){var e=this.props.initDiagram();e.div=this.divRef.current,this.modelChangedListener=function(e){if(e.isTransactionFinished&&e.model&&!e.model.isReadOnly&&t.props.onModelChange){var i=e.model.toIncrementalData(e);null!==i&&t.props.onModelChange(i)}},e.addModelChangedListener(this.modelChangedListener),e.delayInitialization((function(){t.mergeData(e,!0)}))}},i.prototype.componentWillUnmount=function(){var t=this.getDiagram();null!==t&&(t.div=null,null!==this.modelChangedListener&&(t.removeModelChangedListener(this.modelChangedListener),this.modelChangedListener=null))},i.prototype.shouldComponentUpdate=function(t,e){return t.divClassName!==this.props.divClassName||t.style!==this.props.style||!t.skipsDiagramUpdate&&(t.nodeDataArray!==this.props.nodeDataArray||t.linkDataArray!==this.props.linkDataArray||t.modelData!==this.props.modelData)},i.prototype.componentDidUpdate=function(t,e){var i=this;if(t.nodeDataArray!==this.props.nodeDataArray||t.linkDataArray!==this.props.linkDataArray||t.modelData!==this.props.modelData){var n=this.getDiagram();null!==n&&(this.wasCleared?n.delayInitialization((function(){i.mergeData(n,!0),i.wasCleared=!1})):this.mergeData(n,!1))}},i.prototype.mergeData=function(t,e){var i=this;t.model.commit((function(t){void 0!==i.props.modelData&&t.assignAllDataProperties(t.modelData,i.props.modelData),t.mergeNodeDataArray(i.props.nodeDataArray),void 0!==i.props.linkDataArray&&t instanceof x&&t.mergeLinkDataArray(i.props.linkDataArray)}),e?"initial merge":"merge data")},i.prototype.render=function(){return t.createElement("div",{ref:this.divRef,className:this.props.divClassName,style:this.props.style})},i}(t.Component);(function(e){function i(i){var n=e.call(this,i)||this;return n.divRef=t.createRef(),n}B(i,e),i.prototype.getOverview=function(){return null===this.divRef.current?null:k.fromDiv(this.divRef.current)},i.prototype.componentDidMount=function(){var t;null!==this.divRef.current&&(void 0!==this.props.initOverview?t=this.props.initOverview():(t=new S).contentAlignment=b.Center,t.div=this.divRef.current,t.observed=this.props.observedDiagram)},i.prototype.componentWillUnmount=function(){var t=this.getOverview();null!==t&&(t.div=null,t.observed=null)},i.prototype.shouldComponentUpdate=function(t,e){return t.divClassName!==this.props.divClassName||t.style!==this.props.style||t.observedDiagram!==this.props.observedDiagram},i.prototype.componentDidUpdate=function(t,e){if(t.observedDiagram!==this.props.observedDiagram){var i=this.getOverview();null!==i&&(i.observed=this.props.observedDiagram)}},i.prototype.render=function(){return t.createElement("div",{ref:this.divRef,className:this.props.divClassName,style:this.props.style})}})(t.Component),function(e){function i(i){var n=e.call(this,i)||this;return n.wasCleared=!1,n.divRef=t.createRef(),n}B(i,e),i.prototype.getPalette=function(){return null===this.divRef.current?null:k.fromDiv(this.divRef.current)},i.prototype.clear=function(){var t=this.getPalette();null!==t&&(t.clear(),this.wasCleared=!0)},i.prototype.componentDidMount=function(){var t=this;if(null!==this.divRef.current){var e=this.props.initPalette();e.div=this.divRef.current,e.delayInitialization((function(){t.mergeData(e,!0)}))}},i.prototype.componentWillUnmount=function(){var t=this.getPalette();null!==t&&(t.div=null)},i.prototype.shouldComponentUpdate=function(t,e){return t.divClassName!==this.props.divClassName||t.style!==this.props.style||(t.nodeDataArray!==this.props.nodeDataArray||t.linkDataArray!==this.props.linkDataArray||t.modelData!==this.props.modelData)},i.prototype.componentDidUpdate=function(t,e){var i=this;if(t.nodeDataArray!==this.props.nodeDataArray||t.linkDataArray!==this.props.linkDataArray||t.modelData!==this.props.modelData){var n=this.getPalette();null!==n&&(this.wasCleared?n.delayInitialization((function(){i.mergeData(n,!0),i.wasCleared=!1})):this.mergeData(n,!1))}},i.prototype.mergeData=function(t,e){var i=this;t.model.commit((function(t){void 0!==i.props.modelData&&t.assignAllDataProperties(t.modelData,i.props.modelData),t.mergeNodeDataArray(i.props.nodeDataArray),void 0!==i.props.linkDataArray&&t instanceof x&&t.mergeLinkDataArray(i.props.linkDataArray)}),e?"initial merge":"merge data")},i.prototype.render=function(){return t.createElement("div",{ref:this.divRef,className:this.props.divClassName,style:this.props.style})}}(t.Component);const V=()=>{const t=P.make,e=t(k,{initialAutoScale:A.UniformToFill,"undoManager.isEnabled":!0,allowZoom:!0,allowHorizontalScroll:!0,allowVerticalScroll:!0,layout:t(T,{angle:0,layerSpacing:500,nodeSpacing:10,alignment:O.Start}),"toolManager.mouseWheelBehavior":R.Zoom});return e.nodeTemplate=t(N,"Auto",{selectionChanged:t=>{t.findLinksConnected().each((e=>e.isHighlighted=t.isSelected))}},t(M,"RoundedRectangle",{fill:"white"},new w("fill","color",(t=>t.background))),t(C,{margin:5},new w("text","label"))),e.linkTemplate=t(L,{curve:D.Bezier,toEndSegmentLength:300,fromEndSegmentLength:300,curviness:40,adjusting:F.Stretch,reshapable:!0,relinkableFrom:!0,relinkableTo:!0,selectionAdorned:!1,isHighlighted:!1},t(M,{strokeWidth:1},new w("stroke","isHighlighted",(t=>t?"#E3CB00":"black")).ofObject()),t(M,{toArrow:""})),e},z=e=>{let{filters:i}=e;const n=(0,t.useRef)();return(0,t.useEffect)((()=>{const t=c.filter((t=>t.groups.some((t=>i[t]))));if(n.current){n.current.getDiagram().model=new x(t.map((t=>({key:t.id,...t}))),d)}}),[i]),(0,f.jsx)(I,{ref:n,initDiagram:V,divClassName:"diagram-component",style:{width:"100vw",height:"50vh",border:"1px solid #333",margin:"20px auto"}})},j=()=>{const[e,i]=(0,t.useState)({apm:!0,server:!0,k8s:!0,db:!0,url:!0,browser:!0,cloud:!0,npm:!0}),n=t=>{const{name:e,checked:n}=t.target;i((t=>({...t,[e]:n})))};return(0,f.jsxs)("div",{className:"App",children:[(0,f.jsx)("h1",{children:"WhaTap Monitoring"}),(0,f.jsx)("p",{children:(0,f.jsx)("a",{href:"https://github.com/whatap/menu-tree-app.git",target:"_blank",rel:"noreferrer",children:"whatap/menu-tree-app"})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("button",{onClick:()=>{const t=Object.keys(e).reduce(((t,e)=>(t[e]=!0,t)),{});i(t)},children:"\ubaa8\ub450 \uc120\ud0dd"}),(0,f.jsx)("button",{onClick:()=>{const t=Object.keys(e).reduce(((t,e)=>(t[e]=!1,t)),{});i(t)},children:"\ubaa8\ub450 \ud574\uc81c"}),Object.keys(e).map((t=>(0,f.jsxs)("label",{children:[(0,f.jsx)("input",{type:"checkbox",name:t,checked:e[t],onChange:n}),t]},t)))]}),(0,f.jsxs)("div",{class:"grid",children:[(0,f.jsx)(z,{filters:e}),(0,f.jsx)(g,{filters:e})]})]})},U=t=>{t&&t instanceof Function&&i.e(488).then(i.bind(i,488)).then((e=>{let{getCLS:i,getFID:n,getFCP:s,getLCP:o,getTTFB:r}=e;i(t),n(t),s(t),o(t),r(t)}))};e.createRoot(document.getElementById("root")).render((0,f.jsx)(t.StrictMode,{children:(0,f.jsx)(j,{})})),U()})()})();
//# sourceMappingURL=main.6c8c0d72.js.map